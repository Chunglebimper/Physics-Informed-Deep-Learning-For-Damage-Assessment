Loaded metrics.py from: /home/caiden/PycharmProjects/Physics-Informed-Deep-Learning-For-Damage-Assessment/src/metrics.py
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27192573520735697, 1: 0.7597378967436342, 2: 186.17906340164237, 3: 1385.4018166804294, 4: 5292.497160883281}
Final class weights used in loss: [2.142537299090924, 0.7597378967436342, 186.17906340164237, 1385.4018166804294, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5764
Confusion Matrix:
 [[1880976 1546693  995967  246552     891]
 [ 514316  629853  590412  127738     764]
 [   1814    4394    6950    3308       0]
 [   1667     620     393     292       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5321
Class 1 F1: 0.3115
Class 2 F1: 0.0086
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.7841
Class 1 Precision: 0.2887
Class 2 Precision: 0.0044
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.4027
Class 1 Recall: 0.3381
Class 2 Recall: 0.4221
Class 3 Recall: 0.0983
Class 4 Recall: 0.0000
Validation Accuracy: 0.3842
Macro F1 Score: 0.1707
xView2 Score: 0.2100
Epoch 1 took:  0 hours,  1 minutes,  5 seconds

Epoch 2/10
Train Loss: 1.4738
Confusion Matrix:
 [[3580714  607511  405435   77131     288]
 [1235136  291865  290602   45284     196]
 [  10272    3090    1353    1751       0]
 [    675     607    1669      21       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7540
Class 1 F1: 0.2110
Class 2 F1: 0.0038
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.7418
Class 1 Precision: 0.3232
Class 2 Precision: 0.0019
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.7666
Class 1 Recall: 0.1567
Class 2 Recall: 0.0822
Class 3 Recall: 0.0071
Class 4 Recall: 0.0000
Validation Accuracy: 0.5911
Macro F1 Score: 0.1938
xView2 Score: 0.1450
Epoch 2 took:  0 hours,  0 minutes, 50 seconds

Epoch 3/10
Train Loss: 1.3892
Confusion Matrix:
 [[4398317  159694   97014   16008      46]
 [1691361   85725   76105    9832      60]
 [  15049     698     719       0       0]
 [   1861      50    1061       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8162
Class 1 F1: 0.0813
Class 2 F1: 0.0075
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7203
Class 1 Precision: 0.3482
Class 2 Precision: 0.0041
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9416
Class 1 Recall: 0.0460
Class 2 Recall: 0.0437
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6843
Macro F1 Score: 0.1810
xView2 Score: 0.0593
Epoch 3 took:  0 hours,  0 minutes, 30 seconds

Epoch 4/10
Train Loss: 1.3012
Confusion Matrix:
 [[4592874   47763   25618    4824       0]
 [1812221   26533   21286    3040       3]
 [  16317      49     100       0       0]
 [   2721      12     239       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8279
Class 1 F1: 0.0274
Class 2 F1: 0.0031
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7149
Class 1 Precision: 0.3568
Class 2 Precision: 0.0021
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9833
Class 1 Recall: 0.0142
Class 2 Recall: 0.0061
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7049
Macro F1 Score: 0.1717
xView2 Score: 0.0200
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2153
Confusion Matrix:
 [[4655200   10807    4513     559       0]
 [1848371   10008    4072     632       0]
 [  16296     168       0       2       0]
 [   2969       2       0       1       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8317
Class 1 F1: 0.0106
Class 2 F1: 0.0000
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7137
Class 1 Precision: 0.4769
Class 2 Precision: 0.0000
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.9966
Class 1 Recall: 0.0054
Class 2 Recall: 0.0000
Class 3 Recall: 0.0003
Class 4 Recall: 0.0000
Validation Accuracy: 0.7119
Macro F1 Score: 0.2107
xView2 Score: 0.0066
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1439
Confusion Matrix:
 [[4669509    1166     358      45       1]
 [1861108    1603     299      73       0]
 [  16466       0       0       0       0]
 [   2972       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0017
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7129
Class 1 Precision: 0.5789
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0009
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.1668
xView2 Score: 0.0009
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0666
Confusion Matrix:
 [[4670864     164      34      17       0]
 [1862432     530      99      22       0]
 [  16466       0       0       0       0]
 [   2972       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7128
Class 1 Precision: 0.7637
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.2082
xView2 Score: 0.0003
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0325
Confusion Matrix:
 [[4671079       0       0       0       0]
 [1863035      48       0       0       0]
 [  16466       0       0       0       0]
 [   2972       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7128
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.2081
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9685
Confusion Matrix:
 [[4671079       0       0       0       0]
 [1863083       0       0       0       0]
 [  16466       0       0       0       0]
 [   2972       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7128
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.2081
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.9370
Confusion Matrix:
 [[4671079       0       0       0       0]
 [1863083       0       0       0       0]
 [  16466       0       0       0       0]
 [   2972       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7128
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.2081
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3842
Best Macro F1: 0.1707
Best xView2 Score: 0.2100
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7841
Class 1 Precision: 0.2887
Class 2 Precision: 0.0044
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Macro Precision: 0.2156
ROC curve saved to .././____________optune_results/50/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/50/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/50/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/50/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/50/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/50/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/50/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2716196348716244, 1: 0.7630458373445116, 2: 151.25964838467317, 3: 958.150542547116, 4: 5292.497160883281}
Final class weights used in loss: [0.3754479369631737, 0.7630458373445116, 151.25964838467317, 958.150542547116, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5398
Confusion Matrix:
 [[3772193  848487    3699   22414    3427]
 [1383360  490622    1388   14535    1898]
 [   7913    2310       0       2       0]
 [   1073     279       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7687
Class 1 F1: 0.3035
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.3657
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8112
Class 1 Recall: 0.2593
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6505
Macro F1 Score: 0.2144
xView2 Score: 0.1507
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5024
Confusion Matrix:
 [[3742522  895013    4696    7130     859]
 [1311298  574759     973    4194     579]
 [   7562    2653       0      10       0]
 [    848     504       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7707
Class 1 F1: 0.3416
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7393
Class 1 Precision: 0.3902
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8048
Class 1 Recall: 0.3038
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6588
Macro F1 Score: 0.2225
xView2 Score: 0.1683
Epoch 2 took:  0 hours,  0 minutes, 59 seconds

Epoch 3/10
Train Loss: 1.4869
Confusion Matrix:
 [[3761774  884437    1433    2510      66]
 [1263232  626430     915    1196      30]
 [   7414    2810       0       1       0]
 [    812     540       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7769
Class 1 F1: 0.3678
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7474
Class 1 Precision: 0.4137
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8089
Class 1 Recall: 0.3311
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6696
Macro F1 Score: 0.2290
xView2 Score: 0.1803
Epoch 3 took:  0 hours,  0 minutes, 34 seconds

Epoch 4/10
Train Loss: 1.4425
Confusion Matrix:
 [[3596194 1051753     996    1276       1]
 [1027102  863347     526     828       0]
 [   5420    4796       0       9       0]
 [    949     403       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7751
Class 1 F1: 0.4530
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7768
Class 1 Precision: 0.4496
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7733
Class 1 Recall: 0.4564
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6805
Macro F1 Score: 0.2456
xView2 Score: 0.2458
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.4113
Confusion Matrix:
 [[3518569 1129797    1276     578       0]
 [ 974083  916299    1128     293       0]
 [   7828    2397       0       0       0]
 [    782     570       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7690
Class 1 F1: 0.4650
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7817
Class 1 Precision: 0.4472
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7566
Class 1 Recall: 0.4844
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6767
Macro F1 Score: 0.3085
xView2 Score: 0.2537
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3893
Confusion Matrix:
 [[3363991 1284628    1230     371       0]
 [ 866764 1024124     824      91       0]
 [   5731    4494       0       0       0]
 [    665     687       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7570
Class 1 F1: 0.4870
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7939
Class 1 Precision: 0.4426
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7234
Class 1 Recall: 0.5413
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6696
Macro F1 Score: 0.3110
xView2 Score: 0.2692
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3446
Confusion Matrix:
 [[3296173 1352408    1498     141       0]
 [ 817188 1073532    1031      52       0]
 [   5195    5027       3       0       0]
 [    653     699       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7517
Class 1 F1: 0.4966
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8002
Class 1 Precision: 0.4415
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7088
Class 1 Recall: 0.5675
Class 2 Recall: 0.0003
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6668
Macro F1 Score: 0.3122
xView2 Score: 0.2760
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.3467
Confusion Matrix:
 [[3262610 1385605    1967      38       0]
 [ 750916 1139269    1596      22       0]
 [   5711    4514       0       0       0]
 [    555     797       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7526
Class 1 F1: 0.5153
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8116
Class 1 Precision: 0.4503
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7016
Class 1 Recall: 0.6022
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6717
Macro F1 Score: 0.3170
xView2 Score: 0.2863
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2862
Confusion Matrix:
 [[3119791 1528397    2006      26       0]
 [ 676276 1214418    1106       3       0]
 [   5622    4603       0       0       0]
 [    387     965       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7382
Class 1 F1: 0.5234
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8205
Class 1 Precision: 0.4419
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6709
Class 1 Recall: 0.6419
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6613
Macro F1 Score: 0.3154
xView2 Score: 0.2940
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2576
Confusion Matrix:
 [[3028301 1619675    2228      16       0]
 [ 596936 1293871     992       4       0]
 [   5558    4667       0       0       0]
 [    254    1098       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7314
Class 1 F1: 0.5379
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8340
Class 1 Precision: 0.4432
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6512
Class 1 Recall: 0.6839
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6595
Macro F1 Score: 0.3173
xView2 Score: 0.3036
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6595
Best Macro F1: 0.3173
Best xView2 Score: 0.3036
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8340
Class 1 Precision: 0.4432
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3193
ROC curve saved to .././____________optune_results/51/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/51/plot_loss_curves.jpg
Prediction distribution: {0: 194767, 1: 67377}
ROC curve saved to .././____________optune_results/51/visualize_predictions.jpg
Prediction distribution: {0: 104491, 1: 157653}
ROC curve saved to .././____________optune_results/51/visualize_predictions.jpg
Prediction distribution: {0: 53735, 1: 208409}
ROC curve saved to .././____________optune_results/51/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/51/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/51/plot_epoch_f1.jpg
[FrozenTrial(number=0, state=TrialState.COMPLETE, values=[0.17074564427903244, 0.6640211791992188, 1.2244227481739862], datetime_start=datetime.datetime(2025, 7, 22, 9, 39, 2, 325030), datetime_complete=datetime.datetime(2025, 7, 22, 9, 45, 9, 937380), params={'class1': 7.879126620572091}, user_attrs={'f1': 0.17074564427903244, 'accuracy': 0.6640211791992188, 'val_loss': 1.2244227481739862}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class1': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=0, value=None), FrozenTrial(number=1, state=TrialState.COMPLETE, values=[0.31730727790263547, 0.6664854736328124, 1.4529742853982106], datetime_start=datetime.datetime(2025, 7, 22, 9, 45, 9, 937715), datetime_complete=datetime.datetime(2025, 7, 22, 9, 52, 2, 907967), params={'class1': 1.3822562464625272}, user_attrs={'f1': 0.31730727790263547, 'accuracy': 0.6664854736328124, 'val_loss': 1.4529742853982106}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class1': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=1, value=None)]
append() takes 2 positional arguments but 3 were given
Loaded metrics.py from: /home/caiden/PycharmProjects/Physics-Informed-Deep-Learning-For-Damage-Assessment/src/metrics.py
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2718906275946392, 1: 0.760404196060924, 2: 167.43171551179267, 3: 1251.719671723452, 4: 5292.497160883281}
Final class weights used in loss: [4.33486358638055, 0.760404196060924, 167.43171551179267, 1251.719671723452, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5787
Confusion Matrix:
 [[3327837  531769  104503  547779  156801]
 [1196554  262759   65198  272977   71400]
 [   7522     759      87    4606     465]
 [    925    1444       0     215       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7233
Class 1 F1: 0.1971
Class 2 F1: 0.0009
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7342
Class 1 Precision: 0.3298
Class 2 Precision: 0.0005
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.7128
Class 1 Recall: 0.1406
Class 2 Recall: 0.0065
Class 3 Recall: 0.0832
Class 4 Recall: 0.0000
Validation Accuracy: 0.5479
Macro F1 Score: 0.1844
xView2 Score: 0.1395
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.4522
Confusion Matrix:
 [[4319668   91212   21065  195191   41553]
 [1700204   49563   12534   91184   15403]
 [  10558     159       0    2721       1]
 [   2495       0       0      89       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8073
Class 1 F1: 0.0493
Class 2 F1: 0.0000
Class 3 F1: 0.0006
Class 4 F1: 0.0000
Class 0 Precision: 0.7160
Class 1 Precision: 0.3517
Class 2 Precision: 0.0000
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.9252
Class 1 Recall: 0.0265
Class 2 Recall: 0.0000
Class 3 Recall: 0.0344
Class 4 Recall: 0.0000
Validation Accuracy: 0.6667
Macro F1 Score: 0.1714
xView2 Score: 0.0503
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.3402
Confusion Matrix:
 [[4631083    9428    1002   22863    4313]
 [1846551    4746     711   15130    1750]
 [  12940       0       0     499       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8298
Class 1 F1: 0.0050
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7132
Class 1 Precision: 0.3348
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9919
Class 1 Recall: 0.0025
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7074
Macro F1 Score: 0.1670
xView2 Score: 0.0078
Epoch 3 took:  0 hours,  1 minutes,  4 seconds

Epoch 4/10
Train Loss: 1.2289
Confusion Matrix:
 [[4666330     660       2    1673      24]
 [1867829     295      18     731      15]
 [  13418       0       0      21       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8319
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.3089
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7121
Macro F1 Score: 0.1664
xView2 Score: 0.0004
Epoch 4 took:  0 hours,  0 minutes, 32 seconds

Epoch 5/10
Train Loss: 1.1079
Confusion Matrix:
 [[4668682       7       0       0       0]
 [1868870      11       0       7       0]
 [  13439       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.6111
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.2080
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.0165
Confusion Matrix:
 [[4668689       0       0       0       0]
 [1868888       0       0       0       0]
 [  13439       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.2080
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 0.9288
Confusion Matrix:
 [[4668689       0       0       0       0]
 [1868888       0       0       0       0]
 [  13439       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.2080
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 0.8609
Confusion Matrix:
 [[4668689       0       0       0       0]
 [1868888       0       0       0       0]
 [  13439       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.2080
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8017
Confusion Matrix:
 [[4668689       0       0       0       0]
 [1868888       0       0       0       0]
 [  13439       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.2080
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.7536
Confusion Matrix:
 [[4668689       0       0       0       0]
 [1868888       0       0       0       0]
 [  13439       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7124
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.2080
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5479
Best Macro F1: 0.1844
Best xView2 Score: 0.1395
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7342
Class 1 Precision: 0.3298
Class 2 Precision: 0.0005
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Macro Precision: 0.2129
ROC curve saved to .././____________optune_results/52/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/52/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/52/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/52/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/52/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/52/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/52/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2738209369809752, 1: 0.7456967977275142, 2: 180.3226139294927, 3: 822.2781898382617, 4: 5292.497160883281}
Final class weights used in loss: [0.4030548446820124, 0.7456967977275142, 180.3226139294927, 822.2781898382617, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6257
Confusion Matrix:
 [[1843618  423455  118955 1505673  907487]
 [ 429855  174835   25073  600843  507734]
 [   6117    2044     254    4225    2948]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5209
Class 1 F1: 0.1495
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8086
Class 1 Precision: 0.2912
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3842
Class 1 Recall: 0.1006
Class 2 Recall: 0.0163
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3080
Macro F1 Score: 0.1347
xView2 Score: 0.1585
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5889
Confusion Matrix:
 [[2758898  778298  114067  795752  352173]
 [ 640782  417277   42417  393810  244054]
 [   7065    5057     174    3042     250]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6724
Class 1 F1: 0.2840
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8097
Class 1 Precision: 0.3475
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5749
Class 1 Recall: 0.2400
Class 2 Recall: 0.0112
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4847
Macro F1 Score: 0.1917
xView2 Score: 0.1903
Epoch 2 took:  0 hours,  1 minutes, 24 seconds

Epoch 3/10
Train Loss: 1.5610
Confusion Matrix:
 [[3360181  796232   97058  441278  104439]
 [ 866412  501976   41858  241716   86378]
 [  10176    3908     102    1242     160]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7437
Class 1 F1: 0.3302
Class 2 F1: 0.0013
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7930
Class 1 Precision: 0.3855
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7002
Class 1 Recall: 0.2888
Class 2 Recall: 0.0065
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5893
Macro F1 Score: 0.2150
xView2 Score: 0.1924
Epoch 3 took:  0 hours,  1 minutes, 24 seconds

Epoch 4/10
Train Loss: 1.5154
Confusion Matrix:
 [[3577239  977415   75716  143412   25406]
 [ 891619  702734   36208   85462   22317]
 [  10133    5205     129     111      10]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7711
Class 1 F1: 0.4105
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7986
Class 1 Precision: 0.4170
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7454
Class 1 Recall: 0.4043
Class 2 Recall: 0.0083
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6531
Macro F1 Score: 0.2367
xView2 Score: 0.2147
Epoch 4 took:  0 hours,  1 minutes, 21 seconds

Epoch 5/10
Train Loss: 1.4769
Confusion Matrix:
 [[3424818 1293501   40108   36736    4025]
 [ 746023  950327   15372   23739    2879]
 [   8960    6543      20      58       7]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7628
Class 1 F1: 0.4765
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8193
Class 1 Precision: 0.4223
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7136
Class 1 Recall: 0.5467
Class 2 Recall: 0.0013
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6676
Macro F1 Score: 0.2480
xView2 Score: 0.2441
Epoch 5 took:  0 hours,  1 minutes, 11 seconds

Epoch 6/10
Train Loss: 1.4438
Confusion Matrix:
 [[3443562 1315315   24444   15261     606]
 [ 680456 1033683   12607   11119     475]
 [   7817    7546       0     225       0]
 [    453      31       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7711
Class 1 F1: 0.5049
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8333
Class 1 Precision: 0.4386
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7175
Class 1 Recall: 0.5946
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6832
Macro F1 Score: 0.2552
xView2 Score: 0.2573
Epoch 6 took:  0 hours,  0 minutes, 50 seconds

Epoch 7/10
Train Loss: 1.3853
Confusion Matrix:
 [[3548073 1235282   13476    2296      61]
 [ 712782 1015666    7645    2212      35]
 [   9015    6373     190      10       0]
 [    478       6       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7824
Class 1 F1: 0.5084
Class 2 F1: 0.0103
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8309
Class 1 Precision: 0.4499
Class 2 Precision: 0.0089
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7393
Class 1 Recall: 0.5843
Class 2 Recall: 0.0122
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6964
Macro F1 Score: 0.2602
xView2 Score: 0.2587
Epoch 7 took:  0 hours,  0 minutes, 32 seconds

Epoch 8/10
Train Loss: 1.3347
Confusion Matrix:
 [[3490421 1299093    9094     575       5]
 [ 706862 1027705    3371     389      13]
 [   7891    7690       7       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7752
Class 1 F1: 0.5047
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8299
Class 1 Precision: 0.4402
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7273
Class 1 Recall: 0.5912
Class 2 Recall: 0.0004
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6894
Macro F1 Score: 0.2561
xView2 Score: 0.2558
Epoch 8 took:  0 hours,  0 minutes, 28 seconds

Epoch 9/10
Train Loss: 1.3365
Confusion Matrix:
 [[3634761 1159941    4274     212       0]
 [ 726311 1009229    2646     154       0]
 [   9201    6387       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7928
Class 1 F1: 0.5157
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8316
Class 1 Precision: 0.4639
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7574
Class 1 Recall: 0.5806
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7086
Macro F1 Score: 0.3271
xView2 Score: 0.2835
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.3147
Confusion Matrix:
 [[3582863 1213757    2349     219       0]
 [ 750827  986396     987     130       0]
 [   9871    5714       3       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7837
Class 1 F1: 0.5002
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8248
Class 1 Precision: 0.4472
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7466
Class 1 Recall: 0.5674
Class 2 Recall: 0.0002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6972
Macro F1 Score: 0.3211
xView2 Score: 0.2768
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7086
Best Macro F1: 0.3271
Best xView2 Score: 0.2835
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8316
Class 1 Precision: 0.4639
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3239
ROC curve saved to .././____________optune_results/53/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/53/plot_loss_curves.jpg
Prediction distribution: {0: 169628, 1: 92486, 2: 15, 3: 15}
ROC curve saved to .././____________optune_results/53/visualize_predictions.jpg
Prediction distribution: {0: 154898, 1: 106896, 2: 285, 3: 65}
ROC curve saved to .././____________optune_results/53/visualize_predictions.jpg
Prediction distribution: {0: 65805, 1: 196339}
ROC curve saved to .././____________optune_results/53/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/53/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/53/plot_epoch_f1.jpg
[FrozenTrial(number=0, state=TrialState.COMPLETE, values=[0.18438766773112963, 0.6908387756347657, 1.1148056434733526], datetime_start=datetime.datetime(2025, 7, 22, 11, 14, 30, 46831), datetime_complete=datetime.datetime(2025, 7, 22, 11, 22, 5, 949609), params={'class5': 15.943409394910745}, user_attrs={'f1': 0.18438766773112963, 'accuracy': 0.6908387756347657, 'val_loss': 1.1148056434733526}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=0, value=None), FrozenTrial(number=1, state=TrialState.COMPLETE, values=[0.3271177280103599, 0.6177542266845703, 1.4932946366923197], datetime_start=datetime.datetime(2025, 7, 22, 11, 22, 5, 950012), datetime_complete=datetime.datetime(2025, 7, 22, 11, 32, 21, 428212), params={'class5': 1.4719650335212178}, user_attrs={'f1': 0.3271177280103599, 'accuracy': 0.6177542266845703, 'val_loss': 1.4932946366923197}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=1, value=None)]
can only concatenate tuple (not "str") to tuple
Loaded metrics.py from: /home/caiden/PycharmProjects/Physics-Informed-Deep-Learning-For-Damage-Assessment/src/metrics.py
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27430541635452027, 1: 0.7429973062247348, 2: 131.58256777600585, 3: 1325.5635501711877, 4: 5732.533940774488}
Final class weights used in loss: [3.815595695732134, 0.7429973062247348, 131.58256777600585, 1325.5635501711877, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5269
Confusion Matrix:
 [[3229702  701868   10441  345445  544197]
 [ 750363  486745    2368  188146  286195]
 [   1425    1840       0    1430     554]
 [    263     526       0      31    1988]
 [     72       0       0       0       1]]
Class 0 F1: 0.7329
Class 1 F1: 0.3351
Class 2 F1: 0.0000
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.8111
Class 1 Precision: 0.4087
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.6684
Class 1 Recall: 0.2840
Class 2 Recall: 0.0000
Class 3 Recall: 0.0110
Class 4 Recall: 0.0137
Validation Accuracy: 0.5671
Macro F1 Score: 0.2136
xView2 Score: 0.1974
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4078
Confusion Matrix:
 [[4598456  145065     366   49144   38622]
 [1524084  119101     131   39023   31478]
 [   4022    1087       0     135       5]
 [   2638     111       0       0      59]
 [     73       0       0       0       0]]
Class 0 F1: 0.8391
Class 1 F1: 0.1204
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7502
Class 1 Precision: 0.4488
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9517
Class 1 Recall: 0.0695
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7198
Macro F1 Score: 0.1919
xView2 Score: 0.0716
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.3018
Confusion Matrix:
 [[4809231   15229      15    2769    4409]
 [1691678   15278       0    2174    4687]
 [   5146     103       0       0       0]
 [   2788      20       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8481
Class 1 F1: 0.0175
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7389
Class 1 Precision: 0.4988
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9954
Class 1 Recall: 0.0089
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7362
Macro F1 Score: 0.1731
xView2 Score: 0.0100
Epoch 3 took:  0 hours,  1 minutes,  4 seconds

Epoch 4/10
Train Loss: 1.2044
Confusion Matrix:
 [[4829051    2197       0     171     234]
 [1711069    2261       0     189     298]
 [   5205      44       0       0       0]
 [   2801       7       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8487
Class 1 F1: 0.0026
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7375
Class 1 Precision: 0.5014
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0013
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7372
Macro F1 Score: 0.1703
xView2 Score: 0.0013
Epoch 4 took:  0 hours,  0 minutes, 37 seconds

Epoch 5/10
Train Loss: 1.1004
Confusion Matrix:
 [[4831512     136       0       5       0]
 [1713657     146       0      14       0]
 [   5247       2       0       0       0]
 [   2807       1       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8488
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 0.5123
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7373
Macro F1 Score: 0.1698
xView2 Score: 0.0001
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.0160
Confusion Matrix:
 [[4831653       0       0       0       0]
 [1713808       9       0       0       0]
 [   5249       0       0       0       0]
 [   2808       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8488
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7373
Macro F1 Score: 0.1698
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 0.9350
Confusion Matrix:
 [[4831653       0       0       0       0]
 [1713817       0       0       0       0]
 [   5249       0       0       0       0]
 [   2808       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8488
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7373
Macro F1 Score: 0.1698
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 0.8758
Confusion Matrix:
 [[4831653       0       0       0       0]
 [1713817       0       0       0       0]
 [   5249       0       0       0       0]
 [   2808       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8488
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7373
Macro F1 Score: 0.1698
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 28 seconds

Epoch 9/10
Train Loss: 0.8137
Confusion Matrix:
 [[4831653       0       0       0       0]
 [1713817       0       0       0       0]
 [   5249       0       0       0       0]
 [   2808       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8488
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7373
Macro F1 Score: 0.1698
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.7902
Confusion Matrix:
 [[4831653       0       0       0       0]
 [1713817       0       0       0       0]
 [   5249       0       0       0       0]
 [   2808       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8488
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7373
Macro F1 Score: 0.1698
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5671
Best Macro F1: 0.2136
Best xView2 Score: 0.1974
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8111
Class 1 Precision: 0.4087
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.2440
ROC curve saved to .././____________optune_results/54/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/54/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/54/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/54/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/54/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/54/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/54/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27604248008231974, 1: 0.730571477466752, 2: 129.77425742574258, 3: 1166.1642261353104, 4: 68947.46301369862}
Final class weights used in loss: [4.987882257597665, 0.730571477466752, 129.77425742574258, 1166.1642261353104, 68947.46301369862]

Epoch 1/10
Train Loss: 1.4707
Confusion Matrix:
 [[4540577  212632   44514  144972    4422]
 [1402075  112521   21461   61177    1366]
 [   4432     199      18      67       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8333
Class 1 F1: 0.1170
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7631
Class 1 Precision: 0.3458
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9178
Class 1 Recall: 0.0704
Class 2 Recall: 0.0038
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7100
Macro F1 Score: 0.1902
xView2 Score: 0.0720
Epoch 1 took:  0 hours,  1 minutes, 11 seconds

Epoch 2/10
Train Loss: 1.3565
Confusion Matrix:
 [[4893946   24457    5045   23602      67]
 [1566132   17048    2774   12584      62]
 [   4513     143       0      60       0]
 [   2049      21       0     219       0]
 [    442      16      17     403       0]]
Class 0 F1: 0.8575
Class 1 F1: 0.0208
Class 2 F1: 0.0000
Class 3 F1: 0.0112
Class 4 F1: 0.0000
Class 0 Precision: 0.7567
Class 1 Precision: 0.4090
Class 2 Precision: 0.0000
Class 3 Precision: 0.0059
Class 4 Precision: 0.0000
Class 0 Recall: 0.9893
Class 1 Recall: 0.0107
Class 2 Recall: 0.0000
Class 3 Recall: 0.0957
Class 4 Recall: 0.0000
Validation Accuracy: 0.7494
Macro F1 Score: 0.1779
xView2 Score: 0.0187
Epoch 2 took:  0 hours,  0 minutes, 40 seconds

Epoch 3/10
Train Loss: 1.2586
Confusion Matrix:
 [[4945156    1117     139     705       0]
 [1597066    1004      72     458       0]
 [   4716       0       0       0       0]
 [   2285       0       0       4       0]
 [    853       0       2      23       0]]
Class 0 F1: 0.8602
Class 1 F1: 0.0013
Class 2 F1: 0.0000
Class 3 F1: 0.0023
Class 4 F1: 0.0000
Class 0 Precision: 0.7550
Class 1 Precision: 0.4734
Class 2 Precision: 0.0000
Class 3 Precision: 0.0034
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0006
Class 2 Recall: 0.0000
Class 3 Recall: 0.0017
Class 4 Recall: 0.0000
Validation Accuracy: 0.7547
Macro F1 Score: 0.1728
xView2 Score: 0.0012
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.1619
Confusion Matrix:
 [[4946891     204       1      21       0]
 [1598536      62       0       2       0]
 [   4681      35       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.2060
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7548
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 4 took:  0 hours,  0 minutes, 26 seconds

Epoch 5/10
Train Loss: 1.0649
Confusion Matrix:
 [[4947110       5       0       2       0]
 [1598600       0       0       0       0]
 [   4716       0       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7549
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 0.9777
Confusion Matrix:
 [[4947117       0       0       0       0]
 [1598600       0       0       0       0]
 [   4716       0       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7549
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 0.9111
Confusion Matrix:
 [[4947117       0       0       0       0]
 [1598600       0       0       0       0]
 [   4716       0       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7549
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 0.8508
Confusion Matrix:
 [[4947117       0       0       0       0]
 [1598600       0       0       0       0]
 [   4716       0       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7549
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 0.7970
Confusion Matrix:
 [[4947117       0       0       0       0]
 [1598600       0       0       0       0]
 [   4716       0       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7549
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.7609
Confusion Matrix:
 [[4947117       0       0       0       0]
 [1598600       0       0       0       0]
 [   4716       0       0       0       0]
 [   2289       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8603
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7549
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7549
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7100
Best Macro F1: 0.1902
Best xView2 Score: 0.0720
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7631
Class 1 Precision: 0.3458
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2218
ROC curve saved to .././____________optune_results/55/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/55/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/55/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/55/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/55/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/55/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/55/plot_epoch_f1.jpg
[FrozenTrial(number=0, state=TrialState.COMPLETE, values=[0.2136300636662675, 0.718380569458008, 1.0265021945749009], datetime_start=datetime.datetime(2025, 7, 22, 13, 4, 31, 35732), datetime_complete=datetime.datetime(2025, 7, 22, 13, 12, 12, 824980), params={'class5': 13.91002681041029}, user_attrs={'f1': 0.2136300636662675, 'accuracy': 0.718380569458008, 'val_loss': 1.0265021945749009}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=0, value=None), FrozenTrial(number=1, state=TrialState.COMPLETE, values=[0.19016247232280542, 0.7498190460205076, 1.0690476323877063], datetime_start=datetime.datetime(2025, 7, 22, 13, 12, 12, 825394), datetime_complete=datetime.datetime(2025, 7, 22, 13, 18, 6, 430090), params={'class5': 18.069256065625147}, user_attrs={'f1': 0.19016247232280542, 'accuracy': 0.7498190460205076, 'val_loss': 1.0690476323877063}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=1, value=None)]
Found 'class5': 13.91002681041029
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2703269517028617, 1: 0.7729138574018322, 2: 167.08155623423184, 3: 1029.9089011663598, 4: 68947.46301369862}
Final class weights used in loss: [4.8846069117588895, 1.2371951006188115, 167.08155623423184, 1029.9089011663598, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6256
Confusion Matrix:
 [[1331974  131693  991059 1910022  196862]
 [ 458725   40377  547383  829496  100037]
 [   4743     105    3690    3924     914]
 [     19     139    1271     289       0]
 [     33       0     347      16     482]]
Class 0 F1: 0.4191
Class 1 F1: 0.0376
Class 2 F1: 0.0047
Class 3 F1: 0.0002
Class 4 F1: 0.0032
Class 0 Precision: 0.7418
Class 1 Precision: 0.2343
Class 2 Precision: 0.0024
Class 3 Precision: 0.0001
Class 4 Precision: 0.0016
Class 0 Recall: 0.2920
Class 1 Recall: 0.0204
Class 2 Recall: 0.2759
Class 3 Recall: 0.1682
Class 4 Recall: 0.5490
Validation Accuracy: 0.2101
Macro F1 Score: 0.0930
xView2 Score: 0.1447
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.5256
Confusion Matrix:
 [[3444748   33658  259278  782372   41554]
 [1310586   18776  163054  453153   30449]
 [  11071       0     138    2158       9]
 [    569      93     129     927       0]
 [    743       0      32     103       0]]
Class 0 F1: 0.7385
Class 1 F1: 0.0185
Class 2 F1: 0.0006
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.7225
Class 1 Precision: 0.3575
Class 2 Precision: 0.0003
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.7552
Class 1 Recall: 0.0095
Class 2 Recall: 0.0103
Class 3 Recall: 0.5396
Class 4 Recall: 0.0000
Validation Accuracy: 0.5287
Macro F1 Score: 0.1518
xView2 Score: 0.1097
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.4282
Confusion Matrix:
 [[4282442   10199   64028  200235    4706]
 [1778183    3861   42517  146099    5358]
 [  11897       0     414    1065       0]
 [   1496      19      11     190       2]
 [    878       0       0       0       0]]
Class 0 F1: 0.8052
Class 1 F1: 0.0039
Class 2 F1: 0.0069
Class 3 F1: 0.0011
Class 4 F1: 0.0000
Class 0 Precision: 0.7049
Class 1 Precision: 0.2742
Class 2 Precision: 0.0039
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.9388
Class 1 Recall: 0.0020
Class 2 Recall: 0.0310
Class 3 Recall: 0.1106
Class 4 Recall: 0.0000
Validation Accuracy: 0.6541
Macro F1 Score: 0.1634
xView2 Score: 0.0514
Epoch 3 took:  0 hours,  1 minutes, 12 seconds

Epoch 4/10
Train Loss: 1.3301
Confusion Matrix:
 [[4500142    2156    9011   49504     797]
 [1914027     864   11224   48982     921]
 [  13317       0       0      59       0]
 [   1644       0       0      74       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8188
Class 1 F1: 0.0009
Class 2 F1: 0.0000
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.6999
Class 1 Precision: 0.2861
Class 2 Precision: 0.0000
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.9865
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0431
Class 4 Recall: 0.0000
Validation Accuracy: 0.6868
Macro F1 Score: 0.1642
xView2 Score: 0.0181
Epoch 4 took:  0 hours,  0 minutes, 49 seconds

Epoch 5/10
Train Loss: 1.2335
Confusion Matrix:
 [[4556110      96     637    4700      67]
 [1970211      41    1118    4586      62]
 [  13376       0       0       0       0]
 [   1696       0       0      22       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8206
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0040
Class 4 F1: 0.0000
Class 0 Precision: 0.6964
Class 1 Precision: 0.2993
Class 2 Precision: 0.0000
Class 3 Precision: 0.0024
Class 4 Precision: 0.0000
Class 0 Recall: 0.9988
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0128
Class 4 Recall: 0.0000
Validation Accuracy: 0.6952
Macro F1 Score: 0.1649
xView2 Score: 0.0027
Epoch 5 took:  0 hours,  0 minutes, 33 seconds

Epoch 6/10
Train Loss: 1.1387
Confusion Matrix:
 [[4561206       0     111     278      15]
 [1975464       0     111     437       6]
 [  13376       0       0       0       0]
 [   1718       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8208
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6961
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6960
Macro F1 Score: 0.1642
xView2 Score: 0.0002
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0442
Confusion Matrix:
 [[4561610       0       0       0       0]
 [1976002       0       0      16       0]
 [  13376       0       0       0       0]
 [   1718       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8208
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6960
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6960
Macro F1 Score: 0.1642
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9947
Confusion Matrix:
 [[4561610       0       0       0       0]
 [1976017       0       0       1       0]
 [  13376       0       0       0       0]
 [   1718       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8208
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6960
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6960
Macro F1 Score: 0.1642
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 28 seconds

Epoch 9/10
Train Loss: 0.9247
Confusion Matrix:
 [[4561610       0       0       0       0]
 [1976018       0       0       0       0]
 [  13376       0       0       0       0]
 [   1718       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8208
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6960
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6960
Macro F1 Score: 0.1642
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8894
Confusion Matrix:
 [[4561610       0       0       0       0]
 [1976018       0       0       0       0]
 [  13376       0       0       0       0]
 [   1718       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8208
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6960
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6960
Macro F1 Score: 0.1642
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2101
Best Macro F1: 0.0930
Best xView2 Score: 0.1447
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7418
Class 1 Precision: 0.2343
Class 2 Precision: 0.0024
Class 3 Precision: 0.0001
Class 4 Precision: 0.0016
Macro Precision: 0.1961
ROC curve saved to .././____________optune_results/56/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/56/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/56/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/56/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/56/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/56/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/56/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2719872173976199, 1: 0.7590109504819252, 2: 216.91870878765675, 3: 949.1165000942863, 4: 5292.497160883281}
Final class weights used in loss: [4.914606677734449, 5.328013835745118, 216.91870878765675, 949.1165000942863, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5201
Confusion Matrix:
 [[4081839  357881   26539  177608   31396]
 [1577808  196054   14758   55260   12858]
 [  16984    3234      23      44      12]
 [   1271       1       0      23       7]
 [      0       0       0       0       0]]
Class 0 F1: 0.7885
Class 1 F1: 0.1624
Class 2 F1: 0.0007
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.7189
Class 1 Precision: 0.3519
Class 2 Precision: 0.0006
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.8731
Class 1 Recall: 0.1056
Class 2 Recall: 0.0011
Class 3 Recall: 0.0177
Class 4 Recall: 0.0000
Validation Accuracy: 0.6528
Macro F1 Score: 0.1904
xView2 Score: 0.0885
Epoch 1 took:  0 hours,  1 minutes, 24 seconds

Epoch 2/10
Train Loss: 1.4413
Confusion Matrix:
 [[4440497  214137    2007   14739    3883]
 [1702136  144500    1425    7453    1224]
 [  18261    1994       2      26      14]
 [   1137     160       0       5       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8195
Class 1 F1: 0.1303
Class 2 F1: 0.0002
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.7206
Class 1 Precision: 0.4005
Class 2 Precision: 0.0006
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.9498
Class 1 Recall: 0.0778
Class 2 Recall: 0.0001
Class 3 Recall: 0.0038
Class 4 Recall: 0.0000
Validation Accuracy: 0.6996
Macro F1 Score: 0.1901
xView2 Score: 0.0618
Epoch 2 took:  0 hours,  1 minutes, 13 seconds

Epoch 3/10
Train Loss: 1.3719
Confusion Matrix:
 [[4564959  109629      20     503     152]
 [1766296   89937      59     407      39]
 [  19487     810       0       0       0]
 [   1028     274       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8280
Class 1 F1: 0.0874
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7187
Class 1 Precision: 0.4482
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9764
Class 1 Recall: 0.0484
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7103
Macro F1 Score: 0.1831
xView2 Score: 0.0393
Epoch 3 took:  0 hours,  0 minutes, 34 seconds

Epoch 4/10
Train Loss: 1.2978
Confusion Matrix:
 [[4438050  237182       0      26       5]
 [1645886  210754       0      98       0]
 [  18690    1607       0       0       0]
 [   1149     153       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8235
Class 1 F1: 0.1828
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7271
Class 1 Precision: 0.4687
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9493
Class 1 Recall: 0.1135
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7094
Macro F1 Score: 0.2012
xView2 Score: 0.0904
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2136
Confusion Matrix:
 [[4349265  325998       0       0       0]
 [1551521  305217       0       0       0]
 [  17780    2517       0       0       0]
 [   1041     261       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8210
Class 1 F1: 0.2451
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7347
Class 1 Precision: 0.4814
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9303
Class 1 Recall: 0.1644
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7102
Macro F1 Score: 0.2665
xView2 Score: 0.1229
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1392
Confusion Matrix:
 [[4145868  529395       0       0       0]
 [1429473  427265       0       0       0]
 [  19481     816       0       0       0]
 [   1149     153       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8073
Class 1 F1: 0.3036
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7409
Class 1 Precision: 0.4462
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8868
Class 1 Recall: 0.2301
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6978
Macro F1 Score: 0.2777
xView2 Score: 0.1560
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0729
Confusion Matrix:
 [[4027742  647521       0       0       0]
 [1258596  598142       0       0       0]
 [  17854    2443       0       0       0]
 [    943     359       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8071
Class 1 F1: 0.3853
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7592
Class 1 Precision: 0.4791
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8615
Class 1 Recall: 0.3221
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7059
Macro F1 Score: 0.2981
xView2 Score: 0.2005
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0096
Confusion Matrix:
 [[3904271  770992       0       0       0]
 [1141955  714783       0       0       0]
 [  17158    3139       0       0       0]
 [    919     383       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8017
Class 1 F1: 0.4272
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7709
Class 1 Precision: 0.4799
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8351
Class 1 Recall: 0.3850
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7048
Macro F1 Score: 0.3072
xView2 Score: 0.2251
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9578
Confusion Matrix:
 [[3744343  930920       0       0       0]
 [1074840  781898       0       0       0]
 [  17272    3025       0       0       0]
 [    791     511       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7872
Class 1 F1: 0.4377
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7741
Class 1 Precision: 0.4556
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8009
Class 1 Recall: 0.4211
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6906
Macro F1 Score: 0.3062
xView2 Score: 0.2347
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9495
Confusion Matrix:
 [[3757512  917751       0       0       0]
 [1085336  771402       0       0       0]
 [  17982    2315       0       0       0]
 [   1104     198       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7880
Class 1 F1: 0.4348
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7728
Class 1 Precision: 0.4560
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8037
Class 1 Recall: 0.4155
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6911
Macro F1 Score: 0.3057
xView2 Score: 0.2327
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6906
Best Macro F1: 0.3062
Best xView2 Score: 0.2347
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7741
Class 1 Precision: 0.4556
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3074
ROC curve saved to .././____________optune_results/57/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/57/plot_loss_curves.jpg
Prediction distribution: {0: 236266, 1: 25878}
ROC curve saved to .././____________optune_results/57/visualize_predictions.jpg
Prediction distribution: {0: 259845, 1: 2299}
ROC curve saved to .././____________optune_results/57/visualize_predictions.jpg
Prediction distribution: {0: 87539, 1: 174605}
ROC curve saved to .././____________optune_results/57/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/57/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/57/plot_epoch_f1.jpg
[FrozenTrial(number=1, state=TrialState.COMPLETE, values=[0.3062262941930191, 0.697240463256836, 1.2474589594772882], datetime_start=datetime.datetime(2025, 7, 22, 13, 26, 16, 929728), datetime_complete=datetime.datetime(2025, 7, 22, 13, 33, 25, 814821), params={'class4': 7.019679798245542}, user_attrs={'f1': 0.3062262941930191, 'accuracy': 0.697240463256836, 'val_loss': 1.2474589594772882}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=1, value=None)]
Found 'class4': 7.019679798245542
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2766647189551178, 1: 0.7267139412320929, 2: 125.31220714552471, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [4.999125651124239, 5.10129917237032, 824.2919543509192, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6393
Confusion Matrix:
 [[ 213658 3261852    3984   42982 1465649]
 [  82631 1150400    1484   19193  308322]
 [     12    1251       0      21    2051]
 [      0     110       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0809
Class 1 F1: 0.3850
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7211
Class 1 Precision: 0.2606
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0428
Class 1 Recall: 0.7365
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2081
Macro F1 Score: 0.0932
xView2 Score: 0.2324
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.5730
Confusion Matrix:
 [[2022526 2459681    1966   19093  484859]
 [ 368646 1077256     557    7966  107605]
 [     77    2855       0       0     403]
 [     14      96       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5482
Class 1 F1: 0.4223
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8458
Class 1 Precision: 0.3043
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4055
Class 1 Recall: 0.6897
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4730
Macro F1 Score: 0.1941
xView2 Score: 0.2395
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5172
Confusion Matrix:
 [[3372375 1515975     911    4415   94449]
 [ 707130  826555     337    2163   25845]
 [   1886    1417       0      20      12]
 [     59      21       0       0      30]
 [      0       0       0       0       0]]
Class 0 F1: 0.7437
Class 1 F1: 0.4232
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8263
Class 1 Precision: 0.3526
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6761
Class 1 Recall: 0.5292
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6407
Macro F1 Score: 0.2334
xView2 Score: 0.2241
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4717
Confusion Matrix:
 [[3897856 1076788     474     256   12751]
 [ 819000  738794     157     204    3875]
 [   2899     434       0       1       1]
 [    109       1       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8030
Class 1 F1: 0.4374
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8258
Class 1 Precision: 0.4068
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7814
Class 1 Recall: 0.4730
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7075
Macro F1 Score: 0.2481
xView2 Score: 0.2211
Epoch 4 took:  0 hours,  1 minutes, 20 seconds

Epoch 5/10
Train Loss: 1.4146
Confusion Matrix:
 [[4275282  711623     145      23    1052]
 [ 932368  629420      75       0     167]
 [   2002    1333       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8385
Class 1 F1: 0.4334
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8206
Class 1 Precision: 0.4689
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8571
Class 1 Recall: 0.4030
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7484
Macro F1 Score: 0.2544
xView2 Score: 0.2105
Epoch 5 took:  0 hours,  0 minutes, 47 seconds

Epoch 6/10
Train Loss: 1.3590
Confusion Matrix:
 [[4506628  481410      70       0      17]
 [1087148  474837      45       0       0]
 [   3327       8       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8515
Class 1 F1: 0.3771
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8052
Class 1 Precision: 0.4966
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9035
Class 1 Recall: 0.3040
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7601
Macro F1 Score: 0.2457
xView2 Score: 0.1946
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.3093
Confusion Matrix:
 [[4539799  448296      29       0       1]
 [1069783  492193      54       0       0]
 [   3033     302       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8565
Class 1 F1: 0.3933
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8088
Class 1 Precision: 0.5232
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9101
Class 1 Recall: 0.3151
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7678
Macro F1 Score: 0.2500
xView2 Score: 0.2018
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2650
Confusion Matrix:
 [[4591551  396551      23       0       0]
 [1104184  457812      34       0       0]
 [   3335       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8593
Class 1 F1: 0.3789
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8057
Class 1 Precision: 0.5359
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9205
Class 1 Recall: 0.2931
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7705
Macro F1 Score: 0.3095
xView2 Score: 0.1929
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2209
Confusion Matrix:
 [[4566809  421299      17       0       0]
 [1080022  481979      29       0       0]
 [   3335       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8586
Class 1 F1: 0.3910
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8082
Class 1 Precision: 0.5336
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9155
Class 1 Recall: 0.3086
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7704
Macro F1 Score: 0.3124
xView2 Score: 0.1997
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1981
Confusion Matrix:
 [[4613631  374486       8       0       0]
 [1110548  451466      16       0       0]
 [   3335       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8611
Class 1 F1: 0.3781
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8055
Class 1 Precision: 0.5466
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9249
Class 1 Recall: 0.2890
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7729
Macro F1 Score: 0.3098
xView2 Score: 0.1918
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4730
Best Macro F1: 0.1941
Best xView2 Score: 0.2395
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8458
Class 1 Precision: 0.3043
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2300
ROC curve saved to .././____________optune_results/58/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/58/plot_loss_curves.jpg
Prediction distribution: {0: 206551, 1: 55593}
ROC curve saved to .././____________optune_results/58/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/58/visualize_predictions.jpg
Prediction distribution: {0: 232801, 1: 29343}
ROC curve saved to .././____________optune_results/58/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/58/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/58/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.26999696001853063, 1: 0.7762038167682294, 2: 142.7848170212766, 3: 1350.0978540772533, 4: 5292.497160883281}
Final class weights used in loss: [4.878644207515185, 5.448702251889023, 2638.2026410922454, 1350.0978540772533, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5039
Confusion Matrix:
 [[4038195   71953  284811  143886       9]
 [1651517   58245  221815   72034       8]
 [   7086     480     391     293       0]
 [   1787       0    1090       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7889
Class 1 F1: 0.0546
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7086
Class 1 Precision: 0.4457
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8897
Class 1 Recall: 0.0291
Class 2 Recall: 0.0474
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6251
Macro F1 Score: 0.1690
xView2 Score: 0.0825
Epoch 1 took:  0 hours,  0 minutes, 29 seconds

Epoch 2/10
Train Loss: 1.4553
Confusion Matrix:
 [[4255967   43325  224646   14916       0]
 [1777320   37841  181724    6734       0]
 [   7395     169     685       1       0]
 [   2244       0     633       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8044
Class 1 F1: 0.0363
Class 2 F1: 0.0033
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7043
Class 1 Precision: 0.4652
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9377
Class 1 Recall: 0.0189
Class 2 Recall: 0.0830
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6553
Macro F1 Score: 0.2110
xView2 Score: 0.0619
Epoch 2 took:  0 hours,  0 minutes, 25 seconds

Epoch 3/10
Train Loss: 1.4070
Confusion Matrix:
 [[4395574   16889  125651     740       0]
 [1877720   16855  108276     768       0]
 [   8148       0     102       0       0]
 [   2307      99     471       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8123
Class 1 F1: 0.0165
Class 2 F1: 0.0008
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6995
Class 1 Precision: 0.4980
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9684
Class 1 Recall: 0.0084
Class 2 Recall: 0.0124
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6733
Macro F1 Score: 0.2074
xView2 Score: 0.0365
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.3521
Confusion Matrix:
 [[4379486   36255  123099      14       0]
 [1864414   33773  105361      71       0]
 [   7651     215     384       0       0]
 [   2719       0     158       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8115
Class 1 F1: 0.0326
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7002
Class 1 Precision: 0.4808
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9649
Class 1 Recall: 0.0169
Class 2 Recall: 0.0465
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6735
Macro F1 Score: 0.2118
xView2 Score: 0.0433
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3154
Confusion Matrix:
 [[4314393   30000  194461       0       0]
 [1807639   31574  164406       0       0]
 [   7843       4     403       0       0]
 [   2679       0     198       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8086
Class 1 F1: 0.0306
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7035
Class 1 Precision: 0.5127
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9505
Class 1 Recall: 0.0158
Class 2 Recall: 0.0488
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6632
Macro F1 Score: 0.2103
xView2 Score: 0.0547
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2608
Confusion Matrix:
 [[4298983   38843  201028       0       0]
 [1774412   42021  187186       0       0]
 [   7343     415     492       0       0]
 [   2671      83     123       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8094
Class 1 F1: 0.0403
Class 2 F1: 0.0025
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7067
Class 1 Precision: 0.5165
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9472
Class 1 Recall: 0.0210
Class 2 Recall: 0.0596
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6625
Macro F1 Score: 0.2131
xView2 Score: 0.0637
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Loaded metrics.py from: /home/caiden/PycharmProjects/Physics-Informed-Deep-Learning-For-Damage-Assessment/src/metrics.py
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.34104112074544635, 1: 0.9408496553159761, 2: 217.52432320298723, 3: 2976.0908230842006}
Final class weights used in loss: [5.668186459250416, 0.9408496553159761, 217.52432320298723, 2976.0908230842006, 1.0]

Epoch 1/10
Train Loss: 1.6928
Confusion Matrix:
 [[ 207253 1734703  536959 2240390   13317]
 [  24196  810749  187909  777183     922]
 [    103    2727    1132   10606       9]
 [      0    2021     490    1980       0]
 [      0     556      44     351       0]]
Class 0 F1: 0.0835
Class 1 F1: 0.3726
Class 2 F1: 0.0031
Class 3 F1: 0.0013
Class 4 F1: 0.0000
Class 0 Precision: 0.8951
Class 1 Precision: 0.3178
Class 2 Precision: 0.0016
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.0438
Class 1 Recall: 0.4502
Class 2 Recall: 0.0777
Class 3 Recall: 0.4409
Class 4 Recall: 0.0000
Validation Accuracy: 0.1558
Macro F1 Score: 0.0921
xView2 Score: 0.2214
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5777
Confusion Matrix:
 [[1800427 1412220  509609 1005663    4703]
 [ 252952  794091  218923  534258     735]
 [   2547    4607    1620    5803       0]
 [    336    2533     722     892       8]
 [     19     697      34     201       0]]
Class 0 F1: 0.5304
Class 1 F1: 0.3956
Class 2 F1: 0.0043
Class 3 F1: 0.0011
Class 4 F1: 0.0000
Class 0 Precision: 0.8756
Class 1 Precision: 0.3586
Class 2 Precision: 0.0022
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Class 0 Recall: 0.3804
Class 1 Recall: 0.4409
Class 2 Recall: 0.1111
Class 3 Recall: 0.1986
Class 4 Recall: 0.0000
Validation Accuracy: 0.3963
Macro F1 Score: 0.1863
xView2 Score: 0.2364
Epoch 2 took:  0 hours,  1 minutes, 15 seconds

Epoch 3/10
Train Loss: 1.4816
Confusion Matrix:
 [[3305542  822138  234054  370537     351]
 [ 861554  555995  126520  256844      46]
 [  11562    1489     141    1385       0]
 [   1168    2644      62     617       0]
 [    408       0      91     452       0]]
Class 0 F1: 0.7417
Class 1 F1: 0.3493
Class 2 F1: 0.0008
Class 3 F1: 0.0019
Class 4 F1: 0.0000
Class 0 Precision: 0.7908
Class 1 Precision: 0.4022
Class 2 Precision: 0.0004
Class 3 Precision: 0.0010
Class 4 Precision: 0.0000
Class 0 Recall: 0.6985
Class 1 Recall: 0.3087
Class 2 Recall: 0.0097
Class 3 Recall: 0.1374
Class 4 Recall: 0.0000
Validation Accuracy: 0.5893
Macro F1 Score: 0.2188
xView2 Score: 0.2022
Epoch 3 took:  0 hours,  0 minutes, 49 seconds

Epoch 4/10
Train Loss: 1.3773
Confusion Matrix:
 [[4124093  453469   62291   92762       7]
 [1282649  393397   41693   83179      41]
 [  12788    1109     393     287       0]
 [   2773    1688      12      18       0]
 [    787      68      13      83       0]]
Class 0 F1: 0.8122
Class 1 F1: 0.2968
Class 2 F1: 0.0066
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.7605
Class 1 Precision: 0.4630
Class 2 Precision: 0.0038
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.8714
Class 1 Recall: 0.2184
Class 2 Recall: 0.0270
Class 3 Recall: 0.0040
Class 4 Recall: 0.0000
Validation Accuracy: 0.6894
Macro F1 Score: 0.2232
xView2 Score: 0.1582
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.2702
Confusion Matrix:
 [[4476242  210418   13163   32794       5]
 [1553102  202642   12064   33122      29]
 [  13828     652      94       3       0]
 [   4461      23       7       0       0]
 [    950       0       0       1       0]]
Class 0 F1: 0.8304
Class 1 F1: 0.1830
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7400
Class 1 Precision: 0.4898
Class 2 Precision: 0.0037
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9458
Class 1 Recall: 0.1125
Class 2 Recall: 0.0064
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7140
Macro F1 Score: 0.2036
xView2 Score: 0.0934
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.1605
Confusion Matrix:
 [[4655595   68496    1527    7001       3]
 [1723233   68553    1856    7309       8]
 [  14533      41       0       3       0]
 [   4482       8       0       1       0]
 [    950       0       0       1       0]]
Class 0 F1: 0.8365
Class 1 F1: 0.0707
Class 2 F1: 0.0000
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7276
Class 1 Precision: 0.5000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.9837
Class 1 Recall: 0.0381
Class 2 Recall: 0.0000
Class 3 Recall: 0.0002
Class 4 Recall: 0.0000
Validation Accuracy: 0.7208
Macro F1 Score: 0.1815
xView2 Score: 0.0339
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.0796
Confusion Matrix:
 [[4718371   13235      65     951       0]
 [1785522   14247     144    1046       0]
 [  14577       0       0       0       0]
 [   4491       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8383
Class 1 F1: 0.0156
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7232
Class 1 Precision: 0.5184
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9970
Class 1 Recall: 0.0079
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7221
Macro F1 Score: 0.1708
xView2 Score: 0.0072
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0167
Confusion Matrix:
 [[4731735     653       0     234       0]
 [1800289     548       0     122       0]
 [  14577       0       0       0       0]
 [   4491       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8386
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7222
Class 1 Precision: 0.4563
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7221
Macro F1 Score: 0.1678
xView2 Score: 0.0003
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 0.9314
Confusion Matrix:
 [[4732469      47       0     106       0]
 [1800864      17       0      78       0]
 [  14577       0       0       0       0]
 [   4491       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8386
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7221
Class 1 Precision: 0.2656
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7221
Macro F1 Score: 0.1677
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.8814
Confusion Matrix:
 [[4732568       0       0      54       0]
 [1800932       2       0      25       0]
 [  14577       0       0       0       0]
 [   4491       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8387
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7221
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7221
Macro F1 Score: 0.1677
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3963
Best Macro F1: 0.1863
Best xView2 Score: 0.2364
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8756
Class 1 Precision: 0.3586
Class 2 Precision: 0.0022
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Macro Precision: 0.2474
ROC curve saved to .././____________optune_results/60/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/60/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/60/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/60/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/60/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/60/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/60/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2766067133598097, 1: 0.7268505814253228, 2: 133.01526995956553, 3: 788.7736718382698, 4: 5732.533940774488}
Final class weights used in loss: [2.827380456598154, 0.7268505814253228, 133.01526995956553, 788.7736718382698, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6618
Confusion Matrix:
 [[ 564976  794633 2881967   11597  731137]
 [ 121693  266432  837418    5018  332771]
 [    353    1393    2711      40    1164]
 [      0       4     193       0      27]
 [      0      65       8       0       0]]
Class 0 F1: 0.1992
Class 1 F1: 0.2029
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8224
Class 1 Precision: 0.2508
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1134
Class 1 Recall: 0.1704
Class 2 Recall: 0.4789
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1273
Macro F1 Score: 0.0807
xView2 Score: 0.1584
Epoch 1 took:  0 hours,  1 minutes, 26 seconds

Epoch 2/10
Train Loss: 1.5441
Confusion Matrix:
 [[3167901  294022 1215332    9175  297880]
 [ 687357  153633  549290    4524  168528]
 [   2456     776    1480       0     949]
 [     73       0     136       0      15]
 [     60      12       1       0       0]]
Class 0 F1: 0.7165
Class 1 F1: 0.1527
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8212
Class 1 Precision: 0.3426
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6356
Class 1 Recall: 0.0983
Class 2 Recall: 0.2614
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5071
Macro F1 Score: 0.1742
xView2 Score: 0.1495
Epoch 2 took:  0 hours,  1 minutes, 26 seconds

Epoch 3/10
Train Loss: 1.4435
Confusion Matrix:
 [[4602726   62445  261451    1576   56112]
 [1306022   44180  168114     892   44124]
 [   4933      83     616      24       5]
 [     90      45      57       0      32]
 [     73       0       0       0       0]]
Class 0 F1: 0.8447
Class 1 F1: 0.0529
Class 2 F1: 0.0028
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7783
Class 1 Precision: 0.4139
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9234
Class 1 Recall: 0.0283
Class 2 Recall: 0.1088
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7092
Macro F1 Score: 0.1801
xView2 Score: 0.0788
Epoch 3 took:  0 hours,  1 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.3371
Confusion Matrix:
 [[4933669    7862   36427      56    6296]
 [1513178    6021   36820      58    7255]
 [   5395      27     154       0      85]
 [    176       4      44       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8628
Class 1 F1: 0.0076
Class 2 F1: 0.0039
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7646
Class 1 Precision: 0.4327
Class 2 Precision: 0.0021
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9898
Class 1 Recall: 0.0039
Class 2 Recall: 0.0272
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7538
Macro F1 Score: 0.1749
xView2 Score: 0.0202
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.2230
Confusion Matrix:
 [[4979800     833    3123       1     553]
 [1558408     783    3714       2     425]
 [   5648       0       1       0      12]
 [    224       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8639
Class 1 F1: 0.0010
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7610
Class 1 Precision: 0.4845
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9991
Class 1 Recall: 0.0005
Class 2 Recall: 0.0002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7600
Macro F1 Score: 0.1730
xView2 Score: 0.0020
Epoch 5 took:  0 hours,  0 minutes, 52 seconds

Epoch 6/10
Train Loss: 1.1591
Confusion Matrix:
 [[4984080       3     150       0      77]
 [1563122      25     166       0      19]
 [   5661       0       0       0       0]
 [    224       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8640
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7606
Class 1 Precision: 0.8929
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7605
Macro F1 Score: 0.1728
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 30 seconds

Epoch 7/10
Train Loss: 1.0731
Confusion Matrix:
 [[4984305       0       5       0       0]
 [1563329       2       1       0       0]
 [   5661       0       0       0       0]
 [    224       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8640
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7605
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7605
Macro F1 Score: 0.1728
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 0.9977
Confusion Matrix:
 [[4984310       0       0       0       0]
 [1563332       0       0       0       0]
 [   5661       0       0       0       0]
 [    224       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8640
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7605
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7605
Macro F1 Score: 0.1728
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9628
Confusion Matrix:
 [[4984310       0       0       0       0]
 [1563332       0       0       0       0]
 [   5661       0       0       0       0]
 [    224       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8640
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7605
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7605
Macro F1 Score: 0.1728
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.9035
Confusion Matrix:
 [[4984310       0       0       0       0]
 [1563332       0       0       0       0]
 [   5661       0       0       0       0]
 [    224       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8640
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7605
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7605
Macro F1 Score: 0.1728
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1273
Best Macro F1: 0.0807
Best xView2 Score: 0.1584
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8224
Class 1 Precision: 0.2508
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2148
ROC curve saved to .././____________optune_results/61/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/61/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/61/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/61/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/61/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/61/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/61/plot_epoch_f1.jpg
[FrozenTrial(number=0, state=TrialState.COMPLETE, values=[0.18629013708091632, 0.61540869140625, 1.2703814736434391], datetime_start=datetime.datetime(2025, 7, 22, 13, 45, 36, 669034), datetime_complete=datetime.datetime(2025, 7, 22, 13, 52, 46, 383221), params={'class5': 16.620243467593927}, user_attrs={'f1': 0.18629013708091632, 'accuracy': 0.61540869140625, 'val_loss': 1.2703814736434391}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=0, value=None), FrozenTrial(number=1, state=TrialState.COMPLETE, values=[0.08072461608503695, 0.6659915924072265, 1.116849729844502], datetime_start=datetime.datetime(2025, 7, 22, 13, 52, 46, 383605), datetime_complete=datetime.datetime(2025, 7, 22, 14, 1, 59, 514024), params={'class5': 10.221662454447738}, user_attrs={'f1': 0.08072461608503695, 'accuracy': 0.6659915924072265, 'val_loss': 1.116849729844502}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=1, value=None)]
Found 'class5': 16.620243467593927
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2739718946591056, 1: 0.7455014099335514, 2: 123.0843392350582, 3: 2116.5537426408746, 4: 68947.46301369862}
Final class weights used in loss: [2.8004482292108905, 3.9233028850245706, 123.0843392350582, 2116.5537426408746, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6036
Confusion Matrix:
 [[2714747   47087 1123557  918746    5179]
 [ 852146   29534  398945  453312    2634]
 [   1517      17     356     718       0]
 [    562      19    3238     408       0]
 [      0       0     811      67       0]]
Class 0 F1: 0.6480
Class 1 F1: 0.0326
Class 2 F1: 0.0005
Class 3 F1: 0.0006
Class 4 F1: 0.0000
Class 0 Precision: 0.7607
Class 1 Precision: 0.3853
Class 2 Precision: 0.0002
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.5645
Class 1 Recall: 0.0170
Class 2 Recall: 0.1365
Class 3 Recall: 0.0965
Class 4 Recall: 0.0000
Validation Accuracy: 0.4189
Macro F1 Score: 0.1363
xView2 Score: 0.1181
Epoch 1 took:  0 hours,  1 minutes, 19 seconds

Epoch 2/10
Loaded metrics.py from: /home/caiden/PycharmProjects/Physics-Informed-Deep-Learning-For-Damage-Assessment/src/metrics.py
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27609207075602704, 1: 0.7302290113548127, 2: 140.1098126548451, 3: 784.4708229426434, 4: 5732.533940774488}
Final class weights used in loss: [2.2108235858629635, 0.7302290113548127, 140.1098126548451, 784.4708229426434, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6494
Confusion Matrix:
 [[ 579563 3116312  145000  956724  152793]
 [ 230243  846853   55298  421285   41690]
 [    538    4518     575    1935      11]
 [      2     187       0       0       0]
 [      0      69       0       4       0]]
Class 0 F1: 0.2012
Class 1 F1: 0.3044
Class 2 F1: 0.0055
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7152
Class 1 Precision: 0.2134
Class 2 Precision: 0.0029
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1171
Class 1 Recall: 0.5308
Class 2 Recall: 0.0759
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2177
Macro F1 Score: 0.1022
xView2 Score: 0.2115
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5623
Confusion Matrix:
 [[2668939 1774454   55597  386587   64815]
 [ 720619  654534   23200  175326   21690]
 [   2782    4314      97     354      30]
 [     95      94       0       0       0]
 [     35      38       0       0       0]]
Class 0 F1: 0.6398
Class 1 F1: 0.3249
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7867
Class 1 Precision: 0.2690
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5391
Class 1 Recall: 0.4103
Class 2 Recall: 0.0128
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5071
Macro F1 Score: 0.1934
xView2 Score: 0.1930
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4719
Confusion Matrix:
 [[4254460  597036   11360   79797    7739]
 [1194942  349033    4892   44111    2391]
 [   5861    1325       0     391       0]
 [     29     160       0       0       0]
 [     11      59       0       3       0]]
Class 0 F1: 0.8177
Class 1 F1: 0.2745
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7799
Class 1 Precision: 0.3683
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8594
Class 1 Recall: 0.2188
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7024
Macro F1 Score: 0.2184
xView2 Score: 0.1396
Epoch 3 took:  0 hours,  1 minutes, 16 seconds

Epoch 4/10
Train Loss: 1.3888
Confusion Matrix:
 [[4734368  197210    3314   15068     432]
 [1423433  158796    1407   11539     194]
 [   6510    1028      12      27       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8519
Class 1 F1: 0.1627
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7680
Class 1 Precision: 0.4448
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9564
Class 1 Recall: 0.0995
Class 2 Recall: 0.0016
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7466
Macro F1 Score: 0.2033
xView2 Score: 0.0778
Epoch 4 took:  0 hours,  0 minutes, 54 seconds

Epoch 5/10
Train Loss: 1.3050
Confusion Matrix:
 [[4883859   63432     786    2301      14]
 [1544008   49336     269    1749       7]
 [   7451     126       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8579
Class 1 F1: 0.0578
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7589
Class 1 Precision: 0.4370
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9866
Class 1 Recall: 0.0309
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7527
Macro F1 Score: 0.1831
xView2 Score: 0.0263
Epoch 5 took:  0 hours,  0 minutes, 31 seconds

Epoch 6/10
Train Loss: 1.2183
Confusion Matrix:
 [[4932147   17953     191     101       0]
 [1579494   15728      80      67       0]
 [   7575       2       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8600
Class 1 F1: 0.0193
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7565
Class 1 Precision: 0.4669
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9963
Class 1 Recall: 0.0099
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7550
Macro F1 Score: 0.1759
xView2 Score: 0.0086
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1522
Confusion Matrix:
 [[4946522    3771      97       2       0]
 [1591966    3355      45       3       0]
 [   7577       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8605
Class 1 F1: 0.0042
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7556
Class 1 Precision: 0.4708
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9992
Class 1 Recall: 0.0021
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7553
Macro F1 Score: 0.1729
xView2 Score: 0.0019
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0822
Confusion Matrix:
 [[4950125     228      39       0       0]
 [1595136     213      20       0       0]
 [   7577       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8606
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7554
Class 1 Precision: 0.4830
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7554
Macro F1 Score: 0.1722
xView2 Score: 0.0001
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0272
Confusion Matrix:
 [[4950315      60      17       0       0]
 [1595310      49      10       0       0]
 [   7577       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8606
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7554
Class 1 Precision: 0.4495
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7554
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9805
Confusion Matrix:
 [[4950384       6       2       0       0]
 [1595369       0       0       0       0]
 [   7577       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8606
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7554
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7554
Macro F1 Score: 0.1721
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2177
Best Macro F1: 0.1022
Best xView2 Score: 0.2115
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7152
Class 1 Precision: 0.2134
Class 2 Precision: 0.0029
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1863
ROC curve saved to .././____________optune_results/63/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/63/plot_loss_curves.jpg
Prediction distribution: {0: 262140, 1: 4}
ROC curve saved to .././____________optune_results/63/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/63/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/63/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/63/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/63/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2748161295678768, 1: 0.7389987856032539, 2: 137.47684575673978, 3: 1745.8081165452654, 4: 5732.533940774488}
Final class weights used in loss: [0.5730135561861427, 0.7389987856032539, 137.47684575673978, 1745.8081165452654, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6084
Confusion Matrix:
 [[2222775 1126444  517093  113504  885936]
 [ 793930  361020  226369   72146  223699]
 [   2738    1676    1468     270     737]
 [   1205    1275      23       0    1219]
 [     24      49       0       0       0]]
Class 0 F1: 0.5637
Class 1 F1: 0.2279
Class 2 F1: 0.0039
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7359
Class 1 Precision: 0.2422
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4568
Class 1 Recall: 0.2153
Class 2 Recall: 0.2131
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3945
Macro F1 Score: 0.1591
xView2 Score: 0.1536
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5605
Confusion Matrix:
 [[3349875  858580  386297   30289  240711]
 [ 977609  426977  166917   22317   83344]
 [   2918    3395     325      17     234]
 [    894    2381      92       0     355]
 [     45      27       0       1       0]]
Class 0 F1: 0.7285
Class 1 F1: 0.2877
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7734
Class 1 Precision: 0.3306
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6885
Class 1 Recall: 0.2546
Class 2 Recall: 0.0472
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5764
Macro F1 Score: 0.2035
xView2 Score: 0.1656
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.5170
Confusion Matrix:
 [[3968395  610175  228123   10796   48263]
 [1188954  354763  105748    7441   20258]
 [   5953     773     126       8      29]
 [   1658    1232     832       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7912
Class 1 F1: 0.2683
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7683
Class 1 Precision: 0.3669
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8156
Class 1 Recall: 0.2115
Class 2 Recall: 0.0183
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6597
Macro F1 Score: 0.2121
xView2 Score: 0.1450
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4835
Confusion Matrix:
 [[4284283  473002   97094    3829    7544]
 [1271402  350977   48964    2543    3278]
 [   4560    2327       2       0       0]
 [   2472    1208      42       0       0]
 [     25      48       0       0       0]]
Class 0 F1: 0.8216
Class 1 F1: 0.2803
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7702
Class 1 Precision: 0.4241
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8805
Class 1 Recall: 0.2093
Class 2 Recall: 0.0003
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7073
Macro F1 Score: 0.2204
xView2 Score: 0.1401
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.4481
Confusion Matrix:
 [[4232643  539737   90964    1341    1067]
 [1186803  442961   46180     725     495]
 [   5423    1444      22       0       0]
 [    877    2845       0       0       0]
 [      4      69       0       0       0]]
Class 0 F1: 0.8226
Class 1 F1: 0.3325
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7801
Class 1 Precision: 0.4488
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8699
Class 1 Recall: 0.2641
Class 2 Recall: 0.0032
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7134
Macro F1 Score: 0.2311
xView2 Score: 0.1639
Epoch 5 took:  0 hours,  0 minutes, 51 seconds

Epoch 6/10
Train Loss: 1.3946
Confusion Matrix:
 [[4245480  576423   43248     354     247]
 [1161922  490270   24693     221      58]
 [   5220    1628      41       0       0]
 [    888    2834       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8260
Class 1 F1: 0.3568
Class 2 F1: 0.0011
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7842
Class 1 Precision: 0.4577
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8725
Class 1 Recall: 0.2923
Class 2 Recall: 0.0060
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7226
Macro F1 Score: 0.2368
xView2 Score: 0.1738
Epoch 6 took:  0 hours,  0 minutes, 31 seconds

Epoch 7/10
Train Loss: 1.3696
Confusion Matrix:
 [[4396679  442491   26402     154      26]
 [1237179  424659   15246      76       4]
 [   4307    2582       0       0       0]
 [   2520    1192      10       0       0]
 [     33      40       0       0       0]]
Class 0 F1: 0.8369
Class 1 F1: 0.3333
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7795
Class 1 Precision: 0.4876
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9036
Class 1 Recall: 0.2532
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.2341
xView2 Score: 0.1589
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3200
Confusion Matrix:
 [[4348868  499354   17507      23       0]
 [1192747  473449   10958      10       0]
 [   4448    2441       0       0       0]
 [   1275    2447       0       0       0]
 [     26      47       0       0       0]]
Class 0 F1: 0.8353
Class 1 F1: 0.3567
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7840
Class 1 Precision: 0.4842
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8938
Class 1 Recall: 0.2823
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7358
Macro F1 Score: 0.2384
xView2 Score: 0.1705
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2917
Confusion Matrix:
 [[4203168  649508   13065      11       0]
 [1052820  616603    7735       6       0]
 [   3596    3293       0       0       0]
 [   1553    2169       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8301
Class 1 F1: 0.4182
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7989
Class 1 Precision: 0.4849
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8638
Class 1 Recall: 0.3676
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7354
Macro F1 Score: 0.2497
xView2 Score: 0.2019
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.2489
Confusion Matrix:
 [[4202475  655987    7290       0       0]
 [1065404  607559    4198       3       0]
 [   5482    1407       0       0       0]
 [    668    3054       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8289
Class 1 F1: 0.4126
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7968
Class 1 Precision: 0.4791
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8637
Class 1 Recall: 0.3623
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7340
Macro F1 Score: 0.2483
xView2 Score: 0.1989
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7354
Best Macro F1: 0.2497
Best xView2 Score: 0.2019
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7989
Class 1 Precision: 0.4849
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2568
ROC curve saved to .././____________optune_results/64/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/64/plot_loss_curves.jpg
Prediction distribution: {0: 200650, 1: 61464, 2: 30}
ROC curve saved to .././____________optune_results/64/visualize_predictions.jpg
Prediction distribution: {0: 220178, 1: 41946, 2: 20}
ROC curve saved to .././____________optune_results/64/visualize_predictions.jpg
Prediction distribution: {0: 222351, 1: 39789, 2: 4}
ROC curve saved to .././____________optune_results/64/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/64/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/64/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27363717464107434, 1: 0.7481313011424942, 2: 135.8552364500108, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [5.231558131554958, 0.7481313011424942, 135.8552364500108, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5674
Confusion Matrix:
 [[2683381  669186  252716  962369  219192]
 [1139921  266935   62337  197082   94029]
 [   5536      32     126     612     146]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6229
Class 1 F1: 0.1980
Class 2 F1: 0.0008
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7008
Class 1 Precision: 0.2851
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5606
Class 1 Recall: 0.1516
Class 2 Recall: 0.0195
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4502
Macro F1 Score: 0.1643
xView2 Score: 0.1204
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4529
Confusion Matrix:
 [[4499549  102781   24997  146314   13203]
 [1669574   43048    7785   32852    7045]
 [   6451       0       0       0       1]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8209
Class 1 F1: 0.0452
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7286
Class 1 Precision: 0.2952
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9400
Class 1 Recall: 0.0245
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6931
Macro F1 Score: 0.1732
xView2 Score: 0.0321
Epoch 2 took:  0 hours,  1 minutes, 17 seconds

Epoch 3/10
Train Loss: 1.3443
Confusion Matrix:
 [[4774836    4320     523    6366     799]
 [1754937    2172     356    2488     351]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8434
Class 1 F1: 0.0025
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7305
Class 1 Precision: 0.3346
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9975
Class 1 Recall: 0.0012
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7289
Macro F1 Score: 0.1692
xView2 Score: 0.0021
Epoch 3 took:  0 hours,  0 minutes, 57 seconds

Epoch 4/10
Train Loss: 1.2341
Confusion Matrix:
 [[4786093     101      60     456     134]
 [1759857      53      96     254      44]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.3442
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7303
Macro F1 Score: 0.1688
xView2 Score: 0.0002
Epoch 4 took:  0 hours,  0 minutes, 31 seconds

Epoch 5/10
Train Loss: 1.1272
Confusion Matrix:
 [[4786801       4      23      11       5]
 [1760227       0      49      26       2]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.1688
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.0266
Confusion Matrix:
 [[4786844       0       0       0       0]
 [1760284       0      20       0       0]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.2814
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 0.9528
Confusion Matrix:
 [[4786844       0       0       0       0]
 [1760304       0       0       0       0]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.2814
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.8681
Confusion Matrix:
 [[4786844       0       0       0       0]
 [1760304       0       0       0       0]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.2814
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8180
Confusion Matrix:
 [[4786844       0       0       0       0]
 [1760304       0       0       0       0]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.2814
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.7746
Confusion Matrix:
 [[4786844       0       0       0       0]
 [1760304       0       0       0       0]
 [   6452       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7304
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.2814
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4502
Best Macro F1: 0.1643
Best xView2 Score: 0.1204
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7008
Class 1 Precision: 0.2851
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1973
ROC curve saved to .././____________optune_results/65/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/65/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/65/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/65/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/65/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/65/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/65/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27216819562720657, 1: 0.7593206919805506, 2: 134.67021993899502, 3: 819.4667535004885, 4: 5292.497160883281}
Final class weights used in loss: [0.3855395060168452, 0.7593206919805506, 134.67021993899502, 819.4667535004885, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5619
Confusion Matrix:
 [[3862601  343360    2404     398  478805]
 [1318749  281870     472     182  258170]
 [   5372     159       0       0     595]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7823
Class 1 F1: 0.2269
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7446
Class 1 Precision: 0.4507
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8240
Class 1 Recall: 0.1516
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6324
Macro F1 Score: 0.2018
xView2 Score: 0.1374
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5387
Confusion Matrix:
 [[4260085  284603    1305     158  141417]
 [1497390  248744     636      82  112591]
 [   4885     379       0       0     862]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8153
Class 1 F1: 0.2079
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7392
Class 1 Precision: 0.4661
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9088
Class 1 Recall: 0.1338
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6880
Macro F1 Score: 0.2046
xView2 Score: 0.1151
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5123
Confusion Matrix:
 [[4326930  336295     780      45   23518]
 [1537123  301215     523      20   20562]
 [   5323     727       0       0      76]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.2412
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7371
Class 1 Precision: 0.4719
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9231
Class 1 Recall: 0.1620
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7062
Macro F1 Score: 0.2122
xView2 Score: 0.1151
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4807
Confusion Matrix:
 [[4077128  606553     627       2    3258]
 [1320445  536131     324      10    2533]
 [   4637    1482       0       0       7]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8081
Class 1 F1: 0.3570
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7547
Class 1 Precision: 0.4686
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8698
Class 1 Recall: 0.2883
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7039
Macro F1 Score: 0.2330
xView2 Score: 0.1701
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.4431
Confusion Matrix:
 [[3960743  725857     630       0     338]
 [1188493  670356     319      10     265]
 [   5263     863       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8048
Class 1 F1: 0.4117
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7683
Class 1 Precision: 0.4798
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8449
Class 1 Recall: 0.3605
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7066
Macro F1 Score: 0.2433
xView2 Score: 0.1976
Epoch 5 took:  0 hours,  0 minutes, 50 seconds

Epoch 6/10
Train Loss: 1.4118
Confusion Matrix:
 [[3988818  698433     191       0     126]
 [1186190  673054     149       0      50]
 [   4263    1863       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8085
Class 1 F1: 0.4164
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7701
Class 1 Precision: 0.4901
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8509
Class 1 Recall: 0.3620
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7113
Macro F1 Score: 0.2450
xView2 Score: 0.1994
Epoch 6 took:  0 hours,  0 minutes, 33 seconds

Epoch 7/10
Train Loss: 1.4059
Confusion Matrix:
 [[3795008  892270     290       0       0]
 [1004458  854813     172       0       0]
 [   3624    2502       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7997
Class 1 F1: 0.4737
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7900
Class 1 Precision: 0.4886
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8096
Class 1 Recall: 0.4597
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7095
Macro F1 Score: 0.3184
xView2 Score: 0.2524
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3647
Confusion Matrix:
 [[3721019  966213     336       0       0]
 [ 983951  875331     161       0       0]
 [   4207    1919       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7919
Class 1 F1: 0.4728
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7901
Class 1 Precision: 0.4748
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7938
Class 1 Recall: 0.4707
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7013
Macro F1 Score: 0.3162
xView2 Score: 0.2538
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.3432
Confusion Matrix:
 [[3742155  945005     408       0       0]
 [ 932290  926882     271       0       0]
 [   2997    3129       0       0       0]
 [    455       8       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7991
Class 1 F1: 0.4964
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8000
Class 1 Precision: 0.4943
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7983
Class 1 Recall: 0.4985
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7124
Macro F1 Score: 0.3239
xView2 Score: 0.2655
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2732
Confusion Matrix:
 [[3547895 1139431     242       0       0]
 [ 773929 1085347     167       0       0]
 [   2882    3244       0       0       0]
 [    424      39       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7873
Class 1 F1: 0.5311
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8203
Class 1 Precision: 0.4871
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7569
Class 1 Recall: 0.5837
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7070
Macro F1 Score: 0.3296
xView2 Score: 0.2884
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7070
Best Macro F1: 0.3296
Best xView2 Score: 0.2884
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8203
Class 1 Precision: 0.4871
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3269
ROC curve saved to .././____________optune_results/66/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/66/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/66/visualize_predictions.jpg
Prediction distribution: {0: 203129, 1: 59015}
ROC curve saved to .././____________optune_results/66/visualize_predictions.jpg
Prediction distribution: {0: 48615, 1: 213491, 2: 38}
ROC curve saved to .././____________optune_results/66/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/66/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/66/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2710450780110908, 1: 0.7680833293529007, 2: 134.87953692785936, 3: 969.2210283073368, 4: 5292.497160883281}
Final class weights used in loss: [0.5196236408981514, 0.7680833293529007, 134.87953692785936, 969.2210283073368, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6038
Confusion Matrix:
 [[1664688  826751  194378  984150  940973]
 [ 501402  509340  102495  318031  503796]
 [   1722    2938     363     606     555]
 [    621     569      10      79     133]
 [      0       0       0       0       0]]
Class 0 F1: 0.4911
Class 1 F1: 0.3111
Class 2 F1: 0.0024
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7677
Class 1 Precision: 0.3802
Class 2 Precision: 0.0012
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.3610
Class 1 Recall: 0.2632
Class 2 Recall: 0.0587
Class 3 Recall: 0.0559
Class 4 Recall: 0.0000
Validation Accuracy: 0.3318
Macro F1 Score: 0.1609
xView2 Score: 0.1957
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5599
Confusion Matrix:
 [[3282170  688073  123888  267751  249058]
 [1026117  509994   79367  117195  202391]
 [   4243    1534     129     103     175]
 [   1356       1       0       4      51]
 [      0       0       0       0       0]]
Class 0 F1: 0.7355
Class 1 F1: 0.3254
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7608
Class 1 Precision: 0.4251
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7118
Class 1 Recall: 0.2636
Class 2 Recall: 0.0209
Class 3 Recall: 0.0028
Class 4 Recall: 0.0000
Validation Accuracy: 0.5787
Macro F1 Score: 0.2124
xView2 Score: 0.1895
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5253
Confusion Matrix:
 [[3818626  557114   92827   80569   61804]
 [1288970  460571   65623   53609   66291]
 [   3978    2024      52     127       3]
 [   1331      81       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7854
Class 1 F1: 0.3117
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7469
Class 1 Precision: 0.4516
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8282
Class 1 Recall: 0.2380
Class 2 Recall: 0.0084
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6530
Macro F1 Score: 0.2196
xView2 Score: 0.1690
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.4908
Confusion Matrix:
 [[3984886  529561   65958   20229   10306]
 [1325984  530774   48003   18497   11806]
 [   4801    1292      90       1       0]
 [   1384      27       1       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8028
Class 1 F1: 0.3542
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7495
Class 1 Precision: 0.5000
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8642
Class 1 Recall: 0.2743
Class 2 Recall: 0.0146
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6890
Macro F1 Score: 0.2317
xView2 Score: 0.1759
Epoch 4 took:  0 hours,  1 minutes, 16 seconds

Epoch 5/10
Train Loss: 1.4474
Confusion Matrix:
 [[4042648  524243   40271    2812     966]
 [1349569  552524   28300    3053    1618]
 [   4315    1841      28       0       0]
 [   1217     195       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8078
Class 1 F1: 0.3667
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7490
Class 1 Precision: 0.5122
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8768
Class 1 Recall: 0.2855
Class 2 Recall: 0.0045
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7012
Macro F1 Score: 0.2350
xView2 Score: 0.1761
Epoch 5 took:  0 hours,  0 minutes, 58 seconds

Epoch 6/10
Train Loss: 1.4125
Confusion Matrix:
 [[3954289  630226   24987    1335     103]
 [1247418  670460   16138     915     133]
 [   4704    1480       0       0       0]
 [   1173     239       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8055
Class 1 F1: 0.4142
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7593
Class 1 Precision: 0.5148
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8576
Class 1 Recall: 0.3465
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7057
Macro F1 Score: 0.2439
xView2 Score: 0.1978
Epoch 6 took:  0 hours,  0 minutes, 36 seconds

Epoch 7/10
Train Loss: 1.3516
Confusion Matrix:
 [[4011378  589544    9455     555       8]
 [1263355  665088    6352     258      11]
 [   4262    1922       0       0       0]
 [   1323      89       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8111
Class 1 F1: 0.4168
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7597
Class 1 Precision: 0.5293
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8700
Class 1 Recall: 0.3437
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7136
Macro F1 Score: 0.2456
xView2 Score: 0.1973
Epoch 7 took:  0 hours,  0 minutes, 29 seconds

Epoch 8/10
Train Loss: 1.3366
Confusion Matrix:
 [[3866763  736993    7114      70       0]
 [1139617  790571    4817      59       0]
 [   4535    1649       0       0       0]
 [   1404       8       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8036
Class 1 F1: 0.4564
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7715
Class 1 Precision: 0.5170
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8386
Class 1 Recall: 0.4086
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7107
Macro F1 Score: 0.3150
xView2 Score: 0.2387
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.3240
Confusion Matrix:
 [[3823270  780791    6787      92       0]
 [1075427  855509    4074      54       0]
 [   4280    1904       0       0       0]
 [   1324      88       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8036
Class 1 F1: 0.4788
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7796
Class 1 Precision: 0.5222
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8292
Class 1 Recall: 0.4421
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7139
Macro F1 Score: 0.3206
xView2 Score: 0.2511
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2840
Confusion Matrix:
 [[3880765  726852    3191     132       0]
 [1108222  824915    1879      48       0]
 [   3892    2292       0       0       0]
 [   1240     172       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8081
Class 1 F1: 0.4728
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7771
Class 1 Precision: 0.5308
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8416
Class 1 Recall: 0.4263
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7180
Macro F1 Score: 0.3202
xView2 Score: 0.2466
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7139
Best Macro F1: 0.3206
Best xView2 Score: 0.2511
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7796
Class 1 Precision: 0.5222
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3254
ROC curve saved to .././____________optune_results/67/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/67/plot_loss_curves.jpg
Prediction distribution: {0: 246903, 1: 14739, 2: 502}
ROC curve saved to .././____________optune_results/67/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/67/visualize_predictions.jpg
Prediction distribution: {0: 253120, 1: 9024}
ROC curve saved to .././____________optune_results/67/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/67/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/67/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2713970125737413, 1: 0.7640040638281498, 2: 196.52355628440904, 3: 830.144285007422, 4: 5732.533940774488}
Final class weights used in loss: [3.2117021701390263, 0.7640040638281498, 196.52355628440904, 830.144285007422, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6112
Confusion Matrix:
 [[1613773    8994  306174 1477217 1228862]
 [ 571776    4291   63020  685694  575295]
 [   1910       0     334   11214    4431]
 [      0       0       0     542       0]
 [      0       0       0      73       0]]
Class 0 F1: 0.4731
Class 1 F1: 0.0045
Class 2 F1: 0.0017
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7377
Class 1 Precision: 0.3230
Class 2 Precision: 0.0009
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.3482
Class 1 Recall: 0.0023
Class 2 Recall: 0.0187
Class 3 Recall: 1.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2470
Macro F1 Score: 0.0960
xView2 Score: 0.1304
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5163
Confusion Matrix:
 [[3653345    3856   82088  552446  343285]
 [1327499    3414   36128  312835  220200]
 [  10069       0     115    6832     873]
 [    161       0       0     381       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7590
Class 1 F1: 0.0036
Class 2 F1: 0.0017
Class 3 F1: 0.0009
Class 4 F1: 0.0000
Class 0 Precision: 0.7320
Class 1 Precision: 0.4696
Class 2 Precision: 0.0010
Class 3 Precision: 0.0004
Class 4 Precision: 0.0000
Class 0 Recall: 0.7882
Class 1 Recall: 0.0018
Class 2 Recall: 0.0064
Class 3 Recall: 0.7030
Class 4 Recall: 0.0000
Validation Accuracy: 0.5581
Macro F1 Score: 0.1530
xView2 Score: 0.1015
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4240
Confusion Matrix:
 [[4454963     319    9555  110840   59343]
 [1779818     356    5137   68672   46093]
 [  15399       0       4    2262     224]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8185
Class 1 F1: 0.0004
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7127
Class 1 Precision: 0.5274
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9612
Class 1 Recall: 0.0002
Class 2 Recall: 0.0002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6798
Macro F1 Score: 0.1638
xView2 Score: 0.0333
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.3399
Confusion Matrix:
 [[4617517      13     209   12496    4785]
 [1887478      11     294    7451    4842]
 [  17818       0       0      44      27]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8276
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7078
Class 1 Precision: 0.4583
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9962
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7046
Macro F1 Score: 0.1655
xView2 Score: 0.0039
Epoch 4 took:  0 hours,  1 minutes,  8 seconds

Epoch 5/10
Train Loss: 1.2518
Confusion Matrix:
 [[4632475       0      10    2124     411]
 [1898547       0     246     955     328]
 [  17852       0       0      28       9]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8284
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7073
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7069
Macro F1 Score: 0.1657
xView2 Score: 0.0005
Epoch 5 took:  0 hours,  0 minutes, 42 seconds

Epoch 6/10
Train Loss: 1.1655
Confusion Matrix:
 [[4634856       0       0     163       1]
 [1900020       0       0      54       2]
 [  17881       0       0       8       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8285
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7072
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1657
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 29 seconds

Epoch 7/10
Train Loss: 1.0800
Confusion Matrix:
 [[4634995       0       0      25       0]
 [1900075       0       0       1       0]
 [  17889       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8285
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7072
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1657
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0085
Confusion Matrix:
 [[4635016       0       0       4       0]
 [1900076       0       0       0       0]
 [  17889       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8285
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7072
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1657
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9429
Confusion Matrix:
 [[4635020       0       0       0       0]
 [1900076       0       0       0       0]
 [  17889       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8285
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7072
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1657
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8992
Confusion Matrix:
 [[4635020       0       0       0       0]
 [1900076       0       0       0       0]
 [  17889       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8285
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7072
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1657
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2470
Best Macro F1: 0.0960
Best xView2 Score: 0.1304
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7377
Class 1 Precision: 0.3230
Class 2 Precision: 0.0009
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Macro Precision: 0.2124
ROC curve saved to .././____________optune_results/68/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/68/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/68/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/68/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/68/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/68/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/68/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2701800409459932, 1: 0.7749866579783135, 2: 144.08876928802496, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [2.2802604726303164, 0.7749866579783135, 144.08876928802496, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5287
Confusion Matrix:
 [[3595093   14039   91033  199993  651328]
 [1305518    4687   66490   96372  520368]
 [   6203       8      53     481    1824]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7602
Class 1 F1: 0.0047
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7327
Class 1 Precision: 0.2502
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7899
Class 1 Recall: 0.0024
Class 2 Recall: 0.0062
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5493
Macro F1 Score: 0.1531
xView2 Score: 0.1144
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4344
Confusion Matrix:
 [[4393398    1260   17806   38324  100698]
 [1865635     749   15218   26493   85340]
 [   7440      38       9     100     982]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8122
Class 1 F1: 0.0008
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7011
Class 1 Precision: 0.3659
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9653
Class 1 Recall: 0.0004
Class 2 Recall: 0.0011
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6705
Macro F1 Score: 0.1627
xView2 Score: 0.0340
Epoch 2 took:  0 hours,  1 minutes, 18 seconds

Epoch 3/10
Train Loss: 1.3450
Confusion Matrix:
 [[4536704      24    1835    3956    8967]
 [1983036      88    1179    3517    5615]
 [   8223       0     346       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8189
Class 1 F1: 0.0001
Class 2 F1: 0.0580
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6950
Class 1 Precision: 0.7857
Class 2 Precision: 0.1030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9968
Class 1 Recall: 0.0000
Class 2 Recall: 0.0404
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6923
Macro F1 Score: 0.1754
xView2 Score: 0.0128
Epoch 3 took:  0 hours,  1 minutes,  7 seconds

Epoch 4/10
Train Loss: 1.2671
Confusion Matrix:
 [[4549048       1     229     633    1575]
 [1991779      44     376     404     832]
 [   8470       7       0       0      92]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8196
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6946
Class 1 Precision: 0.8462
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6941
Macro F1 Score: 0.1639
xView2 Score: 0.0005
Epoch 4 took:  0 hours,  0 minutes, 45 seconds

Epoch 5/10
Train Loss: 1.1865
Confusion Matrix:
 [[4551461       0      16       0       9]
 [1993406       0      25       3       1]
 [   8569       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6945
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.1639
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 29 seconds

Epoch 6/10
Train Loss: 1.1000
Confusion Matrix:
 [[4551485       0       1       0       0]
 [1993430       0       5       0       0]
 [   8569       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6945
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.2049
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.0570
Confusion Matrix:
 [[4551486       0       0       0       0]
 [1993434       0       1       0       0]
 [   8569       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6945
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.2049
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.0005
Confusion Matrix:
 [[4551486       0       0       0       0]
 [1993435       0       0       0       0]
 [   8569       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6945
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.2049
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9567
Confusion Matrix:
 [[4551486       0       0       0       0]
 [1993435       0       0       0       0]
 [   8569       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6945
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.2049
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8906
Confusion Matrix:
 [[4551486       0       0       0       0]
 [1993435       0       0       0       0]
 [   8569       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8197
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6945
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.2049
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5493
Best Macro F1: 0.1531
Best xView2 Score: 0.1144
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7327
Class 1 Precision: 0.2502
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1966
ROC curve saved to .././____________optune_results/69/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/69/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/69/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/69/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/69/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/69/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/69/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.26942684620802293, 1: 0.7806350528869523, 2: 169.26735496889188, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [0.33240696242045237, 0.7806350528869523, 169.26735496889188, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5856
Confusion Matrix:
 [[3266972  130583  593968  492615   15270]
 [1349158  104863  279359  295208   11839]
 [  10142     240    1383    1863     137]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7160
Class 1 F1: 0.0921
Class 2 F1: 0.0031
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7062
Class 1 Precision: 0.4449
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7261
Class 1 Recall: 0.0514
Class 2 Recall: 0.1005
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5147
Macro F1 Score: 0.1623
xView2 Score: 0.1197
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5591
Confusion Matrix:
 [[3811263  258946  220996  205304    2899]
 [1558784  220962  137173  120495    3013]
 [  11887     698     271     908       1]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7714
Class 1 F1: 0.1753
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7082
Class 1 Precision: 0.4598
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8471
Class 1 Recall: 0.1083
Class 2 Recall: 0.0197
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6153
Macro F1 Score: 0.1896
xView2 Score: 0.1178
Epoch 2 took:  0 hours,  1 minutes, 12 seconds

Epoch 3/10
Train Loss: 1.5311
Confusion Matrix:
 [[3888294  343679  153115  113913     407]
 [1549096  306187  109828   74806     510]
 [  11148    1472     530     615       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7817
Class 1 F1: 0.2275
Class 2 F1: 0.0038
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 0.4701
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8642
Class 1 Recall: 0.1501
Class 2 Recall: 0.0385
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6401
Macro F1 Score: 0.2026
xView2 Score: 0.1315
Epoch 3 took:  0 hours,  0 minutes, 55 seconds

Epoch 4/10
Train Loss: 1.4974
Confusion Matrix:
 [[3724144  686174   55039   34033      18]
 [1347060  635211   37906   20241       9]
 [   8927    4285     325     228       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7775
Class 1 F1: 0.3774
Class 2 F1: 0.0061
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7331
Class 1 Precision: 0.4792
Class 2 Precision: 0.0035
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8277
Class 1 Recall: 0.3113
Class 2 Recall: 0.0236
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6652
Macro F1 Score: 0.2322
xView2 Score: 0.1869
Epoch 4 took:  0 hours,  0 minutes, 34 seconds

Epoch 5/10
Train Loss: 1.4702
Confusion Matrix:
 [[3592154  842527   43169   21558       0]
 [1227693  772252   28071   12410       1]
 [  10310    3301      88      66       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7701
Class 1 F1: 0.4222
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7437
Class 1 Precision: 0.4773
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7984
Class 1 Recall: 0.3785
Class 2 Recall: 0.0064
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6660
Macro F1 Score: 0.2389
xView2 Score: 0.2070
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.4251
Confusion Matrix:
 [[3287548 1146238   56838    8784       0]
 [ 959681 1041764   34066    4916       0]
 [   7755    5788     222       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7511
Class 1 F1: 0.4921
Class 2 F1: 0.0042
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7726
Class 1 Precision: 0.4749
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7307
Class 1 Recall: 0.5106
Class 2 Recall: 0.0161
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6606
Macro F1 Score: 0.3118
xView2 Score: 0.2695
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.3887
Confusion Matrix:
 [[3324476 1140819   30708    3405       0]
 [ 940468 1076762   21159    2038       0]
 [   6358    6680     684      43       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7581
Class 1 F1: 0.5050
Class 2 F1: 0.0206
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7783
Class 1 Precision: 0.4841
Class 2 Precision: 0.0130
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7389
Class 1 Recall: 0.5277
Class 2 Recall: 0.0497
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6717
Macro F1 Score: 0.3209
xView2 Score: 0.2806
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3659
Confusion Matrix:
 [[3141295 1341993   15531     589       0]
 [ 814879 1219554    5678     316       0]
 [   7765    5833     167       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7423
Class 1 F1: 0.5293
Class 2 F1: 0.0095
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7925
Class 1 Precision: 0.4750
Class 2 Precision: 0.0078
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6982
Class 1 Recall: 0.5977
Class 2 Recall: 0.0121
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6654
Macro F1 Score: 0.3203
xView2 Score: 0.2928
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.3346
Confusion Matrix:
 [[2942210 1548506    8067     625       0]
 [ 688530 1347025    4624     248       0]
 [   7018    6600     147       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7232
Class 1 F1: 0.5451
Class 2 F1: 0.0111
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8088
Class 1 Precision: 0.4642
Class 2 Precision: 0.0115
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6539
Class 1 Recall: 0.6602
Class 2 Recall: 0.0107
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6545
Macro F1 Score: 0.3198
xView2 Score: 0.3057
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.3058
Confusion Matrix:
 [[2873346 1621031    4761     270       0]
 [ 643127 1393278    3891     131       0]
 [   6513    7116     136       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7163
Class 1 F1: 0.5505
Class 2 F1: 0.0121
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8156
Class 1 Precision: 0.4611
Class 2 Precision: 0.0155
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6386
Class 1 Recall: 0.6828
Class 2 Recall: 0.0099
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6511
Macro F1 Score: 0.3197
xView2 Score: 0.3101
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6511
Best Macro F1: 0.3197
Best xView2 Score: 0.3101
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8156
Class 1 Precision: 0.4611
Class 2 Precision: 0.0155
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3231
ROC curve saved to .././____________optune_results/70/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/70/plot_loss_curves.jpg
Prediction distribution: {0: 143810, 1: 118300, 2: 34}
ROC curve saved to .././____________optune_results/70/visualize_predictions.jpg
Prediction distribution: {0: 158723, 1: 103357, 2: 64}
ROC curve saved to .././____________optune_results/70/visualize_predictions.jpg
Prediction distribution: {0: 192948, 1: 69171, 2: 25}
ROC curve saved to .././____________optune_results/70/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/70/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/70/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2739786803336889, 1: 0.743646529324836, 2: 224.45437031751695, 3: 1404.7348032375105, 4: 5292.497160883281}
Final class weights used in loss: [1.126681351057717, 0.743646529324836, 224.45437031751695, 1404.7348032375105, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6057
Confusion Matrix:
 [[1769918 1412436   52648  609716  965053]
 [ 491112  634696   15205  290579  288139]
 [   9491    4866      91    3129    3499]
 [    383    1564       0      80     995]
 [      0       0       0       0       0]]
Class 0 F1: 0.4999
Class 1 F1: 0.3364
Class 2 F1: 0.0020
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.7794
Class 1 Precision: 0.3091
Class 2 Precision: 0.0013
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.3680
Class 1 Recall: 0.3691
Class 2 Recall: 0.0043
Class 3 Recall: 0.0265
Class 4 Recall: 0.0000
Validation Accuracy: 0.3669
Macro F1 Score: 0.1677
xView2 Score: 0.1998
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5458
Confusion Matrix:
 [[3405557  791306   14899  164911  433098]
 [ 995070  454115    6571  100873  163102]
 [  14919    2119      14    1051    2973]
 [   1303    1383       0      33     303]
 [      0       0       0       0       0]]
Class 0 F1: 0.7382
Class 1 F1: 0.3059
Class 2 F1: 0.0007
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.7710
Class 1 Precision: 0.3636
Class 2 Precision: 0.0007
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.7080
Class 1 Recall: 0.2641
Class 2 Recall: 0.0007
Class 3 Recall: 0.0109
Class 4 Recall: 0.0000
Validation Accuracy: 0.5889
Macro F1 Score: 0.2090
xView2 Score: 0.1719
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4821
Confusion Matrix:
 [[4389930  300357    2551   41930   75003]
 [1442418  213781    1082   24994   37456]
 [  19376    1454       1      50     195]
 [   2395     416       0       0     211]
 [      0       0       0       0       0]]
Class 0 F1: 0.8233
Class 1 F1: 0.1912
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7499
Class 1 Precision: 0.4143
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9127
Class 1 Recall: 0.1243
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7025
Macro F1 Score: 0.2029
xView2 Score: 0.0996
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.4395
Confusion Matrix:
 [[4582045  198375     532   13072   15747]
 [1530511  169249     392    8976   10603]
 [  19434    1115       0       6     521]
 [   2325     560       0       0     137]
 [      0       0       0       0       0]]
Class 0 F1: 0.8374
Class 1 F1: 0.1620
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7470
Class 1 Precision: 0.4583
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9527
Class 1 Recall: 0.0984
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7250
Macro F1 Score: 0.1999
xView2 Score: 0.0782
Epoch 4 took:  0 hours,  1 minutes, 13 seconds

Epoch 5/10
Train Loss: 1.3538
Confusion Matrix:
 [[4628630  175975      59    2611    2496]
 [1557119  158795      22    1992    1803]
 [  19868     962       0       0     246]
 [   2910     112       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.1545
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7455
Class 1 Precision: 0.4728
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9623
Class 1 Recall: 0.0923
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7305
Macro F1 Score: 0.1989
xView2 Score: 0.0707
Epoch 5 took:  0 hours,  0 minutes, 53 seconds

Epoch 6/10
Train Loss: 1.3055
Confusion Matrix:
 [[4716907   92475       9     333      47]
 [1623176   96102       4     358      91]
 [  20798     278       0       0       0]
 [   2749     273       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8443
Class 1 F1: 0.1007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7412
Class 1 Precision: 0.5081
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9807
Class 1 Recall: 0.0559
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7344
Macro F1 Score: 0.1890
xView2 Score: 0.0449
Epoch 6 took:  0 hours,  0 minutes, 31 seconds

Epoch 7/10
Train Loss: 1.2349
Confusion Matrix:
 [[4669636  140038       0      32      65]
 [1569125  150547       0      58       1]
 [  20398     678       0       0       0]
 [   2748     274       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8435
Class 1 F1: 0.1497
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7457
Class 1 Precision: 0.5164
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9709
Class 1 Recall: 0.0875
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7355
Macro F1 Score: 0.1986
xView2 Score: 0.0672
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.1869
Confusion Matrix:
 [[4716342   93417       0      12       0]
 [1618435  101293       0       3       0]
 [  20896     180       0       0       0]
 [   2903     119       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8446
Class 1 F1: 0.1058
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7417
Class 1 Precision: 0.5194
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9806
Class 1 Recall: 0.0589
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7351
Macro F1 Score: 0.2376
xView2 Score: 0.0509
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1654
Confusion Matrix:
 [[4755472   54299       0       0       0]
 [1649960   69771       0       0       0]
 [  21055      21       0       0       0]
 [   2991      31       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8462
Class 1 F1: 0.0757
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7396
Class 1 Precision: 0.5621
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9887
Class 1 Recall: 0.0406
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7363
Macro F1 Score: 0.2305
xView2 Score: 0.0361
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1296
Confusion Matrix:
 [[4760377   49394       0       0       0]
 [1657613   62118       0       0       0]
 [  21040      36       0       0       0]
 [   3005      17       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8462
Class 1 F1: 0.0678
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7390
Class 1 Precision: 0.5568
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9897
Class 1 Recall: 0.0361
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7359
Macro F1 Score: 0.2285
xView2 Score: 0.0323
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3669
Best Macro F1: 0.1677
Best xView2 Score: 0.1998
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7794
Class 1 Precision: 0.3091
Class 2 Precision: 0.0013
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.2180
ROC curve saved to .././____________optune_results/71/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/71/plot_loss_curves.jpg
Prediction distribution: {0: 261498, 1: 646}
ROC curve saved to .././____________optune_results/71/visualize_predictions.jpg
Prediction distribution: {0: 249525, 1: 12619}
ROC curve saved to .././____________optune_results/71/visualize_predictions.jpg
Prediction distribution: {0: 257462, 1: 4682}
ROC curve saved to .././____________optune_results/71/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/71/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/71/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27484824455920137, 1: 0.7386885940264901, 2: 154.5859762277711, 3: 819.4667535004885, 4: 5292.497160883281}
Final class weights used in loss: [1.5043463399264172, 0.7386885940264901, 154.5859762277711, 819.4667535004885, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6736
Confusion Matrix:
 [[ 577553 2150628  141174  614458 1384079]
 [ 216251  995244   64054  143980  254775]
 [   1338    6895     431     988    1289]
 [    271      30       2      43     117]
 [      0       0       0       0       0]]
Class 0 F1: 0.2040
Class 1 F1: 0.4124
Class 2 F1: 0.0040
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.3157
Class 2 Precision: 0.0021
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.1186
Class 1 Recall: 0.5944
Class 2 Recall: 0.0394
Class 3 Recall: 0.0929
Class 4 Recall: 0.0000
Validation Accuracy: 0.2401
Macro F1 Score: 0.1241
xView2 Score: 0.2241
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5808
Confusion Matrix:
 [[2639399 1321320  120611  203803  582759]
 [ 702275  722156   53051   57585  139237]
 [   3476    5663     256     466    1080]
 [    412      14       0       5      32]
 [      0       0       0       0       0]]
Class 0 F1: 0.6427
Class 1 F1: 0.3879
Class 2 F1: 0.0028
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7889
Class 1 Precision: 0.3524
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5422
Class 1 Recall: 0.4313
Class 2 Recall: 0.0234
Class 3 Recall: 0.0108
Class 4 Recall: 0.0000
Validation Accuracy: 0.5130
Macro F1 Score: 0.2067
xView2 Score: 0.2054
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.5109
Confusion Matrix:
 [[4277845  440146   34332   20822   94747]
 [1307330  306852   23613    8714   27795]
 [   6670    3531     180      16     544]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8179
Class 1 F1: 0.2531
Class 2 F1: 0.0052
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7650
Class 1 Precision: 0.4088
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8788
Class 1 Recall: 0.1833
Class 2 Recall: 0.0165
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6996
Macro F1 Score: 0.2152
xView2 Score: 0.1289
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4228
Confusion Matrix:
 [[4660779  172252   20307    3136   11418]
 [1481495  170490   14196    2137    5986]
 [   7559    3132       0       0     250]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.1688
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7578
Class 1 Precision: 0.4929
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9575
Class 1 Recall: 0.1018
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7372
Macro F1 Score: 0.2030
xView2 Score: 0.0822
Epoch 4 took:  0 hours,  1 minutes, 18 seconds

Epoch 5/10
Train Loss: 1.3533
Confusion Matrix:
 [[4795898   63691    7063     664     576]
 [1591407   76727    5378     456     336]
 [  10808     133       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8514
Class 1 F1: 0.0846
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7495
Class 1 Precision: 0.5459
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9852
Class 1 Recall: 0.0458
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7435
Macro F1 Score: 0.1872
xView2 Score: 0.0393
Epoch 5 took:  0 hours,  0 minutes, 57 seconds

Epoch 6/10
Train Loss: 1.2950
Confusion Matrix:
 [[4835527   31087    1093     168      17]
 [1629505   43487    1205      79      28]
 [  10286     643      12       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8526
Class 1 F1: 0.0497
Class 2 F1: 0.0018
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7467
Class 1 Precision: 0.5782
Class 2 Precision: 0.0052
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9934
Class 1 Recall: 0.0260
Class 2 Recall: 0.0011
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7445
Macro F1 Score: 0.1808
xView2 Score: 0.0228
Epoch 6 took:  0 hours,  0 minutes, 36 seconds

Epoch 7/10
Train Loss: 1.2070
Confusion Matrix:
 [[4863078    4730      84       0       0]
 [1663699   10429     176       0       0]
 [  10941       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8527
Class 1 F1: 0.0123
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7438
Class 1 Precision: 0.6880
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9990
Class 1 Recall: 0.0062
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7436
Macro F1 Score: 0.2163
xView2 Score: 0.0059
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.1730
Confusion Matrix:
 [[4866595    1290       7       0       0]
 [1670503    3792       9       0       0]
 [  10941       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8526
Class 1 F1: 0.0045
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7432
Class 1 Precision: 0.7462
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0023
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7432
Macro F1 Score: 0.2143
xView2 Score: 0.0021
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1038
Confusion Matrix:
 [[4867438     443      11       0       0]
 [1673235    1063       6       0       0]
 [  10811     130       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0013
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.6498
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0006
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2134
xView2 Score: 0.0006
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.0797
Confusion Matrix:
 [[4867394     498       0       0       0]
 [1674042     262       0       0       0]
 [  10941       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8524
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7428
Class 1 Precision: 0.3447
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7427
Macro F1 Score: 0.2132
xView2 Score: 0.0001
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2401
Best Macro F1: 0.1241
Best xView2 Score: 0.2241
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7261
Class 1 Precision: 0.3157
Class 2 Precision: 0.0021
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.2088
ROC curve saved to .././____________optune_results/72/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/72/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/72/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/72/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/72/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/72/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/72/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27291509159111227, 1: 0.7524409503438122, 2: 186.75936178107608, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [5.26680873447267, 0.7524409503438122, 186.75936178107608, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4777
Confusion Matrix:
 [[3699716     552  804526  233371      13]
 [1254870     490  411794  131666      17]
 [  14789       8    1322     431       0]
 [      0       0      35       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7622
Class 1 F1: 0.0005
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7445
Class 1 Precision: 0.4667
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7808
Class 1 Recall: 0.0003
Class 2 Recall: 0.0799
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5648
Macro F1 Score: 0.1530
xView2 Score: 0.0973
Epoch 1 took:  0 hours,  0 minutes, 34 seconds

Epoch 2/10
Train Loss: 1.3571
Confusion Matrix:
 [[4617934      35   89594   30615       0]
 [1723701       5   53606   21525       0]
 [  13692       0    2812      46       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8325
Class 1 F1: 0.0000
Class 2 F1: 0.0346
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7266
Class 1 Precision: 0.1250
Class 2 Precision: 0.0193
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9746
Class 1 Recall: 0.0000
Class 2 Recall: 0.1699
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7051
Macro F1 Score: 0.2168
xView2 Score: 0.0367
Epoch 2 took:  0 hours,  0 minutes, 25 seconds

Epoch 3/10
Train Loss: 1.2523
Confusion Matrix:
 [[4731200       3    5396    1579       0]
 [1794087       0    3517    1233       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8389
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7232
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9985
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7219
Macro F1 Score: 0.2097
xView2 Score: 0.0016
Epoch 3 took:  0 hours,  0 minutes, 24 seconds

Epoch 4/10
Train Loss: 1.1423
Confusion Matrix:
 [[4738004       0     151      23       0]
 [1798648       0     155      34       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 26 seconds

Epoch 5/10
Train Loss: 1.0319
Confusion Matrix:
 [[4738175       0       3       0       0]
 [1798830       0       7       0       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 0.9423
Confusion Matrix:
 [[4738178       0       0       0       0]
 [1798837       0       0       0       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 0.8702
Confusion Matrix:
 [[4738178       0       0       0       0]
 [1798837       0       0       0       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 0.7951
Confusion Matrix:
 [[4738178       0       0       0       0]
 [1798837       0       0       0       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.7503
Confusion Matrix:
 [[4738178       0       0       0       0]
 [1798837       0       0       0       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.6949
Confusion Matrix:
 [[4738178       0       0       0       0]
 [1798837       0       0       0       0]
 [  16550       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8392
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7230
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7230
Macro F1 Score: 0.2098
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5648
Best Macro F1: 0.1530
Best xView2 Score: 0.0973
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7445
Class 1 Precision: 0.4667
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2425
ROC curve saved to .././____________optune_results/73/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/73/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/73/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/73/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/73/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/73/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/73/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27517481749011385, 1: 0.7360580286633519, 2: 164.60623344343787, 3: 902.1625380892633, 4: 5732.533940774488}
Final class weights used in loss: [0.7598071526943793, 0.7360580286633519, 164.60623344343787, 902.1625380892633, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5876
Confusion Matrix:
 [[1462062  557092   21960 2846576    1935]
 [ 778992  297767    6839  566029     326]
 [   5823    1327       2    5771       0]
 [    258     219       0     549       0]
 [      0       1       0      72       0]]
Class 0 F1: 0.4097
Class 1 F1: 0.2376
Class 2 F1: 0.0001
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.6506
Class 1 Precision: 0.3477
Class 2 Precision: 0.0001
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.2990
Class 1 Recall: 0.1805
Class 2 Recall: 0.0002
Class 3 Recall: 0.5351
Class 4 Recall: 0.0000
Validation Accuracy: 0.2686
Macro F1 Score: 0.1296
xView2 Score: 0.1314
Epoch 1 took:  0 hours,  0 minutes, 54 seconds

Epoch 2/10
Train Loss: 1.5254
Confusion Matrix:
 [[2999215  315254    7163 1567744     249]
 [1204532  161606    3421  280008     386]
 [   9819     362      48    2694       0]
 [    987      39       0       0       0]
 [     24       0       0      49       0]]
Class 0 F1: 0.6589
Class 1 F1: 0.1519
Class 2 F1: 0.0041
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7116
Class 1 Precision: 0.3386
Class 2 Precision: 0.0045
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6134
Class 1 Recall: 0.0979
Class 2 Recall: 0.0037
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4823
Macro F1 Score: 0.1630
xView2 Score: 0.0930
Epoch 2 took:  0 hours,  0 minutes, 37 seconds

Epoch 3/10
Train Loss: 1.4791
Confusion Matrix:
 [[4500803  128220    4455  256147       0]
 [1514232   69361    1206   65154       0]
 [  12473      90       0     360       0]
 [   1026       0       0       0       0]
 [     72       1       0       0       0]]
Class 0 F1: 0.8245
Class 1 F1: 0.0751
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7466
Class 1 Precision: 0.3509
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9205
Class 1 Recall: 0.0420
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6974
Macro F1 Score: 0.1799
xView2 Score: 0.0486
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.4355
Confusion Matrix:
 [[4795385   74953     572   18715       0]
 [1592957   49673     187    7136       0]
 [  12205     113       0     605       0]
 [    806     161       0      59       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8494
Class 1 F1: 0.0560
Class 2 F1: 0.0000
Class 3 F1: 0.0043
Class 4 F1: 0.0000
Class 0 Precision: 0.7491
Class 1 Precision: 0.3977
Class 2 Precision: 0.0000
Class 3 Precision: 0.0022
Class 4 Precision: 0.0000
Class 0 Recall: 0.9807
Class 1 Recall: 0.0301
Class 2 Recall: 0.0000
Class 3 Recall: 0.0575
Class 4 Recall: 0.0000
Validation Accuracy: 0.7393
Macro F1 Score: 0.1819
xView2 Score: 0.0292
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3822
Confusion Matrix:
 [[4854330   33955     416     924       0]
 [1625709   23742      50     452       0]
 [  12895      28       0       0       0]
 [   1026       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8529
Class 1 F1: 0.0278
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7475
Class 1 Precision: 0.4113
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9928
Class 1 Recall: 0.0144
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7443
Macro F1 Score: 0.1761
xView2 Score: 0.0124
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.3439
Confusion Matrix:
 [[4870596   18395     456     178       0]
 [1631849   17982      99      23       0]
 [  12913      10       0       0       0]
 [   1026       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8540
Class 1 F1: 0.0213
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7474
Class 1 Precision: 0.4942
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9961
Class 1 Recall: 0.0109
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7459
Macro F1 Score: 0.1751
xView2 Score: 0.0094
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2889
Confusion Matrix:
 [[4874984   14437     203       1       0]
 [1635242   14680      31       0       0]
 [  12923       0       0       0       0]
 [   1026       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8542
Class 1 F1: 0.0175
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7472
Class 1 Precision: 0.5042
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9970
Class 1 Recall: 0.0089
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7461
Macro F1 Score: 0.1743
xView2 Score: 0.0077
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2435
Confusion Matrix:
 [[4872543   16825     257       0       0]
 [1630533   19373      47       0       0]
 [  12922       1       0       0       0]
 [   1026       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8543
Class 1 F1: 0.0230
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7477
Class 1 Precision: 0.5352
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9965
Class 1 Recall: 0.0117
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7464
Macro F1 Score: 0.1755
xView2 Score: 0.0101
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1996
Confusion Matrix:
 [[4855652   33895      76       2       0]
 [1612728   37224       1       0       0]
 [  12923       0       0       0       0]
 [   1026       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8540
Class 1 F1: 0.0433
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7491
Class 1 Precision: 0.5234
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9931
Class 1 Recall: 0.0226
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7466
Macro F1 Score: 0.1794
xView2 Score: 0.0190
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1779
Confusion Matrix:
 [[4858314   31307       4       0       0]
 [1615266   34687       0       0       0]
 [  12923       0       0       0       0]
 [   1026       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8540
Class 1 F1: 0.0404
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7489
Class 1 Precision: 0.5256
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9936
Class 1 Recall: 0.0210
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7466
Macro F1 Score: 0.1789
xView2 Score: 0.0178
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2686
Best Macro F1: 0.1296
Best xView2 Score: 0.1314
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.6506
Class 1 Precision: 0.3477
Class 2 Precision: 0.0001
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Macro Precision: 0.1997
ROC curve saved to .././____________optune_results/74/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/74/plot_loss_curves.jpg
Prediction distribution: {0: 258936, 1: 3208}
ROC curve saved to .././____________optune_results/74/visualize_predictions.jpg
Prediction distribution: {0: 261634, 1: 510}
ROC curve saved to .././____________optune_results/74/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/74/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/74/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/74/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2771720215983342, 1: 0.7224557235839693, 2: 147.56552128532894, 3: 1001.2263377760096, 4: 5292.497160883281}
Final class weights used in loss: [3.216020064194482, 0.7224557235839693, 147.56552128532894, 1001.2263377760096, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5545
Confusion Matrix:
 [[3867492   27317  427175  524751  174687]
 [1253230   14488   89337  123728   40425]
 [   7348     266     515     966     297]
 [   1024       0      79     267     208]
 [      0       0       0       0       0]]
Class 0 F1: 0.7620
Class 1 F1: 0.0185
Class 2 F1: 0.0020
Class 3 F1: 0.0008
Class 4 F1: 0.0000
Class 0 Precision: 0.7540
Class 1 Precision: 0.3444
Class 2 Precision: 0.0010
Class 3 Precision: 0.0004
Class 4 Precision: 0.0000
Class 0 Recall: 0.7702
Class 1 Recall: 0.0095
Class 2 Recall: 0.0548
Class 3 Recall: 0.1692
Class 4 Recall: 0.0000
Validation Accuracy: 0.5925
Macro F1 Score: 0.1567
xView2 Score: 0.0596
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.4445
Confusion Matrix:
 [[4880006    1722   52777   67894   19023]
 [1483450     765   12348   19471    5174]
 [   8895       0      16     333     148]
 [   1566       0       2       6       4]
 [      0       0       0       0       0]]
Class 0 F1: 0.8565
Class 1 F1: 0.0010
Class 2 F1: 0.0004
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7656
Class 1 Precision: 0.3076
Class 2 Precision: 0.0002
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.9718
Class 1 Recall: 0.0005
Class 2 Recall: 0.0017
Class 3 Recall: 0.0038
Class 4 Recall: 0.0000
Validation Accuracy: 0.7447
Macro F1 Score: 0.1716
xView2 Score: 0.0138
Epoch 2 took:  0 hours,  1 minutes, 19 seconds

Epoch 3/10
Train Loss: 1.3449
Confusion Matrix:
 [[5015599      27    1795    3408     593]
 [1519446      38     877     700     147]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8672
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.5846
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9988
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7653
Macro F1 Score: 0.1734
xView2 Score: 0.0007
Epoch 3 took:  0 hours,  0 minutes, 54 seconds

Epoch 4/10
Train Loss: 1.2473
Confusion Matrix:
 [[5021338       0      48      10      26]
 [1521021       1     177       1       8]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.1735
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.1333
Confusion Matrix:
 [[5021422       0       0       0       0]
 [1521199       0       9       0       0]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.2169
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.0591
Confusion Matrix:
 [[5021422       0       0       0       0]
 [1521208       0       0       0       0]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.2169
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 0.9864
Confusion Matrix:
 [[5021422       0       0       0       0]
 [1521208       0       0       0       0]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.2169
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 0.9280
Confusion Matrix:
 [[5021422       0       0       0       0]
 [1521208       0       0       0       0]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.2169
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 0.8758
Confusion Matrix:
 [[5021422       0       0       0       0]
 [1521208       0       0       0       0]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.2169
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.8374
Confusion Matrix:
 [[5021422       0       0       0       0]
 [1521208       0       0       0       0]
 [   9392       0       0       0       0]
 [   1578       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7662
Macro F1 Score: 0.2169
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5925
Best Macro F1: 0.1567
Best xView2 Score: 0.0596
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7540
Class 1 Precision: 0.3444
Class 2 Precision: 0.0010
Class 3 Precision: 0.0004
Class 4 Precision: 0.0000
Macro Precision: 0.2200
ROC curve saved to .././____________optune_results/75/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/75/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/75/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/75/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/75/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/75/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/75/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27929632947386523, 1: 0.7087752601174954, 2: 127.39931657680917, 3: 1503.3347670250896, 4: 5732.533940774488}
Final class weights used in loss: [0.4273113779625357, 0.7087752601174954, 127.39931657680917, 1503.3347670250896, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5724
Confusion Matrix:
 [[2719941 1167911 1159609    5780  106297]
 [ 593548  527032  213688    1770   50701]
 [   2133     346    1486       0      28]
 [    937    1883     401       0      36]
 [      0      20       0       0      53]]
Class 0 F1: 0.6418
Class 1 F1: 0.3418
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0007
Class 0 Precision: 0.8201
Class 1 Precision: 0.3105
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0003
Class 0 Recall: 0.5272
Class 1 Recall: 0.3801
Class 2 Recall: 0.3722
Class 3 Recall: 0.0000
Class 4 Recall: 0.7260
Validation Accuracy: 0.4957
Macro F1 Score: 0.1973
xView2 Score: 0.1825
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5363
Confusion Matrix:
 [[3807320  683670  647202    1127   20219]
 [ 813553  388345  175405     440    8996]
 [   2833     251     906       0       3]
 [   1574    1480     197       0       6]
 [      2      17      54       0       0]]
Class 0 F1: 0.7782
Class 1 F1: 0.3157
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8232
Class 1 Precision: 0.3617
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7379
Class 1 Recall: 0.2800
Class 2 Recall: 0.2269
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6403
Macro F1 Score: 0.2192
xView2 Score: 0.1666
Epoch 2 took:  0 hours,  1 minutes, 19 seconds

Epoch 3/10
Train Loss: 1.4961
Confusion Matrix:
 [[4319350  510477  326641     116    2954]
 [ 929151  346207  110323      22    1036]
 [   3178     742      72       1       0]
 [   1496    1618     143       0       0]
 [     32      12      29       0       0]]
Class 0 F1: 0.8296
Class 1 F1: 0.3083
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8222
Class 1 Precision: 0.4030
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8372
Class 1 Recall: 0.2497
Class 2 Recall: 0.0180
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7119
Macro F1 Score: 0.2277
xView2 Score: 0.1585
Epoch 3 took:  0 hours,  1 minutes,  7 seconds

Epoch 4/10
Train Loss: 1.4721
Confusion Matrix:
 [[4566810  446965  145425      27     311]
 [ 964470  351019   71049       4     197]
 [   3559     228     206       0       0]
 [   2045    1190      22       0       0]
 [     65       8       0       0       0]]
Class 0 F1: 0.8539
Class 1 F1: 0.3211
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8248
Class 1 Precision: 0.4391
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8851
Class 1 Recall: 0.2531
Class 2 Recall: 0.0516
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7504
Macro F1 Score: 0.2354
xView2 Score: 0.1628
Epoch 4 took:  0 hours,  0 minutes, 41 seconds

Epoch 5/10
Train Loss: 1.4378
Confusion Matrix:
 [[4578466  482575   98479       4      14]
 [ 927399  409730   49564       0      46]
 [   3584     156     253       0       0]
 [   1964    1218      75       0       0]
 [     35      38       0       0       0]]
Class 0 F1: 0.8581
Class 1 F1: 0.3593
Class 2 F1: 0.0033
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8307
Class 1 Precision: 0.4585
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8874
Class 1 Recall: 0.2955
Class 2 Recall: 0.0634
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7612
Macro F1 Score: 0.2442
xView2 Score: 0.1787
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.3825
Confusion Matrix:
 [[4555338  538527   65672       0       1]
 [ 864540  484669   37527       0       3]
 [   3615     143     235       0       0]
 [    803    1313    1141       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.4020
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8398
Class 1 Precision: 0.4730
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8829
Class 1 Recall: 0.3495
Class 2 Recall: 0.0589
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7691
Macro F1 Score: 0.2534
xView2 Score: 0.1988
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3490
Confusion Matrix:
 [[4658430  465426   35682       0       0]
 [ 912964  451515   22260       0       0]
 [   3875     117       1       0       0]
 [   1509    1317     431       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8678
Class 1 F1: 0.3918
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8353
Class 1 Precision: 0.4916
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9029
Class 1 Recall: 0.3256
Class 2 Recall: 0.0003
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7797
Macro F1 Score: 0.2519
xView2 Score: 0.1891
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.3391
Confusion Matrix:
 [[4368088  746351   45099       0       0]
 [ 698571  665620   22548       0       0]
 [   3471      86     436       0       0]
 [    515    2436     306       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8540
Class 1 F1: 0.4752
Class 2 F1: 0.0120
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8614
Class 1 Precision: 0.4706
Class 2 Precision: 0.0064
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8466
Class 1 Recall: 0.4800
Class 2 Recall: 0.1092
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7681
Macro F1 Score: 0.2682
xView2 Score: 0.2394
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2910
Confusion Matrix:
 [[4322726  788576   48236       0       0]
 [ 696430  666385   23924       0       0]
 [   3467     348     178       0       0]
 [    724    2533       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8490
Class 1 F1: 0.4685
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8605
Class 1 Precision: 0.4571
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8378
Class 1 Recall: 0.4805
Class 2 Recall: 0.0446
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7613
Macro F1 Score: 0.2644
xView2 Score: 0.2348
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.2671
Confusion Matrix:
 [[4369167  755965   34406       0       0]
 [ 660894  708723   17122       0       0]
 [   3451     285     257       0       0]
 [    863    2283     111       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8572
Class 1 F1: 0.4967
Class 2 F1: 0.0092
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8679
Class 1 Precision: 0.4830
Class 2 Precision: 0.0050
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8468
Class 1 Recall: 0.5111
Class 2 Recall: 0.0644
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7749
Macro F1 Score: 0.2726
xView2 Score: 0.2480
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7749
Best Macro F1: 0.2726
Best xView2 Score: 0.2480
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8679
Class 1 Precision: 0.4830
Class 2 Precision: 0.0050
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2712
ROC curve saved to .././____________optune_results/76/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/76/plot_loss_curves.jpg
Prediction distribution: {0: 152044, 1: 109658, 2: 442}
ROC curve saved to .././____________optune_results/76/visualize_predictions.jpg
Prediction distribution: {0: 243139, 1: 18887, 2: 118}
ROC curve saved to .././____________optune_results/76/visualize_predictions.jpg
Prediction distribution: {0: 90671, 1: 171454, 2: 19}
ROC curve saved to .././____________optune_results/76/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/76/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/76/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.276869689356109, 1: 0.7245310136048448, 2: 142.82533484676503, 3: 1251.719671723452, 4: 5292.497160883281}
Final class weights used in loss: [1.0894304891707263, 0.7245310136048448, 142.82533484676503, 1251.719671723452, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6531
Confusion Matrix:
 [[1058006   45044  117225 2443448 1337870]
 [ 230067   22925   13382  671378  603411]
 [   1351     214      75    2771    3849]
 [    735       0      14     226    1609]
 [      0       0       0       0       0]]
Class 0 F1: 0.3363
Class 1 F1: 0.0285
Class 2 F1: 0.0011
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.8201
Class 1 Precision: 0.3362
Class 2 Precision: 0.0006
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.2115
Class 1 Recall: 0.0149
Class 2 Recall: 0.0091
Class 3 Recall: 0.0875
Class 4 Recall: 0.0000
Validation Accuracy: 0.1650
Macro F1 Score: 0.0732
xView2 Score: 0.1214
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5826
Confusion Matrix:
 [[3104752   38170   30961 1049519  778191]
 [ 805454   23338    5483  365985  340903]
 [   5461     219       0    1136    1444]
 [   1946       0       0     373     265]
 [      0       0       0       0       0]]
Class 0 F1: 0.6962
Class 1 F1: 0.0291
Class 2 F1: 0.0000
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7925
Class 1 Precision: 0.3781
Class 2 Precision: 0.0000
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.6208
Class 1 Recall: 0.0151
Class 2 Recall: 0.0000
Class 3 Recall: 0.1443
Class 4 Recall: 0.0000
Validation Accuracy: 0.4774
Macro F1 Score: 0.1452
xView2 Score: 0.1104
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5217
Confusion Matrix:
 [[4498120   21503    7085  242534  232351]
 [1296919   15505    1577  112880  114282]
 [   7623     138       0     328     171]
 [   2444       2       0      86      52]
 [      0       0       0       0       0]]
Class 0 F1: 0.8325
Class 1 F1: 0.0196
Class 2 F1: 0.0000
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7749
Class 1 Precision: 0.4174
Class 2 Precision: 0.0000
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.8993
Class 1 Recall: 0.0101
Class 2 Recall: 0.0000
Class 3 Recall: 0.0333
Class 4 Recall: 0.0000
Validation Accuracy: 0.6887
Macro F1 Score: 0.1705
xView2 Score: 0.0669
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4623
Confusion Matrix:
 [[4906033   11921    1353   39555   42731]
 [1476666    9569     456   27005   27467]
 [   8197      43       0      10      10]
 [   2580       0       0       0       4]
 [      0       0       0       0       0]]
Class 0 F1: 0.8611
Class 1 F1: 0.0122
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7673
Class 1 Precision: 0.4444
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9809
Class 1 Recall: 0.0062
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7501
Macro F1 Score: 0.1747
xView2 Score: 0.0244
Epoch 4 took:  0 hours,  1 minutes, 21 seconds

Epoch 5/10
Train Loss: 1.3957
Confusion Matrix:
 [[4974660   11090     453    9423    5967]
 [1521762   10623     240    5066    3472]
 [   8256       4       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8645
Class 1 F1: 0.0136
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7645
Class 1 Precision: 0.4892
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9946
Class 1 Recall: 0.0069
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7607
Macro F1 Score: 0.1756
xView2 Score: 0.0092
Epoch 5 took:  0 hours,  1 minutes, 11 seconds

Epoch 6/10
Train Loss: 1.3263
Confusion Matrix:
 [[4991775    8207      87     881     643]
 [1531953    8382      28     355     445]
 [   8260       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8654
Class 1 F1: 0.0108
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7639
Class 1 Precision: 0.5053
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9980
Class 1 Recall: 0.0054
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7630
Macro F1 Score: 0.1752
xView2 Score: 0.0050
Epoch 6 took:  0 hours,  0 minutes, 46 seconds

Epoch 7/10
Train Loss: 1.2979
Confusion Matrix:
 [[4995980    5434       0     147      32]
 [1535851    5173       0      40      99]
 [   8260       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8655
Class 1 F1: 0.0067
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7636
Class 1 Precision: 0.4877
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9989
Class 1 Recall: 0.0034
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7631
Macro F1 Score: 0.1744
xView2 Score: 0.0030
Epoch 7 took:  0 hours,  0 minutes, 29 seconds

Epoch 8/10
Train Loss: 1.2375
Confusion Matrix:
 [[4997565    4014       0       7       7]
 [1537092    4037       0       4      30]
 [   8260       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8656
Class 1 F1: 0.0052
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7635
Class 1 Precision: 0.5014
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9992
Class 1 Recall: 0.0026
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7632
Macro F1 Score: 0.1742
xView2 Score: 0.0023
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2025
Confusion Matrix:
 [[4998361    3232       0       0       0]
 [1537883    3280       0       0       0]
 [   8260       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8656
Class 1 F1: 0.0042
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7634
Class 1 Precision: 0.5037
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0021
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7632
Macro F1 Score: 0.2175
xView2 Score: 0.0020
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1826
Confusion Matrix:
 [[4998687    2906       0       0       0]
 [1538107    3056       0       0       0]
 [   8260       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8656
Class 1 F1: 0.0040
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7634
Class 1 Precision: 0.5126
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0020
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7632
Macro F1 Score: 0.2174
xView2 Score: 0.0019
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1650
Best Macro F1: 0.0732
Best xView2 Score: 0.1214
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8201
Class 1 Precision: 0.3362
Class 2 Precision: 0.0006
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.2314
ROC curve saved to .././____________optune_results/77/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/77/plot_loss_curves.jpg
Prediction distribution: {0: 261504, 1: 640}
ROC curve saved to .././____________optune_results/77/visualize_predictions.jpg
Prediction distribution: {0: 262142, 1: 2}
ROC curve saved to .././____________optune_results/77/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/77/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/77/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/77/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2750734853363799, 1: 0.7382424186687518, 2: 117.02857142857142, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.2265646852946075, 0.7382424186687518, 117.02857142857142, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6267
Confusion Matrix:
 [[1746149 2225541  286894  128719  495584]
 [ 248731 1012775  146111   30911  231658]
 [     60      10       2       0     420]
 [      0       0       9       0      26]
 [      0       0       0       0       0]]
Class 0 F1: 0.5078
Class 1 F1: 0.4127
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8753
Class 1 Precision: 0.3127
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3576
Class 1 Recall: 0.6064
Class 2 Recall: 0.0041
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4210
Macro F1 Score: 0.1841
xView2 Score: 0.2427
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5345
Confusion Matrix:
 [[3533355  877436  211046   58403  202647]
 [ 821745  568338  130756   18230  131117]
 [    103      20       0       0     369]
 [      0       0       0       0      35]
 [      0       0       0       0       0]]
Class 0 F1: 0.7650
Class 1 F1: 0.3648
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8113
Class 1 Precision: 0.3931
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7236
Class 1 Recall: 0.3403
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6259
Macro F1 Score: 0.2259
xView2 Score: 0.2027
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4461
Confusion Matrix:
 [[4562592  232490   49749    6098   31958]
 [1405044  198620   36515    2524   27483]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8409
Class 1 F1: 0.1890
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7645
Class 1 Precision: 0.4607
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9344
Class 1 Recall: 0.1189
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7265
Macro F1 Score: 0.2060
xView2 Score: 0.1003
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.3630
Confusion Matrix:
 [[4786321   88926    5628     388    1624]
 [1554549  108140    5334     226    1937]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8529
Class 1 F1: 0.1158
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7548
Class 1 Precision: 0.5488
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9802
Class 1 Recall: 0.0647
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7468
Macro F1 Score: 0.1937
xView2 Score: 0.0539
Epoch 4 took:  0 hours,  1 minutes, 10 seconds

Epoch 5/10
Train Loss: 1.2843
Confusion Matrix:
 [[4853016   28904     765      31     171]
 [1627493   41276    1173      53     191]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8541
Class 1 F1: 0.0474
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7488
Class 1 Precision: 0.5881
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9939
Class 1 Recall: 0.0247
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7468
Macro F1 Score: 0.1803
xView2 Score: 0.0214
Epoch 5 took:  0 hours,  0 minutes, 42 seconds

Epoch 6/10
Train Loss: 1.1981
Confusion Matrix:
 [[4870648   12155      63       3      18]
 [1650452   19540     189       3       2]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8542
Class 1 F1: 0.0230
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7468
Class 1 Precision: 0.6165
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9975
Class 1 Recall: 0.0117
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7462
Macro F1 Score: 0.1754
xView2 Score: 0.0102
Epoch 6 took:  0 hours,  0 minutes, 29 seconds

Epoch 7/10
Train Loss: 1.1472
Confusion Matrix:
 [[4881587    1293       7       0       0]
 [1668133    2036      17       0       0]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8539
Class 1 F1: 0.0024
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7453
Class 1 Precision: 0.6116
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0012
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7452
Macro F1 Score: 0.2141
xView2 Score: 0.0012
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.0803
Confusion Matrix:
 [[4882569     318       0       0       0]
 [1669642     544       0       0       0]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8539
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7451
Class 1 Precision: 0.6311
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7451
Macro F1 Score: 0.2136
xView2 Score: 0.0003
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.0430
Confusion Matrix:
 [[4882882       5       0       0       0]
 [1670151      35       0       0       0]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8539
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7451
Class 1 Precision: 0.8750
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7451
Macro F1 Score: 0.2135
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9797
Confusion Matrix:
 [[4882887       0       0       0       0]
 [1670180       6       0       0       0]
 [    492       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8539
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7451
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7451
Macro F1 Score: 0.2135
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4210
Best Macro F1: 0.1841
Best xView2 Score: 0.2427
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8753
Class 1 Precision: 0.3127
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2376
ROC curve saved to .././____________optune_results/78/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/78/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/78/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/78/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/78/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/78/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/78/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27253639470901425, 1: 0.7561578045009222, 2: 147.30208083350405, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [3.2152037479855635, 0.7561578045009222, 147.30208083350405, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5527
Confusion Matrix:
 [[3167779   31304  627539  503374  382556]
 [ 816410   18269  426860  295817  274361]
 [   5177       0     743    2111    1300]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7281
Class 1 F1: 0.0194
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7941
Class 1 Precision: 0.3685
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6722
Class 1 Recall: 0.0100
Class 2 Recall: 0.0796
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4863
Macro F1 Score: 0.1498
xView2 Score: 0.1421
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4465
Confusion Matrix:
 [[4375679    5618  141801  114923   74531]
 [1512297    4332  140000  105769   69319]
 [   8428       0     227     167     509]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8249
Class 1 F1: 0.0047
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7421
Class 1 Precision: 0.4354
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9285
Class 1 Recall: 0.0024
Class 2 Recall: 0.0243
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6684
Macro F1 Score: 0.1662
xView2 Score: 0.0780
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.3509
Confusion Matrix:
 [[4658940     447   26329   15257   11579]
 [1771669     475   30885   15557   13131]
 [   8994       0     248      89       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8355
Class 1 F1: 0.0005
Class 2 F1: 0.0074
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7235
Class 1 Precision: 0.5152
Class 2 Precision: 0.0043
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9886
Class 1 Recall: 0.0003
Class 2 Recall: 0.0266
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7110
Macro F1 Score: 0.1687
xView2 Score: 0.0203
Epoch 3 took:  0 hours,  1 minutes, 13 seconds

Epoch 4/10
Train Loss: 1.2529
Confusion Matrix:
 [[4700606     111    7368    3217    1250]
 [1814265     178   10355    4307    2612]
 [   9322       0       0       0       9]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8366
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7205
Class 1 Precision: 0.6159
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9975
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7173
Macro F1 Score: 0.1674
xView2 Score: 0.0056
Epoch 4 took:  0 hours,  0 minutes, 47 seconds

Epoch 5/10
Train Loss: 1.1435
Confusion Matrix:
 [[4711254       0     922     348      28]
 [1828715       0    1572     953     477]
 [   9331       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8367
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7194
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7189
Macro F1 Score: 0.1673
xView2 Score: 0.0010
Epoch 5 took:  0 hours,  0 minutes, 30 seconds

Epoch 6/10
Train Loss: 1.0673
Confusion Matrix:
 [[4712460       0      88       4       0]
 [1831541       0      89      85       2]
 [   9331       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8366
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7191
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7191
Macro F1 Score: 0.1673
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 0.9842
Confusion Matrix:
 [[4712539       0      13       0       0]
 [1831706       0      11       0       0]
 [   9331       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8366
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7191
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7191
Macro F1 Score: 0.2789
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9236
Confusion Matrix:
 [[4712552       0       0       0       0]
 [1831717       0       0       0       0]
 [   9331       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8366
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7191
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7191
Macro F1 Score: 0.2789
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8888
Confusion Matrix:
 [[4712552       0       0       0       0]
 [1831717       0       0       0       0]
 [   9331       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8366
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7191
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7191
Macro F1 Score: 0.2789
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8392
Confusion Matrix:
 [[4712552       0       0       0       0]
 [1831717       0       0       0       0]
 [   9331       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8366
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7191
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7191
Macro F1 Score: 0.2789
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4863
Best Macro F1: 0.1498
Best xView2 Score: 0.1421
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7941
Class 1 Precision: 0.3685
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2327
ROC curve saved to .././____________optune_results/79/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/79/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/79/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/79/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/79/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/79/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/79/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27860991875296665, 1: 0.7133892961092287, 2: 123.68929519315836, 3: 1118.7296732607247, 4: 68947.46301369862}
Final class weights used in loss: [5.465610620117355, 0.7133892961092287, 123.68929519315836, 1118.7296732607247, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6919
Confusion Matrix:
 [[ 430364 3538413  472504  185978  487881]
 [  83101  974572  152360   68388  154247]
 [    848    1375     395     130      60]
 [    410     629     291      50     726]
 [     11     828       0       0      39]]
Class 0 F1: 0.1529
Class 1 F1: 0.3277
Class 2 F1: 0.0013
Class 3 F1: 0.0004
Class 4 F1: 0.0001
Class 0 Precision: 0.8361
Class 1 Precision: 0.2158
Class 2 Precision: 0.0006
Class 3 Precision: 0.0002
Class 4 Precision: 0.0001
Class 0 Recall: 0.0841
Class 1 Recall: 0.6802
Class 2 Recall: 0.1407
Class 3 Recall: 0.0237
Class 4 Recall: 0.0444
Validation Accuracy: 0.2145
Macro F1 Score: 0.0965
xView2 Score: 0.2229
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5701
Confusion Matrix:
 [[2946094 1598705  291645   88846  189850]
 [ 526043  672359  120178   35043   79045]
 [   1482    1193      44      35      54]
 [   1609     155     196     107      39]
 [    598     149      53      18      60]]
Class 0 F1: 0.6859
Class 1 F1: 0.3629
Class 2 F1: 0.0002
Class 3 F1: 0.0017
Class 4 F1: 0.0004
Class 0 Precision: 0.8476
Class 1 Precision: 0.2959
Class 2 Precision: 0.0001
Class 3 Precision: 0.0009
Class 4 Precision: 0.0002
Class 0 Recall: 0.5760
Class 1 Recall: 0.4693
Class 2 Recall: 0.0157
Class 3 Recall: 0.0508
Class 4 Recall: 0.0683
Validation Accuracy: 0.5522
Macro F1 Score: 0.2102
xView2 Score: 0.2112
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4575
Confusion Matrix:
 [[4497652  494145   80241   16006   27096]
 [1066044  295735   44715    8146   18028]
 [   2645     100       0      46      17]
 [   2106       0       0       0       0]
 [    877       0       1       0       0]]
Class 0 F1: 0.8419
Class 1 F1: 0.2661
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8076
Class 1 Precision: 0.3744
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8793
Class 1 Recall: 0.2064
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7314
Macro F1 Score: 0.2216
xView2 Score: 0.1387
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.3426
Confusion Matrix:
 [[4928151  164699   16180    1254    4856]
 [1291937  122870   12814     876    4171]
 [   2801       6       0       1       0]
 [   2106       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8691
Class 1 F1: 0.1429
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7916
Class 1 Precision: 0.4273
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9634
Class 1 Recall: 0.0858
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7707
Macro F1 Score: 0.2024
xView2 Score: 0.0699
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.2335
Confusion Matrix:
 [[5077184   35698    2087      52     119]
 [1402146   28276    1926      78     242]
 [   2808       0       0       0       0]
 [   2106       0       0       0       0]
 [    861      17       0       0       0]]
Class 0 F1: 0.8754
Class 1 F1: 0.0378
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7829
Class 1 Precision: 0.4419
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9926
Class 1 Recall: 0.0197
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7790
Macro F1 Score: 0.1826
xView2 Score: 0.0176
Epoch 5 took:  0 hours,  0 minutes, 56 seconds

Epoch 6/10
Train Loss: 1.1329
Confusion Matrix:
 [[5110196    4836     103       4       1]
 [1429521    3030     115       2       0]
 [   2808       0       0       0       0]
 [   2106       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8765
Class 1 F1: 0.0042
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7807
Class 1 Precision: 0.3852
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9990
Class 1 Recall: 0.0021
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7802
Macro F1 Score: 0.1761
xView2 Score: 0.0019
Epoch 6 took:  0 hours,  0 minutes, 32 seconds

Epoch 7/10
Train Loss: 1.0448
Confusion Matrix:
 [[5115039     101       0       0       0]
 [1432651      15       2       0       0]
 [   2808       0       0       0       0]
 [   2106       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8767
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7805
Class 1 Precision: 0.1293
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7805
Macro F1 Score: 0.1753
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9674
Confusion Matrix:
 [[5115140       0       0       0       0]
 [1432668       0       0       0       0]
 [   2808       0       0       0       0]
 [   2106       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8767
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7805
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7805
Macro F1 Score: 0.1753
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8889
Confusion Matrix:
 [[5115140       0       0       0       0]
 [1432668       0       0       0       0]
 [   2808       0       0       0       0]
 [   2106       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8767
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7805
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7805
Macro F1 Score: 0.1753
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8368
Confusion Matrix:
 [[5115140       0       0       0       0]
 [1432668       0       0       0       0]
 [   2808       0       0       0       0]
 [   2106       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8767
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7805
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7805
Macro F1 Score: 0.1753
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2145
Best Macro F1: 0.0965
Best xView2 Score: 0.2229
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8361
Class 1 Precision: 0.2158
Class 2 Precision: 0.0006
Class 3 Precision: 0.0002
Class 4 Precision: 0.0001
Macro Precision: 0.2106
ROC curve saved to .././____________optune_results/80/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/80/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/80/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/80/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/80/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/80/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/80/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27358574039319067, 1: 0.7482111530503286, 2: 146.2364111801964, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [0.757927088689447, 0.7482111530503286, 146.2364111801964, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6424
Confusion Matrix:
 [[ 464022  972745  343163 2452738  550718]
 [ 140794  337620   45116 1086717  150775]
 [    994    1865     692    5067     464]
 [     39      43      18      10       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1722
Class 1 F1: 0.2197
Class 2 F1: 0.0035
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7659
Class 1 Precision: 0.2573
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0970
Class 1 Recall: 0.1917
Class 2 Recall: 0.0762
Class 3 Recall: 0.0909
Class 4 Recall: 0.0000
Validation Accuracy: 0.1224
Macro F1 Score: 0.0791
xView2 Score: 0.1751
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5878
Confusion Matrix:
 [[2371811  671354  159779 1415464  164978]
 [ 630420  323213   26842  733209   47338]
 [   3246    2095     133    3071     537]
 [     70      40       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6090
Class 1 F1: 0.2344
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7891
Class 1 Precision: 0.3243
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4958
Class 1 Recall: 0.1835
Class 2 Recall: 0.0146
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4112
Macro F1 Score: 0.1690
xView2 Score: 0.1726
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.5466
Confusion Matrix:
 [[3774420  317718   37605  610340   43303]
 [1165527  214757   12560  350401   17777]
 [   6612     752      14    1226     478]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7758
Class 1 F1: 0.1872
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7630
Class 1 Precision: 0.4027
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7891
Class 1 Recall: 0.1220
Class 2 Recall: 0.0015
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6087
Macro F1 Score: 0.1927
xView2 Score: 0.1368
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.5018
Confusion Matrix:
 [[4265001  236036   17376  257527    7446]
 [1344803  202974    6596  201454    5195]
 [   7377     427     130     773     375]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8201
Class 1 F1: 0.1845
Class 2 F1: 0.0078
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7593
Class 1 Precision: 0.4619
Class 2 Precision: 0.0054
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8916
Class 1 Recall: 0.1153
Class 2 Recall: 0.0143
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6818
Macro F1 Score: 0.2025
xView2 Score: 0.1239
Epoch 4 took:  0 hours,  1 minutes, 18 seconds

Epoch 5/10
Train Loss: 1.4585
Confusion Matrix:
 [[4561555  121328    3275   96736     492]
 [1558696  120087    1902   79343     994]
 [   8244     448       0     390       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8361
Class 1 F1: 0.1199
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7443
Class 1 Precision: 0.4965
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9536
Class 1 Recall: 0.0682
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7144
Macro F1 Score: 0.1912
xView2 Score: 0.0734
Epoch 5 took:  0 hours,  0 minutes, 59 seconds

Epoch 6/10
Train Loss: 1.4161
Confusion Matrix:
 [[4609461  134347    1337   38175      66]
 [1577050  147509    1170   34997     296]
 [   7837     932      56     257       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8398
Class 1 F1: 0.1443
Class 2 F1: 0.0096
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7441
Class 1 Precision: 0.5216
Class 2 Precision: 0.0218
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9636
Class 1 Recall: 0.0838
Class 2 Recall: 0.0062
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7259
Macro F1 Score: 0.1987
xView2 Score: 0.0753
Epoch 6 took:  0 hours,  0 minutes, 40 seconds

Epoch 7/10
Train Loss: 1.3909
Confusion Matrix:
 [[4644402  125783     459   12731      11]
 [1616374  134785     667    9173      23]
 [   9062      20       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8404
Class 1 F1: 0.1333
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7407
Class 1 Precision: 0.5172
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9709
Class 1 Recall: 0.0765
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7292
Macro F1 Score: 0.1947
xView2 Score: 0.0622
Epoch 7 took:  0 hours,  0 minutes, 31 seconds

Epoch 8/10
Train Loss: 1.3357
Confusion Matrix:
 [[4659118  120554     689    3025       0]
 [1624910  132280     793    3039       0]
 [   7539    1543       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8414
Class 1 F1: 0.1313
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7405
Class 1 Precision: 0.5200
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9740
Class 1 Recall: 0.0751
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7311
Macro F1 Score: 0.2432
xView2 Score: 0.0651
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2818
Confusion Matrix:
 [[4671558  109038     217    2573       0]
 [1629647  127100     450    3825       0]
 [   8823     259       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8422
Class 1 F1: 0.1273
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7403
Class 1 Precision: 0.5377
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9766
Class 1 Recall: 0.0722
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7322
Macro F1 Score: 0.2424
xView2 Score: 0.0628
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2593
Confusion Matrix:
 [[4624901  157200      54    1231       0]
 [1588732  171238      96     956       0]
 [   7902    1180       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8405
Class 1 F1: 0.1638
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7434
Class 1 Precision: 0.5195
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9669
Class 1 Recall: 0.0972
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7318
Macro F1 Score: 0.2511
xView2 Score: 0.0805
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1224
Best Macro F1: 0.0791
Best xView2 Score: 0.1751
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7659
Class 1 Precision: 0.2573
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2050
ROC curve saved to .././____________optune_results/81/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/81/plot_loss_curves.jpg
Prediction distribution: {0: 262089, 1: 55}
ROC curve saved to .././____________optune_results/81/visualize_predictions.jpg
Prediction distribution: {0: 243740, 1: 18404}
ROC curve saved to .././____________optune_results/81/visualize_predictions.jpg
Prediction distribution: {0: 251530, 1: 10601, 2: 7, 3: 6}
ROC curve saved to .././____________optune_results/81/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/81/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/81/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27449398475373005, 1: 0.7418705048696095, 2: 117.71832725231546, 3: 2085.853626191463, 4: 68947.46301369862}
Final class weights used in loss: [0.3151021666431794, 0.7418705048696095, 117.71832725231546, 2085.853626191463, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5833
Confusion Matrix:
 [[ 822045 2994704  795215   65582  166712]
 [ 166233 1397683   88152   31241   20219]
 [      0     618      47      41      38]
 [   1031    3144       0      13       4]
 [      0     869       9       0       0]]
Class 0 F1: 0.2818
Class 1 F1: 0.4582
Class 2 F1: 0.0001
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.8309
Class 1 Precision: 0.3179
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.1697
Class 1 Recall: 0.8205
Class 2 Recall: 0.0632
Class 3 Recall: 0.0031
Class 4 Recall: 0.0000
Validation Accuracy: 0.3387
Macro F1 Score: 0.1481
xView2 Score: 0.2535
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5719
Confusion Matrix:
 [[1439440 2556610  782191   33490   32527]
 [ 232601 1342989  108361   14254    5323]
 [    201      64      15     446      18]
 [    102    4061      21       8       0]
 [      0     858      20       0       0]]
Class 0 F1: 0.4418
Class 1 F1: 0.4789
Class 2 F1: 0.0000
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.8607
Class 1 Precision: 0.3440
Class 2 Precision: 0.0000
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.2971
Class 1 Recall: 0.7884
Class 2 Recall: 0.0202
Class 3 Recall: 0.0019
Class 4 Recall: 0.0000
Validation Accuracy: 0.4246
Macro F1 Score: 0.1842
xView2 Score: 0.2578
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5365
Confusion Matrix:
 [[2050491 2350308  423534   14551    5374]
 [ 255158 1367143   73706    6649     872]
 [    233     478       0      33       0]
 [    345    3825       0      22       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.5735
Class 1 F1: 0.5039
Class 2 F1: 0.0000
Class 3 F1: 0.0017
Class 4 F1: 0.0000
Class 0 Precision: 0.8891
Class 1 Precision: 0.3673
Class 2 Precision: 0.0000
Class 3 Precision: 0.0010
Class 4 Precision: 0.0000
Class 0 Recall: 0.4233
Class 1 Recall: 0.8025
Class 2 Recall: 0.0000
Class 3 Recall: 0.0052
Class 4 Recall: 0.0000
Validation Accuracy: 0.5215
Macro F1 Score: 0.2158
xView2 Score: 0.2714
Epoch 3 took:  0 hours,  1 minutes, 16 seconds

Epoch 4/10
Train Loss: 1.5025
Confusion Matrix:
 [[2670936 2016599  150607    4425    1691]
 [ 251091 1412791   37572    1900     174]
 [     94     645       0       5       0]
 [    953    3239       0       0       0]
 [     13     863       2       0       0]]
Class 0 F1: 0.6877
Class 1 F1: 0.5500
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9137
Class 1 Precision: 0.4114
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5514
Class 1 Recall: 0.8293
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6231
Macro F1 Score: 0.2475
xView2 Score: 0.2905
Epoch 4 took:  0 hours,  0 minutes, 56 seconds

Epoch 5/10
Train Loss: 1.4851
Confusion Matrix:
 [[2853039 1900706   88710    1605     198]
 [ 252195 1419724   30878     649      82]
 [      0     723      21       0       0]
 [    124    4001      67       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7178
Class 1 F1: 0.5646
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9187
Class 1 Precision: 0.4269
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5890
Class 1 Recall: 0.8334
Class 2 Recall: 0.0282
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6520
Macro F1 Score: 0.2565
xView2 Score: 0.2967
Epoch 5 took:  0 hours,  0 minutes, 36 seconds

Epoch 6/10
Train Loss: 1.4385
Confusion Matrix:
 [[3016932 1790233   36675     412       6]
 [ 279818 1407424   15978     308       0]
 [    277     467       0       0       0]
 [    539    3612      41       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7411
Class 1 F1: 0.5737
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9149
Class 1 Precision: 0.4395
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6228
Class 1 Recall: 0.8262
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6751
Macro F1 Score: 0.2630
xView2 Score: 0.2991
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.4231
Confusion Matrix:
 [[3167546 1653307   23222     182       1]
 [ 289070 1401063   13147     248       0]
 [    235     509       0       0       0]
 [    351    3841       0       0       0]
 [    103     775       0       0       0]]
Class 0 F1: 0.7631
Class 1 F1: 0.5883
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9162
Class 1 Precision: 0.4579
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6539
Class 1 Recall: 0.8224
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6971
Macro F1 Score: 0.2703
xView2 Score: 0.3034
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.4127
Confusion Matrix:
 [[3178246 1657374    8523     115       0]
 [ 289463 1408248    5627     190       0]
 [    218     526       0       0       0]
 [    250    3942       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7647
Class 1 F1: 0.5899
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9164
Class 1 Precision: 0.4586
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6561
Class 1 Recall: 0.8267
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6998
Macro F1 Score: 0.2709
xView2 Score: 0.3041
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.3579
Confusion Matrix:
 [[3192905 1643705    7606      42       0]
 [ 289719 1409716    3974     119       0]
 [    673      71       0       0       0]
 [     89    4103       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7668
Class 1 F1: 0.5921
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9166
Class 1 Precision: 0.4609
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6591
Class 1 Recall: 0.8275
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7023
Macro F1 Score: 0.2718
xView2 Score: 0.3047
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.3358
Confusion Matrix:
 [[3156492 1682543    5146      77       0]
 [ 250146 1450329    2968      85       0]
 [    201     543       0       0       0]
 [    357    3835       0       0       0]
 [     71     807       0       0       0]]
Class 0 F1: 0.7651
Class 1 F1: 0.5991
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9264
Class 1 Precision: 0.4622
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6516
Class 1 Recall: 0.8514
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7029
Macro F1 Score: 0.2728
xView2 Score: 0.3088
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7029
Best Macro F1: 0.2728
Best xView2 Score: 0.3088
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9264
Class 1 Precision: 0.4622
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2777
ROC curve saved to .././____________optune_results/82/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/82/plot_loss_curves.jpg
Prediction distribution: {0: 66714, 1: 194150, 2: 1280}
ROC curve saved to .././____________optune_results/82/visualize_predictions.jpg
Prediction distribution: {0: 211770, 1: 50374}
ROC curve saved to .././____________optune_results/82/visualize_predictions.jpg
Prediction distribution: {0: 190668, 1: 71365, 2: 111}
ROC curve saved to .././____________optune_results/82/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/82/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/82/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2771203028325249, 1: 0.723284515262916, 2: 132.78366442421844, 3: 853.5127692046804, 4: 5732.533940774488}
Final class weights used in loss: [2.6391242721406867, 0.723284515262916, 132.78366442421844, 853.5127692046804, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6797
Confusion Matrix:
 [[ 429963   92872 3856036  166940  472222]
 [  70443   31345 1158682   26283  242438]
 [     86      21    4222      11    1255]
 [      0       0     708       0       0]
 [      0       0      73       0       0]]
Class 0 F1: 0.1558
Class 1 F1: 0.0379
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8591
Class 1 Precision: 0.2523
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0857
Class 1 Recall: 0.0205
Class 2 Recall: 0.7546
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.0710
Macro F1 Score: 0.0391
xView2 Score: 0.1225
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5718
Confusion Matrix:
 [[2418941   39664 2258570   41820  259038]
 [ 441658   23028  877124    9373  178008]
 [   2920       0    2371       3     301]
 [    621       0      87       0       0]
 [     10       0      63       0       0]]
Class 0 F1: 0.6138
Class 1 F1: 0.0289
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8446
Class 1 Precision: 0.3673
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4820
Class 1 Recall: 0.0151
Class 2 Recall: 0.4238
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3730
Macro F1 Score: 0.1288
xView2 Score: 0.1301
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4760
Confusion Matrix:
 [[4201400    9715  718922    4005   83991]
 [1045948    8891  402476    1447   70429]
 [   2595       0    2935      55      10]
 [    208       0     500       0       0]
 [     64       0       9       0       0]]
Class 0 F1: 0.8183
Class 1 F1: 0.0115
Class 2 F1: 0.0052
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8002
Class 1 Precision: 0.4779
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8373
Class 1 Recall: 0.0058
Class 2 Recall: 0.5246
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6429
Macro F1 Score: 0.1670
xView2 Score: 0.1065
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.3835
Confusion Matrix:
 [[4852008    2649  143587      39   19750]
 [1391558    2899  109969      74   24691]
 [   5364       0      47       0     184]
 [    687       0      21       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8612
Class 1 F1: 0.0038
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7764
Class 1 Precision: 0.5225
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9669
Class 1 Recall: 0.0019
Class 2 Recall: 0.0084
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7408
Macro F1 Score: 0.1731
xView2 Score: 0.0456
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.2879
Confusion Matrix:
 [[4997055     644   17150       7    3177]
 [1508219     790   15573      14    4595]
 [   5563       0      12       0      20]
 [    708       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8668
Class 1 F1: 0.0010
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7674
Class 1 Precision: 0.5509
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9958
Class 1 Recall: 0.0005
Class 2 Recall: 0.0021
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7626
Macro F1 Score: 0.1737
xView2 Score: 0.0083
Epoch 5 took:  0 hours,  1 minutes,  1 seconds

Epoch 6/10
Train Loss: 1.2148
Confusion Matrix:
 [[5016122      24    1705       0     182]
 [1527288      54    1596       0     253]
 [   5595       0       0       0       0]
 [    708       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8673
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7658
Class 1 Precision: 0.6923
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7654
Macro F1 Score: 0.1735
xView2 Score: 0.0008
Epoch 6 took:  0 hours,  0 minutes, 39 seconds

Epoch 7/10
Train Loss: 1.1299
Confusion Matrix:
 [[5017929       0     103       0       1]
 [1529032       4     155       0       0]
 [   5595       0       0       0       0]
 [    708       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8673
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7657
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7657
Macro F1 Score: 0.1735
xView2 Score: 0.0001
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0671
Confusion Matrix:
 [[5018003       0      30       0       0]
 [1529172       2      17       0       0]
 [   5595       0       0       0       0]
 [    708       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8673
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7657
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7657
Macro F1 Score: 0.1735
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0116
Confusion Matrix:
 [[5018032       0       1       0       0]
 [1529191       0       0       0       0]
 [   5595       0       0       0       0]
 [    708       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8673
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7657
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7657
Macro F1 Score: 0.1735
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9629
Confusion Matrix:
 [[5018033       0       0       0       0]
 [1529191       0       0       0       0]
 [   5595       0       0       0       0]
 [    708       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8673
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7657
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7657
Macro F1 Score: 0.1735
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3730
Best Macro F1: 0.1288
Best xView2 Score: 0.1301
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8446
Class 1 Precision: 0.3673
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2425
ROC curve saved to .././____________optune_results/83/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/83/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/83/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/83/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/83/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/83/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/83/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2733761726329484, 1: 0.7484736277639678, 2: 188.8475461503827, 3: 1943.3068725868725, 4: 5732.533940774488}
Final class weights used in loss: [1.495932465035913, 0.7484736277639678, 188.8475461503827, 1943.3068725868725, 5732.533940774488]

Epoch 1/10
Train Loss: 1.4494
Confusion Matrix:
 [[4750877     219    8124     755    9308]
 [1754671       2    3841     400    4467]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8412
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7279
Class 1 Precision: 0.0090
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9961
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7249
Macro F1 Score: 0.1682
xView2 Score: 0.0029
Epoch 1 took:  0 hours,  1 minutes, 15 seconds

Epoch 2/10
Train Loss: 1.3778
Confusion Matrix:
 [[4766528      12    1927      40     776]
 [1761861       0    1244      12     264]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8422
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7278
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7273
Macro F1 Score: 0.1684
xView2 Score: 0.0005
Epoch 2 took:  0 hours,  0 minutes, 43 seconds

Epoch 3/10
Train Loss: 1.3261
Confusion Matrix:
 [[4769207       0      40       0      36]
 [1763354       0      23       0       4]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.2725
Confusion Matrix:
 [[4769273       0      10       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2030
Confusion Matrix:
 [[4769283       0       0       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1518
Confusion Matrix:
 [[4769283       0       0       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0906
Confusion Matrix:
 [[4769283       0       0       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0453
Confusion Matrix:
 [[4769283       0       0       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0235
Confusion Matrix:
 [[4769283       0       0       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9841
Confusion Matrix:
 [[4769283       0       0       0       0]
 [1763381       0       0       0       0]
 [  16848       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8424
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7277
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7277
Macro F1 Score: 0.1685
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7249
Best Macro F1: 0.1682
Best xView2 Score: 0.0029
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7279
Class 1 Precision: 0.0090
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1474
ROC curve saved to .././____________optune_results/84/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/84/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/84/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/84/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/84/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/84/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/84/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2780448798245187, 1: 0.7165073736771811, 2: 157.03122426057655, 3: 805.0487523992323, 4: 5292.497160883281}
Final class weights used in loss: [1.0040311929537447, 0.7165073736771811, 157.03122426057655, 805.0487523992323, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6273
Confusion Matrix:
 [[1975568   11539  923464 1748611  419246]
 [ 696162    5377  337501  338159   86172]
 [   9336       0     397    1432     283]
 [    179       0     174       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5092
Class 1 F1: 0.0073
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7368
Class 1 Precision: 0.3179
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3890
Class 1 Recall: 0.0037
Class 2 Recall: 0.0347
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3023
Macro F1 Score: 0.1034
xView2 Score: 0.0877
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.5712
Confusion Matrix:
 [[3920588    9528  521216  471550  155546]
 [1109983    4812  196799  121715   30062]
 [   9372       0    1669     388      19]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7749
Class 1 F1: 0.0065
Class 2 F1: 0.0046
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7778
Class 1 Precision: 0.3356
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7720
Class 1 Recall: 0.0033
Class 2 Recall: 0.1458
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5992
Macro F1 Score: 0.1572
xView2 Score: 0.0745
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.5182
Confusion Matrix:
 [[4858754    3509  131103   69466   15596]
 [1369756    1899   59134   26884    5698]
 [  11322       0     121       5       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8585
Class 1 F1: 0.0026
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7786
Class 1 Precision: 0.3511
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9567
Class 1 Recall: 0.0013
Class 2 Recall: 0.0106
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7417
Macro F1 Score: 0.1725
xView2 Score: 0.0323
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.4639
Confusion Matrix:
 [[5034200    2100   32820    7970    1338]
 [1436122    1605   20853    4359     432]
 [  11406       0      42       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8709
Class 1 F1: 0.0022
Class 2 F1: 0.0013
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7766
Class 1 Precision: 0.4332
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9913
Class 1 Recall: 0.0011
Class 2 Recall: 0.0037
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7684
Macro F1 Score: 0.1749
xView2 Score: 0.0113
Epoch 4 took:  0 hours,  1 minutes,  3 seconds

Epoch 5/10
Train Loss: 1.4034
Confusion Matrix:
 [[5072347     695    4897     457      32]
 [1457357     731    5014     266       3]
 [  11448       0       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8730
Class 1 F1: 0.0010
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7754
Class 1 Precision: 0.5126
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9988
Class 1 Recall: 0.0005
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7741
Macro F1 Score: 0.1748
xView2 Score: 0.0026
Epoch 5 took:  0 hours,  0 minutes, 34 seconds

Epoch 6/10
Train Loss: 1.3521
Confusion Matrix:
 [[5075458     284    2658      28       0]
 [1460248     429    2689       5       0]
 [  11403       0      45       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8731
Class 1 F1: 0.0006
Class 2 F1: 0.0053
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7752
Class 1 Precision: 0.6017
Class 2 Precision: 0.0083
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0003
Class 2 Recall: 0.0039
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7745
Macro F1 Score: 0.2198
xView2 Score: 0.0025
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.3064
Confusion Matrix:
 [[5077177     141    1110       0       0]
 [1461386     404    1581       0       0]
 [  11448       0       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8732
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7751
Class 1 Precision: 0.7413
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7748
Macro F1 Score: 0.2184
xView2 Score: 0.0009
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2679
Confusion Matrix:
 [[5077929     228     271       0       0]
 [1461705     768     898       0       0]
 [  11448       0       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8733
Class 1 F1: 0.0010
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7751
Class 1 Precision: 0.7711
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0005
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7749
Macro F1 Score: 0.2186
xView2 Score: 0.0009
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2376
Confusion Matrix:
 [[5077913     369     146       0       0]
 [1461518    1246     607       0       0]
 [  11448       0       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8733
Class 1 F1: 0.0017
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7751
Class 1 Precision: 0.7715
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0009
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7750
Macro F1 Score: 0.2187
xView2 Score: 0.0011
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2159
Confusion Matrix:
 [[5078026     193     209       0       0]
 [1462230     813     328       0       0]
 [  11448       0       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8732
Class 1 F1: 0.0011
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7750
Class 1 Precision: 0.8082
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0006
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7750
Macro F1 Score: 0.2186
xView2 Score: 0.0007
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3023
Best Macro F1: 0.1034
Best xView2 Score: 0.0877
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7368
Class 1 Precision: 0.3179
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2110
ROC curve saved to .././____________optune_results/85/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/85/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/85/visualize_predictions.jpg
Prediction distribution: {0: 262138, 1: 6}
ROC curve saved to .././____________optune_results/85/visualize_predictions.jpg
Prediction distribution: {0: 261923, 2: 221}
ROC curve saved to .././____________optune_results/85/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/85/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/85/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27472651742403936, 1: 0.740426087800802, 2: 125.10041011110283, 3: 784.4708229426434, 4: 5732.533940774488}
Final class weights used in loss: [4.9231660015040415, 0.740426087800802, 125.10041011110283, 784.4708229426434, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5974
Confusion Matrix:
 [[1348998   24678  174923   11481 3299698]
 [ 620338    7820   63901    8629  989605]
 [   1807       5      75       0    1380]
 [      2      17     159       0      11]
 [     19       0      18       0      36]]
Class 0 F1: 0.3950
Class 1 F1: 0.0091
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6844
Class 1 Precision: 0.2405
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2776
Class 1 Recall: 0.0046
Class 2 Recall: 0.0230
Class 3 Recall: 0.0000
Class 4 Recall: 0.4932
Validation Accuracy: 0.2071
Macro F1 Score: 0.0809
xView2 Score: 0.1041
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4752
Confusion Matrix:
 [[3810487    3014   43165    2086 1001026]
 [1262802    1222   14296    1445  410528]
 [   2366       0       0       0     901]
 [    186       0       3       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7670
Class 1 F1: 0.0014
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7507
Class 1 Precision: 0.2885
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7841
Class 1 Recall: 0.0007
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5816
Macro F1 Score: 0.1537
xView2 Score: 0.0812
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.3705
Confusion Matrix:
 [[4684377      85    1939      94  173283]
 [1561451      50    1372     123  127297]
 [   2465       0       0       0     802]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8434
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7497
Class 1 Precision: 0.3704
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9639
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7148
Macro F1 Score: 0.1687
xView2 Score: 0.0389
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.2606
Confusion Matrix:
 [[4815543       5     258       4   43968]
 [1659529       0     257       2   30505]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8494
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7433
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9909
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7348
Macro F1 Score: 0.1699
xView2 Score: 0.0104
Epoch 4 took:  0 hours,  1 minutes, 18 seconds

Epoch 5/10
Train Loss: 1.1485
Confusion Matrix:
 [[4850540       0      35       0    9203]
 [1683393       0      26       0    6874]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8512
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7420
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9981
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7401
Macro F1 Score: 0.1702
xView2 Score: 0.0024
Epoch 5 took:  0 hours,  1 minutes,  0 seconds

Epoch 6/10
Train Loss: 1.0565
Confusion Matrix:
 [[4858730       0       0       0    1048]
 [1688906       0       0       0    1387]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8516
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7417
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7414
Macro F1 Score: 0.1703
xView2 Score: 0.0005
Epoch 6 took:  0 hours,  0 minutes, 40 seconds

Epoch 7/10
Train Loss: 0.9661
Confusion Matrix:
 [[4859771       0       0       0       7]
 [1690231       0       0       0      62]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8516
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7416
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7415
Macro F1 Score: 0.1703
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 30 seconds

Epoch 8/10
Train Loss: 0.9000
Confusion Matrix:
 [[4859778       0       0       0       0]
 [1690293       0       0       0       0]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8516
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7415
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7415
Macro F1 Score: 0.1703
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8596
Confusion Matrix:
 [[4859778       0       0       0       0]
 [1690293       0       0       0       0]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8516
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7415
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7415
Macro F1 Score: 0.1703
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.7902
Confusion Matrix:
 [[4859778       0       0       0       0]
 [1690293       0       0       0       0]
 [   3267       0       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8516
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7415
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7415
Macro F1 Score: 0.1703
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2071
Best Macro F1: 0.0809
Best xView2 Score: 0.1041
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.6844
Class 1 Precision: 0.2405
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1850
ROC curve saved to .././____________optune_results/86/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/86/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/86/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/86/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/86/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/86/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/86/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27244733380607233, 1: 0.7573984328550578, 2: 128.93979249391572, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [1.100001402751931, 0.7573984328550578, 128.93979249391572, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.7022
Confusion Matrix:
 [[ 152716  264082 1521738   31408 2736571]
 [  44743  123591  539269    4864 1130153]
 [    149     208    1979       0    2129]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0623
Class 1 F1: 0.1108
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7728
Class 1 Precision: 0.3186
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0324
Class 1 Recall: 0.0671
Class 2 Recall: 0.4432
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.0425
Macro F1 Score: 0.0350
xView2 Score: 0.1504
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.6330
Confusion Matrix:
 [[ 923691  344558 1309993   21395 2106878]
 [ 256286  193580  525096    3610  864048]
 [    957     161    1480       0    1867]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3138
Class 1 F1: 0.1626
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7822
Class 1 Precision: 0.3596
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1963
Class 1 Recall: 0.1051
Class 2 Recall: 0.3315
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1707
Macro F1 Score: 0.0956
xView2 Score: 0.1595
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5718
Confusion Matrix:
 [[2490581  255599  907916    9284 1043135]
 [ 768045  164930  413284    1618  494743]
 [   1477       0    1463       0    1525]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6253
Class 1 F1: 0.1458
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7640
Class 1 Precision: 0.3922
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5292
Class 1 Recall: 0.0895
Class 2 Recall: 0.3277
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4054
Macro F1 Score: 0.1546
xView2 Score: 0.1498
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.5107
Confusion Matrix:
 [[3627949  245873  439084    3130  390479]
 [1199154  181041  221679     972  239774]
 [   3068      81    1157       0     159]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7608
Class 1 F1: 0.1595
Class 2 F1: 0.0035
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7511
Class 1 Precision: 0.4240
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7708
Class 1 Recall: 0.0983
Class 2 Recall: 0.2591
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5814
Macro F1 Score: 0.1848
xView2 Score: 0.1348
Epoch 4 took:  0 hours,  1 minutes, 23 seconds

Epoch 5/10
Train Loss: 1.4429
Confusion Matrix:
 [[4179078  208933  199629     765  118110]
 [1457349  178542  124863     340   81526]
 [   4109       0     294       0      62]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8078
Class 1 F1: 0.1601
Class 2 F1: 0.0018
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7409
Class 1 Precision: 0.4608
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8879
Class 1 Recall: 0.0969
Class 2 Recall: 0.0658
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6650
Macro F1 Score: 0.1939
xView2 Score: 0.1092
Epoch 5 took:  0 hours,  1 minutes, 19 seconds

Epoch 6/10
Train Loss: 1.3871
Confusion Matrix:
 [[4487444  131865   66215     348   20643]
 [1659100  121122   46169     126   16103]
 [   4447       0      18       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8266
Class 1 F1: 0.1156
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7295
Class 1 Precision: 0.4788
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9535
Class 1 Recall: 0.0657
Class 2 Recall: 0.0040
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7032
Macro F1 Score: 0.1885
xView2 Score: 0.0663
Epoch 6 took:  0 hours,  1 minutes, 13 seconds

Epoch 7/10
Train Loss: 1.3348
Confusion Matrix:
 [[4599080   85198   17965      96    4176]
 [1742905   82438   13467       5    3805]
 [   4459       2       4       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8322
Class 1 F1: 0.0820
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7247
Class 1 Precision: 0.4918
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9772
Class 1 Recall: 0.0447
Class 2 Recall: 0.0009
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7143
Macro F1 Score: 0.1829
xView2 Score: 0.0412
Epoch 7 took:  0 hours,  1 minutes,  3 seconds

Epoch 8/10
Train Loss: 1.2759
Confusion Matrix:
 [[4572085  122309   10874      64    1183]
 [1714290  119020    8289       4    1017]
 [   4219     246       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8315
Class 1 F1: 0.1142
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7268
Class 1 Precision: 0.4927
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9714
Class 1 Recall: 0.0646
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7158
Macro F1 Score: 0.1891
xView2 Score: 0.0535
Epoch 8 took:  0 hours,  0 minutes, 42 seconds

Epoch 9/10
Train Loss: 1.2301
Confusion Matrix:
 [[4601553  100655    4135      26     146]
 [1747906   92648    1862       0     204]
 [   4465       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8321
Class 1 F1: 0.0910
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7242
Class 1 Precision: 0.4793
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9777
Class 1 Recall: 0.0503
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7163
Macro F1 Score: 0.1846
xView2 Score: 0.0445
Epoch 9 took:  0 hours,  0 minutes, 29 seconds

Epoch 10/10
Train Loss: 1.1816
Confusion Matrix:
 [[4635183   70771     559       0       2]
 [1767661   74435     519       0       5]
 [   4465       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8341
Class 1 F1: 0.0749
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7234
Class 1 Precision: 0.5126
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9848
Class 1 Recall: 0.0404
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7186
Macro F1 Score: 0.2273
xView2 Score: 0.0362
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1707
Best Macro F1: 0.0956
Best xView2 Score: 0.1595
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7822
Class 1 Precision: 0.3596
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2285
ROC curve saved to .././____________optune_results/87/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/87/plot_loss_curves.jpg
Prediction distribution: {0: 258916, 1: 3228}
ROC curve saved to .././____________optune_results/87/visualize_predictions.jpg
Prediction distribution: {0: 239119, 1: 23025}
ROC curve saved to .././____________optune_results/87/visualize_predictions.jpg
Prediction distribution: {0: 260822, 1: 1322}
ROC curve saved to .././____________optune_results/87/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/87/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/87/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2744916793786929, 1: 0.7409196229368132, 2: 174.61109453599306, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [1.9689467493583106, 0.7409196229368132, 174.61109453599306, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6613
Confusion Matrix:
 [[ 431485 2391664  177267 1148413  695275]
 [ 129264  600753  149307  515483  300014]
 [   1354    5291     790    5434    1806]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1596
Class 1 F1: 0.2560
Class 2 F1: 0.0046
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7676
Class 1 Precision: 0.2004
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0891
Class 1 Recall: 0.3545
Class 2 Recall: 0.0538
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1576
Macro F1 Score: 0.0841
xView2 Score: 0.1975
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5779
Confusion Matrix:
 [[2368504 1202314  117438  743669  412179]
 [ 625908  413190  105840  357840  192043]
 [   5530    3421     249    4178    1297]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6039
Class 1 F1: 0.2494
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7895
Class 1 Precision: 0.2552
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4889
Class 1 Recall: 0.2438
Class 2 Recall: 0.0170
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4245
Macro F1 Score: 0.1711
xView2 Score: 0.1783
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5002
Confusion Matrix:
 [[4061357  292988   46271  338678  104810]
 [1226535  162578   51246  191228   63234]
 [  10890    1027     220    2208     330]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8008
Class 1 F1: 0.1511
Class 2 F1: 0.0039
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7665
Class 1 Precision: 0.3561
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8384
Class 1 Recall: 0.0959
Class 2 Recall: 0.0150
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6446
Macro F1 Score: 0.1912
xView2 Score: 0.1210
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.4248
Confusion Matrix:
 [[4699513   52435   12624   70236    9296]
 [1571199   46975   12202   54570    9875]
 [  13080      43       2     914     636]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8446
Class 1 F1: 0.0524
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7479
Class 1 Precision: 0.4723
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9702
Class 1 Recall: 0.0277
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7243
Macro F1 Score: 0.1794
xView2 Score: 0.0455
Epoch 4 took:  0 hours,  1 minutes, 18 seconds

Epoch 5/10
Train Loss: 1.3363
Confusion Matrix:
 [[4808603   11891    2834   19854     922]
 [1658509   13571    3717   17424    1600]
 [  13716      58       0     894       7]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8492
Class 1 F1: 0.0158
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7420
Class 1 Precision: 0.5318
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9927
Class 1 Recall: 0.0080
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7358
Macro F1 Score: 0.1730
xView2 Score: 0.0148
Epoch 5 took:  0 hours,  1 minutes,  2 seconds

Epoch 6/10
Train Loss: 1.2563
Confusion Matrix:
 [[4836944    2419     618    4013     110]
 [1684873    3619     900    4942     487]
 [  14590       0       0      85       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8500
Class 1 F1: 0.0043
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7400
Class 1 Precision: 0.5994
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9985
Class 1 Recall: 0.0021
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7386
Macro F1 Score: 0.1709
xView2 Score: 0.0041
Epoch 6 took:  0 hours,  0 minutes, 40 seconds

Epoch 7/10
Train Loss: 1.1939
Confusion Matrix:
 [[4843347     185      20     537      15]
 [1693386     348      60     966      61]
 [  14656      19       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8500
Class 1 F1: 0.0004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7393
Class 1 Precision: 0.6304
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7391
Macro F1 Score: 0.1701
xView2 Score: 0.0006
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1299
Confusion Matrix:
 [[4844083       0       0      21       0]
 [1694769       0       0      43       9]
 [  14675       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8500
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7392
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7391
Macro F1 Score: 0.1700
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0633
Confusion Matrix:
 [[4843958     146       0       0       0]
 [1694694     127       0       0       0]
 [  14675       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8500
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7392
Class 1 Precision: 0.4652
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7391
Macro F1 Score: 0.2834
xView2 Score: 0.0001
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0300
Confusion Matrix:
 [[4844093      11       0       0       0]
 [1694820       1       0       0       0]
 [  14675       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8500
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7392
Class 1 Precision: 0.0833
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7392
Macro F1 Score: 0.2833
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1576
Best Macro F1: 0.0841
Best xView2 Score: 0.1975
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7676
Class 1 Precision: 0.2004
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1941
ROC curve saved to .././____________optune_results/88/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/88/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/88/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/88/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/88/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/88/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/88/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.343925932546532, 1: 0.9207298922688003, 2: 167.94234157279377, 3: 2874.123343992691}
Final class weights used in loss: [6.535617058153106, 0.9207298922688003, 167.94234157279377, 2874.123343992691, 1.0]

Epoch 1/10
Train Loss: 1.5273
Confusion Matrix:
 [[3212328   38914   97264   88301 1450553]
 [ 775118   16976   28932   34080  799729]
 [   3139       1       0     209    2689]
 [   1812       0       2       0    2602]
 [    817       2       0       5     127]]
Class 0 F1: 0.7235
Class 1 F1: 0.0198
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0001
Class 0 Precision: 0.8044
Class 1 Precision: 0.3037
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0001
Class 0 Recall: 0.6573
Class 1 Recall: 0.0103
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.1335
Validation Accuracy: 0.4928
Macro F1 Score: 0.1487
xView2 Score: 0.1286
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4096
Confusion Matrix:
 [[4587237    3232   20611   15084  261196]
 [1470617    1649    5497    7087  169985]
 [   5056       0       0      92     890]
 [   4307       0       0       0     109]
 [    922       0      29       0       0]]
Class 0 F1: 0.8374
Class 1 F1: 0.0020
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7560
Class 1 Precision: 0.3378
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9386
Class 1 Recall: 0.0010
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7002
Macro F1 Score: 0.1679
xView2 Score: 0.0520
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.2999
Confusion Matrix:
 [[4848213     191    3299    1699   33958]
 [1631144     178     388     953   22172]
 [   5966       0       0       0      72]
 [   4152       0       0       0     264]
 [    951       0       0       0       0]]
Class 0 F1: 0.8522
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7470
Class 1 Precision: 0.4824
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9920
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7398
Macro F1 Score: 0.1705
xView2 Score: 0.0084
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.1993
Confusion Matrix:
 [[4883805      17     241     127    3170]
 [1652358      11      14     203    2249]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8542
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7459
Class 1 Precision: 0.3929
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9993
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7452
Macro F1 Score: 0.1708
xView2 Score: 0.0009
Epoch 4 took:  0 hours,  1 minutes, 11 seconds

Epoch 5/10
Train Loss: 1.0891
Confusion Matrix:
 [[4887347       0       0       0      13]
 [1654835       0       0       0       0]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8544
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7458
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7457
Macro F1 Score: 0.1709
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 37 seconds

Epoch 6/10
Train Loss: 0.9826
Confusion Matrix:
 [[4887360       0       0       0       0]
 [1654835       0       0       0       0]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8544
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7458
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7458
Macro F1 Score: 0.1709
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 0.8960
Confusion Matrix:
 [[4887360       0       0       0       0]
 [1654835       0       0       0       0]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8544
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7458
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7458
Macro F1 Score: 0.1709
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.8290
Confusion Matrix:
 [[4887360       0       0       0       0]
 [1654835       0       0       0       0]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8544
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7458
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7458
Macro F1 Score: 0.1709
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.7778
Confusion Matrix:
 [[4887360       0       0       0       0]
 [1654835       0       0       0       0]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8544
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7458
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7458
Macro F1 Score: 0.1709
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.7266
Confusion Matrix:
 [[4887360       0       0       0       0]
 [1654835       0       0       0       0]
 [   6038       0       0       0       0]
 [   4416       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8544
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7458
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7458
Macro F1 Score: 0.1709
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4928
Best Macro F1: 0.1487
Best xView2 Score: 0.1286
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8044
Class 1 Precision: 0.3037
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0001
Macro Precision: 0.2216
ROC curve saved to .././____________optune_results/89/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/89/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/89/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/89/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/89/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/89/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/89/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27300915285695837, 1: 0.7526659923351113, 2: 141.3929488440037, 3: 801.8424087940099, 4: 5292.497160883281}
Final class weights used in loss: [0.49429202665477306, 0.7526659923351113, 141.3929488440037, 801.8424087940099, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6019
Confusion Matrix:
 [[1787979 2285465    1247   46178  623663]
 [ 578532  908677     159   33203  280266]
 [   2628    4363       0      22     890]
 [      0     328       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5027
Class 1 F1: 0.3635
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7547
Class 1 Precision: 0.2841
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3769
Class 1 Recall: 0.5046
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4115
Macro F1 Score: 0.1732
xView2 Score: 0.2167
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5524
Confusion Matrix:
 [[3111798 1364579    1254   26543  240358]
 [ 942605  722437     236   21447  114112]
 [   4604    2463       0       0     836]
 [     35     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7069
Class 1 F1: 0.3714
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7666
Class 1 Precision: 0.3457
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6559
Class 1 Recall: 0.4012
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5851
Macro F1 Score: 0.2157
xView2 Score: 0.2002
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.5194
Confusion Matrix:
 [[3854659  852002     754    4444   32673]
 [1216964  559899      96    3926   19952]
 [   5930    1972       0       0       1]
 [    328       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7849
Class 1 F1: 0.3483
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7591
Class 1 Precision: 0.3960
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8124
Class 1 Recall: 0.3109
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6736
Macro F1 Score: 0.2266
xView2 Score: 0.1734
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.5079
Confusion Matrix:
 [[3939575  795950     164    2350    6493]
 [1156380  638149      90    1860    4358]
 [   6204    1699       0       0       0]
 [     35     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8002
Class 1 F1: 0.3943
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7721
Class 1 Precision: 0.4444
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8303
Class 1 Recall: 0.3544
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6985
Macro F1 Score: 0.2389
xView2 Score: 0.1922
Epoch 4 took:  0 hours,  1 minutes, 18 seconds

Epoch 5/10
Train Loss: 1.4413
Confusion Matrix:
 [[3896061  846323      54     677    1417]
 [1080575  718497      67     585    1113]
 [   6189    1714       0       0       0]
 [    254      74       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8010
Class 1 F1: 0.4267
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7819
Class 1 Precision: 0.4586
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8212
Class 1 Recall: 0.3990
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7041
Macro F1 Score: 0.2456
xView2 Score: 0.2080
Epoch 5 took:  0 hours,  0 minutes, 55 seconds

Epoch 6/10
Train Loss: 1.4225
Confusion Matrix:
 [[3909520  834740      70       9     193]
 [1086930  713771      42      13      81]
 [   6089    1814       0       0       0]
 [    291      37       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8022
Class 1 F1: 0.4260
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7815
Class 1 Precision: 0.4604
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8240
Class 1 Recall: 0.3964
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7055
Macro F1 Score: 0.2456
xView2 Score: 0.2072
Epoch 6 took:  0 hours,  0 minutes, 30 seconds

Epoch 7/10
Train Loss: 1.3931
Confusion Matrix:
 [[3901376  843123       3      30       0]
 [1030455  770346       1      35       0]
 [   5633    2270       0       0       0]
 [     35     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8059
Class 1 F1: 0.4509
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7902
Class 1 Precision: 0.4767
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8223
Class 1 Recall: 0.4278
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.3142
xView2 Score: 0.2402
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3524
Confusion Matrix:
 [[3815483  929016      13      20       0]
 [ 947099  853737       0       1       0]
 [   5185    2718       0       0       0]
 [     35     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8022
Class 1 F1: 0.4761
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8003
Class 1 Precision: 0.4781
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8042
Class 1 Recall: 0.4741
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7125
Macro F1 Score: 0.3196
xView2 Score: 0.2554
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.3318
Confusion Matrix:
 [[3824429  920103       0       0       0]
 [ 928721  872116       0       0       0]
 [   5601    2302       0       0       0]
 [     35     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8049
Class 1 F1: 0.4851
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8037
Class 1 Precision: 0.4859
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8061
Class 1 Recall: 0.4843
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7166
Macro F1 Score: 0.3225
xView2 Score: 0.2597
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2881
Confusion Matrix:
 [[3786320  958212       0       0       0]
 [ 883107  917730       0       0       0]
 [   5671    2232       0       0       0]
 [     35     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8039
Class 1 F1: 0.4989
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8099
Class 1 Precision: 0.4886
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7980
Class 1 Recall: 0.5096
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7178
Macro F1 Score: 0.3257
xView2 Score: 0.2678
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7178
Best Macro F1: 0.3257
Best xView2 Score: 0.2678
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8099
Class 1 Precision: 0.4886
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3246
ROC curve saved to .././____________optune_results/90/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/90/plot_loss_curves.jpg
Prediction distribution: {0: 257468, 1: 4676}
ROC curve saved to .././____________optune_results/90/visualize_predictions.jpg
Prediction distribution: {0: 57736, 1: 204408}
ROC curve saved to .././____________optune_results/90/visualize_predictions.jpg
Prediction distribution: {0: 262063, 1: 81}
ROC curve saved to .././____________optune_results/90/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/90/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/90/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2743521266472172, 1: 0.7433559183253905, 2: 119.58101211689237, 3: 801.8424087940099, 4: 5292.497160883281}
Final class weights used in loss: [0.6370130468608293, 0.7433559183253905, 119.58101211689237, 801.8424087940099, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6123
Confusion Matrix:
 [[1548661   26970 1891119   50228 1317799]
 [ 404144    9650  695633   24017  583641]
 [    744       0     119     117     430]
 [      0       0      73     126     129]
 [      0       0       0       0       0]]
Class 0 F1: 0.4563
Class 1 F1: 0.0110
Class 2 F1: 0.0001
Class 3 F1: 0.0034
Class 4 F1: 0.0000
Class 0 Precision: 0.7927
Class 1 Precision: 0.2635
Class 2 Precision: 0.0000
Class 3 Precision: 0.0017
Class 4 Precision: 0.0000
Class 0 Recall: 0.3203
Class 1 Recall: 0.0056
Class 2 Recall: 0.0844
Class 3 Recall: 0.3841
Class 4 Recall: 0.0000
Validation Accuracy: 0.2378
Macro F1 Score: 0.0941
xView2 Score: 0.1278
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5702
Confusion Matrix:
 [[3112560   24877 1045719   30151  621470]
 [ 893912   11617  502744   13333  295479]
 [    924       6      63      82     335]
 [      0       0     229      55      44]
 [      0       0       0       0       0]]
Class 0 F1: 0.7040
Class 1 F1: 0.0132
Class 2 F1: 0.0001
Class 3 F1: 0.0025
Class 4 F1: 0.0000
Class 0 Precision: 0.7767
Class 1 Precision: 0.3183
Class 2 Precision: 0.0000
Class 3 Precision: 0.0013
Class 4 Precision: 0.0000
Class 0 Recall: 0.6438
Class 1 Recall: 0.0068
Class 2 Recall: 0.0447
Class 3 Recall: 0.1677
Class 4 Recall: 0.0000
Validation Accuracy: 0.4767
Macro F1 Score: 0.1440
xView2 Score: 0.1190
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.5328
Confusion Matrix:
 [[4048719   23268  550292   11959  200539]
 [1268420   12841  329910    5981   99933]
 [   1177      21     201       0      11]
 [    122       0     206       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7975
Class 1 F1: 0.0146
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7613
Class 1 Precision: 0.3554
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8374
Class 1 Recall: 0.0075
Class 2 Recall: 0.1426
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6198
Macro F1 Score: 0.1625
xView2 Score: 0.0935
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.5005
Confusion Matrix:
 [[4546866   35998  203554    3995   44364]
 [1498060   26696  163222    2402   26705]
 [   1365       6       0       0      39]
 [    326       0       0       0       2]
 [      0       0       0       0       0]]
Class 0 F1: 0.8357
Class 1 F1: 0.0300
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7520
Class 1 Precision: 0.4258
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9404
Class 1 Recall: 0.0155
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6979
Macro F1 Score: 0.1731
xView2 Score: 0.0633
Epoch 4 took:  0 hours,  1 minutes, 21 seconds

Epoch 5/10
Train Loss: 1.4613
Confusion Matrix:
 [[4703649   40299   81552    1183    8094]
 [1592875   35274   82958     903    5075]
 [   1410       0       0       0       0]
 [    328       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8450
Class 1 F1: 0.0394
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7468
Class 1 Precision: 0.4668
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9729
Class 1 Recall: 0.0205
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7231
Macro F1 Score: 0.1769
xView2 Score: 0.0434
Epoch 5 took:  0 hours,  1 minutes, 13 seconds

Epoch 6/10
Train Loss: 1.4321
Confusion Matrix:
 [[4708897   64581   59171     797    1331]
 [1588914   62942   63763     556     910]
 [   1403       7       0       0       0]
 [    328       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8458
Class 1 F1: 0.0682
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7475
Class 1 Precision: 0.4935
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9740
Class 1 Recall: 0.0367
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7281
Macro F1 Score: 0.1828
xView2 Score: 0.0489
Epoch 6 took:  0 hours,  0 minutes, 54 seconds

Epoch 7/10
Train Loss: 1.3890
Confusion Matrix:
 [[4705814   79561   48829     410     163]
 [1582680   81142   52804     404      55]
 [   1392       9       0       9       0]
 [    324       0       0       4       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0864
Class 2 F1: 0.0000
Class 3 F1: 0.0069
Class 4 F1: 0.0000
Class 0 Precision: 0.7481
Class 1 Precision: 0.5049
Class 2 Precision: 0.0000
Class 3 Precision: 0.0048
Class 4 Precision: 0.0000
Class 0 Recall: 0.9733
Class 1 Recall: 0.0473
Class 2 Recall: 0.0000
Class 3 Recall: 0.0122
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.1879
xView2 Score: 0.0548
Epoch 7 took:  0 hours,  0 minutes, 33 seconds

Epoch 8/10
Train Loss: 1.3470
Confusion Matrix:
 [[4717113   94167   23277     178      42]
 [1585444  103895   27625     121       0]
 [   1353      57       0       0       0]
 [    274      54       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8470
Class 1 F1: 0.1085
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7483
Class 1 Precision: 0.5243
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9757
Class 1 Recall: 0.0605
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7356
Macro F1 Score: 0.1911
xView2 Score: 0.0601
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.3301
Confusion Matrix:
 [[4705596  118958   10194      25       4]
 [1567600  136126   13348      11       0]
 [   1410       0       0       0       0]
 [    328       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8471
Class 1 F1: 0.1380
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7499
Class 1 Precision: 0.5337
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9733
Class 1 Recall: 0.0793
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7388
Macro F1 Score: 0.1970
xView2 Score: 0.0706
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2742
Confusion Matrix:
 [[4674140  152887    7717      33       0]
 [1532240  175246    9578      21       0]
 [   1410       0       0       0       0]
 [    328       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8465
Class 1 F1: 0.1714
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7529
Class 1 Precision: 0.5341
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9668
Class 1 Recall: 0.1021
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7400
Macro F1 Score: 0.2545
xView2 Score: 0.0861
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2378
Best Macro F1: 0.0941
Best xView2 Score: 0.1278
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7927
Class 1 Precision: 0.2635
Class 2 Precision: 0.0000
Class 3 Precision: 0.0017
Class 4 Precision: 0.0000
Macro Precision: 0.2116
ROC curve saved to .././____________optune_results/91/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/91/plot_loss_curves.jpg
Prediction distribution: {0: 239372, 1: 19746, 2: 3026}
ROC curve saved to .././____________optune_results/91/visualize_predictions.jpg
Prediction distribution: {0: 241994, 1: 19908, 2: 242}
ROC curve saved to .././____________optune_results/91/visualize_predictions.jpg
Prediction distribution: {0: 236930, 1: 24622, 2: 592}
ROC curve saved to .././____________optune_results/91/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/91/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/91/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.3383261549322534, 1: 0.9611812368288298, 2: 300.43722840361016, 3: 1794.4826012549916}
Final class weights used in loss: [0.5064412710443703, 0.9611812368288298, 300.43722840361016, 1794.4826012549916, 1.0]

Epoch 1/10
Train Loss: 1.6156
Confusion Matrix:
 [[1827482  260881 1365135  900534  230552]
 [ 702233  133356  642420  404690   59708]
 [   4326    1199    9501    6026    1507]
 [    370     164    2214     350       1]
 [    162     146     642       1       0]]
Class 0 F1: 0.5134
Class 1 F1: 0.1141
Class 2 F1: 0.0093
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7210
Class 1 Precision: 0.3370
Class 2 Precision: 0.0047
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.3986
Class 1 Recall: 0.0687
Class 2 Recall: 0.4212
Class 3 Recall: 0.1129
Class 4 Recall: 0.0000
Validation Accuracy: 0.3007
Macro F1 Score: 0.1275
xView2 Score: 0.1486
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5634
Confusion Matrix:
 [[3048241  270469  896986  320024   48864]
 [1132653  178968  469149  145318   16319]
 [  11701    2461    6697    1354     346]
 [   1691     312     735     348      13]
 [    417      73     451      10       0]]
Class 0 F1: 0.6944
Class 1 F1: 0.1495
Class 2 F1: 0.0096
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.7267
Class 1 Precision: 0.3957
Class 2 Precision: 0.0049
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.6649
Class 1 Recall: 0.0921
Class 2 Recall: 0.2969
Class 3 Recall: 0.1123
Class 4 Recall: 0.0000
Validation Accuracy: 0.4935
Macro F1 Score: 0.1710
xView2 Score: 0.1420
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5235
Confusion Matrix:
 [[3545981  373448  546541  115408    3206]
 [1318858  258239  311481   52251    1578]
 [  15538    1581    5117     323       0]
 [   1997     303     492     304       3]
 [    850       0     100       1       0]]
Class 0 F1: 0.7491
Class 1 F1: 0.2005
Class 2 F1: 0.0115
Class 3 F1: 0.0035
Class 4 F1: 0.0000
Class 0 Precision: 0.7262
Class 1 Precision: 0.4076
Class 2 Precision: 0.0059
Class 3 Precision: 0.0018
Class 4 Precision: 0.0000
Class 0 Recall: 0.7735
Class 1 Recall: 0.1329
Class 2 Recall: 0.2268
Class 3 Recall: 0.0981
Class 4 Recall: 0.0000
Validation Accuracy: 0.5813
Macro F1 Score: 0.1929
xView2 Score: 0.1427
Epoch 3 took:  0 hours,  1 minutes, 14 seconds

Epoch 4/10
Train Loss: 1.4750
Confusion Matrix:
 [[3488830  731013  335389   29307      45]
 [1110872  588680  226744   16049      62]
 [  13496    4074    4903      86       0]
 [   2473     583      39       0       4]
 [    291     638      22       0       0]]
Class 0 F1: 0.7584
Class 1 F1: 0.3603
Class 2 F1: 0.0166
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7558
Class 1 Precision: 0.4443
Class 2 Precision: 0.0086
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7610
Class 1 Recall: 0.3031
Class 2 Recall: 0.2173
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6229
Macro F1 Score: 0.2271
xView2 Score: 0.1997
Epoch 4 took:  0 hours,  0 minutes, 44 seconds

Epoch 5/10
Train Loss: 1.4128
Confusion Matrix:
 [[3481562  815457  278979    8586       0]
 [1033209  716897  187998    4302       1]
 [  16200    3350    2925      84       0]
 [   1938     523     635       3       0]
 [    324      29     598       0       0]]
Class 0 F1: 0.7637
Class 1 F1: 0.4122
Class 2 F1: 0.0118
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.7680
Class 1 Precision: 0.4667
Class 2 Precision: 0.0062
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.7594
Class 1 Recall: 0.3691
Class 2 Recall: 0.1297
Class 3 Recall: 0.0010
Class 4 Recall: 0.0000
Validation Accuracy: 0.6411
Macro F1 Score: 0.2376
xView2 Score: 0.2173
Epoch 5 took:  0 hours,  0 minutes, 29 seconds

Epoch 6/10
Train Loss: 1.3724
Confusion Matrix:
 [[3263100 1106507  212293    2684       0]
 [ 873182  927144  140203    1878       0]
 [  16436    3823    2300       0       0]
 [   1692     660     747       0       0]
 [     84     175     692       0       0]]
Class 0 F1: 0.7468
Class 1 F1: 0.4658
Class 2 F1: 0.0121
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7854
Class 1 Precision: 0.4549
Class 2 Precision: 0.0065
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7118
Class 1 Recall: 0.4773
Class 2 Recall: 0.1020
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6397
Macro F1 Score: 0.2449
xView2 Score: 0.2422
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3328
Confusion Matrix:
 [[3205509 1250979  126924    1172       0]
 [ 781961 1075788   84288     370       0]
 [  14505    6475    1579       0       0]
 [   1277    1247     575       0       0]
 [      4     377     570       0       0]]
Class 0 F1: 0.7465
Class 1 F1: 0.5030
Class 2 F1: 0.0134
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8007
Class 1 Precision: 0.4607
Class 2 Precision: 0.0074
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6992
Class 1 Recall: 0.5538
Class 2 Recall: 0.0700
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6535
Macro F1 Score: 0.2526
xView2 Score: 0.2591
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3041
Confusion Matrix:
 [[3077590 1437039   69773     182       0]
 [ 737771 1162837   41761      38       0]
 [  17278    4493     788       0       0]
 [   1643    1147     309       0       0]
 [    310     577      64       0       0]]
Class 0 F1: 0.7311
Class 1 F1: 0.5113
Class 2 F1: 0.0117
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8026
Class 1 Precision: 0.4462
Class 2 Precision: 0.0070
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6713
Class 1 Recall: 0.5987
Class 2 Recall: 0.0349
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6472
Macro F1 Score: 0.2508
xView2 Score: 0.2631
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2820
Confusion Matrix:
 [[3090770 1446653   47132      29       0]
 [ 722187 1195094   25119       7       0]
 [  15089    7198     272       0       0]
 [   1328    1534     237       0       0]
 [     18     835      98       0       0]]
Class 0 F1: 0.7347
Class 1 F1: 0.5203
Class 2 F1: 0.0057
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8071
Class 1 Precision: 0.4508
Class 2 Precision: 0.0037
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6742
Class 1 Recall: 0.6153
Class 2 Recall: 0.0121
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6540
Macro F1 Score: 0.2521
xView2 Score: 0.2652
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2150
Confusion Matrix:
 [[2989506 1554108   40959      11       0]
 [ 652916 1265657   23830       4       0]
 [  12979    8974     606       0       0]
 [   1359    1509     231       0       0]
 [    114     796      41       0       0]]
Class 0 F1: 0.7255
Class 1 F1: 0.5303
Class 2 F1: 0.0137
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8175
Class 1 Precision: 0.4471
Class 2 Precision: 0.0092
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6521
Class 1 Recall: 0.6516
Class 2 Recall: 0.0269
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6494
Macro F1 Score: 0.2539
xView2 Score: 0.2742
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6494
Best Macro F1: 0.2539
Best xView2 Score: 0.2742
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8175
Class 1 Precision: 0.4471
Class 2 Precision: 0.0092
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2548
ROC curve saved to .././____________optune_results/92/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/92/plot_loss_curves.jpg
Prediction distribution: {0: 162322, 1: 99547, 2: 275}
ROC curve saved to .././____________optune_results/92/visualize_predictions.jpg
Prediction distribution: {0: 32048, 1: 229899, 2: 197}
ROC curve saved to .././____________optune_results/92/visualize_predictions.jpg
Prediction distribution: {0: 75168, 1: 185610, 2: 1366}
ROC curve saved to .././____________optune_results/92/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/92/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/92/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27192312018565157, 1: 0.7616595007744974, 2: 123.97568353120843, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [4.615543033326081, 0.7616595007744974, 123.97568353120843, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6764
Confusion Matrix:
 [[ 599003  319209 3248147   53576  450966]
 [  78007  239403 1370578   23993  167816]
 [      0       0    2871       0      31]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.2240
Class 1 F1: 0.1964
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8848
Class 1 Precision: 0.4286
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1282
Class 1 Recall: 0.1274
Class 2 Recall: 0.9893
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1284
Macro F1 Score: 0.0843
xView2 Score: 0.1718
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5532
Confusion Matrix:
 [[2943494  204790 1350447   16217  155953]
 [ 724550  191674  864843    9524   89206]
 [    233      34    2574       0      61]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7059
Class 1 F1: 0.1684
Class 2 F1: 0.0023
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8024
Class 1 Precision: 0.4834
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6302
Class 1 Recall: 0.1020
Class 2 Recall: 0.8870
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4788
Macro F1 Score: 0.1753
xView2 Score: 0.1724
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4438
Confusion Matrix:
 [[4238874   44381  372888    1393   13365]
 [1522380   51462  291142    1059   13754]
 [   1822       0    1080       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8125
Class 1 F1: 0.0521
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7355
Class 1 Precision: 0.5369
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9075
Class 1 Recall: 0.0274
Class 2 Recall: 0.3722
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6548
Macro F1 Score: 0.1736
xView2 Score: 0.0889
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.3322
Confusion Matrix:
 [[4582906    9411   77899     194     491]
 [1802116   11726   64762     287     906]
 [   2893       0       9       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8288
Class 1 F1: 0.0123
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7174
Class 1 Precision: 0.5548
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9812
Class 1 Recall: 0.0062
Class 2 Recall: 0.0031
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7011
Macro F1 Score: 0.1683
xView2 Score: 0.0245
Epoch 4 took:  0 hours,  1 minutes,  6 seconds

Epoch 5/10
Train Loss: 1.2162
Confusion Matrix:
 [[4664360     650    5891       0       0]
 [1873933     763    5089      10       2]
 [   2902       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.0008
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7131
Class 1 Precision: 0.5400
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9986
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7118
Macro F1 Score: 0.1666
xView2 Score: 0.0020
Epoch 5 took:  0 hours,  0 minutes, 36 seconds

Epoch 6/10
Train Loss: 1.1169
Confusion Matrix:
 [[4670637       6     258       0       0]
 [1879566      14     217       0       0]
 [   2902       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7127
Class 1 Precision: 0.7000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7127
Macro F1 Score: 0.2774
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0094
Confusion Matrix:
 [[4670901       0       0       0       0]
 [1879797       0       0       0       0]
 [   2902       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7127
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7127
Macro F1 Score: 0.2774
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9436
Confusion Matrix:
 [[4670901       0       0       0       0]
 [1879797       0       0       0       0]
 [   2902       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7127
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7127
Macro F1 Score: 0.2774
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8770
Confusion Matrix:
 [[4670901       0       0       0       0]
 [1879797       0       0       0       0]
 [   2902       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7127
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7127
Macro F1 Score: 0.2774
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8234
Confusion Matrix:
 [[4670901       0       0       0       0]
 [1879797       0       0       0       0]
 [   2902       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7127
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7127
Macro F1 Score: 0.2774
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4788
Best Macro F1: 0.1753
Best xView2 Score: 0.1724
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8024
Class 1 Precision: 0.4834
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2574
ROC curve saved to .././____________optune_results/93/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/93/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/93/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/93/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/93/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/93/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/93/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.271696670990747, 1: 0.7634637883825943, 2: 121.47426750977458, 3: 844.6324551099178, 4: 5292.497160883281}
Final class weights used in loss: [1.317842088359842, 0.7634637883825943, 121.47426750977458, 844.6324551099178, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6156
Confusion Matrix:
 [[1815351  357864 1263574  584984  633701]
 [ 450350  112437  645164  293086  394377]
 [   1096      59     242     364     305]
 [      0       0     190     414      42]
 [      0       0       0       0       0]]
Class 0 F1: 0.5245
Class 1 F1: 0.0951
Class 2 F1: 0.0003
Class 3 F1: 0.0009
Class 4 F1: 0.0000
Class 0 Precision: 0.8008
Class 1 Precision: 0.2390
Class 2 Precision: 0.0001
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.3899
Class 1 Recall: 0.0593
Class 2 Recall: 0.1171
Class 3 Recall: 0.6409
Class 4 Recall: 0.0000
Validation Accuracy: 0.2943
Macro F1 Score: 0.1241
xView2 Score: 0.1565
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5403
Confusion Matrix:
 [[3196408  130361  897533  176970  254202]
 [ 996200   56851  541597  123511  177255]
 [   1684      31     237      78      36]
 [    534       0     103       7       2]
 [      0       0       0       0       0]]
Class 0 F1: 0.7223
Class 1 F1: 0.0546
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7620
Class 1 Precision: 0.3036
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6866
Class 1 Recall: 0.0300
Class 2 Recall: 0.1147
Class 3 Recall: 0.0108
Class 4 Recall: 0.0000
Validation Accuracy: 0.4964
Macro F1 Score: 0.1555
xView2 Score: 0.1351
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4787
Confusion Matrix:
 [[4173301   31548  362071   37469   51085]
 [1536377   18075  268576   32676   39710]
 [   1785       0     153     128       0]
 [    426       0     220       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8051
Class 1 F1: 0.0186
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7306
Class 1 Precision: 0.3642
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8964
Class 1 Recall: 0.0095
Class 2 Recall: 0.0741
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6396
Macro F1 Score: 0.1648
xView2 Score: 0.0815
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.4145
Confusion Matrix:
 [[4460510   10785  167576    7926    8677]
 [1722890    7445  146326    9889    8864]
 [   2043      22       1       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8229
Class 1 F1: 0.0078
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7211
Class 1 Precision: 0.4079
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9581
Class 1 Recall: 0.0039
Class 2 Recall: 0.0005
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6818
Macro F1 Score: 0.1661
xView2 Score: 0.0468
Epoch 4 took:  0 hours,  1 minutes, 11 seconds

Epoch 5/10
Train Loss: 1.3433
Confusion Matrix:
 [[4582349    2668   68167    1324     966]
 [1818062    2519   72004    1800    1029]
 [   2061       5       0       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8287
Class 1 F1: 0.0027
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7156
Class 1 Precision: 0.4852
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9843
Class 1 Recall: 0.0013
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6996
Macro F1 Score: 0.1663
xView2 Score: 0.0230
Epoch 5 took:  0 hours,  0 minutes, 54 seconds

Epoch 6/10
Train Loss: 1.2753
Confusion Matrix:
 [[4633596     961   20663     131     123]
 [1864285    1263   29498     234     134]
 [   2066       0       0       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8307
Class 1 F1: 0.0013
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7128
Class 1 Precision: 0.5679
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9953
Class 1 Recall: 0.0007
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1664
xView2 Score: 0.0098
Epoch 6 took:  0 hours,  0 minutes, 34 seconds

Epoch 7/10
Train Loss: 1.2094
Confusion Matrix:
 [[4650032     655    4688       1      98]
 [1885405    1198    8767      14      30]
 [   2066       0       0       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8308
Class 1 F1: 0.0013
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7112
Class 1 Precision: 0.6465
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9988
Class 1 Recall: 0.0006
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7097
Macro F1 Score: 0.1664
xView2 Score: 0.0033
Epoch 7 took:  0 hours,  0 minutes, 30 seconds

Epoch 8/10
Train Loss: 1.1699
Confusion Matrix:
 [[4653607     301    1566       0       0]
 [1891264     729    3419       2       0]
 [   2066       0       0       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8308
Class 1 F1: 0.0008
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7107
Class 1 Precision: 0.7078
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7102
Macro F1 Score: 0.2079
xView2 Score: 0.0014
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1448
Confusion Matrix:
 [[4654985     159     330       0       0]
 [1893932     499     983       0       0]
 [   2066       0       0       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8307
Class 1 F1: 0.0005
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7105
Class 1 Precision: 0.7584
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7104
Macro F1 Score: 0.2078
xView2 Score: 0.0006
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0748
Confusion Matrix:
 [[4655004     163     307       0       0]
 [1894361     428     625       0       0]
 [   2066       0       0       0       0]
 [    646       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8307
Class 1 F1: 0.0005
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7105
Class 1 Precision: 0.7242
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7104
Macro F1 Score: 0.2078
xView2 Score: 0.0004
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2943
Best Macro F1: 0.1241
Best xView2 Score: 0.1565
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8008
Class 1 Precision: 0.2390
Class 2 Precision: 0.0001
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Macro Precision: 0.2081
ROC curve saved to .././____________optune_results/94/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/94/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/94/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/94/visualize_predictions.jpg
Prediction distribution: {0: 262059, 1: 16, 2: 69}
ROC curve saved to .././____________optune_results/94/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/94/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/94/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2732148210794645, 1: 0.7518316501947783, 2: 120.62418635862532, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [1.3674986879349265, 0.7518316501947783, 120.62418635862532, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5763
Confusion Matrix:
 [[2811044    2334  155786  297035 1492211]
 [1072007    1088   36853  148195  535273]
 [   1440       0       0      11     323]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6505
Class 1 F1: 0.0012
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7237
Class 1 Precision: 0.3179
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5908
Class 1 Recall: 0.0006
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4291
Macro F1 Score: 0.1303
xView2 Score: 0.0972
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4956
Confusion Matrix:
 [[4416450     942   35563   75245  230210]
 [1621326     752   18112   41470  111756]
 [   1520       0       0      11     243]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8180
Class 1 F1: 0.0008
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7313
Class 1 Precision: 0.4439
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9281
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6740
Macro F1 Score: 0.1638
xView2 Score: 0.0449
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.4287
Confusion Matrix:
 [[4726491     184    4621    8704   18410]
 [1772340      38    3719    5896   11423]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8396
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7271
Class 1 Precision: 0.1712
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9933
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7212
Macro F1 Score: 0.1679
xView2 Score: 0.0068
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.3701
Confusion Matrix:
 [[4755502      93     528     797    1490]
 [1789943       6     860     937    1670]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7263
Class 1 Precision: 0.0606
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7256
Macro F1 Score: 0.1683
xView2 Score: 0.0012
Epoch 4 took:  0 hours,  0 minutes, 59 seconds

Epoch 5/10
Train Loss: 1.3050
Confusion Matrix:
 [[4758093      10     129      65     113]
 [1792859       0     162     178     217]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7260
Macro F1 Score: 0.1683
xView2 Score: 0.0002
Epoch 5 took:  0 hours,  0 minutes, 33 seconds

Epoch 6/10
Train Loss: 1.2375
Confusion Matrix:
 [[4758364       2      42       2       0]
 [1793391       0       2      23       0]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7261
Macro F1 Score: 0.2103
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1970
Confusion Matrix:
 [[4758407       0       3       0       0]
 [1793416       0       0       0       0]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7261
Macro F1 Score: 0.2804
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1540
Confusion Matrix:
 [[4758410       0       0       0       0]
 [1793416       0       0       0       0]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7261
Macro F1 Score: 0.2804
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1289
Confusion Matrix:
 [[4758410       0       0       0       0]
 [1793416       0       0       0       0]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7261
Macro F1 Score: 0.2804
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0779
Confusion Matrix:
 [[4758409       1       0       0       0]
 [1793416       0       0       0       0]
 [   1774       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7261
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7261
Macro F1 Score: 0.2804
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4291
Best Macro F1: 0.1303
Best xView2 Score: 0.0972
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7237
Class 1 Precision: 0.3179
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2083
ROC curve saved to .././____________optune_results/95/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/95/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/95/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/95/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/95/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/95/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/95/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2731827011375437, 1: 0.7503829019083522, 2: 182.46682134570764, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [0.6846693323502212, 0.7503829019083522, 182.46682134570764, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5919
Confusion Matrix:
 [[3057410  106051  362460   23904 1206419]
 [ 862683   34267  157176   10760  715605]
 [   9733     968    3136     921    1158]
 [    498       0     129       0     322]
 [      0       0       0       0       0]]
Class 0 F1: 0.7039
Class 1 F1: 0.0357
Class 2 F1: 0.0116
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7779
Class 1 Precision: 0.2425
Class 2 Precision: 0.0060
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6428
Class 1 Recall: 0.0192
Class 2 Recall: 0.1970
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4722
Macro F1 Score: 0.1502
xView2 Score: 0.1357
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5387
Confusion Matrix:
 [[4087809   60709  195943   13677  398106]
 [1345403   31970  112334    5973  284811]
 [  13330     798    1371     395      22]
 [    946       3       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8012
Class 1 F1: 0.0341
Class 2 F1: 0.0084
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7504
Class 1 Precision: 0.3420
Class 2 Precision: 0.0044
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8595
Class 1 Recall: 0.0180
Class 2 Recall: 0.0861
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6288
Macro F1 Score: 0.1688
xView2 Score: 0.0983
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4971
Confusion Matrix:
 [[4583508   32220   66687    2748   71081]
 [1642133   23062   50937    1955   62404]
 [  15533       1     368      14       0]
 [    936       0      13       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8335
Class 1 F1: 0.0251
Class 2 F1: 0.0055
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7343
Class 1 Precision: 0.4172
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9637
Class 1 Recall: 0.0130
Class 2 Recall: 0.0231
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7030
Macro F1 Score: 0.1728
xView2 Score: 0.0446
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.4578
Confusion Matrix:
 [[4659928   43354   31617    1937   19408]
 [1692311   37932   30070    1015   19163]
 [  15715      16     171      13       1]
 [    941       8       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8377
Class 1 F1: 0.0407
Class 2 F1: 0.0044
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7317
Class 1 Precision: 0.4665
Class 2 Precision: 0.0028
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9797
Class 1 Recall: 0.0213
Class 2 Recall: 0.0107
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7169
Macro F1 Score: 0.1766
xView2 Score: 0.0336
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.4119
Confusion Matrix:
 [[4680069   53164   20803     485    1723]
 [1709048   48745   20329     623    1746]
 [  15749      26     141       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8386
Class 1 F1: 0.0518
Class 2 F1: 0.0049
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7306
Class 1 Precision: 0.4782
Class 2 Precision: 0.0034
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9840
Class 1 Recall: 0.0274
Class 2 Recall: 0.0089
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7216
Macro F1 Score: 0.1791
xView2 Score: 0.0306
Epoch 5 took:  0 hours,  0 minutes, 58 seconds

Epoch 6/10
Train Loss: 1.3675
Confusion Matrix:
 [[4697003   50300    8846      61      34]
 [1722412   48986    8767     237      89]
 [  15912       4       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8393
Class 1 F1: 0.0521
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7298
Class 1 Precision: 0.4934
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9875
Class 1 Recall: 0.0275
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7242
Macro F1 Score: 0.1783
xView2 Score: 0.0257
Epoch 6 took:  0 hours,  0 minutes, 36 seconds

Epoch 7/10
Train Loss: 1.3398
Confusion Matrix:
 [[4671942   75555    8606     138       3]
 [1699146   73500    7618     215      12]
 [  15916       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8385
Class 1 F1: 0.0762
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7314
Class 1 Precision: 0.4931
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9823
Class 1 Recall: 0.0413
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7241
Macro F1 Score: 0.1829
xView2 Score: 0.0360
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.2715
Confusion Matrix:
 [[4629178  122082    4976       8       0]
 [1654469  121313    4662      47       0]
 [  15889      25       2       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8374
Class 1 F1: 0.1199
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7347
Class 1 Precision: 0.4984
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9733
Class 1 Recall: 0.0681
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7249
Macro F1 Score: 0.2393
xView2 Score: 0.0592
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2634
Confusion Matrix:
 [[4587297  155110   13706     131       0]
 [1617710  152792    9907      82       0]
 [  15864       0      49       3       0]
 [    919      30       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8357
Class 1 F1: 0.1463
Class 2 F1: 0.0025
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7373
Class 1 Precision: 0.4962
Class 2 Precision: 0.0021
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9645
Class 1 Recall: 0.0858
Class 2 Recall: 0.0031
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7233
Macro F1 Score: 0.2461
xView2 Score: 0.0742
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2429
Confusion Matrix:
 [[4541759  208452    6033       0       0]
 [1556358  218273    5853       7       0]
 [  15916       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8356
Class 1 F1: 0.1978
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7427
Class 1 Precision: 0.5115
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9549
Class 1 Recall: 0.1226
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7263
Macro F1 Score: 0.2583
xView2 Score: 0.0984
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4722
Best Macro F1: 0.1502
Best xView2 Score: 0.1357
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7779
Class 1 Precision: 0.2425
Class 2 Precision: 0.0060
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2053
ROC curve saved to .././____________optune_results/96/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/96/plot_loss_curves.jpg
Prediction distribution: {0: 258103, 1: 4041}
ROC curve saved to .././____________optune_results/96/visualize_predictions.jpg
Prediction distribution: {0: 201874, 1: 60242, 2: 28}
ROC curve saved to .././____________optune_results/96/visualize_predictions.jpg
Prediction distribution: {0: 262142, 1: 2}
ROC curve saved to .././____________optune_results/96/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/96/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/96/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.34959026001329024, 1: 0.8827911971989583, 2: 156.49998756249843, 3: 2874.123343992691}
Final class weights used in loss: [0.41359041573954564, 0.8827911971989583, 156.49998756249843, 2874.123343992691, 1.0]

Epoch 1/10
Train Loss: 1.6543
Confusion Matrix:
 [[ 638799  130598  219360 3746721  448280]
 [ 147985   85167   72720  971010   84294]
 [    820     188     555    1559     177]
 [    737      16     346    3251      66]
 [     81       0       0     870       0]]
Class 0 F1: 0.2139
Class 1 F1: 0.1080
Class 2 F1: 0.0037
Class 3 F1: 0.0014
Class 4 F1: 0.0000
Class 0 Precision: 0.8102
Class 1 Precision: 0.3943
Class 2 Precision: 0.0019
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.1232
Class 1 Recall: 0.0626
Class 2 Recall: 0.1682
Class 3 Recall: 0.7362
Class 4 Recall: 0.0000
Validation Accuracy: 0.1110
Macro F1 Score: 0.0654
xView2 Score: 0.1220
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.6056
Confusion Matrix:
 [[1816131  283946  299114 2605478  179089]
 [ 281593  173040   87835  787447   31261]
 [    949      11     926    1397      16]
 [   1804      48     276    2279       9]
 [      6       0       9     936       0]]
Class 0 F1: 0.4986
Class 1 F1: 0.1903
Class 2 F1: 0.0047
Class 3 F1: 0.0013
Class 4 F1: 0.0000
Class 0 Precision: 0.8646
Class 1 Precision: 0.3786
Class 2 Precision: 0.0024
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.3504
Class 1 Recall: 0.1271
Class 2 Recall: 0.2807
Class 3 Recall: 0.5161
Class 4 Recall: 0.0000
Validation Accuracy: 0.3040
Macro F1 Score: 0.1390
xView2 Score: 0.1470
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.5823
Confusion Matrix:
 [[3093425  380445  262663 1377578   69647]
 [ 444135  280252   99390  526730   10669]
 [   1721     147     628     734      69]
 [   1284      84      52    2986      10]
 [    416      21       1     513       0]]
Class 0 F1: 0.7091
Class 1 F1: 0.2772
Class 2 F1: 0.0034
Class 3 F1: 0.0031
Class 4 F1: 0.0000
Class 0 Precision: 0.8736
Class 1 Precision: 0.4240
Class 2 Precision: 0.0017
Class 3 Precision: 0.0016
Class 4 Precision: 0.0000
Class 0 Recall: 0.5968
Class 1 Recall: 0.2059
Class 2 Recall: 0.1904
Class 3 Recall: 0.6762
Class 4 Recall: 0.0000
Validation Accuracy: 0.5153
Macro F1 Score: 0.1986
xView2 Score: 0.1773
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.5443
Confusion Matrix:
 [[3711226  488941  227200  734342   22049]
 [ 536207  407048   75889  339846    2186]
 [   1172     993     837     297       0]
 [   1379     472      25    2540       0]
 [    652       0      28     271       0]]
Class 0 F1: 0.7867
Class 1 F1: 0.3604
Class 2 F1: 0.0054
Class 3 F1: 0.0047
Class 4 F1: 0.0000
Class 0 Precision: 0.8731
Class 1 Precision: 0.4536
Class 2 Precision: 0.0028
Class 3 Precision: 0.0024
Class 4 Precision: 0.0000
Class 0 Recall: 0.7159
Class 1 Recall: 0.2990
Class 2 Recall: 0.2537
Class 3 Recall: 0.5752
Class 4 Recall: 0.0000
Validation Accuracy: 0.6289
Macro F1 Score: 0.2315
xView2 Score: 0.2050
Epoch 4 took:  0 hours,  1 minutes, 16 seconds

Epoch 5/10
Train Loss: 1.4995
Confusion Matrix:
 [[3912562  750380  163707  354069    3040]
 [ 529699  587462   50668  193282      65]
 [   2450     412     347      90       0]
 [   1701    1516     444     755       0]
 [     62     752       8     129       0]]
Class 0 F1: 0.8126
Class 1 F1: 0.4349
Class 2 F1: 0.0032
Class 3 F1: 0.0027
Class 4 F1: 0.0000
Class 0 Precision: 0.8799
Class 1 Precision: 0.4382
Class 2 Precision: 0.0016
Class 3 Precision: 0.0014
Class 4 Precision: 0.0000
Class 0 Recall: 0.7548
Class 1 Recall: 0.4316
Class 2 Recall: 0.1052
Class 3 Recall: 0.1710
Class 4 Recall: 0.0000
Validation Accuracy: 0.6868
Macro F1 Score: 0.2507
xView2 Score: 0.2314
Epoch 5 took:  0 hours,  0 minutes, 52 seconds

Epoch 6/10
Train Loss: 1.4583
Confusion Matrix:
 [[4216339  699785   86225  181013     396]
 [ 619640  600856   32596  108081       3]
 [   2291     444     538      26       0]
 [   2899    1480      11      26       0]
 [    869      42       0      40       0]]
Class 0 F1: 0.8411
Class 1 F1: 0.4511
Class 2 F1: 0.0088
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.8708
Class 1 Precision: 0.4613
Class 2 Precision: 0.0045
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.8134
Class 1 Recall: 0.4414
Class 2 Recall: 0.1631
Class 3 Recall: 0.0059
Class 4 Recall: 0.0000
Validation Accuracy: 0.7351
Macro F1 Score: 0.2602
xView2 Score: 0.2348
Epoch 6 took:  0 hours,  0 minutes, 35 seconds

Epoch 7/10
Train Loss: 1.4402
Confusion Matrix:
 [[4187782  855079   69930   70967       0]
 [ 566249  724521   19461   50945       0]
 [   2779     486      34       0       0]
 [   2569    1065     780       2       0]
 [     24     863      23      41       0]]
Class 0 F1: 0.8423
Class 1 F1: 0.4923
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8799
Class 1 Precision: 0.4580
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8079
Class 1 Recall: 0.5323
Class 2 Recall: 0.0103
Class 3 Recall: 0.0005
Class 4 Recall: 0.0000
Validation Accuracy: 0.7496
Macro F1 Score: 0.2671
xView2 Score: 0.2489
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.3838
Confusion Matrix:
 [[4101467 1035901   25517   20873       0]
 [ 477611  853929    9845   19791       0]
 [   2068    1231       0       0       0]
 [   1014    3402       0       0       0]
 [     68     854       0      29       0]]
Class 0 F1: 0.8399
Class 1 F1: 0.5244
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8951
Class 1 Precision: 0.4505
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7912
Class 1 Recall: 0.6273
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7561
Macro F1 Score: 0.2729
xView2 Score: 0.2673
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.3757
Confusion Matrix:
 [[4272537  883990   16148   11083       0]
 [ 571303  771894    6393   11586       0]
 [   2543     747       9       0       0]
 [   3051    1277      58      30       0]
 [    226     725       0       0       0]]
Class 0 F1: 0.8517
Class 1 F1: 0.5112
Class 2 F1: 0.0007
Class 3 F1: 0.0022
Class 4 F1: 0.0000
Class 0 Precision: 0.8810
Class 1 Precision: 0.4654
Class 2 Precision: 0.0004
Class 3 Precision: 0.0013
Class 4 Precision: 0.0000
Class 0 Recall: 0.8242
Class 1 Recall: 0.5671
Class 2 Recall: 0.0027
Class 3 Recall: 0.0068
Class 4 Recall: 0.0000
Validation Accuracy: 0.7697
Macro F1 Score: 0.2732
xView2 Score: 0.2567
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.3256
Confusion Matrix:
 [[4258250  899542   21068    4898       0]
 [ 530158  817226    7834    5958       0]
 [   2548     738      13       0       0]
 [   1676    2708      32       0       0]
 [     73     878       0       0       0]]
Class 0 F1: 0.8537
Class 1 F1: 0.5303
Class 2 F1: 0.0008
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8885
Class 1 Precision: 0.4748
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8215
Class 1 Recall: 0.6004
Class 2 Recall: 0.0039
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7745
Macro F1 Score: 0.2769
xView2 Score: 0.2653
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7561
Best Macro F1: 0.2729
Best xView2 Score: 0.2673
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8951
Class 1 Precision: 0.4505
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2691
ROC curve saved to .././____________optune_results/97/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/97/plot_loss_curves.jpg
Prediction distribution: {0: 162241, 1: 97771, 2: 558, 3: 1574}
ROC curve saved to .././____________optune_results/97/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/97/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/97/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/97/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/97/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27053407902905474, 1: 0.7714397908888786, 2: 165.57007796309088, 3: 907.5306166606563, 4: 5292.497160883281}
Final class weights used in loss: [2.168632414094189, 0.7714397908888786, 165.57007796309088, 907.5306166606563, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6051
Confusion Matrix:
 [[1992250  992384  120572  253109 1217550]
 [ 645973  563710   55122  126814  571956]
 [   4028    4490     292     922    3369]
 [    760     190       0      92      17]
 [      0       0       0       0       0]]
Class 0 F1: 0.5520
Class 1 F1: 0.3199
Class 2 F1: 0.0031
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7538
Class 1 Precision: 0.3612
Class 2 Precision: 0.0017
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.4354
Class 1 Recall: 0.2871
Class 2 Recall: 0.0223
Class 3 Recall: 0.0869
Class 4 Recall: 0.0000
Validation Accuracy: 0.3901
Macro F1 Score: 0.1751
xView2 Score: 0.1989
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4971
Confusion Matrix:
 [[3759913  320047   46945   68857  380103]
 [1420342  244620   24464   40889  233260]
 [   6929    2227     732      65    3148]
 [   1042      17       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7702
Class 1 F1: 0.1933
Class 2 F1: 0.0172
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7247
Class 1 Precision: 0.4315
Class 2 Precision: 0.0101
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8217
Class 1 Recall: 0.1246
Class 2 Recall: 0.0559
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6112
Macro F1 Score: 0.1961
xView2 Score: 0.1349
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4135
Confusion Matrix:
 [[4354363  123315   11646    7079   79462]
 [1818305   86668    5039    3930   49633]
 [  11365     765     313       0     658]
 [   1058       1       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8093
Class 1 F1: 0.0797
Class 2 F1: 0.0208
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7040
Class 1 Precision: 0.4112
Class 2 Precision: 0.0184
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9516
Class 1 Recall: 0.0441
Class 2 Recall: 0.0239
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6777
Macro F1 Score: 0.1820
xView2 Score: 0.0542
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.3241
Confusion Matrix:
 [[4487149   74548    3031    1448    9689]
 [1901007   53952    1744     990    5882]
 [  12348     710      28       0      15]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8175
Class 1 F1: 0.0516
Class 2 F1: 0.0031
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7009
Class 1 Precision: 0.4176
Class 2 Precision: 0.0058
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9806
Class 1 Recall: 0.0275
Class 2 Recall: 0.0021
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6929
Macro F1 Score: 0.1744
xView2 Score: 0.0259
Epoch 4 took:  0 hours,  1 minutes, 12 seconds

Epoch 5/10
Train Loss: 1.2415
Confusion Matrix:
 [[4567506    7740     218      59     342]
 [1958350    4616     119      74     416]
 [  13100       0       1       0       0]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8218
Class 1 F1: 0.0047
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6984
Class 1 Precision: 0.3736
Class 2 Precision: 0.0030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9982
Class 1 Recall: 0.0024
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6977
Macro F1 Score: 0.1653
xView2 Score: 0.0023
Epoch 5 took:  0 hours,  0 minutes, 44 seconds

Epoch 6/10
Train Loss: 1.1627
Confusion Matrix:
 [[4574038    1819       2       0       6]
 [1961936    1618       3       0      18]
 [  13101       0       0       0       0]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8222
Class 1 F1: 0.0016
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6983
Class 1 Precision: 0.4708
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0008
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6982
Macro F1 Score: 0.1648
xView2 Score: 0.0007
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.0800
Confusion Matrix:
 [[4575171     694       0       0       0]
 [1963219     356       0       0       0]
 [  13101       0       0       0       0]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8223
Class 1 F1: 0.0004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6982
Class 1 Precision: 0.3390
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6982
Macro F1 Score: 0.2057
xView2 Score: 0.0002
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0220
Confusion Matrix:
 [[4575836      29       0       0       0]
 [1963453     122       0       0       0]
 [  13101       0       0       0       0]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8223
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6982
Class 1 Precision: 0.8079
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6982
Macro F1 Score: 0.2056
xView2 Score: 0.0001
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9904
Confusion Matrix:
 [[4575863       2       0       0       0]
 [1963575       0       0       0       0]
 [  13101       0       0       0       0]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8223
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6982
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6982
Macro F1 Score: 0.2056
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9344
Confusion Matrix:
 [[4575865       0       0       0       0]
 [1963575       0       0       0       0]
 [  13101       0       0       0       0]
 [   1059       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8223
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6982
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6982
Macro F1 Score: 0.2056
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3901
Best Macro F1: 0.1751
Best xView2 Score: 0.1989
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7538
Class 1 Precision: 0.3612
Class 2 Precision: 0.0017
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Macro Precision: 0.2234
ROC curve saved to .././____________optune_results/98/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/98/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/98/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/98/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/98/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/98/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/98/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2689697662337551, 1: 0.784783586600832, 2: 140.3559620747351, 3: 1362.1555615696889, 4: 68947.46301369862}
Final class weights used in loss: [4.08935814847308, 0.784783586600832, 140.3559620747351, 1362.1555615696889, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6230
Confusion Matrix:
 [[ 889108 1292962  116864 2142384   26344]
 [ 278273 1035991   49515  698825   11906]
 [    614    4395     262    2369       0]
 [    705     322      71    1795      17]
 [    127     143       0     608       0]]
Class 0 F1: 0.3155
Class 1 F1: 0.4700
Class 2 F1: 0.0030
Class 3 F1: 0.0013
Class 4 F1: 0.0000
Class 0 Precision: 0.7607
Class 1 Precision: 0.4439
Class 2 Precision: 0.0016
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Class 0 Recall: 0.1990
Class 1 Recall: 0.4994
Class 2 Recall: 0.0343
Class 3 Recall: 0.6168
Class 4 Recall: 0.0000
Validation Accuracy: 0.2941
Macro F1 Score: 0.1580
xView2 Score: 0.2402
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5102
Confusion Matrix:
 [[2830464  561056   99036  970961    6145]
 [1140468  502665   42965  384212    4200]
 [   4915     884     507    1280      54]
 [   1362     423     102    1015       8]
 [    826       0       0      52       0]]
Class 0 F1: 0.6703
Class 1 F1: 0.3202
Class 2 F1: 0.0067
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.7115
Class 1 Precision: 0.4720
Class 2 Precision: 0.0036
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.6335
Class 1 Recall: 0.2423
Class 2 Recall: 0.0664
Class 3 Recall: 0.3488
Class 4 Recall: 0.0000
Validation Accuracy: 0.5088
Macro F1 Score: 0.1997
xView2 Score: 0.1789
Epoch 2 took:  0 hours,  1 minutes, 14 seconds

Epoch 3/10
Train Loss: 1.4078
Confusion Matrix:
 [[4107258  145832   14992  199092     488]
 [1809424  153979    7151  103629     327]
 [   6205     333     930     172       0]
 [   2901       0       0       9       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.7903
Class 1 F1: 0.1297
Class 2 F1: 0.0606
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.6930
Class 1 Precision: 0.5130
Class 2 Precision: 0.0403
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9193
Class 1 Recall: 0.0742
Class 2 Recall: 0.1217
Class 3 Recall: 0.0031
Class 4 Recall: 0.0000
Validation Accuracy: 0.6504
Macro F1 Score: 0.1961
xView2 Score: 0.0949
Epoch 3 took:  0 hours,  0 minutes, 51 seconds

Epoch 4/10
Train Loss: 1.3065
Confusion Matrix:
 [[4397777   35518    1589   32738      40]
 [2010490   39887    1288   22835      10]
 [   7638       2       0       0       0]
 [   2909       0       0       1       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8079
Class 1 F1: 0.0371
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6850
Class 1 Precision: 0.5290
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9844
Class 1 Recall: 0.0192
Class 2 Recall: 0.0000
Class 3 Recall: 0.0003
Class 4 Recall: 0.0000
Validation Accuracy: 0.6771
Macro F1 Score: 0.1690
xView2 Score: 0.0226
Epoch 4 took:  0 hours,  0 minutes, 34 seconds

Epoch 5/10
Train Loss: 1.2039
Confusion Matrix:
 [[4459775    4595      69    3223       0]
 [2066236    5494      92    2688       0]
 [   7413       0       0     227       0]
 [   2910       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8105
Class 1 F1: 0.0053
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6822
Class 1 Precision: 0.5446
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9982
Class 1 Recall: 0.0026
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6813
Macro F1 Score: 0.1632
xView2 Score: 0.0032
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.1188
Confusion Matrix:
 [[4467234     235       0     193       0]
 [2073583     609       0     318       0]
 [   7640       0       0       0       0]
 [   2910       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8108
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6818
Class 1 Precision: 0.7216
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6817
Macro F1 Score: 0.1623
xView2 Score: 0.0003
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0135
Confusion Matrix:
 [[4467647       6       0       9       0]
 [2074486      12       0      12       0]
 [   7640       0       0       0       0]
 [   2910       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8107
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6817
Class 1 Precision: 0.6667
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6817
Macro F1 Score: 0.1621
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9471
Confusion Matrix:
 [[4467662       0       0       0       0]
 [2074510       0       0       0       0]
 [   7640       0       0       0       0]
 [   2910       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8107
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6817
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6817
Macro F1 Score: 0.1621
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8889
Confusion Matrix:
 [[4467662       0       0       0       0]
 [2074510       0       0       0       0]
 [   7640       0       0       0       0]
 [   2910       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8107
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6817
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6817
Macro F1 Score: 0.1621
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8445
Confusion Matrix:
 [[4467662       0       0       0       0]
 [2074510       0       0       0       0]
 [   7640       0       0       0       0]
 [   2910       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8107
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6817
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6817
Macro F1 Score: 0.1621
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2941
Best Macro F1: 0.1580
Best xView2 Score: 0.2402
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7607
Class 1 Precision: 0.4439
Class 2 Precision: 0.0016
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Macro Precision: 0.2414
ROC curve saved to .././____________optune_results/99/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/99/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/99/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/99/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/99/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/99/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/99/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27305454868593615, 1: 0.7524010194528088, 2: 139.46534401064037, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [5.009834627127327, 0.7524010194528088, 139.46534401064037, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5473
Confusion Matrix:
 [[3499981  424906   12291  547544  262875]
 [1229311  193222    2839  245502  127608]
 [   5806     504       0     561     540]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7382
Class 1 F1: 0.1599
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7391
Class 1 Precision: 0.3123
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7372
Class 1 Recall: 0.1074
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5635
Macro F1 Score: 0.1796
xView2 Score: 0.1216
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4364
Confusion Matrix:
 [[4630786   44627    1187   34467   36530]
 [1717546   32122     500   25449   22865]
 [   6914     135       0     316      46]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8342
Class 1 F1: 0.0343
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7286
Class 1 Precision: 0.4178
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9754
Class 1 Recall: 0.0179
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7115
Macro F1 Score: 0.1737
xView2 Score: 0.0293
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.3339
Confusion Matrix:
 [[4740648    2407      15    1474    3053]
 [1793421    2154      16    1183    1708]
 [   7408       3       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8399
Class 1 F1: 0.0024
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7247
Class 1 Precision: 0.4720
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9985
Class 1 Recall: 0.0012
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7237
Macro F1 Score: 0.1684
xView2 Score: 0.0020
Epoch 3 took:  0 hours,  1 minutes,  7 seconds

Epoch 4/10
Train Loss: 1.2271
Confusion Matrix:
 [[4747001     249       0     172     175]
 [1798234     115       0      55      78]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.3159
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.1681
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 36 seconds

Epoch 5/10
Train Loss: 1.1244
Confusion Matrix:
 [[4747587       4       0       6       0]
 [1798481       0       0       1       0]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.2100
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0233
Confusion Matrix:
 [[4747597       0       0       0       0]
 [1798482       0       0       0       0]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.2100
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 0.9359
Confusion Matrix:
 [[4747597       0       0       0       0]
 [1798482       0       0       0       0]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.2100
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.8642
Confusion Matrix:
 [[4747597       0       0       0       0]
 [1798482       0       0       0       0]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.2100
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8129
Confusion Matrix:
 [[4747597       0       0       0       0]
 [1798482       0       0       0       0]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.2100
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.7378
Confusion Matrix:
 [[4747597       0       0       0       0]
 [1798482       0       0       0       0]
 [   7411       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8402
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7244
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7244
Macro F1 Score: 0.2100
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5635
Best Macro F1: 0.1796
Best xView2 Score: 0.1216
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7391
Class 1 Precision: 0.3123
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2103
ROC curve saved to .././____________optune_results/100/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/100/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/100/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/100/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/100/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/100/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/100/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2747954238805838, 1: 0.7398173785393546, 2: 129.1482294981012, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [4.405152609098423, 0.7398173785393546, 129.1482294981012, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6527
Confusion Matrix:
 [[ 933933  147852  236475 3123589  422523]
 [ 210843   87077  129280 1049182  208318]
 [     91     604     158    2928     747]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3108
Class 1 F1: 0.0907
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8158
Class 1 Precision: 0.3697
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1920
Class 1 Recall: 0.0517
Class 2 Recall: 0.0349
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1558
Macro F1 Score: 0.0805
xView2 Score: 0.1390
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.5248
Confusion Matrix:
 [[3685625   64951   73256  911686  128854]
 [1007809   71996   62712  450854   91329]
 [   1522     462     326    1637     581]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7711
Class 1 F1: 0.0790
Class 2 F1: 0.0046
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7850
Class 1 Precision: 0.5240
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7577
Class 1 Recall: 0.0427
Class 2 Recall: 0.0720
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5734
Macro F1 Score: 0.1710
xView2 Score: 0.1278
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.4010
Confusion Matrix:
 [[4744534    8348    4890   89451   17149]
 [1573076   14453    5324   74543   17304]
 [   4500       0       2      26       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8483
Class 1 F1: 0.0169
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7505
Class 1 Precision: 0.6339
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9754
Class 1 Recall: 0.0086
Class 2 Recall: 0.0004
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7262
Macro F1 Score: 0.1731
xView2 Score: 0.0373
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.2895
Confusion Matrix:
 [[4846299    3614     417   11592    2450]
 [1658761    9188     565   12643    3543]
 [   4475      51       0       0       2]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8522
Class 1 F1: 0.0108
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7445
Class 1 Precision: 0.7149
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9963
Class 1 Recall: 0.0055
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7409
Macro F1 Score: 0.1726
xView2 Score: 0.0105
Epoch 4 took:  0 hours,  1 minutes,  0 seconds

Epoch 5/10
Train Loss: 1.1683
Confusion Matrix:
 [[4862743     243      19    1339      28]
 [1682174    1379      15    1065      67]
 [   4528       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8521
Class 1 F1: 0.0016
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7425
Class 1 Precision: 0.8502
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0008
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.1707
xView2 Score: 0.0011
Epoch 5 took:  0 hours,  0 minutes, 37 seconds

Epoch 6/10
Train Loss: 1.0626
Confusion Matrix:
 [[4864362       0       0      10       0]
 [1684604      16       0      80       0]
 [   4528       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8521
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7423
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.2130
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 0.9899
Confusion Matrix:
 [[4864372       0       0       0       0]
 [1684700       0       0       0       0]
 [   4528       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8521
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7422
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.2840
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9179
Confusion Matrix:
 [[4864372       0       0       0       0]
 [1684700       0       0       0       0]
 [   4528       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8521
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7422
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.2840
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8272
Confusion Matrix:
 [[4864372       0       0       0       0]
 [1684700       0       0       0       0]
 [   4528       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8521
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7422
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.2840
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.7867
Confusion Matrix:
 [[4864372       0       0       0       0]
 [1684700       0       0       0       0]
 [   4528       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8521
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7422
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.2840
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1558
Best Macro F1: 0.0805
Best xView2 Score: 0.1390
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8158
Class 1 Precision: 0.3697
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2372
ROC curve saved to .././____________optune_results/101/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/101/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/101/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/101/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/101/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/101/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/101/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27200281278340016, 1: 0.7595459714747235, 2: 165.96316153922248, 3: 1286.9252876502173, 4: 5292.497160883281}
Final class weights used in loss: [2.7923187915547287, 0.7595459714747235, 165.96316153922248, 1286.9252876502173, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5518
Confusion Matrix:
 [[2647298  179589   62025 1759498   27914]
 [ 708921   37597   16221 1096842    1828]
 [   4572      22       8    8570       1]
 [   2310       0       0     384       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6586
Class 1 F1: 0.0362
Class 2 F1: 0.0002
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.7872
Class 1 Precision: 0.1731
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.5661
Class 1 Recall: 0.0202
Class 2 Recall: 0.0006
Class 3 Recall: 0.1425
Class 4 Recall: 0.0000
Validation Accuracy: 0.4097
Macro F1 Score: 0.1390
xView2 Score: 0.1432
Epoch 1 took:  0 hours,  1 minutes, 16 seconds

Epoch 2/10
Train Loss: 1.4509
Confusion Matrix:
 [[4107894   48307   17197  501424    1502]
 [1481140   16646    7758  355672     193]
 [   9952      29     124    3042      26]
 [   2641       0       0      53       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7994
Class 1 F1: 0.0173
Class 2 F1: 0.0065
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7333
Class 1 Precision: 0.2562
Class 2 Precision: 0.0049
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.8784
Class 1 Recall: 0.0089
Class 2 Recall: 0.0094
Class 3 Recall: 0.0197
Class 4 Recall: 0.0000
Validation Accuracy: 0.6294
Macro F1 Score: 0.1646
xView2 Score: 0.0855
Epoch 2 took:  0 hours,  0 minutes, 51 seconds

Epoch 3/10
Train Loss: 1.3588
Confusion Matrix:
 [[4605486    4255    2231   64296      56]
 [1806100    1779    1421   52096      13]
 [  13155       0       0      18       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8295
Class 1 F1: 0.0019
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7165
Class 1 Precision: 0.2948
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9849
Class 1 Recall: 0.0010
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7030
Macro F1 Score: 0.1663
xView2 Score: 0.0168
Epoch 3 took:  0 hours,  0 minutes, 28 seconds

Epoch 4/10
Train Loss: 1.2654
Confusion Matrix:
 [[4665154     787      91   10284       8]
 [1850457     434     137   10381       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8325
Class 1 F1: 0.0005
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7143
Class 1 Precision: 0.3554
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9976
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7119
Macro F1 Score: 0.1666
xView2 Score: 0.0035
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1795
Confusion Matrix:
 [[4675423       7       0     893       1]
 [1860268      70       0    1071       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8328
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 0.9091
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7134
Macro F1 Score: 0.1666
xView2 Score: 0.0004
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0974
Confusion Matrix:
 [[4676291       0       0      33       0]
 [1861371      12       0      26       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8328
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7135
Macro F1 Score: 0.2082
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0328
Confusion Matrix:
 [[4676324       0       0       0       0]
 [1861409       0       0       0       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8328
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7136
Macro F1 Score: 0.2082
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9714
Confusion Matrix:
 [[4676324       0       0       0       0]
 [1861409       0       0       0       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8328
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7136
Macro F1 Score: 0.2082
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9263
Confusion Matrix:
 [[4676324       0       0       0       0]
 [1861409       0       0       0       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8328
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7136
Macro F1 Score: 0.2082
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8889
Confusion Matrix:
 [[4676324       0       0       0       0]
 [1861409       0       0       0       0]
 [  13173       0       0       0       0]
 [   2694       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8328
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7136
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7136
Macro F1 Score: 0.2082
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4097
Best Macro F1: 0.1390
Best xView2 Score: 0.1432
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7872
Class 1 Precision: 0.1731
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.1921
ROC curve saved to .././____________optune_results/102/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/102/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/102/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/102/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/102/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/102/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/102/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27156974746243295, 1: 0.7636346422975107, 2: 149.28562360966927, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [2.226395432748671, 0.7636346422975107, 149.28562360966927, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5158
Confusion Matrix:
 [[2512567   42675    1610 2089941      23]
 [1053458   33004    1493  808921      13]
 [   6353     184       0    3248       0]
 [     16       0       0      94       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6114
Class 1 F1: 0.0335
Class 2 F1: 0.0000
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7033
Class 1 Precision: 0.4350
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5407
Class 1 Recall: 0.0174
Class 2 Recall: 0.0000
Class 3 Recall: 0.8545
Class 4 Recall: 0.0000
Validation Accuracy: 0.3884
Macro F1 Score: 0.1290
xView2 Score: 0.1088
Epoch 1 took:  0 hours,  0 minutes, 32 seconds

Epoch 2/10
Train Loss: 1.4198
Confusion Matrix:
 [[3934137    8945     477  703257       0]
 [1588156   11073     392  297268       0]
 [   8401       7       0    1377       0]
 [     94       0       0      16       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7731
Class 1 F1: 0.0116
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7113
Class 1 Precision: 0.5530
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8466
Class 1 Recall: 0.0058
Class 2 Recall: 0.0000
Class 3 Recall: 0.1455
Class 4 Recall: 0.0000
Validation Accuracy: 0.6020
Macro F1 Score: 0.1962
xView2 Score: 0.0656
Epoch 2 took:  0 hours,  0 minutes, 26 seconds

Epoch 3/10
Train Loss: 1.3372
Confusion Matrix:
 [[4528017    1375       6  117418       0]
 [1846780    1848       2   48259       0]
 [   9600       0       0     185       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8209
Class 1 F1: 0.0019
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7092
Class 1 Precision: 0.5734
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9744
Class 1 Recall: 0.0010
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6912
Macro F1 Score: 0.2057
xView2 Score: 0.0149
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.2545
Confusion Matrix:
 [[4633229     867       0   12720       0]
 [1883463    1702       0   11724       0]
 [   9782       0       0       3       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8293
Class 1 F1: 0.0018
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7099
Class 1 Precision: 0.6625
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9971
Class 1 Recall: 0.0009
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.2078
xView2 Score: 0.0045
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1828
Confusion Matrix:
 [[4642859     261       0    3696       0]
 [1892892     664       0    3333       0]
 [   9785       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8296
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7093
Class 1 Precision: 0.7178
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9991
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.2076
xView2 Score: 0.0014
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1035
Confusion Matrix:
 [[4646675       3       0     138       0]
 [1896686      52       0     151       0]
 [   9785       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8298
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7091
Class 1 Precision: 0.9455
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7090
Macro F1 Score: 0.2075
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0438
Confusion Matrix:
 [[4646797       2       0      17       0]
 [1896854      10       0      25       0]
 [   9785       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8298
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7091
Class 1 Precision: 0.8333
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7090
Macro F1 Score: 0.2074
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0164
Confusion Matrix:
 [[4646816       0       0       0       0]
 [1896889       0       0       0       0]
 [   9785       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8298
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7090
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7090
Macro F1 Score: 0.2074
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9455
Confusion Matrix:
 [[4646816       0       0       0       0]
 [1896889       0       0       0       0]
 [   9785       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8298
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7090
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7090
Macro F1 Score: 0.2074
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9104
Confusion Matrix:
 [[4646816       0       0       0       0]
 [1896889       0       0       0       0]
 [   9785       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8298
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7090
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7090
Macro F1 Score: 0.2074
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3884
Best Macro F1: 0.1290
Best xView2 Score: 0.1088
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7033
Class 1 Precision: 0.4350
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2277
ROC curve saved to .././____________optune_results/103/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/103/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/103/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/103/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/103/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/103/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/103/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27147509385217233, 1: 0.7645869155556366, 2: 137.8911481877209, 3: 910.3209983722193, 4: 5732.533940774488}
Final class weights used in loss: [0.7952322794171578, 0.7645869155556366, 137.8911481877209, 910.3209983722193, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6095
Confusion Matrix:
 [[2576819   32313   46447 1184974  799801]
 [1016469   21937   16101  596068  254523]
 [   4902       0       3    1944     150]
 [    919       0       0      97      60]
 [     47       0       0       1      25]]
Class 0 F1: 0.6255
Class 1 F1: 0.0224
Class 2 F1: 0.0001
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7160
Class 1 Precision: 0.4044
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.5553
Class 1 Recall: 0.0115
Class 2 Recall: 0.0004
Class 3 Recall: 0.0901
Class 4 Recall: 0.3425
Validation Accuracy: 0.3966
Macro F1 Score: 0.1296
xView2 Score: 0.1131
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5564
Confusion Matrix:
 [[3961891   31764   20399  399258  227042]
 [1566282   21170    9685  216294   91667]
 [   6492       0       8     492       7]
 [   1023       0       0      53       0]
 [     60       0       0      13       0]]
Class 0 F1: 0.7787
Class 1 F1: 0.0216
Class 2 F1: 0.0004
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.7157
Class 1 Precision: 0.3999
Class 2 Precision: 0.0003
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.8538
Class 1 Recall: 0.0111
Class 2 Recall: 0.0011
Class 3 Recall: 0.0493
Class 4 Recall: 0.0000
Validation Accuracy: 0.6078
Macro F1 Score: 0.1602
xView2 Score: 0.0728
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.5080
Confusion Matrix:
 [[4496158   17202    4747   85697   36550]
 [1815080   14908    2965   55422   16723]
 [   6637       0       7     355       0]
 [   1076       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8205
Class 1 F1: 0.0154
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7115
Class 1 Precision: 0.4643
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9689
Class 1 Recall: 0.0078
Class 2 Recall: 0.0010
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6883
Macro F1 Score: 0.1674
xView2 Score: 0.0276
Epoch 3 took:  0 hours,  1 minutes, 17 seconds

Epoch 4/10
Train Loss: 1.4493
Confusion Matrix:
 [[4581936   33500    1366   17232    6320]
 [1864822   25074    1165   10771    3266]
 [   6999       0       0       0       0]
 [   1076       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8259
Class 1 F1: 0.0255
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7098
Class 1 Precision: 0.4281
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9874
Class 1 Recall: 0.0132
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7030
Macro F1 Score: 0.1703
xView2 Score: 0.0156
Epoch 4 took:  0 hours,  1 minutes,  9 seconds

Epoch 5/10
Train Loss: 1.3999
Confusion Matrix:
 [[4597293   36596     218    5838     409]
 [1870630   30493     471    3314     190]
 [   6990       5       0       4       0]
 [   1076       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8271
Class 1 F1: 0.0309
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7099
Class 1 Precision: 0.4545
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9907
Class 1 Recall: 0.0160
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7061
Macro F1 Score: 0.1716
xView2 Score: 0.0148
Epoch 5 took:  0 hours,  0 minutes, 43 seconds

Epoch 6/10
Train Loss: 1.3471
Confusion Matrix:
 [[4597436   40981      17    1898      22]
 [1873172   31452      50     422       2]
 [   6992       7       0       0       0]
 [   1076       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8269
Class 1 F1: 0.0318
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7096
Class 1 Precision: 0.4342
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9908
Class 1 Recall: 0.0165
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7063
Macro F1 Score: 0.1718
xView2 Score: 0.0142
Epoch 6 took:  0 hours,  0 minutes, 31 seconds

Epoch 7/10
Train Loss: 1.2857
Confusion Matrix:
 [[4585149   55109       5      91       0]
 [1855737   49307       3      51       0]
 [   6999       0       0       0       0]
 [   1076       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8269
Class 1 F1: 0.0491
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7110
Class 1 Precision: 0.4722
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9881
Class 1 Recall: 0.0259
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7072
Macro F1 Score: 0.1752
xView2 Score: 0.0217
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.2381
Confusion Matrix:
 [[4574449   65905       0       0       0]
 [1835192   69906       0       0       0]
 [   6906      93       0       0       0]
 [   1036      40       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8274
Class 1 F1: 0.0685
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7128
Class 1 Precision: 0.5142
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9858
Class 1 Recall: 0.0367
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7087
Macro F1 Score: 0.1792
xView2 Score: 0.0304
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2284
Confusion Matrix:
 [[4587319   53035       0       0       0]
 [1848099   56999       0       0       0]
 [   6998       1       0       0       0]
 [   1076       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8277
Class 1 F1: 0.0566
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7119
Class 1 Precision: 0.5180
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9886
Class 1 Recall: 0.0299
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7087
Macro F1 Score: 0.1769
xView2 Score: 0.0250
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1912
Confusion Matrix:
 [[4506722  133632       0       0       0]
 [1772570  132528       0       0       0]
 [   6923      76       0       0       0]
 [   1067       9       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8248
Class 1 F1: 0.1221
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7168
Class 1 Precision: 0.4978
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9712
Class 1 Recall: 0.0696
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7079
Macro F1 Score: 0.1894
xView2 Score: 0.0547
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3966
Best Macro F1: 0.1296
Best xView2 Score: 0.1131
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7160
Class 1 Precision: 0.4044
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.2241
ROC curve saved to .././____________optune_results/104/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/104/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/104/visualize_predictions.jpg
Prediction distribution: {0: 251489, 1: 10655}
ROC curve saved to .././____________optune_results/104/visualize_predictions.jpg
Prediction distribution: {0: 256456, 1: 5688}
ROC curve saved to .././____________optune_results/104/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/104/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/104/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.26961306836516447, 1: 0.7775059882838797, 2: 296.9068428504011, 3: 784.4708229426434, 4: 5732.533940774488}
Final class weights used in loss: [0.5873209658118059, 0.7775059882838797, 296.9068428504011, 784.4708229426434, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5780
Confusion Matrix:
 [[2403218   23080 1527656  533876   24481]
 [1031040   12330  630782  330963    9364]
 [  15212      42    8492    2762      40]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.6037
Class 1 F1: 0.0120
Class 2 F1: 0.0077
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6966
Class 1 Precision: 0.3478
Class 2 Precision: 0.0039
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5326
Class 1 Recall: 0.0061
Class 2 Recall: 0.3199
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3699
Macro F1 Score: 0.1247
xView2 Score: 0.1213
Epoch 1 took:  0 hours,  1 minutes, 18 seconds

Epoch 2/10
Train Loss: 1.5294
Confusion Matrix:
 [[3469890   43848  785902  206832    5839]
 [1492149   26345  353372  140474    2139]
 [  22689     362    2426     979      92]
 [    185       0       0       4       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7307
Class 1 F1: 0.0253
Class 2 F1: 0.0042
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6961
Class 1 Precision: 0.3734
Class 2 Precision: 0.0021
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7690
Class 1 Recall: 0.0131
Class 2 Recall: 0.0914
Class 3 Recall: 0.0212
Class 4 Recall: 0.0000
Validation Accuracy: 0.5339
Macro F1 Score: 0.1520
xView2 Score: 0.0929
Epoch 2 took:  0 hours,  1 minutes,  9 seconds

Epoch 3/10
Train Loss: 1.4904
Confusion Matrix:
 [[4099846   51975  274696   84725    1069]
 [1796064   32253  130721   54960     481]
 [  24954     375     460     722      37]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7859
Class 1 F1: 0.0307
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6924
Class 1 Precision: 0.3812
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9086
Class 1 Recall: 0.0160
Class 2 Recall: 0.0173
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6306
Macro F1 Score: 0.1638
xView2 Score: 0.0546
Epoch 3 took:  0 hours,  0 minutes, 45 seconds

Epoch 4/10
Train Loss: 1.4560
Confusion Matrix:
 [[4160449  131285  165159   55249     169]
 [1794303   96673   89077   34273     153]
 [  24289     379    1630     245       5]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7931
Class 1 F1: 0.0862
Class 2 F1: 0.0115
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6958
Class 1 Precision: 0.4234
Class 2 Precision: 0.0064
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9220
Class 1 Recall: 0.0480
Class 2 Recall: 0.0614
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6498
Macro F1 Score: 0.1782
xView2 Score: 0.0677
Epoch 4 took:  0 hours,  0 minutes, 34 seconds

Epoch 5/10
Train Loss: 1.4038
Confusion Matrix:
 [[4232669  175187   90205   14229      21]
 [1793390  155926   55829    9312      22]
 [  24526    1739     205      78       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8014
Class 1 F1: 0.1329
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6995
Class 1 Precision: 0.4685
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9380
Class 1 Recall: 0.0774
Class 2 Recall: 0.0077
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6697
Macro F1 Score: 0.1873
xView2 Score: 0.0734
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3565
Confusion Matrix:
 [[4220400  261734   26508    3669       0]
 [1753939  244965   13613    1962       0]
 [  24362    2019     167       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8030
Class 1 F1: 0.1942
Class 2 F1: 0.0050
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7035
Class 1 Precision: 0.4815
Class 2 Precision: 0.0041
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9353
Class 1 Recall: 0.1216
Class 2 Recall: 0.0063
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6814
Macro F1 Score: 0.2004
xView2 Score: 0.0922
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3290
Confusion Matrix:
 [[4072832  415628   22570    1281       0]
 [1619131  383680   11005     663       0]
 [  24025    2494      29       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7964
Class 1 F1: 0.2725
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7125
Class 1 Precision: 0.4785
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9026
Class 1 Recall: 0.1905
Class 2 Recall: 0.0011
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6800
Macro F1 Score: 0.2140
xView2 Score: 0.1279
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2877
Confusion Matrix:
 [[3898150  601188   11548    1425       0]
 [1467421  541491    5241     326       0]
 [  22415    4122       0      11       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7875
Class 1 F1: 0.3426
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7235
Class 1 Precision: 0.4722
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8639
Class 1 Recall: 0.2688
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6774
Macro F1 Score: 0.2260
xView2 Score: 0.1624
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2661
Confusion Matrix:
 [[3766618  740963    4710      20       0]
 [1331161  680954    2349      15       0]
 [  22660    3888       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7820
Class 1 F1: 0.3959
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7356
Class 1 Precision: 0.4776
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8347
Class 1 Recall: 0.3380
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6786
Macro F1 Score: 0.2356
xView2 Score: 0.1893
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2154
Confusion Matrix:
 [[3767364  742673    2245      29       0]
 [1294300  719052    1108      19       0]
 [  23108    3440       0       0       0]
 [    180       9       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7851
Class 1 F1: 0.4133
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7409
Class 1 Precision: 0.4908
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8349
Class 1 Recall: 0.3569
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6846
Macro F1 Score: 0.2397
xView2 Score: 0.1973
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6846
Best Macro F1: 0.2397
Best xView2 Score: 0.1973
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7409
Class 1 Precision: 0.4908
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2463
ROC curve saved to .././____________optune_results/105/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/105/plot_loss_curves.jpg
Prediction distribution: {0: 178579, 1: 83565}
ROC curve saved to .././____________optune_results/105/visualize_predictions.jpg
Prediction distribution: {0: 146757, 1: 115249, 2: 138}
ROC curve saved to .././____________optune_results/105/visualize_predictions.jpg
Prediction distribution: {0: 170641, 1: 90858, 2: 645}
ROC curve saved to .././____________optune_results/105/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/105/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/105/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27243870668113346, 1: 0.757914747095458, 2: 117.11298601577587, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [0.37043194343667113, 0.757914747095458, 117.11298601577587, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5805
Confusion Matrix:
 [[1033165 3208462  342668   15232  106403]
 [ 198147 1510547  112915    6584   18954]
 [    202     321       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3480
Class 1 F1: 0.4601
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8389
Class 1 Precision: 0.3201
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2195
Class 1 Recall: 0.8178
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3881
Macro F1 Score: 0.1616
xView2 Score: 0.2640
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5531
Confusion Matrix:
 [[1775941 2613299  264110   10307   42273]
 [ 294264 1442454   97869    4827    7733]
 [      0     517       6       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5242
Class 1 F1: 0.4887
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8579
Class 1 Precision: 0.3556
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3774
Class 1 Recall: 0.7809
Class 2 Recall: 0.0115
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4911
Macro F1 Score: 0.2026
xView2 Score: 0.2700
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5425
Confusion Matrix:
 [[2132606 2382279  177679    6901    6465]
 [ 332698 1444863   64698    3219    1669]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5948
Class 1 F1: 0.5092
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8650
Class 1 Precision: 0.3775
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4532
Class 1 Recall: 0.7822
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5459
Macro F1 Score: 0.2208
xView2 Score: 0.2760
Epoch 3 took:  0 hours,  1 minutes, 18 seconds

Epoch 4/10
Train Loss: 1.5067
Confusion Matrix:
 [[2497819 2096939  108871    1587     714]
 [ 369693 1439567   36585    1101     201]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6596
Class 1 F1: 0.5347
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8711
Class 1 Precision: 0.4070
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5308
Class 1 Recall: 0.7793
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6008
Macro F1 Score: 0.2389
xView2 Score: 0.2829
Epoch 4 took:  0 hours,  0 minutes, 58 seconds

Epoch 5/10
Train Loss: 1.4733
Confusion Matrix:
 [[2604270 2012206   87764    1477     213]
 [ 363412 1454070   28715     900      50]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6788
Class 1 F1: 0.5473
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8775
Class 1 Precision: 0.4194
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5534
Class 1 Recall: 0.7872
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6193
Macro F1 Score: 0.2452
xView2 Score: 0.2872
Epoch 5 took:  0 hours,  0 minutes, 36 seconds

Epoch 6/10
Train Loss: 1.4428
Confusion Matrix:
 [[2837324 1815220   52532     809      45]
 [ 439137 1387779   19702     529       0]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7109
Class 1 F1: 0.5495
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8660
Class 1 Precision: 0.4332
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6029
Class 1 Recall: 0.7513
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6447
Macro F1 Score: 0.2521
xView2 Score: 0.3150
Epoch 6 took:  0 hours,  0 minutes, 30 seconds

Epoch 7/10
Train Loss: 1.4004
Confusion Matrix:
 [[3053574 1616719   34972     665       0]
 [ 543509 1289228   13998     412       0]
 [      1     522       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7355
Class 1 F1: 0.5424
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8489
Class 1 Precision: 0.4436
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6489
Class 1 Recall: 0.6980
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6627
Macro F1 Score: 0.3195
xView2 Score: 0.3067
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.4034
Confusion Matrix:
 [[3030741 1631681   42511     997       0]
 [ 505078 1321834   19738     497       0]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7355
Class 1 F1: 0.5506
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8572
Class 1 Precision: 0.4475
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6440
Class 1 Recall: 0.7156
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6642
Macro F1 Score: 0.3215
xView2 Score: 0.3115
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.3424
Confusion Matrix:
 [[2942095 1724535   37808    1492       0]
 [ 458293 1371913   16319     622       0]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7259
Class 1 F1: 0.5550
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8652
Class 1 Precision: 0.4430
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6252
Class 1 Recall: 0.7427
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6583
Macro F1 Score: 0.3202
xView2 Score: 0.3158
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.3388
Confusion Matrix:
 [[2893244 1779639   31545    1502       0]
 [ 415625 1417242   13764     516       0]
 [      0     523       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7220
Class 1 F1: 0.5619
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8744
Class 1 Precision: 0.4432
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6148
Class 1 Recall: 0.7673
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6577
Macro F1 Score: 0.3210
xView2 Score: 0.3207
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6577
Best Macro F1: 0.3210
Best xView2 Score: 0.3207
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8744
Class 1 Precision: 0.4432
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3294
ROC curve saved to .././____________optune_results/106/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/106/plot_loss_curves.jpg
Prediction distribution: {0: 134289, 1: 125106, 2: 2749}
ROC curve saved to .././____________optune_results/106/visualize_predictions.jpg
Prediction distribution: {0: 183300, 1: 78213, 2: 624, 3: 7}
ROC curve saved to .././____________optune_results/106/visualize_predictions.jpg
Prediction distribution: {0: 38815, 1: 222946, 2: 383}
ROC curve saved to .././____________optune_results/106/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/106/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/106/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27339396219454126, 1: 0.7482216084617481, 2: 232.94139862081732, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [1.5223572756497108, 0.7482216084617481, 232.94139862081732, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5453
Confusion Matrix:
 [[3516425  216183  178432  842422   17019]
 [1008633  125321  123920  494447    8795]
 [  12349     759    4505    4187      93]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7556
Class 1 F1: 0.1192
Class 2 F1: 0.0274
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7750
Class 1 Precision: 0.3662
Class 2 Precision: 0.0147
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7371
Class 1 Recall: 0.0712
Class 2 Recall: 0.2058
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5564
Macro F1 Score: 0.1804
xView2 Score: 0.1473
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4749
Confusion Matrix:
 [[4427354   87396   35932  216050    3749]
 [1503714   67313   29661  157466    2962]
 [  18219     253    2014    1155     252]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8260
Class 1 F1: 0.0703
Class 2 F1: 0.0450
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7442
Class 1 Precision: 0.4344
Class 2 Precision: 0.0298
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9281
Class 1 Recall: 0.0382
Class 2 Recall: 0.0920
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6861
Macro F1 Score: 0.1883
xView2 Score: 0.0864
Epoch 2 took:  0 hours,  1 minutes,  5 seconds

Epoch 3/10
Train Loss: 1.4071
Confusion Matrix:
 [[4716705   15204    4495   33949     128]
 [1709137   15251    4318   32339      71]
 [  21366      43      11     473       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8409
Class 1 F1: 0.0170
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7316
Class 1 Precision: 0.5001
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9887
Class 1 Recall: 0.0087
Class 2 Recall: 0.0005
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7220
Macro F1 Score: 0.1717
xView2 Score: 0.0192
Epoch 3 took:  0 hours,  0 minutes, 35 seconds

Epoch 4/10
Train Loss: 1.3350
Confusion Matrix:
 [[4762395    3044     734    4308       0]
 [1750313    2758     664    7380       1]
 [  21797       0       0      96       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8425
Class 1 F1: 0.0031
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7288
Class 1 Precision: 0.4754
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9983
Class 1 Recall: 0.0016
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7271
Macro F1 Score: 0.1691
xView2 Score: 0.0041
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.2685
Confusion Matrix:
 [[4769350     342      65     724       0]
 [1758712     494     142    1768       0]
 [  21893       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8426
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7281
Class 1 Precision: 0.5909
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7278
Macro F1 Score: 0.2108
xView2 Score: 0.0009
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2171
Confusion Matrix:
 [[4770368       7       0     106       0]
 [1760905      16      26     169       0]
 [  21893       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8425
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7279
Class 1 Precision: 0.6957
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7279
Macro F1 Score: 0.2106
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1702
Confusion Matrix:
 [[4770479       1       0       1       0]
 [1761113       0       2       1       0]
 [  21893       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8425
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7279
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7279
Macro F1 Score: 0.2106
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1153
Confusion Matrix:
 [[4770481       0       0       0       0]
 [1761114       0       2       0       0]
 [  21893       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8425
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7279
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7279
Macro F1 Score: 0.2106
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0728
Confusion Matrix:
 [[4770481       0       0       0       0]
 [1761116       0       0       0       0]
 [  21893       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8425
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7279
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7279
Macro F1 Score: 0.2106
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0176
Confusion Matrix:
 [[4770481       0       0       0       0]
 [1761116       0       0       0       0]
 [  21893       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8425
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7279
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7279
Macro F1 Score: 0.2106
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5564
Best Macro F1: 0.1804
Best xView2 Score: 0.1473
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7750
Class 1 Precision: 0.3662
Class 2 Precision: 0.0147
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2312
ROC curve saved to .././____________optune_results/107/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/107/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/107/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/107/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/107/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/107/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/107/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27392857865928405, 1: 0.7460833463284652, 2: 121.0390015150422, 3: 1243.3707509881424, 4: 68947.46301369862}
Final class weights used in loss: [1.5750196407634354, 0.7460833463284652, 121.0390015150422, 1243.3707509881424, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5838
Confusion Matrix:
 [[2887558   80697 1496222  243837   98097]
 [ 637405   54018  873734  114567   62113]
 [   1688       0     217      12       0]
 [   1903      43     382      25     204]
 [    856      11       5       0       6]]
Class 0 F1: 0.6928
Class 1 F1: 0.0576
Class 2 F1: 0.0002
Class 3 F1: 0.0001
Class 4 F1: 0.0001
Class 0 Precision: 0.8181
Class 1 Precision: 0.4008
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.6008
Class 1 Recall: 0.0310
Class 2 Recall: 0.1132
Class 3 Recall: 0.0098
Class 4 Recall: 0.0068
Validation Accuracy: 0.4489
Macro F1 Score: 0.1502
xView2 Score: 0.1476
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4966
Confusion Matrix:
 [[4027046   17509  671330   69322   21204]
 [1185954   15449  466145   55083   19206]
 [   1634       0     283       0       0]
 [   1975       9     571       2       0]
 [    162       0     716       0       0]]
Class 0 F1: 0.8035
Class 1 F1: 0.0174
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7719
Class 1 Precision: 0.4686
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8378
Class 1 Recall: 0.0089
Class 2 Recall: 0.1476
Class 3 Recall: 0.0008
Class 4 Recall: 0.0000
Validation Accuracy: 0.6169
Macro F1 Score: 0.1643
xView2 Score: 0.1111
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4223
Confusion Matrix:
 [[4624458    2184  165498   12482    1789]
 [1607098    2896  118748   11238    1857]
 [   1917       0       0       0       0]
 [   2454       0     103       0       0]
 [    546       0     332       0       0]]
Class 0 F1: 0.8375
Class 1 F1: 0.0033
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7415
Class 1 Precision: 0.5701
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9621
Class 1 Recall: 0.0017
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7061
Macro F1 Score: 0.1682
xView2 Score: 0.0398
Epoch 3 took:  0 hours,  1 minutes,  7 seconds

Epoch 4/10
Train Loss: 1.3626
Confusion Matrix:
 [[4748348    1894   53841    2227     101]
 [1696317    2312   41217    1907      84]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8437
Class 1 F1: 0.0026
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7362
Class 1 Precision: 0.5497
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9879
Class 1 Recall: 0.0013
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7249
Macro F1 Score: 0.1693
xView2 Score: 0.0151
Epoch 4 took:  0 hours,  0 minutes, 37 seconds

Epoch 5/10
Train Loss: 1.2844
Confusion Matrix:
 [[4787807     868   17376     360       0]
 [1727816     813   13016     191       1]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8454
Class 1 F1: 0.0009
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7342
Class 1 Precision: 0.4836
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9961
Class 1 Recall: 0.0005
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7307
Macro F1 Score: 0.1693
xView2 Score: 0.0049
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.2277
Confusion Matrix:
 [[4803206      64    3094      47       0]
 [1739604      23    2203       7       0]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7335
Class 1 Precision: 0.2644
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9993
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7329
Macro F1 Score: 0.1692
xView2 Score: 0.0008
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1700
Confusion Matrix:
 [[4805443      79     885       4       0]
 [1740843      27     967       0       0]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8462
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7335
Class 1 Precision: 0.2547
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7333
Macro F1 Score: 0.1692
xView2 Score: 0.0003
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1302
Confusion Matrix:
 [[4805681       8     722       0       0]
 [1741477       1     359       0       0]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8462
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7334
Class 1 Precision: 0.1111
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7333
Macro F1 Score: 0.1692
xView2 Score: 0.0001
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0798
Confusion Matrix:
 [[4806372       0      39       0       0]
 [1741764       0      73       0       0]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8462
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7334
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7334
Macro F1 Score: 0.1692
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0466
Confusion Matrix:
 [[4806381       0      30       0       0]
 [1741835       0       2       0       0]
 [   1917       0       0       0       0]
 [   2557       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8462
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7334
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7334
Macro F1 Score: 0.1692
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4489
Best Macro F1: 0.1502
Best xView2 Score: 0.1476
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8181
Class 1 Precision: 0.4008
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.2438
ROC curve saved to .././____________optune_results/108/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/108/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/108/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/108/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/108/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/108/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/108/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2727067417043489, 1: 0.7555141193054782, 2: 124.28488036150826, 3: 819.4667535004885, 4: 5292.497160883281}
Final class weights used in loss: [2.7304380141618703, 0.7555141193054782, 124.28488036150826, 819.4667535004885, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5658
Confusion Matrix:
 [[ 995515     912  598019 3129436     206]
 [ 225471    1148  319766 1279423     238]
 [    257       0     661    2085       0]
 [      0       0     387      76       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3349
Class 1 F1: 0.0013
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8152
Class 1 Precision: 0.5573
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2107
Class 1 Recall: 0.0006
Class 2 Recall: 0.2201
Class 3 Recall: 0.1641
Class 4 Recall: 0.0000
Validation Accuracy: 0.1522
Macro F1 Score: 0.0675
xView2 Score: 0.1351
Epoch 1 took:  0 hours,  0 minutes, 37 seconds

Epoch 2/10
Train Loss: 1.4720
Confusion Matrix:
 [[3030804     185  283775 1409194     130]
 [ 848843     198  208635  768332      38]
 [   2244       0     296     463       0]
 [    170       0     293       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7043
Class 1 F1: 0.0002
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7807
Class 1 Precision: 0.5170
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6416
Class 1 Recall: 0.0001
Class 2 Recall: 0.0986
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4625
Macro F1 Score: 0.1411
xView2 Score: 0.1308
Epoch 2 took:  0 hours,  0 minutes, 28 seconds

Epoch 3/10
Train Loss: 1.3875
Confusion Matrix:
 [[4260832       1   77671  385579       5]
 [1512615       0   65690  247741       0]
 [   2952       0       5      46       0]
 [    168       0     295       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8115
Class 1 F1: 0.0000
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7376
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9019
Class 1 Recall: 0.0000
Class 2 Recall: 0.0017
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6502
Macro F1 Score: 0.1623
xView2 Score: 0.0723
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3055
Confusion Matrix:
 [[4599439       1   18909  105739       0]
 [1713506      11   21650   90879       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8332
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7282
Class 1 Precision: 0.9167
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9736
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7018
Macro F1 Score: 0.2083
xView2 Score: 0.0327
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2265
Confusion Matrix:
 [[4716273       0    1705    6110       0]
 [1816738       0    2257    7051       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8377
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7215
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9983
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7196
Macro F1 Score: 0.2094
xView2 Score: 0.0030
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1488
Confusion Matrix:
 [[4723749       0      50     289       0]
 [1825474       0     154     418       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8378
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7209
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7208
Macro F1 Score: 0.2094
xView2 Score: 0.0002
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0666
Confusion Matrix:
 [[4724070       0       0      18       0]
 [1826020       0      15      11       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8378
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7208
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7208
Macro F1 Score: 0.2094
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0254
Confusion Matrix:
 [[4724088       0       0       0       0]
 [1826046       0       0       0       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8378
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7208
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7208
Macro F1 Score: 0.2094
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9750
Confusion Matrix:
 [[4724088       0       0       0       0]
 [1826046       0       0       0       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8378
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7208
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7208
Macro F1 Score: 0.2094
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9245
Confusion Matrix:
 [[4724088       0       0       0       0]
 [1826046       0       0       0       0]
 [   3003       0       0       0       0]
 [    463       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8378
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7208
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7208
Macro F1 Score: 0.2094
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1522
Best Macro F1: 0.0675
Best xView2 Score: 0.1351
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8152
Class 1 Precision: 0.5573
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2746
ROC curve saved to .././____________optune_results/109/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/109/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/109/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/109/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/109/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/109/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/109/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27485628948950214, 1: 0.7389075448901364, 2: 143.25216450832502, 3: 822.2781898382617, 4: 5292.497160883281}
Final class weights used in loss: [3.3856280174168396, 0.7389075448901364, 143.25216450832502, 822.2781898382617, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4747
Confusion Matrix:
 [[4751125   21279   52296   13624   30104]
 [1611999   16852   24483    4258   18731]
 [   8013       8     213       2     129]
 [    476       0       8       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8454
Class 1 F1: 0.0197
Class 2 F1: 0.0050
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7457
Class 1 Precision: 0.4419
Class 2 Precision: 0.0028
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9759
Class 1 Recall: 0.0101
Class 2 Recall: 0.0255
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7276
Macro F1 Score: 0.1740
xView2 Score: 0.0254
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.3667
Confusion Matrix:
 [[4861216    2892    2787     589     944]
 [1670520    2983    1575     449     796]
 [   8330      35       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8522
Class 1 F1: 0.0035
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7432
Class 1 Precision: 0.5047
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9985
Class 1 Recall: 0.0018
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7422
Macro F1 Score: 0.1711
xView2 Score: 0.0026
Epoch 2 took:  0 hours,  1 minutes,  7 seconds

Epoch 3/10
Train Loss: 1.2692
Confusion Matrix:
 [[4867959     208     128      26     107]
 [1675962     162      70      59      70]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8524
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.4378
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7428
Macro F1 Score: 0.1705
xView2 Score: 0.0002
Epoch 3 took:  0 hours,  0 minutes, 34 seconds

Epoch 4/10
Train Loss: 1.1754
Confusion Matrix:
 [[4868372      37      16       3       0]
 [1676182      89      31      15       6]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.7063
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.1705
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.0828
Confusion Matrix:
 [[4868425       0       0       3       0]
 [1676317       5       1       0       0]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2131
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 0.9981
Confusion Matrix:
 [[4868428       0       0       0       0]
 [1676323       0       0       0       0]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2131
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 0.9396
Confusion Matrix:
 [[4868428       0       0       0       0]
 [1676323       0       0       0       0]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2131
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.8700
Confusion Matrix:
 [[4868428       0       0       0       0]
 [1676323       0       0       0       0]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2131
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8467
Confusion Matrix:
 [[4868428       0       0       0       0]
 [1676323       0       0       0       0]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2131
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.7836
Confusion Matrix:
 [[4868428       0       0       0       0]
 [1676323       0       0       0       0]
 [   8365       0       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8525
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7429
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7429
Macro F1 Score: 0.2131
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7276
Best Macro F1: 0.1740
Best xView2 Score: 0.0254
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7457
Class 1 Precision: 0.4419
Class 2 Precision: 0.0028
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2381
ROC curve saved to .././____________optune_results/110/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/110/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/110/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/110/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/110/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/110/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/110/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2701714697963232, 1: 0.774494617646389, 2: 166.58386178592704, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [0.6648582226367057, 0.774494617646389, 166.58386178592704, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5697
Confusion Matrix:
 [[2555565  500635  970704  504034   19957]
 [ 835784  260840  607271  276829    8585]
 [   5280    1597    1468    4928      13]
 [     26       0      69      15       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6431
Class 1 F1: 0.1895
Class 2 F1: 0.0018
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7524
Class 1 Precision: 0.3418
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5616
Class 1 Recall: 0.1311
Class 2 Recall: 0.1105
Class 3 Recall: 0.1364
Class 4 Recall: 0.0000
Validation Accuracy: 0.4300
Macro F1 Score: 0.1669
xView2 Score: 0.1682
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5258
Confusion Matrix:
 [[3577207  283207  533523  152452    4506]
 [1306886  164183  408920  107099    2221]
 [   9708     734    1290    1545       9]
 [     68       0      42       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7575
Class 1 F1: 0.1347
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7310
Class 1 Precision: 0.3664
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7860
Class 1 Recall: 0.0825
Class 2 Recall: 0.0971
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5711
Macro F1 Score: 0.1790
xView2 Score: 0.1346
Epoch 2 took:  0 hours,  1 minutes, 14 seconds

Epoch 3/10
Train Loss: 1.4729
Confusion Matrix:
 [[4241420  108762  175128   25448     137]
 [1745502   67589  156389   19757      72]
 [  13089      46      75      76       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8040
Class 1 F1: 0.0624
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7069
Class 1 Precision: 0.3832
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9320
Class 1 Recall: 0.0340
Class 2 Recall: 0.0056
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6575
Macro F1 Score: 0.1734
xView2 Score: 0.0666
Epoch 3 took:  0 hours,  0 minutes, 46 seconds

Epoch 4/10
Train Loss: 1.4287
Confusion Matrix:
 [[4337313  118200   89792    5587       3]
 [1823247   79018   82845    4196       3]
 [  13028     146      14      98       0]
 [     66       0      44       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8089
Class 1 F1: 0.0723
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7026
Class 1 Precision: 0.4004
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9531
Class 1 Recall: 0.0397
Class 2 Recall: 0.0011
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6739
Macro F1 Score: 0.1763
xView2 Score: 0.0526
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.3916
Confusion Matrix:
 [[4469020   59020   22153     702       0]
 [1915931   48406   24335     637       0]
 [  13270      16       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8163
Class 1 F1: 0.0462
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6985
Class 1 Precision: 0.4505
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9820
Class 1 Recall: 0.0243
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6893
Macro F1 Score: 0.2156
xView2 Score: 0.0287
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3444
Confusion Matrix:
 [[4455781   82910   11922     282       0]
 [1901993   73577   13451     288       0]
 [  13284       2       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8159
Class 1 F1: 0.0686
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6994
Class 1 Precision: 0.4702
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9791
Class 1 Recall: 0.0370
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6911
Macro F1 Score: 0.2211
xView2 Score: 0.0365
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3099
Confusion Matrix:
 [[4464020   81818    4939     118       0]
 [1910912   72999    5296     102       0]
 [  13229      57       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8162
Class 1 F1: 0.0681
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6988
Class 1 Precision: 0.4713
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9809
Class 1 Recall: 0.0367
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6923
Macro F1 Score: 0.2211
xView2 Score: 0.0341
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2892
Confusion Matrix:
 [[4489922   59343    1585      45       0]
 [1930065   58078    1161       5       0]
 [  13278       8       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8175
Class 1 F1: 0.0551
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6979
Class 1 Precision: 0.4946
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9866
Class 1 Recall: 0.0292
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6940
Macro F1 Score: 0.2182
xView2 Score: 0.0267
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2711
Confusion Matrix:
 [[4495476   53999    1393      27       0]
 [1933438   54680    1191       0       0]
 [  13286       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8179
Class 1 F1: 0.0521
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6978
Class 1 Precision: 0.5031
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9878
Class 1 Recall: 0.0275
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6943
Macro F1 Score: 0.2175
xView2 Score: 0.0252
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2122
Confusion Matrix:
 [[4374794  175096     983      22       0]
 [1800729  187002    1578       0       0]
 [  13285       1       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8147
Class 1 F1: 0.1591
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7069
Class 1 Precision: 0.5164
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9613
Class 1 Recall: 0.0940
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6961
Macro F1 Score: 0.2434
xView2 Score: 0.0779
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4300
Best Macro F1: 0.1669
Best xView2 Score: 0.1682
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7524
Class 1 Precision: 0.3418
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2190
ROC curve saved to .././____________optune_results/111/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/111/plot_loss_curves.jpg
Prediction distribution: {0: 254679, 1: 7465}
ROC curve saved to .././____________optune_results/111/visualize_predictions.jpg
Prediction distribution: {0: 246034, 1: 16091, 2: 1, 3: 18}
ROC curve saved to .././____________optune_results/111/visualize_predictions.jpg
Prediction distribution: {0: 247168, 1: 14969, 2: 7}
ROC curve saved to .././____________optune_results/111/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/111/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/111/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2717221931565716, 1: 0.7623177456853137, 2: 137.3905333842878, 3: 1944.808655332303, 4: 5292.497160883281}
Final class weights used in loss: [2.627851653938432, 0.7623177456853137, 137.3905333842878, 1944.808655332303, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6712
Confusion Matrix:
 [[ 379500 1363091    4175 2781783  128665]
 [  43517  412866    1854 1388721   38545]
 [     52    1769       0    4714     331]
 [    129     241       0    3647       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1494
Class 1 F1: 0.2254
Class 2 F1: 0.0000
Class 3 F1: 0.0017
Class 4 F1: 0.0000
Class 0 Precision: 0.8967
Class 1 Precision: 0.2322
Class 2 Precision: 0.0000
Class 3 Precision: 0.0009
Class 4 Precision: 0.0000
Class 0 Recall: 0.0815
Class 1 Recall: 0.2190
Class 2 Recall: 0.0000
Class 3 Recall: 0.9079
Class 4 Recall: 0.0000
Validation Accuracy: 0.1215
Macro F1 Score: 0.0753
xView2 Score: 0.1895
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5741
Confusion Matrix:
 [[2203658  691081    4113 1681597   76765]
 [ 568867  293118    1462 1001031   21025]
 [   3576     908       0    2268     114]
 [   1205     493       0    2305      14]
 [      0       0       0       0       0]]
Class 0 F1: 0.5928
Class 1 F1: 0.2042
Class 2 F1: 0.0000
Class 3 F1: 0.0017
Class 4 F1: 0.0000
Class 0 Precision: 0.7935
Class 1 Precision: 0.2974
Class 2 Precision: 0.0000
Class 3 Precision: 0.0009
Class 4 Precision: 0.0000
Class 0 Recall: 0.4732
Class 1 Recall: 0.1555
Class 2 Recall: 0.0000
Class 3 Recall: 0.5738
Class 4 Recall: 0.0000
Validation Accuracy: 0.3813
Macro F1 Score: 0.1597
xView2 Score: 0.1782
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4804
Confusion Matrix:
 [[3809516  163575    1363  667774   14986]
 [1311152  101715     475  467041    5120]
 [   4801     227       0    1789      49]
 [   2050      49       0    1908      10]
 [      0       0       0       0       0]]
Class 0 F1: 0.7787
Class 1 F1: 0.0946
Class 2 F1: 0.0000
Class 3 F1: 0.0033
Class 4 F1: 0.0000
Class 0 Precision: 0.7430
Class 1 Precision: 0.3830
Class 2 Precision: 0.0000
Class 3 Precision: 0.0017
Class 4 Precision: 0.0000
Class 0 Recall: 0.8180
Class 1 Recall: 0.0539
Class 2 Recall: 0.0000
Class 3 Recall: 0.4750
Class 4 Recall: 0.0000
Validation Accuracy: 0.5971
Macro F1 Score: 0.1753
xView2 Score: 0.1199
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.3892
Confusion Matrix:
 [[4390482   43775     282  221282    1393]
 [1658554   37836     211  187374    1528]
 [   6195      16       0     636      19]
 [   2934      12       0    1071       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8195
Class 1 F1: 0.0385
Class 2 F1: 0.0000
Class 3 F1: 0.0052
Class 4 F1: 0.0000
Class 0 Precision: 0.7247
Class 1 Precision: 0.4635
Class 2 Precision: 0.0000
Class 3 Precision: 0.0026
Class 4 Precision: 0.0000
Class 0 Recall: 0.9427
Class 1 Recall: 0.0201
Class 2 Recall: 0.0000
Class 3 Recall: 0.2666
Class 4 Recall: 0.0000
Validation Accuracy: 0.6759
Macro F1 Score: 0.1726
xView2 Score: 0.0644
Epoch 4 took:  0 hours,  1 minutes,  6 seconds

Epoch 5/10
Train Loss: 1.3058
Confusion Matrix:
 [[4606099   11711     100   39138     166]
 [1834486   12573      63   38235     146]
 [   6643       0       0     223       0]
 [   3884       0       0     133       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8293
Class 1 F1: 0.0132
Class 2 F1: 0.0000
Class 3 F1: 0.0033
Class 4 F1: 0.0000
Class 0 Precision: 0.7140
Class 1 Precision: 0.5177
Class 2 Precision: 0.0000
Class 3 Precision: 0.0017
Class 4 Precision: 0.0000
Class 0 Recall: 0.9890
Class 1 Recall: 0.0067
Class 2 Recall: 0.0000
Class 3 Recall: 0.0331
Class 4 Recall: 0.0000
Validation Accuracy: 0.7048
Macro F1 Score: 0.1691
xView2 Score: 0.0181
Epoch 5 took:  0 hours,  0 minutes, 40 seconds

Epoch 6/10
Train Loss: 1.2161
Confusion Matrix:
 [[4650332    3336       5    3541       0]
 [1877691    3474       0    4338       0]
 [   6866       0       0       0       0]
 [   4011       0       0       6       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8307
Class 1 F1: 0.0037
Class 2 F1: 0.0000
Class 3 F1: 0.0010
Class 4 F1: 0.0000
Class 0 Precision: 0.7112
Class 1 Precision: 0.5101
Class 2 Precision: 0.0000
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.9985
Class 1 Recall: 0.0018
Class 2 Recall: 0.0000
Class 3 Recall: 0.0015
Class 4 Recall: 0.0000
Validation Accuracy: 0.7101
Macro F1 Score: 0.2088
xView2 Score: 0.0033
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.1317
Confusion Matrix:
 [[4655344    1710       0     160       0]
 [1883790    1621       0      92       0]
 [   6866       0       0       0       0]
 [   4017       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8308
Class 1 F1: 0.0017
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7107
Class 1 Precision: 0.4866
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0009
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7106
Macro F1 Score: 0.2081
xView2 Score: 0.0008
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0658
Confusion Matrix:
 [[4656927     281       0       6       0]
 [1885342     161       0       0       0]
 [   6866       0       0       0       0]
 [   4017       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8308
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7106
Class 1 Precision: 0.3643
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7106
Macro F1 Score: 0.2077
xView2 Score: 0.0001
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0157
Confusion Matrix:
 [[4657207       7       0       0       0]
 [1885502       1       0       0       0]
 [   6866       0       0       0       0]
 [   4017       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8308
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7106
Class 1 Precision: 0.1250
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7106
Macro F1 Score: 0.2077
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9541
Confusion Matrix:
 [[4657214       0       0       0       0]
 [1885503       0       0       0       0]
 [   6866       0       0       0       0]
 [   4017       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8308
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7106
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7106
Macro F1 Score: 0.2077
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.1215
Best Macro F1: 0.0753
Best xView2 Score: 0.1895
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8967
Class 1 Precision: 0.2322
Class 2 Precision: 0.0000
Class 3 Precision: 0.0009
Class 4 Precision: 0.0000
Macro Precision: 0.2260
ROC curve saved to .././____________optune_results/112/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/112/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/112/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/112/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/112/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/112/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/112/plot_epoch_f1.jpg
[FrozenTrial(number=3, state=TrialState.COMPLETE, values=[0.32959160503728113, 0.6978778839111328, 1.4290195311818803], datetime_start=datetime.datetime(2025, 7, 22, 14, 31, 40, 78717), datetime_complete=datetime.datetime(2025, 7, 22, 14, 40, 58, 179658), params={'class5': 1.4165487085233326}, user_attrs={'f1': 0.32959160503728113, 'accuracy': 0.6978778839111328, 'val_loss': 1.4290195311818803}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=3, value=None), FrozenTrial(number=10, state=TrialState.COMPLETE, values=[0.15298424600460697, 0.7052695922851564, 0.9895209742443903], datetime_start=datetime.datetime(2025, 7, 22, 15, 32, 45, 584547), datetime_complete=datetime.datetime(2025, 7, 22, 15, 37, 47, 937451), params={'class5': 19.298341853383196}, user_attrs={'f1': 0.15298424600460697, 'accuracy': 0.7052695922851564, 'val_loss': 0.9895209742443903}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=10, value=None), FrozenTrial(number=12, state=TrialState.COMPLETE, values=[0.15666805650872317, 0.7465982513427732, 1.083778755579676], datetime_start=datetime.datetime(2025, 7, 22, 15, 43, 23, 101296), datetime_complete=datetime.datetime(2025, 7, 22, 15, 50, 36, 288492), params={'class5': 11.60297509701394}, user_attrs={'f1': 0.15666805650872317, 'accuracy': 0.7465982513427732, 'val_loss': 1.083778755579676}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=12, value=None), FrozenTrial(number=13, state=TrialState.COMPLETE, values=[0.27261098300298725, 0.7212671508789062, 1.4487689452511927], datetime_start=datetime.datetime(2025, 7, 22, 15, 50, 36, 289108), datetime_complete=datetime.datetime(2025, 7, 22, 15, 58, 23, 500683), params={'class5': 1.5299570129242275}, user_attrs={'f1': 0.27261098300298725, 'accuracy': 0.7212671508789062, 'val_loss': 1.4487689452511927}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=13, value=None), FrozenTrial(number=15, state=TrialState.COMPLETE, values=[0.18408635080020044, 0.6993609313964843, 1.0811191605670114], datetime_start=datetime.datetime(2025, 7, 22, 16, 8, 9, 919069), datetime_complete=datetime.datetime(2025, 7, 22, 16, 16, 55, 281994), params={'class5': 8.09443586528088}, user_attrs={'f1': 0.18408635080020044, 'accuracy': 0.6993609313964843, 'val_loss': 1.0811191605670114}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=15, value=None), FrozenTrial(number=27, state=TrialState.COMPLETE, values=[0.32569471003259226, 0.663796371459961, 1.4033540223326002], datetime_start=datetime.datetime(2025, 7, 22, 17, 55, 9, 221774), datetime_complete=datetime.datetime(2025, 7, 22, 18, 4, 23, 525858), params={'class5': 1.8105328025897895}, user_attrs={'f1': 0.32569471003259226, 'accuracy': 0.663796371459961, 'val_loss': 1.4033540223326002}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=27, value=None), FrozenTrial(number=37, state=TrialState.COMPLETE, values=[0.17961049372328552, 0.7069641265869139, 1.067360161457743], datetime_start=datetime.datetime(2025, 7, 22, 19, 23, 43, 10286), datetime_complete=datetime.datetime(2025, 7, 22, 19, 31, 22, 374462), params={'class5': 18.3473765635363}, user_attrs={'f1': 0.17961049372328552, 'accuracy': 0.7069641265869139, 'val_loss': 1.067360161457743}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=37, value=None), FrozenTrial(number=43, state=TrialState.COMPLETE, values=[0.3209664203062855, 0.5932660217285156, 1.3551217453820363], datetime_start=datetime.datetime(2025, 7, 22, 20, 7, 6, 161013), datetime_complete=datetime.datetime(2025, 7, 22, 20, 15, 50, 60181), params={'class5': 1.3596891130092996}, user_attrs={'f1': 0.3209664203062855, 'accuracy': 0.5932660217285156, 'val_loss': 1.3551217453820363}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=43, value=None), FrozenTrial(number=44, state=TrialState.COMPLETE, values=[0.18042781602282099, 0.7059051818847657, 1.3369567258017405], datetime_start=datetime.datetime(2025, 7, 22, 20, 15, 50, 61588), datetime_complete=datetime.datetime(2025, 7, 22, 20, 22, 33, 348607), params={'class5': 5.568364653812048}, user_attrs={'f1': 0.18042781602282099, 'accuracy': 0.7059051818847657, 'val_loss': 1.3369567258017405}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=44, value=None), FrozenTrial(number=47, state=TrialState.COMPLETE, values=[0.17400836089306831, 0.7412649688720705, 1.0186362317630224], datetime_start=datetime.datetime(2025, 7, 22, 20, 35, 28, 701845), datetime_complete=datetime.datetime(2025, 7, 22, 20, 42, 12, 83882), params={'class5': 12.317811696086912}, user_attrs={'f1': 0.17400836089306831, 'accuracy': 0.7412649688720705, 'val_loss': 1.0186362317630224}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class5': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=47, value=None)]
Found 'class5': 1.4165487085233326
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27101987259629184, 1: 0.7675662997424398, 2: 167.6324662781016, 3: 784.4708229426434, 4: 5732.533940774488}
Final class weights used in loss: [2.6210594437605073, 2.716303466666343, 167.6324662781016, 784.4708229426434, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5215
Confusion Matrix:
 [[4274803   95746  183175   42768   12721]
 [1816652   43232   46566   20589    3611]
 [  12364     255     623     233       0]
 [    184       0       5       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7980
Class 1 F1: 0.0418
Class 2 F1: 0.0051
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7003
Class 1 Precision: 0.3105
Class 2 Precision: 0.0027
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9274
Class 1 Recall: 0.0224
Class 2 Recall: 0.0462
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6590
Macro F1 Score: 0.1690
xView2 Score: 0.0379
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4528
Confusion Matrix:
 [[4556892   36649    9816    4747    1109]
 [1899993   25170    2836    2467     184]
 [  13249     187      29      10       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8226
Class 1 F1: 0.0253
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7043
Class 1 Precision: 0.4059
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9886
Class 1 Recall: 0.0130
Class 2 Recall: 0.0022
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6992
Macro F1 Score: 0.1700
xView2 Score: 0.0132
Epoch 2 took:  0 hours,  1 minutes,  4 seconds

Epoch 3/10
Train Loss: 1.3845
Confusion Matrix:
 [[4597015   11546     477     170       5]
 [1920718    9833      27      72       0]
 [  13459      16       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8253
Class 1 F1: 0.0101
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7038
Class 1 Precision: 0.4596
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9974
Class 1 Recall: 0.0051
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7029
Macro F1 Score: 0.1671
xView2 Score: 0.0045
Epoch 3 took:  0 hours,  0 minutes, 29 seconds

Epoch 4/10
Train Loss: 1.3168
Confusion Matrix:
 [[4598197   11016       0       0       0]
 [1918175   12474       1       0       0]
 [  13407      68       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8256
Class 1 F1: 0.0128
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7042
Class 1 Precision: 0.5295
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9976
Class 1 Recall: 0.0065
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7035
Macro F1 Score: 0.1677
xView2 Score: 0.0056
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2414
Confusion Matrix:
 [[4593669   15544       0       0       0]
 [1909753   20897       0       0       0]
 [  13460      15       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8257
Class 1 F1: 0.0212
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7049
Class 1 Precision: 0.5732
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9966
Class 1 Recall: 0.0108
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7041
Macro F1 Score: 0.1694
xView2 Score: 0.0093
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1823
Confusion Matrix:
 [[4568611   40602       0       0       0]
 [1871887   58763       0       0       0]
 [  13458      17       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8259
Class 1 F1: 0.0579
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7078
Class 1 Precision: 0.5913
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9912
Class 1 Recall: 0.0304
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7061
Macro F1 Score: 0.1768
xView2 Score: 0.0255
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1184
Confusion Matrix:
 [[4498320  110893       0       0       0]
 [1781930  148720       0       0       0]
 [  13164     311       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8252
Class 1 F1: 0.1358
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7147
Class 1 Precision: 0.5722
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9759
Class 1 Recall: 0.0770
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7091
Macro F1 Score: 0.1922
xView2 Score: 0.0606
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0708
Confusion Matrix:
 [[4412813  196400       0       0       0]
 [1678492  252158       0       0       0]
 [  13236     239       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8237
Class 1 F1: 0.2119
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7228
Class 1 Precision: 0.5619
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9574
Class 1 Recall: 0.1306
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7118
Macro F1 Score: 0.2071
xView2 Score: 0.0956
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0224
Confusion Matrix:
 [[4317541  291672       0       0       0]
 [1561700  368950       0       0       0]
 [  13215     260       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8222
Class 1 F1: 0.2847
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7327
Class 1 Precision: 0.5583
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9367
Class 1 Recall: 0.1911
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7151
Macro F1 Score: 0.2214
xView2 Score: 0.1299
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9919
Confusion Matrix:
 [[4233510  375703       0       0       0]
 [1483465  447185       0       0       0]
 [  13228     247       0       0       0]
 [    189       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8189
Class 1 F1: 0.3248
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7388
Class 1 Precision: 0.5433
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9185
Class 1 Recall: 0.2316
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7142
Macro F1 Score: 0.2287
xView2 Score: 0.1497
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7142
Best Macro F1: 0.2287
Best xView2 Score: 0.1497
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7388
Class 1 Precision: 0.5433
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2564
ROC curve saved to .././____________optune_results/113/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/113/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/113/visualize_predictions.jpg
Prediction distribution: {0: 261518, 1: 626}
ROC curve saved to .././____________optune_results/113/visualize_predictions.jpg
Prediction distribution: {0: 166063, 1: 96081}
ROC curve saved to .././____________optune_results/113/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/113/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/113/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2725229957098932, 1: 0.7568089600359912, 2: 127.5122821240373, 3: 822.2781898382617, 4: 5292.497160883281}
Final class weights used in loss: [2.6355962930118095, 2.2628305096398575, 127.5122821240373, 822.2781898382617, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5898
Confusion Matrix:
 [[1443954  311352 1466988     179 1489171]
 [ 422356  184018  788358     112  442600]
 [   1132       1    1091       0    1804]
 [    464       0       0       0      20]
 [      0       0       0       0       0]]
Class 0 F1: 0.4389
Class 1 F1: 0.1578
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7730
Class 1 Precision: 0.3715
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3065
Class 1 Recall: 0.1001
Class 2 Recall: 0.2709
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2486
Macro F1 Score: 0.1195
xView2 Score: 0.1562
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5150
Confusion Matrix:
 [[3335036  356630  686524      19  333435]
 [ 995981  316489  396435      51  128488]
 [   2851      24     948       0     205]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7374
Class 1 F1: 0.2521
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7694
Class 1 Precision: 0.4702
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7078
Class 1 Recall: 0.1722
Class 2 Recall: 0.2354
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5573
Macro F1 Score: 0.1982
xView2 Score: 0.1663
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4484
Confusion Matrix:
 [[4254758  258751  155202       0   42933]
 [1435574  267908  109505       0   24457]
 [   3949       0       3       0      76]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8177
Class 1 F1: 0.2266
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7471
Class 1 Precision: 0.5087
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9030
Class 1 Recall: 0.1458
Class 2 Recall: 0.0007
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6901
Macro F1 Score: 0.2089
xView2 Score: 0.1249
Epoch 3 took:  0 hours,  1 minutes, 16 seconds

Epoch 4/10
Train Loss: 1.3831
Confusion Matrix:
 [[4338006  338263   30144       0    5231]
 [1427623  382754   23415       0    3652]
 [   3990       8       0       0      30]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8277
Class 1 F1: 0.2992
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7518
Class 1 Precision: 0.5308
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9207
Class 1 Recall: 0.2083
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7203
Macro F1 Score: 0.2254
xView2 Score: 0.1419
Epoch 4 took:  0 hours,  1 minutes, 10 seconds

Epoch 5/10
Train Loss: 1.3177
Confusion Matrix:
 [[4342136  365504    3713       0     291]
 [1409934  424520    2660       0     330]
 [   3829     189       0       0      10]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8296
Class 1 F1: 0.3231
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7543
Class 1 Precision: 0.5372
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9216
Class 1 Recall: 0.2310
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7273
Macro F1 Score: 0.2305
xView2 Score: 0.1498
Epoch 5 took:  0 hours,  0 minutes, 47 seconds

Epoch 6/10
Train Loss: 1.2524
Confusion Matrix:
 [[4434746  276556     321       0      21]
 [1498259  339028     140       0      17]
 [   3917     111       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8329
Class 1 F1: 0.2764
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7469
Class 1 Precision: 0.5506
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9412
Class 1 Recall: 0.1845
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7284
Macro F1 Score: 0.2219
xView2 Score: 0.1264
Epoch 6 took:  0 hours,  0 minutes, 29 seconds

Epoch 7/10
Train Loss: 1.1827
Confusion Matrix:
 [[4336513  375127       4       0       0]
 [1394730  442712       1       0       1]
 [   3969      59       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8302
Class 1 F1: 0.3335
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7561
Class 1 Precision: 0.5413
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9204
Class 1 Recall: 0.2409
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7293
Macro F1 Score: 0.2327
xView2 Score: 0.1542
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1253
Confusion Matrix:
 [[4339723  371921       0       0       0]
 [1373607  463837       0       0       0]
 [   3654     374       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8322
Class 1 F1: 0.3470
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7590
Class 1 Precision: 0.5547
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9211
Class 1 Recall: 0.2524
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7330
Macro F1 Score: 0.2948
xView2 Score: 0.1745
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0955
Confusion Matrix:
 [[4431935  279709       0       0       0]
 [1458477  378967       0       0       0]
 [   3937      91       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8357
Class 1 F1: 0.3036
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7518
Class 1 Precision: 0.5753
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9406
Class 1 Recall: 0.2062
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7341
Macro F1 Score: 0.2848
xView2 Score: 0.1508
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0321
Confusion Matrix:
 [[4314034  397610       0       0       0]
 [1299972  537472       0       0       0]
 [   3869     159       0       0       0]
 [    484       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8352
Class 1 F1: 0.3877
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7678
Class 1 Precision: 0.5747
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9156
Class 1 Recall: 0.2925
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7403
Macro F1 Score: 0.3057
xView2 Score: 0.1954
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7403
Best Macro F1: 0.3057
Best xView2 Score: 0.1954
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7678
Class 1 Precision: 0.5747
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3356
ROC curve saved to .././____________optune_results/114/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/114/plot_loss_curves.jpg
Prediction distribution: {0: 252025, 1: 10119}
ROC curve saved to .././____________optune_results/114/visualize_predictions.jpg
Prediction distribution: {0: 200732, 1: 61412}
ROC curve saved to .././____________optune_results/114/visualize_predictions.jpg
Prediction distribution: {0: 241601, 1: 20543}
ROC curve saved to .././____________optune_results/114/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/114/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/114/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2707088035622025, 1: 0.7693702529284945, 2: 207.97342258584357, 3: 811.5389874234118, 4: 5292.497160883281}
Final class weights used in loss: [2.618051064996062, 0.8893277234672733, 207.97342258584357, 811.5389874234118, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4344
Confusion Matrix:
 [[3900315   16310  128183  543064       1]
 [1592236    6784   49605  297400       0]
 [  15518       0     341    3440       0]
 [    131       0       0     272       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7726
Class 1 F1: 0.0069
Class 2 F1: 0.0035
Class 3 F1: 0.0006
Class 4 F1: 0.0000
Class 0 Precision: 0.7081
Class 1 Precision: 0.2938
Class 2 Precision: 0.0019
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.8501
Class 1 Recall: 0.0035
Class 2 Recall: 0.0177
Class 3 Recall: 0.6749
Class 4 Recall: 0.0000
Validation Accuracy: 0.5963
Macro F1 Score: 0.1567
xView2 Score: 0.0746
Epoch 1 took:  0 hours,  0 minutes, 25 seconds

Epoch 2/10
Train Loss: 1.3405
Confusion Matrix:
 [[4542850    2417    8672   33934       0]
 [1920822     289    4182   20732       0]
 [  18880       0      51     368       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8207
Class 1 F1: 0.0003
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7007
Class 1 Precision: 0.1068
Class 2 Precision: 0.0040
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9902
Class 1 Recall: 0.0001
Class 2 Recall: 0.0026
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6932
Macro F1 Score: 0.2060
xView2 Score: 0.0084
Epoch 2 took:  0 hours,  0 minutes, 25 seconds

Epoch 3/10
Train Loss: 1.2570
Confusion Matrix:
 [[4585276      92     936    1569       0]
 [1944987       0      71     967       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8234
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7000
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6997
Macro F1 Score: 0.2058
xView2 Score: 0.0003
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.1708
Confusion Matrix:
 [[4587562      62       0     249       0]
 [1945925       3       0      97       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8235
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0462
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7000
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.0735
Confusion Matrix:
 [[4587845       4       0      24       0]
 [1946020       0       0       5       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8236
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7000
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0157
Confusion Matrix:
 [[4587869       4       0       0       0]
 [1946025       0       0       0       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8236
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7001
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 0.9724
Confusion Matrix:
 [[4587873       0       0       0       0]
 [1946025       0       0       0       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8236
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7001
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9146
Confusion Matrix:
 [[4587873       0       0       0       0]
 [1946025       0       0       0       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8236
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7001
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8753
Confusion Matrix:
 [[4587873       0       0       0       0]
 [1946025       0       0       0       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8236
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7001
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8200
Confusion Matrix:
 [[4587873       0       0       0       0]
 [1946025       0       0       0       0]
 [  19299       0       0       0       0]
 [    403       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8236
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7001
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7001
Macro F1 Score: 0.2059
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5963
Best Macro F1: 0.1567
Best xView2 Score: 0.0746
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7081
Class 1 Precision: 0.2938
Class 2 Precision: 0.0019
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Macro Precision: 0.2008
ROC curve saved to .././____________optune_results/115/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/115/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/115/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/115/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/115/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/115/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/115/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2731819597691539, 1: 0.7510389379973716, 2: 142.25614878041887, 3: 1372.1823336968375, 4: 5292.497160883281}
Final class weights used in loss: [2.641969198268085, 9.453700265484537, 142.25614878041887, 1372.1823336968375, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6382
Confusion Matrix:
 [[1819443  318731 2109476  147167  361377]
 [ 496226  241969  896261   25754  126140]
 [   3097     113    4811       4      94]
 [    727      51    2029       0     130]
 [      0       0       0       0       0]]
Class 0 F1: 0.5143
Class 1 F1: 0.2062
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7844
Class 1 Precision: 0.4314
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3825
Class 1 Recall: 0.1355
Class 2 Recall: 0.5926
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3153
Macro F1 Score: 0.1447
xView2 Score: 0.1639
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5532
Confusion Matrix:
 [[2748774 1253820  619142   74787   59671]
 [ 554177  941127  255158   15747   20141]
 [   1862    4073    1677     380     127]
 [    655    1972     310       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6819
Class 1 F1: 0.4721
Class 2 F1: 0.0038
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8316
Class 1 Precision: 0.4276
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5779
Class 1 Recall: 0.5268
Class 2 Recall: 0.2066
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5633
Macro F1 Score: 0.2316
xView2 Score: 0.2457
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4788
Confusion Matrix:
 [[2770752 1885021   89297    6781    4343]
 [ 447008 1308404   28013    1927     998]
 [   2566    5454      95       2       2]
 [    119    2597     221       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6947
Class 1 F1: 0.5246
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8604
Class 1 Precision: 0.4087
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5826
Class 1 Recall: 0.7324
Class 2 Recall: 0.0117
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6224
Macro F1 Score: 0.2442
xView2 Score: 0.2764
Epoch 3 took:  0 hours,  1 minutes, 18 seconds

Epoch 4/10
Train Loss: 1.4019
Confusion Matrix:
 [[2621044 2125890    8659     497     104]
 [ 255765 1527827    2554     188      16]
 [   1245    6874       0       0       0]
 [    163    2774       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6866
Class 1 F1: 0.5607
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9106
Class 1 Precision: 0.4171
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5511
Class 1 Recall: 0.8553
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6331
Macro F1 Score: 0.2495
xView2 Score: 0.2976
Epoch 4 took:  0 hours,  0 minutes, 54 seconds

Epoch 5/10
Train Loss: 1.3025
Confusion Matrix:
 [[2468542 2287402     242       8       0]
 [ 241251 1545039      60       0       0]
 [   2664    5455       0       0       0]
 [    350    2587       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6610
Class 1 F1: 0.5492
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9100
Class 1 Precision: 0.4023
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5190
Class 1 Recall: 0.8649
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6124
Macro F1 Score: 0.3025
xView2 Score: 0.3272
Epoch 5 took:  0 hours,  0 minutes, 31 seconds

Epoch 6/10
Train Loss: 1.2244
Confusion Matrix:
 [[2457373 2298812       6       3       0]
 [ 144466 1641882       2       0       0]
 [    723    7396       0       0       0]
 [      0    2937       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6679
Class 1 F1: 0.5723
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9442
Class 1 Precision: 0.4156
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5167
Class 1 Recall: 0.9191
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6255
Macro F1 Score: 0.3101
xView2 Score: 0.3396
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1596
Confusion Matrix:
 [[2661654 2094539       1       0       0]
 [ 271852 1514498       0       0       0]
 [   2280    5839       0       0       0]
 [    353    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6920
Class 1 F1: 0.5605
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9065
Class 1 Precision: 0.4187
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5596
Class 1 Recall: 0.8478
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6372
Macro F1 Score: 0.3131
xView2 Score: 0.3289
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0774
Confusion Matrix:
 [[2475717 2280477       0       0       0]
 [ 170873 1615477       0       0       0]
 [   1358    6761       0       0       0]
 [    353    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6687
Class 1 F1: 0.5677
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9348
Class 1 Precision: 0.4137
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5205
Class 1 Recall: 0.9043
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6243
Macro F1 Score: 0.3091
xView2 Score: 0.3367
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0281
Confusion Matrix:
 [[2641887 2114307       0       0       0]
 [ 211304 1575046       0       0       0]
 [   1917    6202       0       0       0]
 [      0    2937       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6942
Class 1 F1: 0.5743
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9253
Class 1 Precision: 0.4259
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5555
Class 1 Recall: 0.8817
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6435
Macro F1 Score: 0.3171
xView2 Score: 0.3365
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0035
Confusion Matrix:
 [[2534904 2221290       0       0       0]
 [ 193761 1592589       0       0       0]
 [   2235    5884       0       0       0]
 [     43    2894       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6771
Class 1 F1: 0.5679
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9282
Class 1 Precision: 0.4166
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5330
Class 1 Recall: 0.8915
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6298
Macro F1 Score: 0.3113
xView2 Score: 0.3355
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6255
Best Macro F1: 0.3101
Best xView2 Score: 0.3396
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9442
Class 1 Precision: 0.4156
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3399
ROC curve saved to .././____________optune_results/116/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/116/plot_loss_curves.jpg
Prediction distribution: {0: 100761, 1: 161383}
ROC curve saved to .././____________optune_results/116/visualize_predictions.jpg
Prediction distribution: {0: 260431, 1: 1713}
ROC curve saved to .././____________optune_results/116/visualize_predictions.jpg
Prediction distribution: {0: 30943, 1: 231201}
ROC curve saved to .././____________optune_results/116/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/116/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/116/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2715149276263516, 1: 0.7641744635315638, 2: 130.36922837827336, 3: 1943.3068725868725, 4: 5732.533940774488}
Final class weights used in loss: [2.62584716891619, 0.8272801882935807, 130.36922837827336, 1943.3068725868725, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5259
Confusion Matrix:
 [[4180843   72976   20022  169413  199820]
 [1720972   26207    3936   74582   75848]
 [   4693       0       2       0     198]
 [   3932      11       0      15      57]
 [     73       0       0       0       0]]
Class 0 F1: 0.7923
Class 1 F1: 0.0262
Class 2 F1: 0.0001
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7074
Class 1 Precision: 0.2642
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.9004
Class 1 Recall: 0.0138
Class 2 Recall: 0.0004
Class 3 Recall: 0.0037
Class 4 Recall: 0.0000
Validation Accuracy: 0.6419
Macro F1 Score: 0.1638
xView2 Score: 0.0464
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4254
Confusion Matrix:
 [[4611955    4952     202    9715   16250]
 [1882776    2495     136    7090    9048]
 [   4893       0       0       0       0]
 [   3730       0       0       0     285]
 [     73       0       0       0       0]]
Class 0 F1: 0.8275
Class 1 F1: 0.0026
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7092
Class 1 Precision: 0.3350
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9933
Class 1 Recall: 0.0013
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7041
Macro F1 Score: 0.1660
xView2 Score: 0.0062
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.3376
Confusion Matrix:
 [[4642654     109       4     181     126]
 [1901084      62       5     228     166]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.3626
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7084
Macro F1 Score: 0.1659
xView2 Score: 0.0002
Epoch 3 took:  0 hours,  0 minutes, 52 seconds

Epoch 4/10
Train Loss: 1.2464
Confusion Matrix:
 [[4643058       5       0       6       5]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4014       0       0       0       1]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 4 took:  0 hours,  0 minutes, 29 seconds

Epoch 5/10
Train Loss: 1.1483
Confusion Matrix:
 [[4643073       0       0       1       0]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0689
Confusion Matrix:
 [[4643074       0       0       0       0]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0076
Confusion Matrix:
 [[4643074       0       0       0       0]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9381
Confusion Matrix:
 [[4643074       0       0       0       0]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.8877
Confusion Matrix:
 [[4643074       0       0       0       0]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8556
Confusion Matrix:
 [[4643074       0       0       0       0]
 [1901545       0       0       0       0]
 [   4893       0       0       0       0]
 [   4015       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8294
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7085
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7085
Macro F1 Score: 0.1659
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6419
Best Macro F1: 0.1638
Best xView2 Score: 0.0464
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7074
Class 1 Precision: 0.2642
Class 2 Precision: 0.0001
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Macro Precision: 0.1943
ROC curve saved to .././____________optune_results/117/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/117/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/117/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/117/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/117/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/117/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/117/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27608283266960615, 1: 0.7303183332049188, 2: 137.3680349344978, 3: 848.4768712070128, 4: 5732.533940774488}
Final class weights used in loss: [2.6700238211193223, 8.370245119761899, 137.3680349344978, 848.4768712070128, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6463
Confusion Matrix:
 [[1154008  670806 1762452    9702 1352814]
 [ 259718  348092  521004    4724  462674]
 [   1106     649    2203       0    2902]
 [      1       0     643       0      29]
 [      0       0      73       0       0]]
Class 0 F1: 0.3626
Class 1 F1: 0.2661
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8156
Class 1 Precision: 0.3414
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2331
Class 1 Recall: 0.2181
Class 2 Recall: 0.3211
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2295
Macro F1 Score: 0.1261
xView2 Score: 0.1708
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5566
Confusion Matrix:
 [[2113512 1620957  819316    2589  393408]
 [ 383441  886250  215771     767  109983]
 [   3891    1740    1112       0     117]
 [    654      10       9       0       0]
 [      0       3      70       0       0]]
Class 0 F1: 0.5673
Class 1 F1: 0.4318
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8449
Class 1 Precision: 0.3532
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4270
Class 1 Recall: 0.5552
Class 2 Recall: 0.1621
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4579
Macro F1 Score: 0.2002
xView2 Score: 0.2303
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4844
Confusion Matrix:
 [[2744555 1948047  173974     230   82976]
 [ 363630 1164374   50216      54   17938]
 [   1842    3470     945       0     603]
 [     38     188     447       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6810
Class 1 F1: 0.4942
Class 2 F1: 0.0081
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8825
Class 1 Precision: 0.3737
Class 2 Precision: 0.0042
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5545
Class 1 Recall: 0.7295
Class 2 Recall: 0.1378
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5966
Macro F1 Score: 0.2367
xView2 Score: 0.2697
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.4028
Confusion Matrix:
 [[2890569 2032389   20524       4    6296]
 [ 308095 1282848    4146       0    1123]
 [   3314    3546       0       0       0]
 [    117     556       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7092
Class 1 F1: 0.5219
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9027
Class 1 Precision: 0.3865
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5840
Class 1 Recall: 0.8037
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6368
Macro F1 Score: 0.2462
xView2 Score: 0.2811
Epoch 4 took:  0 hours,  1 minutes, 13 seconds

Epoch 5/10
Train Loss: 1.3261
Confusion Matrix:
 [[2733880 2213953    1497       0     452]
 [ 183443 1412350     313       0     106]
 [   1114    5746       0       0       0]
 [      0     673       0       0       0]
 [     19      54       0       0       0]]
Class 0 F1: 0.6949
Class 1 F1: 0.5402
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9368
Class 1 Precision: 0.3888
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5523
Class 1 Recall: 0.8848
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6327
Macro F1 Score: 0.2470
xView2 Score: 0.2937
Epoch 5 took:  0 hours,  0 minutes, 47 seconds

Epoch 6/10
Train Loss: 1.2408
Confusion Matrix:
 [[3033752 1916007      23       0       0]
 [ 235189 1360992      15       0      16]
 [    833    6027       0       0       0]
 [      0     673       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7382
Class 1 F1: 0.5578
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9278
Class 1 Precision: 0.4145
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6129
Class 1 Recall: 0.8526
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6706
Macro F1 Score: 0.2592
xView2 Score: 0.2965
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1831
Confusion Matrix:
 [[3041613 1908169       0       0       0]
 [ 308439 1287773       0       0       0]
 [   3070    3790       0       0       0]
 [    191     482       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7326
Class 1 F1: 0.5370
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9070
Class 1 Precision: 0.4024
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6145
Class 1 Recall: 0.8068
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6606
Macro F1 Score: 0.2539
xView2 Score: 0.2862
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1277
Confusion Matrix:
 [[3142887 1806892       3       0       0]
 [ 355646 1240566       0       0       0]
 [   3696    3164       0       0       0]
 [    673       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7436
Class 1 F1: 0.5339
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8972
Class 1 Precision: 0.4067
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6350
Class 1 Recall: 0.7772
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6689
Macro F1 Score: 0.2555
xView2 Score: 0.2826
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0806
Confusion Matrix:
 [[3100347 1849435       0       0       0]
 [ 309882 1286330       0       0       0]
 [   3263    3597       0       0       0]
 [    585      88       0       0       0]
 [     70       3       0       0       0]]
Class 0 F1: 0.7414
Class 1 F1: 0.5433
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9081
Class 1 Precision: 0.4097
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6264
Class 1 Recall: 0.8059
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6694
Macro F1 Score: 0.2569
xView2 Score: 0.2880
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0474
Confusion Matrix:
 [[3175670 1774112       0       0       0]
 [ 278050 1318162       0       0       0]
 [   2208    4652       0       0       0]
 [     18     655       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7556
Class 1 F1: 0.5617
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9189
Class 1 Precision: 0.4255
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6416
Class 1 Recall: 0.8258
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6857
Macro F1 Score: 0.2635
xView2 Score: 0.2953
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6706
Best Macro F1: 0.2592
Best xView2 Score: 0.2965
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9278
Class 1 Precision: 0.4145
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2685
ROC curve saved to .././____________optune_results/118/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/118/plot_loss_curves.jpg
Prediction distribution: {0: 204545, 1: 57599}
ROC curve saved to .././____________optune_results/118/visualize_predictions.jpg
Prediction distribution: {0: 22036, 1: 240108}
ROC curve saved to .././____________optune_results/118/visualize_predictions.jpg
Prediction distribution: {0: 171750, 1: 90394}
ROC curve saved to .././____________optune_results/118/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/118/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/118/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2709107130025618, 1: 0.7689333595084976, 2: 138.18264880298705, 3: 1007.2373023814289, 4: 68947.46301369862}
Final class weights used in loss: [2.6200037507543734, 10.073735458983869, 138.18264880298705, 1007.2373023814289, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6912
Confusion Matrix:
 [[  88883  746232 2584192  296459  885964]
 [  15154  464845  861370   97503  503436]
 [      1     620    3684     915    1856]
 [      0      15    1095      84     414]
 [      0     154     630      21      73]]
Class 0 F1: 0.0378
Class 1 F1: 0.2947
Class 2 F1: 0.0021
Class 3 F1: 0.0004
Class 4 F1: 0.0001
Class 0 Precision: 0.8543
Class 1 Precision: 0.3836
Class 2 Precision: 0.0011
Class 3 Precision: 0.0002
Class 4 Precision: 0.0001
Class 0 Recall: 0.0193
Class 1 Recall: 0.2393
Class 2 Recall: 0.5206
Class 3 Recall: 0.0522
Class 4 Recall: 0.0831
Validation Accuracy: 0.0851
Macro F1 Score: 0.0670
xView2 Score: 0.1938
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.6085
Confusion Matrix:
 [[ 263010 2377379 1633445  110473  217423]
 [  19392 1403347  390063   32125   97381]
 [     29    3223    3660      66      98]
 [      0     419     681      18     490]
 [      0     655      12      28     183]]
Class 0 F1: 0.1077
Class 1 F1: 0.4901
Class 2 F1: 0.0036
Class 3 F1: 0.0002
Class 4 F1: 0.0012
Class 0 Precision: 0.9312
Class 1 Precision: 0.3708
Class 2 Precision: 0.0018
Class 3 Precision: 0.0001
Class 4 Precision: 0.0006
Class 0 Recall: 0.0572
Class 1 Recall: 0.7225
Class 2 Recall: 0.5172
Class 3 Recall: 0.0112
Class 4 Recall: 0.2084
Validation Accuracy: 0.2549
Macro F1 Score: 0.1206
xView2 Score: 0.2615
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5336
Confusion Matrix:
 [[ 615818 3196551  734076   26573   28712]
 [  36396 1764153  124467    5947   11345]
 [   1058    4132    1882       2       2]
 [     87    1074     447       0       0]
 [      0     875       3       0       0]]
Class 0 F1: 0.2344
Class 1 F1: 0.5107
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9425
Class 1 Precision: 0.3552
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1338
Class 1 Recall: 0.9083
Class 2 Recall: 0.2660
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3634
Macro F1 Score: 0.1499
xView2 Score: 0.2833
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4598
Confusion Matrix:
 [[1037854 3360464  199725    2061    1626]
 [  55289 1852494   34167     122     236]
 [   1816    4630     630       0       0]
 [    260     947     401       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.3644
Class 1 F1: 0.5173
Class 2 F1: 0.0052
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9476
Class 1 Precision: 0.3549
Class 2 Precision: 0.0027
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2255
Class 1 Recall: 0.9538
Class 2 Recall: 0.0890
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4411
Macro F1 Score: 0.1774
xView2 Score: 0.2940
Epoch 4 took:  0 hours,  1 minutes, 14 seconds

Epoch 5/10
Train Loss: 1.3593
Confusion Matrix:
 [[1156997 3390799   53764      78      92]
 [  41267 1896345    4606      41      49]
 [    926    6145       5       0       0]
 [    224    1384       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.3989
Class 1 F1: 0.5240
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9646
Class 1 Precision: 0.3581
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2514
Class 1 Recall: 0.9763
Class 2 Recall: 0.0007
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4659
Macro F1 Score: 0.1846
xView2 Score: 0.2950
Epoch 5 took:  0 hours,  0 minutes, 45 seconds

Epoch 6/10
Train Loss: 1.2931
Confusion Matrix:
 [[1309910 3282065    9737      15       3]
 [  66889 1873668    1741       4       6]
 [   1454    5622       0       0       0]
 [    664     944       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.4380
Class 1 F1: 0.5274
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9500
Class 1 Precision: 0.3629
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2847
Class 1 Recall: 0.9647
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4858
Macro F1 Score: 0.1931
xView2 Score: 0.2957
Epoch 6 took:  0 hours,  0 minutes, 31 seconds

Epoch 7/10
Train Loss: 1.2019
Confusion Matrix:
 [[1379909 3220085    1736       0       0]
 [  39742 1901984     581       0       1]
 [     87    6963      26       0       0]
 [      0    1608       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.4583
Class 1 F1: 0.5378
Class 2 F1: 0.0055
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9719
Class 1 Precision: 0.3706
Class 2 Precision: 0.0111
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2999
Class 1 Recall: 0.9792
Class 2 Recall: 0.0037
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5008
Macro F1 Score: 0.2003
xView2 Score: 0.3010
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.1617
Confusion Matrix:
 [[1649351 2952305      74       0       0]
 [  90843 1851452      11       0       2]
 [    739    6337       0       0       0]
 [    664     944       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.5200
Class 1 F1: 0.5482
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9470
Class 1 Precision: 0.3848
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3584
Class 1 Recall: 0.9532
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5342
Macro F1 Score: 0.2137
xView2 Score: 0.3013
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0967
Confusion Matrix:
 [[1633245 2968436      49       0       0]
 [ 126541 1815766       1       0       0]
 [   2434    4640       2       0       0]
 [    372    1236       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.5133
Class 1 F1: 0.5393
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9266
Class 1 Precision: 0.3790
Class 2 Precision: 0.0385
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3549
Class 1 Recall: 0.9348
Class 2 Recall: 0.0003
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5263
Macro F1 Score: 0.2106
xView2 Score: 0.2973
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0529
Confusion Matrix:
 [[1684892 2916822      16       0       0]
 [ 115239 1827068       1       0       0]
 [   1186    5890       0       0       0]
 [    664     944       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.5262
Class 1 F1: 0.5459
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9350
Class 1 Precision: 0.3845
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3661
Class 1 Recall: 0.9407
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5359
Macro F1 Score: 0.2144
xView2 Score: 0.2997
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5342
Best Macro F1: 0.2137
Best xView2 Score: 0.3013
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9470
Class 1 Precision: 0.3848
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2664
ROC curve saved to .././____________optune_results/119/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/119/plot_loss_curves.jpg
Prediction distribution: {0: 259962, 1: 2182}
ROC curve saved to .././____________optune_results/119/visualize_predictions.jpg
Prediction distribution: {0: 11479, 1: 250665}
ROC curve saved to .././____________optune_results/119/visualize_predictions.jpg
Prediction distribution: {0: 41891, 1: 220252, 2: 1}
ROC curve saved to .././____________optune_results/119/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/119/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/119/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.34237690303762786, 1: 0.9315086503653364, 2: 201.0563722357152, 3: 1349.229251554793}
Final class weights used in loss: [3.311160198089947, 1.0604069192794048, 201.0563722357152, 1349.229251554793, 1.0]

Epoch 1/10
Train Loss: 1.5518
Confusion Matrix:
 [[3095059  248409  146832 1183791  130505]
 [ 976032  191877   99130  425667   41197]
 [   7952    1222     221    2689     124]
 [   1261      60       4     494     123]
 [    851       2       0      98       0]]
Class 0 F1: 0.6966
Class 1 F1: 0.1764
Class 2 F1: 0.0017
Class 3 F1: 0.0006
Class 4 F1: 0.0000
Class 0 Precision: 0.7584
Class 1 Precision: 0.4345
Class 2 Precision: 0.0009
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.6442
Class 1 Recall: 0.1107
Class 2 Recall: 0.0181
Class 3 Recall: 0.2544
Class 4 Recall: 0.0000
Validation Accuracy: 0.5017
Macro F1 Score: 0.1751
xView2 Score: 0.1372
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4672
Confusion Matrix:
 [[4387775   64442   44578  289860   17941]
 [1470136   66711   30206  157484    9366]
 [  10957     173     146     751     181]
 [   1669      57       2     214       0]
 [    776      17      70      72      16]]
Class 0 F1: 0.8220
Class 1 F1: 0.0715
Class 2 F1: 0.0033
Class 3 F1: 0.0010
Class 4 F1: 0.0011
Class 0 Precision: 0.7473
Class 1 Precision: 0.5077
Class 2 Precision: 0.0019
Class 3 Precision: 0.0005
Class 4 Precision: 0.0006
Class 0 Recall: 0.9132
Class 1 Recall: 0.0385
Class 2 Recall: 0.0120
Class 3 Recall: 0.1102
Class 4 Recall: 0.0168
Validation Accuracy: 0.6798
Macro F1 Score: 0.1798
xView2 Score: 0.0776
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.3779
Confusion Matrix:
 [[4751900    7942    6992   36667    1095]
 [1685515   10161    6964   30555     708]
 [  11987       0      11     210       0]
 [   1930       0       0      12       0]
 [    921       0      10      20       0]]
Class 0 F1: 0.8443
Class 1 F1: 0.0116
Class 2 F1: 0.0008
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.7365
Class 1 Precision: 0.5613
Class 2 Precision: 0.0008
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.9890
Class 1 Recall: 0.0059
Class 2 Recall: 0.0009
Class 3 Recall: 0.0062
Class 4 Recall: 0.0000
Validation Accuracy: 0.7266
Macro F1 Score: 0.1714
xView2 Score: 0.0177
Epoch 3 took:  0 hours,  1 minutes,  1 seconds

Epoch 4/10
Train Loss: 1.2927
Confusion Matrix:
 [[4793365    3248    2040    5860      83]
 [1719998    4756    2877    6144     128]
 [  12200       0       0       8       0]
 [   1942       0       0       0       0]
 [    945       0       5       0       1]]
Class 0 F1: 0.8459
Class 1 F1: 0.0055
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0017
Class 0 Precision: 0.7342
Class 1 Precision: 0.5942
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0047
Class 0 Recall: 0.9977
Class 1 Recall: 0.0027
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0011
Validation Accuracy: 0.7321
Macro F1 Score: 0.1706
xView2 Score: 0.0057
Epoch 4 took:  0 hours,  0 minutes, 33 seconds

Epoch 5/10
Train Loss: 1.2016
Confusion Matrix:
 [[4802461     321     349    1465       0]
 [1731285     506     794    1318       0]
 [  12208       0       0       0       0]
 [   1942       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7333
Class 1 Precision: 0.6119
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7329
Macro F1 Score: 0.1693
xView2 Score: 0.0010
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1258
Confusion Matrix:
 [[4803935      17      60     584       0]
 [1733500      55      55     293       0]
 [  12208       0       0       0       0]
 [   1942       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7331
Class 1 Precision: 0.7639
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7330
Macro F1 Score: 0.1692
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0545
Confusion Matrix:
 [[4804580       0       0      16       0]
 [1733873       4       0      26       0]
 [  12208       0       0       0       0]
 [   1942       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7331
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7331
Macro F1 Score: 0.1692
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9802
Confusion Matrix:
 [[4804596       0       0       0       0]
 [1733903       0       0       0       0]
 [  12208       0       0       0       0]
 [   1942       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7331
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7331
Macro F1 Score: 0.1692
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9187
Confusion Matrix:
 [[4804596       0       0       0       0]
 [1733903       0       0       0       0]
 [  12208       0       0       0       0]
 [   1942       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7331
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7331
Macro F1 Score: 0.1692
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8806
Confusion Matrix:
 [[4804596       0       0       0       0]
 [1733903       0       0       0       0]
 [  12208       0       0       0       0]
 [   1942       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8460
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7331
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7331
Macro F1 Score: 0.1692
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5017
Best Macro F1: 0.1751
Best xView2 Score: 0.1372
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7584
Class 1 Precision: 0.4345
Class 2 Precision: 0.0009
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Macro Precision: 0.2388
ROC curve saved to .././____________optune_results/120/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/120/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/120/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/120/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/120/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/120/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/120/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2794096693897439, 1: 0.7084159251977813, 2: 124.46005934718102, 3: 822.0096031357178, 4: 5732.533940774488}
Final class weights used in loss: [2.70219798133729, 1.3181494491683816, 124.46005934718102, 822.0096031357178, 5732.533940774488]

Epoch 1/10
Train Loss: 1.4640
Confusion Matrix:
 [[5098030   21838   14788    6116   26076]
 [1348561   12768    3330    2963   15515]
 [   3038       0       0       0      22]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8777
Class 1 F1: 0.0180
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7904
Class 1 Precision: 0.3690
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9867
Class 1 Recall: 0.0092
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7798
Macro F1 Score: 0.1791
xView2 Score: 0.0165
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.3876
Confusion Matrix:
 [[5159901    5664     744      94     445]
 [1378434    3998     136     109     460]
 [   3059       1       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8814
Class 1 F1: 0.0057
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7887
Class 1 Precision: 0.4137
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9987
Class 1 Recall: 0.0029
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7879
Macro F1 Score: 0.1774
xView2 Score: 0.0028
Epoch 2 took:  0 hours,  1 minutes,  4 seconds

Epoch 3/10
Train Loss: 1.3213
Confusion Matrix:
 [[5165966     867       7       0       8]
 [1382398     722       4       0      13]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0010
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7885
Class 1 Precision: 0.4544
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0005
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1765
xView2 Score: 0.0005
Epoch 3 took:  0 hours,  0 minutes, 31 seconds

Epoch 4/10
Train Loss: 1.2362
Confusion Matrix:
 [[5166703     145       0       0       0]
 [1382980     157       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.5199
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1764
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1736
Confusion Matrix:
 [[5166842       6       0       0       0]
 [1383122      15       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.7143
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1763
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1182
Confusion Matrix:
 [[5166802      46       0       0       0]
 [1383133       4       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.0800
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1763
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0581
Confusion Matrix:
 [[5166848       0       0       0       0]
 [1383137       0       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1763
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0145
Confusion Matrix:
 [[5166848       0       0       0       0]
 [1383137       0       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1763
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9576
Confusion Matrix:
 [[5166848       0       0       0       0]
 [1383137       0       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1763
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9453
Confusion Matrix:
 [[5166848       0       0       0       0]
 [1383137       0       0       0       0]
 [   3060       0       0       0       0]
 [    482       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8817
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7884
Macro F1 Score: 0.1763
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7798
Best Macro F1: 0.1791
Best xView2 Score: 0.0165
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7904
Class 1 Precision: 0.3690
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2319
ROC curve saved to .././____________optune_results/121/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/121/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/121/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/121/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/121/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/121/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/121/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2777386796913179, 1: 0.7190118332358587, 2: 137.88359312933184, 3: 797.3961977186311, 4: 5292.497160883281}
Final class weights used in loss: [2.686037678081558, 2.8481363321679143, 137.88359312933184, 797.3961977186311, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5803
Confusion Matrix:
 [[2026716 1717412  319283  479977  515083]
 [ 628015  491033   48850  176634  143307]
 [   3272    1545     704    1230     246]
 [     63     169       0      61       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5253
Class 1 F1: 0.2656
Class 2 F1: 0.0037
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.7625
Class 1 Precision: 0.2222
Class 2 Precision: 0.0019
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.4007
Class 1 Recall: 0.3300
Class 2 Recall: 0.1006
Class 3 Recall: 0.2082
Class 4 Recall: 0.0000
Validation Accuracy: 0.3843
Macro F1 Score: 0.1590
xView2 Score: 0.1691
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5057
Confusion Matrix:
 [[4318278  554330   22842   57220  105801]
 [1112501  306532   10075   26881   31850]
 [   6216     225       0     188     368]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8229
Class 1 F1: 0.2610
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7942
Class 1 Precision: 0.3560
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8537
Class 1 Recall: 0.2060
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7057
Macro F1 Score: 0.2168
xView2 Score: 0.1342
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4352
Confusion Matrix:
 [[4715427  324791    1860    5305   11088]
 [1219238  262028    1105    1949    3519]
 [   6651     335       0       2       9]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8573
Class 1 F1: 0.2526
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7936
Class 1 Precision: 0.4463
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9322
Class 1 Recall: 0.1761
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7595
Macro F1 Score: 0.2220
xView2 Score: 0.1185
Epoch 3 took:  0 hours,  1 minutes, 15 seconds

Epoch 4/10
Train Loss: 1.3721
Confusion Matrix:
 [[4666114  390967     134     492     764]
 [1104874  382380     117     242     226]
 [   5894    1103       0       0       0]
 [     78     215       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.3380
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8077
Class 1 Precision: 0.4936
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9224
Class 1 Recall: 0.2570
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7703
Macro F1 Score: 0.2399
xView2 Score: 0.1587
Epoch 4 took:  0 hours,  0 minutes, 51 seconds

Epoch 5/10
Train Loss: 1.2884
Confusion Matrix:
 [[4636793  421580       9       8      81]
 [1065994  421789      29       0      27]
 [   5503    1494       0       0       0]
 [    288       5       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.3616
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8123
Class 1 Precision: 0.4992
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9166
Class 1 Recall: 0.2835
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7719
Macro F1 Score: 0.2446
xView2 Score: 0.1703
Epoch 5 took:  0 hours,  0 minutes, 29 seconds

Epoch 6/10
Train Loss: 1.2328
Confusion Matrix:
 [[4610323  448148       0       0       0]
 [1043460  444375       4       0       0]
 [   6498     499       0       0       0]
 [    274      19       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8602
Class 1 F1: 0.3733
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8145
Class 1 Precision: 0.4976
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9114
Class 1 Recall: 0.2987
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7713
Macro F1 Score: 0.3084
xView2 Score: 0.1922
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1820
Confusion Matrix:
 [[4626608  431863       0       0       0]
 [1041133  446706       0       0       0]
 [   4696    2301       0       0       0]
 [    258      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8623
Class 1 F1: 0.3772
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8156
Class 1 Precision: 0.5071
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9146
Class 1 Recall: 0.3002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7741
Macro F1 Score: 0.3099
xView2 Score: 0.1941
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1239
Confusion Matrix:
 [[4369251  689220       0       0       0]
 [ 837930  649909       0       0       0]
 [   4157    2840       0       0       0]
 [    177     116       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8509
Class 1 F1: 0.4593
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8384
Class 1 Precision: 0.4843
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8637
Class 1 Recall: 0.4368
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7659
Macro F1 Score: 0.3275
xView2 Score: 0.2443
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0888
Confusion Matrix:
 [[4576279  482192       0       0       0]
 [ 987746  500093       0       0       0]
 [   5475    1522       0       0       0]
 [    285       8       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8612
Class 1 F1: 0.4047
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8216
Class 1 Precision: 0.5083
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9047
Class 1 Recall: 0.3361
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7746
Macro F1 Score: 0.3165
xView2 Score: 0.2094
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0338
Confusion Matrix:
 [[4529782  528689       0       0       0]
 [ 949090  538749       0       0       0]
 [   4824    2173       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8593
Class 1 F1: 0.4213
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8260
Class 1 Precision: 0.5037
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8955
Class 1 Recall: 0.3621
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7734
Macro F1 Score: 0.3202
xView2 Score: 0.2195
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7659
Best Macro F1: 0.3275
Best xView2 Score: 0.2443
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8384
Class 1 Precision: 0.4843
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3307
ROC curve saved to .././____________optune_results/122/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/122/plot_loss_curves.jpg
Prediction distribution: {0: 258994, 1: 3150}
ROC curve saved to .././____________optune_results/122/visualize_predictions.jpg
Prediction distribution: {0: 176823, 1: 85321}
ROC curve saved to .././____________optune_results/122/visualize_predictions.jpg
Prediction distribution: {0: 157726, 1: 104418}
ROC curve saved to .././____________optune_results/122/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/122/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/122/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2690109529249988, 1: 0.7837028771837821, 2: 167.70507796881247, 3: 1412.223569023569, 4: 68947.46301369862}
Final class weights used in loss: [2.601630986999175, 2.0828351950504547, 167.70507796881247, 1412.223569023569, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5188
Confusion Matrix:
 [[3446375  404457  307627  224970   87098]
 [1388180  331755  177509  121404   46818]
 [   8178     972     257    3230     851]
 [   2951      60       0       0      30]
 [    798       0       0       0      80]]
Class 0 F1: 0.7398
Class 1 F1: 0.2367
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0012
Class 0 Precision: 0.7111
Class 1 Precision: 0.4500
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0006
Class 0 Recall: 0.7709
Class 1 Recall: 0.1606
Class 2 Recall: 0.0191
Class 3 Recall: 0.0000
Class 4 Recall: 0.0911
Validation Accuracy: 0.5765
Macro F1 Score: 0.1957
xView2 Score: 0.1477
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4334
Confusion Matrix:
 [[4151643  213780   62739   33914    8451]
 [1794662  198482   44437   23280    4805]
 [  13250     105      19     114       0]
 [   2994       0      47       0       0]
 [    800       6      72       0       0]]
Class 0 F1: 0.7958
Class 1 F1: 0.1602
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6962
Class 1 Precision: 0.4813
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9287
Class 1 Recall: 0.0961
Class 2 Recall: 0.0014
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6638
Macro F1 Score: 0.1913
xView2 Score: 0.0855
Epoch 2 took:  0 hours,  1 minutes, 15 seconds

Epoch 3/10
Train Loss: 1.3622
Confusion Matrix:
 [[4383491   73940    9748    3107     241]
 [1984106   75101    5372     982     105]
 [  13314     173       0       0       1]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8076
Class 1 F1: 0.0678
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6865
Class 1 Precision: 0.5033
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9805
Class 1 Recall: 0.0364
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6803
Macro F1 Score: 0.1751
xView2 Score: 0.0316
Epoch 3 took:  0 hours,  0 minutes, 38 seconds

Epoch 4/10
Train Loss: 1.2765
Confusion Matrix:
 [[4349086  119651    1488     291      11]
 [1938346  126189    1098      33       0]
 [  13314     174       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8072
Class 1 F1: 0.1092
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6898
Class 1 Precision: 0.5129
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9728
Class 1 Recall: 0.0611
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6829
Macro F1 Score: 0.1833
xView2 Score: 0.0489
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.1910
Confusion Matrix:
 [[4390182   80116     229       0       0]
 [1972922   92603     139       2       0]
 [  13452      36       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8092
Class 1 F1: 0.0827
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6881
Class 1 Precision: 0.5360
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9820
Class 1 Recall: 0.0448
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6840
Macro F1 Score: 0.1784
xView2 Score: 0.0367
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1300
Confusion Matrix:
 [[4402208   68272      47       0       0]
 [1989463   76164      39       0       0]
 [  13441      47       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8093
Class 1 F1: 0.0689
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6869
Class 1 Precision: 0.5271
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9847
Class 1 Recall: 0.0369
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6833
Macro F1 Score: 0.1756
xView2 Score: 0.0305
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0805
Confusion Matrix:
 [[4436432   34092       3       0       0]
 [2018786   46866      14       0       0]
 [  13488       0       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8108
Class 1 F1: 0.0437
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6854
Class 1 Precision: 0.5789
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9924
Class 1 Recall: 0.0227
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6841
Macro F1 Score: 0.1709
xView2 Score: 0.0192
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0264
Confusion Matrix:
 [[4426917   43608       2       0       0]
 [2012337   53320       9       0       0]
 [  13488       0       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8103
Class 1 F1: 0.0493
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6856
Class 1 Precision: 0.5501
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9902
Class 1 Recall: 0.0258
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6836
Macro F1 Score: 0.1719
xView2 Score: 0.0217
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9856
Confusion Matrix:
 [[4444383   26143       1       0       0]
 [2028093   37568       5       0       0]
 [  13488       0       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8110
Class 1 F1: 0.0353
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6848
Class 1 Precision: 0.5897
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9942
Class 1 Recall: 0.0182
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6839
Macro F1 Score: 0.1693
xView2 Score: 0.0155
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9422
Confusion Matrix:
 [[4444112   26415       0       0       0]
 [2024345   41321       0       0       0]
 [  13488       0       0       0       0]
 [   3041       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8112
Class 1 F1: 0.0387
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6852
Class 1 Precision: 0.6100
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9941
Class 1 Recall: 0.0200
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6844
Macro F1 Score: 0.1700
xView2 Score: 0.0170
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5765
Best Macro F1: 0.1957
Best xView2 Score: 0.1477
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7111
Class 1 Precision: 0.4500
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0006
Macro Precision: 0.2324
ROC curve saved to .././____________optune_results/123/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/123/plot_loss_curves.jpg
Prediction distribution: {0: 260647, 1: 1497}
ROC curve saved to .././____________optune_results/123/visualize_predictions.jpg
Prediction distribution: {0: 262095, 1: 49}
ROC curve saved to .././____________optune_results/123/visualize_predictions.jpg
Prediction distribution: {0: 262087, 1: 57}
ROC curve saved to .././____________optune_results/123/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/123/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/123/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2744182719400938, 1: 0.7414030043735895, 2: 160.87594451192226, 3: 1372.1823336968375, 4: 5292.497160883281}
Final class weights used in loss: [2.6539256930447803, 4.545024045342263, 160.87594451192226, 1372.1823336968375, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5699
Confusion Matrix:
 [[2161348 1803179  657147  214591    2934]
 [ 593431  687564  312514  105242     499]
 [   5353    4191    2302     363       5]
 [   1469    1160     298      10       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5687
Class 1 F1: 0.3278
Class 2 F1: 0.0047
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7826
Class 1 Precision: 0.2755
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4466
Class 1 Recall: 0.4046
Class 2 Recall: 0.1885
Class 3 Recall: 0.0034
Class 4 Recall: 0.0000
Validation Accuracy: 0.4351
Macro F1 Score: 0.1802
xView2 Score: 0.2039
Epoch 1 took:  0 hours,  1 minutes,  4 seconds

Epoch 2/10
Train Loss: 1.4912
Confusion Matrix:
 [[2996200 1663255  133439   46094     211]
 [ 714223  900068   58867   26054      38]
 [   6589    5419     152      54       0]
 [    499    1820     618       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7003
Class 1 F1: 0.4216
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8060
Class 1 Precision: 0.3501
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6192
Class 1 Recall: 0.5297
Class 2 Recall: 0.0124
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5945
Macro F1 Score: 0.2247
xView2 Score: 0.2282
Epoch 2 took:  0 hours,  0 minutes, 39 seconds

Epoch 3/10
Train Loss: 1.4226
Confusion Matrix:
 [[3593209 1229346   12035    4600       9]
 [ 797496  893822    5162    2770       0]
 [   6749    5324     141       0       0]
 [    940    1997       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7780
Class 1 F1: 0.4668
Class 2 F1: 0.0095
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8169
Class 1 Precision: 0.4195
Class 2 Precision: 0.0081
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7425
Class 1 Recall: 0.5260
Class 2 Recall: 0.0115
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6847
Macro F1 Score: 0.2509
xView2 Score: 0.2641
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3541
Confusion Matrix:
 [[3321103 1516390    1316     367      23]
 [ 642994 1055513     481     262       0]
 [   6020    6194       0       0       0]
 [    371    2566       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7540
Class 1 F1: 0.4932
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8364
Class 1 Precision: 0.4090
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6863
Class 1 Recall: 0.6212
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6678
Macro F1 Score: 0.2494
xView2 Score: 0.2824
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2694
Confusion Matrix:
 [[3233819 1605350       5      24       1]
 [ 514331 1184902       2      15       0]
 [   4781    7433       0       0       0]
 [    432    2505       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7527
Class 1 F1: 0.5267
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8616
Class 1 Precision: 0.4232
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6683
Class 1 Recall: 0.6973
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6742
Macro F1 Score: 0.2559
xView2 Score: 0.3021
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2163
Confusion Matrix:
 [[3305100 1534092       0       7       0]
 [ 577500 1121750       0       0       0]
 [   5155    7059       0       0       0]
 [    430    2507       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7574
Class 1 F1: 0.5140
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8500
Class 1 Precision: 0.4209
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6830
Class 1 Recall: 0.6601
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6755
Macro F1 Score: 0.3179
xView2 Score: 0.2937
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1432
Confusion Matrix:
 [[3303005 1536194       0       0       0]
 [ 544045 1155205       0       0       0]
 [   5884    6330       0       0       0]
 [    353    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7600
Class 1 F1: 0.5251
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8572
Class 1 Precision: 0.4278
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6826
Class 1 Recall: 0.6798
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6803
Macro F1 Score: 0.3213
xView2 Score: 0.2994
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0784
Confusion Matrix:
 [[3315097 1524102       0       0       0]
 [ 558313 1140937       0       0       0]
 [   5637    6577       0       0       0]
 [    351    2586       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7605
Class 1 F1: 0.5218
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8545
Class 1 Precision: 0.4266
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6851
Class 1 Recall: 0.6714
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6799
Macro F1 Score: 0.3206
xView2 Score: 0.2974
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0365
Confusion Matrix:
 [[3357668 1481531       0       0       0]
 [ 589989 1109261       0       0       0]
 [   5490    6724       0       0       0]
 [    353    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7637
Class 1 F1: 0.5160
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8493
Class 1 Precision: 0.4266
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6938
Class 1 Recall: 0.6528
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6816
Macro F1 Score: 0.3199
xView2 Score: 0.2933
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0098
Confusion Matrix:
 [[3404825 1434374       0       0       0]
 [ 617160 1082090       0       0       0]
 [   6531    5683       0       0       0]
 [    353    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7679
Class 1 F1: 0.5124
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8451
Class 1 Precision: 0.4286
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7036
Class 1 Recall: 0.6368
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6846
Macro F1 Score: 0.3201
xView2 Score: 0.2901
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6742
Best Macro F1: 0.2559
Best xView2 Score: 0.3021
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8616
Class 1 Precision: 0.4232
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2569
ROC curve saved to .././____________optune_results/124/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/124/plot_loss_curves.jpg
Prediction distribution: {0: 160032, 1: 102112}
ROC curve saved to .././____________optune_results/124/visualize_predictions.jpg
Prediction distribution: {0: 79917, 1: 182227}
ROC curve saved to .././____________optune_results/124/visualize_predictions.jpg
Prediction distribution: {0: 66509, 1: 195635}
ROC curve saved to .././____________optune_results/124/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/124/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/124/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27611577457621483, 1: 0.7305412563040322, 2: 117.71832725231546, 3: 1251.719671723452, 4: 5292.497160883281}
Final class weights used in loss: [2.670342405489483, 5.33868858182052, 117.71832725231546, 1251.719671723452, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5488
Confusion Matrix:
 [[ 531420 2520046 1898333    1922     236]
 [  81458 1065772  451076       9       0]
 [      0       1     743       0       0]
 [     46    2132     406       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1910
Class 1 F1: 0.4110
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8670
Class 1 Precision: 0.2970
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1073
Class 1 Recall: 0.6668
Class 2 Recall: 0.9987
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2438
Macro F1 Score: 0.1205
xView2 Score: 0.2614
Epoch 1 took:  0 hours,  0 minutes, 34 seconds

Epoch 2/10
Train Loss: 1.4786
Confusion Matrix:
 [[1893264 2455796  602791     101       5]
 [ 189971 1294320  114024       0       0]
 [      0     708      36       0       0]
 [   1274    1310       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5381
Class 1 F1: 0.4838
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9083
Class 1 Precision: 0.3450
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3823
Class 1 Recall: 0.8098
Class 2 Recall: 0.0484
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4864
Macro F1 Score: 0.2044
xView2 Score: 0.2960
Epoch 2 took:  0 hours,  0 minutes, 27 seconds

Epoch 3/10
Train Loss: 1.4188
Confusion Matrix:
 [[2847892 2020925   83140       0       0]
 [ 295181 1283980   19154       0       0]
 [     21     723       0       0       0]
 [    326    2258       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7036
Class 1 F1: 0.5234
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9060
Class 1 Precision: 0.3882
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5751
Class 1 Recall: 0.8033
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6305
Macro F1 Score: 0.3067
xView2 Score: 0.3121
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.3516
Confusion Matrix:
 [[3152366 1794253    5338       0       0]
 [ 273529 1322997    1789       0       0]
 [     58     686       0       0       0]
 [      0    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7525
Class 1 F1: 0.5607
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9201
Class 1 Precision: 0.4240
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6366
Class 1 Recall: 0.8277
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6829
Macro F1 Score: 0.3283
xView2 Score: 0.3268
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2955
Confusion Matrix:
 [[3208501 1742750     706       0       0]
 [ 266306 1331779     230       0       0]
 [     94     650       0       0       0]
 [      0    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7615
Class 1 F1: 0.5696
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9233
Class 1 Precision: 0.4327
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6479
Class 1 Recall: 0.8332
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6928
Macro F1 Score: 0.3328
xView2 Score: 0.3301
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2261
Confusion Matrix:
 [[3284115 1667731     111       0       0]
 [ 287583 1310700      32       0       0]
 [     85     659       0       0       0]
 [      0    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7706
Class 1 F1: 0.5724
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9195
Class 1 Precision: 0.4396
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6632
Class 1 Recall: 0.8201
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7011
Macro F1 Score: 0.3357
xView2 Score: 0.3295
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1685
Confusion Matrix:
 [[3361719 1590235       3       0       0]
 [ 306515 1291782      18       0       0]
 [     85     659       0       0       0]
 [      0    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7800
Class 1 F1: 0.5762
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9164
Class 1 Precision: 0.4477
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6789
Class 1 Recall: 0.8082
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7101
Macro F1 Score: 0.3390
xView2 Score: 0.3294
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1333
Confusion Matrix:
 [[3465791 1486165       1       0       0]
 [ 363066 1235248       1       0       0]
 [     96     648       0       0       0]
 [      0    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7894
Class 1 F1: 0.5715
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9052
Class 1 Precision: 0.4534
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6999
Class 1 Recall: 0.7728
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7173
Macro F1 Score: 0.3402
xView2 Score: 0.3242
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1066
Confusion Matrix:
 [[3401296 1550661       0       0       0]
 [ 303321 1294993       1       0       0]
 [     85     659       0       0       0]
 [      0    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7858
Class 1 F1: 0.5824
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9181
Class 1 Precision: 0.4546
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6869
Class 1 Recall: 0.8102
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7166
Macro F1 Score: 0.3421
xView2 Score: 0.3315
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0458
Confusion Matrix:
 [[3469880 1482077       0       0       0]
 [ 328513 1269802       0       0       0]
 [     85     659       0       0       0]
 [   1103    1481       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7930
Class 1 F1: 0.5835
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9132
Class 1 Precision: 0.4611
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7007
Class 1 Recall: 0.7945
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7232
Macro F1 Score: 0.3441
xView2 Score: 0.3301
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7166
Best Macro F1: 0.3421
Best xView2 Score: 0.3315
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9181
Class 1 Precision: 0.4546
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3432
ROC curve saved to .././____________optune_results/125/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/125/plot_loss_curves.jpg
Prediction distribution: {0: 21155, 1: 240989}
ROC curve saved to .././____________optune_results/125/visualize_predictions.jpg
Prediction distribution: {0: 218689, 1: 43455}
ROC curve saved to .././____________optune_results/125/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/125/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/125/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/125/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27642368778425797, 1: 0.7281866272680397, 2: 131.76169009659938, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6733202639545053, 1.1552296974952403, 131.76169009659938, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5910
Confusion Matrix:
 [[2700121  249891 1603637  102690  315923]
 [ 569330  117211  716246   18108  155142]
 [   2270     330    2432       2     267]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6551
Class 1 F1: 0.1206
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8253
Class 1 Precision: 0.3190
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5430
Class 1 Recall: 0.0744
Class 2 Recall: 0.4588
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4303
Macro F1 Score: 0.1556
xView2 Score: 0.1449
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4983
Confusion Matrix:
 [[4424848   87179  405081    5371   49783]
 [1230904   55254  249691    4249   35939]
 [   4666      17     558       0      60]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8323
Class 1 F1: 0.0643
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7817
Class 1 Precision: 0.3879
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8899
Class 1 Recall: 0.0351
Class 2 Recall: 0.1053
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6837
Macro F1 Score: 0.1797
xView2 Score: 0.0939
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4096
Confusion Matrix:
 [[4894708   21133   50898     581    4942]
 [1518913   14602   37893     559    4070]
 [   5289       0      12       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8594
Class 1 F1: 0.0181
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7625
Class 1 Precision: 0.4086
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9844
Class 1 Recall: 0.0093
Class 2 Recall: 0.0023
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7491
Macro F1 Score: 0.1756
xView2 Score: 0.0226
Epoch 3 took:  0 hours,  1 minutes, 13 seconds

Epoch 4/10
Train Loss: 1.3248
Confusion Matrix:
 [[4960666    6937    4078      45     536]
 [1565375    7059    3081      63     459]
 [   5300       0       1       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8625
Class 1 F1: 0.0089
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7595
Class 1 Precision: 0.5044
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9977
Class 1 Recall: 0.0045
Class 2 Recall: 0.0002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7580
Macro F1 Score: 0.1743
xView2 Score: 0.0053
Epoch 4 took:  0 hours,  0 minutes, 43 seconds

Epoch 5/10
Train Loss: 1.2377
Confusion Matrix:
 [[4970115    1953     192       2       0]
 [1572697    3145     188       5       2]
 [   5301       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8628
Class 1 F1: 0.0040
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7590
Class 1 Precision: 0.6169
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0020
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7589
Macro F1 Score: 0.1734
xView2 Score: 0.0018
Epoch 5 took:  0 hours,  0 minutes, 29 seconds

Epoch 6/10
Train Loss: 1.1663
Confusion Matrix:
 [[4971737     506      19       0       0]
 [1574480    1502      55       0       0]
 [   5301       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8629
Class 1 F1: 0.0019
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7589
Class 1 Precision: 0.7480
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0010
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7589
Macro F1 Score: 0.2883
xView2 Score: 0.0010
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0884
Confusion Matrix:
 [[4972017     245       0       0       0]
 [1575490     547       0       0       0]
 [   5301       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8628
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7588
Class 1 Precision: 0.6907
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7588
Macro F1 Score: 0.2878
xView2 Score: 0.0004
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0395
Confusion Matrix:
 [[4972067     195       0       0       0]
 [1575729     308       0       0       0]
 [   5301       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8628
Class 1 F1: 0.0004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7587
Class 1 Precision: 0.6123
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7587
Macro F1 Score: 0.2877
xView2 Score: 0.0002
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9959
Confusion Matrix:
 [[4972258       4       0       0       0]
 [1576032       5       0       0       0]
 [   5301       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8628
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7587
Class 1 Precision: 0.5556
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7587
Macro F1 Score: 0.2876
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9375
Confusion Matrix:
 [[4972262       0       0       0       0]
 [1576037       0       0       0       0]
 [   5301       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8628
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7587
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7587
Macro F1 Score: 0.2876
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4303
Best Macro F1: 0.1556
Best xView2 Score: 0.1449
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8253
Class 1 Precision: 0.3190
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2291
ROC curve saved to .././____________optune_results/126/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/126/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/126/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/126/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/126/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/126/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/126/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2740855356298985, 1: 0.7445486929700367, 2: 142.50183465458665, 3: 822.0096031357178, 4: 5732.533940774488}
Final class weights used in loss: [2.6507077679540307, 9.099161286966373, 142.50183465458665, 822.0096031357178, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5157
Confusion Matrix:
 [[  99875 4680924     809   29228    6097]
 [  18792 1697419     371   10814     536]
 [     80    8030       7       0      63]
 [      0     477       0       5       0]
 [      0      56       0      17       0]]
Class 0 F1: 0.0405
Class 1 F1: 0.4183
Class 2 F1: 0.0015
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.8411
Class 1 Precision: 0.2658
Class 2 Precision: 0.0059
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.0207
Class 1 Recall: 0.9823
Class 2 Recall: 0.0009
Class 3 Recall: 0.0104
Class 4 Recall: 0.0000
Validation Accuracy: 0.2742
Macro F1 Score: 0.0921
xView2 Score: 0.2649
Epoch 1 took:  0 hours,  1 minutes, 18 seconds

Epoch 2/10
Train Loss: 1.4467
Confusion Matrix:
 [[ 202431 4610542      22    2402    1536]
 [  13886 1713338      75     618      15]
 [     16    8164       0       0       0]
 [      0     482       0       0       0]
 [     33      40       0       0       0]]
Class 0 F1: 0.0804
Class 1 F1: 0.4251
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9356
Class 1 Precision: 0.2706
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0420
Class 1 Recall: 0.9916
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2923
Macro F1 Score: 0.1011
xView2 Score: 0.2671
Epoch 2 took:  0 hours,  0 minutes, 45 seconds

Epoch 3/10
Train Loss: 1.3823
Confusion Matrix:
 [[ 389262 4427413       0     247      11]
 [   8913 1718997       0      22       0]
 [     73    8107       0       0       0]
 [      0     482       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.1493
Class 1 F1: 0.4361
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9774
Class 1 Precision: 0.2793
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0808
Class 1 Recall: 0.9948
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3217
Macro F1 Score: 0.1171
xView2 Score: 0.2706
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3152
Confusion Matrix:
 [[1157066 3659867       0       0       0]
 [  14915 1713013       3       1       0]
 [      0    8180       0       0       0]
 [      0     482       0       0       0]
 [      2      71       0       0       0]]
Class 0 F1: 0.3864
Class 1 F1: 0.4819
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9873
Class 1 Precision: 0.3183
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2402
Class 1 Recall: 0.9914
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4379
Macro F1 Score: 0.1737
xView2 Score: 0.2842
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2302
Confusion Matrix:
 [[1658750 3158183       0       0       0]
 [  69375 1658557       0       0       0]
 [   2085    6095       0       0       0]
 [      0     482       0       0       0]
 [      4      69       0       0       0]]
Class 0 F1: 0.5067
Class 1 F1: 0.5063
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9587
Class 1 Precision: 0.3439
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3444
Class 1 Recall: 0.9599
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5062
Macro F1 Score: 0.2026
xView2 Score: 0.2892
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1782
Confusion Matrix:
 [[1968165 2848768       0       0       0]
 [  84556 1643376       0       0       0]
 [    572    7608       0       0       0]
 [    182     300       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.5729
Class 1 F1: 0.5277
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9584
Class 1 Precision: 0.3652
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4086
Class 1 Recall: 0.9511
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5511
Macro F1 Score: 0.2201
xView2 Score: 0.2950
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1076
Confusion Matrix:
 [[2129095 2687838       0       0       0]
 [ 129997 1597935       0       0       0]
 [    445    7735       0       0       0]
 [      0     482       0       0       0]
 [     39      34       0       0       0]]
Class 0 F1: 0.6017
Class 1 F1: 0.5307
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9423
Class 1 Precision: 0.3721
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4420
Class 1 Recall: 0.9248
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5687
Macro F1 Score: 0.2265
xView2 Score: 0.2940
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0665
Confusion Matrix:
 [[2222425 2594508       0       0       0]
 [ 152401 1575531       0       0       0]
 [   1732    6448       0       0       0]
 [      0     482       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6179
Class 1 F1: 0.5336
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9351
Class 1 Precision: 0.3772
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4614
Class 1 Recall: 0.9118
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5795
Macro F1 Score: 0.2303
xView2 Score: 0.2938
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0181
Confusion Matrix:
 [[2405039 2411894       0       0       0]
 [ 167423 1560509       0       0       0]
 [    286    7894       0       0       0]
 [      0     482       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6509
Class 1 F1: 0.5467
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9348
Class 1 Precision: 0.3920
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4993
Class 1 Recall: 0.9031
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6051
Macro F1 Score: 0.2395
xView2 Score: 0.2972
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9914
Confusion Matrix:
 [[2413650 2403283       0       0       0]
 [ 207515 1520417       0       0       0]
 [   2545    5635       0       0       0]
 [      0     482       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6488
Class 1 F1: 0.5375
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9199
Class 1 Precision: 0.3869
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5011
Class 1 Recall: 0.8799
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6003
Macro F1 Score: 0.2372
xView2 Score: 0.2925
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6051
Best Macro F1: 0.2395
Best xView2 Score: 0.2972
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9348
Class 1 Precision: 0.3920
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2654
ROC curve saved to .././____________optune_results/127/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/127/plot_loss_curves.jpg
Prediction distribution: {0: 167416, 1: 94728}
ROC curve saved to .././____________optune_results/127/visualize_predictions.jpg
Prediction distribution: {0: 12022, 1: 250122}
ROC curve saved to .././____________optune_results/127/visualize_predictions.jpg
Prediction distribution: {0: 134909, 1: 127235}
ROC curve saved to .././____________optune_results/127/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/127/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/127/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2741028056087669, 1: 0.7446579678826648, 2: 136.34839898141627, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6508747875927487, 7.3415961756893156, 136.34839898141627, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5664
Confusion Matrix:
 [[2861790 1254797   10153  575760  115590]
 [ 799232  700405    6729  160354   62204]
 [   4335    1351       0     877      23]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6747
Class 1 F1: 0.3801
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7808
Class 1 Precision: 0.3580
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5940
Class 1 Recall: 0.4051
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5435
Macro F1 Score: 0.2110
xView2 Score: 0.2016
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4970
Confusion Matrix:
 [[2901338 1788582    1073  113261   13836]
 [ 574063 1123193     477   24690    6501]
 [   2628    3813       0     145       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6994
Class 1 F1: 0.4837
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8342
Class 1 Precision: 0.3852
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6022
Class 1 Recall: 0.6496
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6141
Macro F1 Score: 0.2366
xView2 Score: 0.2546
Epoch 2 took:  0 hours,  1 minutes, 19 seconds

Epoch 3/10
Train Loss: 1.4355
Confusion Matrix:
 [[3083933 1724848      39    8884     386]
 [ 601106 1126449       2    1271      96]
 [   3877    2691       0      18       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7250
Class 1 F1: 0.4916
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8360
Class 1 Precision: 0.3947
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6401
Class 1 Recall: 0.6515
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6425
Macro F1 Score: 0.2433
xView2 Score: 0.2578
Epoch 3 took:  0 hours,  0 minutes, 58 seconds

Epoch 4/10
Train Loss: 1.3645
Confusion Matrix:
 [[2943638 1874352       0     100       0]
 [ 427109 1301797       0      18       0]
 [   3341    3245       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7186
Class 1 F1: 0.5304
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8724
Class 1 Precision: 0.4094
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6110
Class 1 Recall: 0.7530
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6478
Macro F1 Score: 0.3123
xView2 Score: 0.3095
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.2769
Confusion Matrix:
 [[2898177 1919913       0       0       0]
 [ 306064 1422860       0       0       0]
 [    983    5603       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7224
Class 1 F1: 0.5605
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9042
Class 1 Precision: 0.4249
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6015
Class 1 Recall: 0.8230
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6593
Macro F1 Score: 0.4276
xView2 Score: 0.3789
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2252
Confusion Matrix:
 [[2818182 1999908       0       0       0]
 [ 306170 1422754       0       0       0]
 [   1538    5048       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7095
Class 1 F1: 0.5518
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9016
Class 1 Precision: 0.4151
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5849
Class 1 Recall: 0.8229
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6471
Macro F1 Score: 0.4204
xView2 Score: 0.3762
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1609
Confusion Matrix:
 [[2813514 2004576       0       0       0]
 [ 339053 1389871       0       0       0]
 [   3169    3417       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7057
Class 1 F1: 0.5422
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8916
Class 1 Precision: 0.4090
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5839
Class 1 Recall: 0.8039
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6414
Macro F1 Score: 0.4160
xView2 Score: 0.3706
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0914
Confusion Matrix:
 [[2910397 1907693       0       0       0]
 [ 275158 1453766       0       0       0]
 [    900    5686       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7272
Class 1 F1: 0.5705
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9134
Class 1 Precision: 0.4318
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6041
Class 1 Recall: 0.8409
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6659
Macro F1 Score: 0.4326
xView2 Score: 0.3844
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0599
Confusion Matrix:
 [[2745497 2072593       0       0       0]
 [ 299703 1429221       0       0       0]
 [   3121    3465       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6980
Class 1 F1: 0.5461
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9007
Class 1 Precision: 0.4077
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5698
Class 1 Recall: 0.8267
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6370
Macro F1 Score: 0.4147
xView2 Score: 0.3750
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0236
Confusion Matrix:
 [[2889307 1928783       0       0       0]
 [ 254367 1474557       0       0       0]
 [    888    5698       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7257
Class 1 F1: 0.5740
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9188
Class 1 Precision: 0.4325
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5997
Class 1 Recall: 0.8529
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6659
Macro F1 Score: 0.4332
xView2 Score: 0.3871
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6659
Best Macro F1: 0.4332
Best xView2 Score: 0.3871
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9188
Class 1 Precision: 0.4325
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4505
ROC curve saved to .././____________optune_results/128/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/128/plot_loss_curves.jpg
Prediction distribution: {0: 39691, 1: 222453}
ROC curve saved to .././____________optune_results/128/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/128/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/128/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/128/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/128/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27611471425449163, 1: 0.7308548296552679, 2: 116.79773513099575, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.6703321510153764, 11.35000369592407, 116.79773513099575, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5746
Confusion Matrix:
 [[1986505 1334083  345554    2384 1283361]
 [ 502305  623409  107374     421  367762]
 [    104     303       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5339
Class 1 F1: 0.3503
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7981
Class 1 Precision: 0.3184
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4012
Class 1 Recall: 0.3893
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3982
Macro F1 Score: 0.1769
xView2 Score: 0.1949
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4954
Confusion Matrix:
 [[2112738 2560882   71983     104  206180]
 [ 266978 1270924   12287       1   51081]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5763
Class 1 F1: 0.4678
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8878
Class 1 Precision: 0.3316
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4267
Class 1 Recall: 0.7937
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5163
Macro F1 Score: 0.2088
xView2 Score: 0.2625
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4214
Confusion Matrix:
 [[2307898 2608475   11187       0   24327]
 [ 186243 1406215    1649       0    7164]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6199
Class 1 F1: 0.5008
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9253
Class 1 Precision: 0.3502
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4661
Class 1 Recall: 0.8782
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5667
Macro F1 Score: 0.2241
xView2 Score: 0.2809
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.3481
Confusion Matrix:
 [[2132817 2816006    1217       0    1847]
 [  64507 1536441     201       0     122]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5967
Class 1 F1: 0.5161
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9706
Class 1 Precision: 0.3530
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4307
Class 1 Recall: 0.9595
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5599
Macro F1 Score: 0.2225
xView2 Score: 0.2919
Epoch 4 took:  0 hours,  1 minutes,  2 seconds

Epoch 5/10
Train Loss: 1.2652
Confusion Matrix:
 [[2271517 2680133     159       0      78]
 [  47033 1554238       0       0       0]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6249
Class 1 F1: 0.5326
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9797
Class 1 Precision: 0.3670
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4587
Class 1 Recall: 0.9706
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5838
Macro F1 Score: 0.2315
xView2 Score: 0.3322
Epoch 5 took:  0 hours,  0 minutes, 33 seconds

Epoch 6/10
Train Loss: 1.1868
Confusion Matrix:
 [[2571575 2380304       8       0       0]
 [  76054 1525217       0       0       0]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6768
Class 1 F1: 0.5539
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9713
Class 1 Precision: 0.3905
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5193
Class 1 Recall: 0.9525
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6251
Macro F1 Score: 0.3077
xView2 Score: 0.3369
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1180
Confusion Matrix:
 [[2745713 2206174       0       0       0]
 [  97716 1503555       0       0       0]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7045
Class 1 F1: 0.5662
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9656
Class 1 Precision: 0.4053
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5545
Class 1 Recall: 0.9390
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6484
Macro F1 Score: 0.3177
xView2 Score: 0.3394
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0703
Confusion Matrix:
 [[2720880 2231007       0       0       0]
 [  83065 1518206       0       0       0]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7016
Class 1 F1: 0.5675
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9704
Class 1 Precision: 0.4049
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5495
Class 1 Recall: 0.9481
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6468
Macro F1 Score: 0.3173
xView2 Score: 0.3406
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0266
Confusion Matrix:
 [[2761127 2190760       0       0       0]
 [  87123 1514148       0       0       0]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7080
Class 1 F1: 0.5707
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9694
Class 1 Precision: 0.4086
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5576
Class 1 Recall: 0.9456
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6524
Macro F1 Score: 0.3197
xView2 Score: 0.3413
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9635
Confusion Matrix:
 [[2812400 2139487       0       0       0]
 [  95541 1505730       0       0       0]
 [      0     407       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7156
Class 1 F1: 0.5739
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9671
Class 1 Precision: 0.4130
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5679
Class 1 Recall: 0.9403
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6589
Macro F1 Score: 0.3224
xView2 Score: 0.3418
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6589
Best Macro F1: 0.3224
Best xView2 Score: 0.3418
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9671
Class 1 Precision: 0.4130
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3450
ROC curve saved to .././____________optune_results/129/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/129/plot_loss_curves.jpg
Prediction distribution: {0: 42906, 1: 219238}
ROC curve saved to .././____________optune_results/129/visualize_predictions.jpg
Prediction distribution: {0: 25288, 1: 236856}
ROC curve saved to .././____________optune_results/129/visualize_predictions.jpg
Prediction distribution: {0: 76579, 1: 185565}
ROC curve saved to .././____________optune_results/129/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/129/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/129/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2789342433913924, 1: 0.7108477779143028, 2: 147.0223987848338, 3: 848.4768712070128, 4: 5732.533940774488}
Final class weights used in loss: [2.6976000904488804, 3.282427967150821, 147.0223987848338, 848.4768712070128, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5815
Confusion Matrix:
 [[2056222 1584726 1317555   96117   81525]
 [ 478758  516165  350493   29338   32689]
 [   3935    4103    1190      31       7]
 [    505      83      85       0       0]
 [      6      20      47       0       0]]
Class 0 F1: 0.5358
Class 1 F1: 0.2939
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8097
Class 1 Precision: 0.2452
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4003
Class 1 Recall: 0.3667
Class 2 Recall: 0.1284
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3927
Macro F1 Score: 0.1662
xView2 Score: 0.1791
Epoch 1 took:  0 hours,  1 minutes, 19 seconds

Epoch 2/10
Train Loss: 1.5104
Confusion Matrix:
 [[3517223 1081407  519394   12837    5284]
 [ 741328  498205  159715    5194    3001]
 [   5927    2510     823       6       0]
 [    537     131       5       0       0]
 [     68       5       0       0       0]]
Class 0 F1: 0.7482
Class 1 F1: 0.3333
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8247
Class 1 Precision: 0.3149
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6848
Class 1 Recall: 0.3540
Class 2 Recall: 0.0888
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6128
Macro F1 Score: 0.2168
xView2 Score: 0.1829
Epoch 2 took:  0 hours,  1 minutes, 15 seconds

Epoch 3/10
Train Loss: 1.4407
Confusion Matrix:
 [[4374083  644638  115961    1110     353]
 [1000818  366998   38959     513     155]
 [   7065    1273     899      29       0]
 [    647      26       0       0       0]
 [     72       1       0       0       0]]
Class 0 F1: 0.8317
Class 1 F1: 0.3033
Class 2 F1: 0.0109
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8126
Class 1 Precision: 0.3623
Class 2 Precision: 0.0058
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8516
Class 1 Recall: 0.2608
Class 2 Recall: 0.0970
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7236
Macro F1 Score: 0.2292
xView2 Score: 0.1578
Epoch 3 took:  0 hours,  0 minutes, 55 seconds

Epoch 4/10
Train Loss: 1.3792
Confusion Matrix:
 [[4521907  605497    8124       3     614]
 [ 950783  451769    4694      24     173]
 [   5568    3698       0       0       0]
 [    652      21       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8520
Class 1 F1: 0.3660
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8253
Class 1 Precision: 0.4258
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8804
Class 1 Recall: 0.3210
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7589
Macro F1 Score: 0.2436
xView2 Score: 0.1787
Epoch 4 took:  0 hours,  0 minutes, 33 seconds

Epoch 5/10
Train Loss: 1.2991
Confusion Matrix:
 [[4579120  556432     593       0       0]
 [ 941412  465407     624       0       0]
 [   7443    1823       0       0       0]
 [    673       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8587
Class 1 F1: 0.3829
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8282
Class 1 Precision: 0.4546
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8915
Class 1 Recall: 0.3307
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7697
Macro F1 Score: 0.2483
xView2 Score: 0.1844
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2423
Confusion Matrix:
 [[4565128  570989      28       0       0]
 [ 911199  496239       5       0       0]
 [   7319    1947       0       0       0]
 [    533     140       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8597
Class 1 F1: 0.4007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8324
Class 1 Precision: 0.4641
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8888
Class 1 Recall: 0.3526
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7723
Macro F1 Score: 0.2521
xView2 Score: 0.1931
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1822
Confusion Matrix:
 [[4550814  585331       0       0       0]
 [ 901669  505774       0       0       0]
 [   6541    2725       0       0       0]
 [    615      58       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8590
Class 1 F1: 0.4044
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8335
Class 1 Precision: 0.4624
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8860
Class 1 Recall: 0.3594
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7716
Macro F1 Score: 0.2527
xView2 Score: 0.1954
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1346
Confusion Matrix:
 [[4541737  594408       0       0       0]
 [ 856972  550471       0       0       0]
 [   3535    5731       0       0       0]
 [    180     493       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8619
Class 1 F1: 0.4303
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8407
Class 1 Precision: 0.4782
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8843
Class 1 Recall: 0.3911
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7770
Macro F1 Score: 0.2584
xView2 Score: 0.2085
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0950
Confusion Matrix:
 [[4616015  520130       0       0       0]
 [ 907574  499869       0       0       0]
 [   6540    2726       0       0       0]
 [    673       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8655
Class 1 F1: 0.4114
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8346
Class 1 Precision: 0.4888
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8987
Class 1 Recall: 0.3552
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7806
Macro F1 Score: 0.2554
xView2 Score: 0.1969
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0552
Confusion Matrix:
 [[4558359  577786       0       0       0]
 [ 881660  525783       0       0       0]
 [   6176    3090       0       0       0]
 [    673       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8614
Class 1 F1: 0.4183
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8369
Class 1 Precision: 0.4751
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8875
Class 1 Recall: 0.3736
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7758
Macro F1 Score: 0.2559
xView2 Score: 0.2017
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7770
Best Macro F1: 0.2584
Best xView2 Score: 0.2085
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8407
Class 1 Precision: 0.4782
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2638
ROC curve saved to .././____________optune_results/130/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/130/plot_loss_curves.jpg
Prediction distribution: {0: 261329, 1: 815}
ROC curve saved to .././____________optune_results/130/visualize_predictions.jpg
Prediction distribution: {0: 110622, 1: 151522}
ROC curve saved to .././____________optune_results/130/visualize_predictions.jpg
Prediction distribution: {0: 71939, 1: 190205}
ROC curve saved to .././____________optune_results/130/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/130/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/130/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27043986977400664, 1: 0.7730075166491429, 2: 129.48713146385387, 3: 1069.9755102040817, 4: 68947.46301369862}
Final class weights used in loss: [2.6154501802766337, 1.6691706795468597, 129.48713146385387, 1069.9755102040817, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6024
Confusion Matrix:
 [[1124641  658199 2524567     149  261828]
 [ 598441  382674  917282     229   78181]
 [    630    1143    2814       0      43]
 [    709      10    1182       0       0]
 [      0      23     855       0       0]]
Class 0 F1: 0.3574
Class 1 F1: 0.2535
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6522
Class 1 Precision: 0.3672
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2461
Class 1 Recall: 0.1936
Class 2 Recall: 0.6078
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2304
Macro F1 Score: 0.1225
xView2 Score: 0.1682
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5154
Confusion Matrix:
 [[3081728  283447 1137914      57   66238]
 [1426534  177154  353145       0   19974]
 [   3531       5    1092       0       2]
 [   1230     179     492       0       0]
 [    551      26     301       0       0]]
Class 0 F1: 0.6786
Class 1 F1: 0.1454
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6828
Class 1 Precision: 0.3844
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6744
Class 1 Recall: 0.0896
Class 2 Recall: 0.2359
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4974
Macro F1 Score: 0.1651
xView2 Score: 0.1062
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4269
Confusion Matrix:
 [[4369417   60947  135256       0    3764]
 [1868484   48081   59518       0     724]
 [   4159      36     435       0       0]
 [   1835       1      65       0       0]
 [    636       0     242       0       0]]
Class 0 F1: 0.8081
Class 1 F1: 0.0461
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6997
Class 1 Precision: 0.4408
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9562
Class 1 Recall: 0.0243
Class 2 Recall: 0.0940
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6741
Macro F1 Score: 0.1717
xView2 Score: 0.0371
Epoch 3 took:  0 hours,  1 minutes, 14 seconds

Epoch 4/10
Train Loss: 1.3637
Confusion Matrix:
 [[4543045   14271   11835       0     233]
 [1953673   13319    9740       0      75]
 [   4526       0     104       0       0]
 [   1634       4     263       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8206
Class 1 F1: 0.0133
Class 2 F1: 0.0078
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6985
Class 1 Precision: 0.4827
Class 2 Precision: 0.0047
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9942
Class 1 Recall: 0.0067
Class 2 Recall: 0.0225
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6953
Macro F1 Score: 0.1683
xView2 Score: 0.0108
Epoch 4 took:  0 hours,  0 minutes, 42 seconds

Epoch 5/10
Train Loss: 1.2797
Confusion Matrix:
 [[4564912    3499     969       0       4]
 [1971332    4662     813       0       0]
 [   4567       6      57       0       0]
 [   1901       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8215
Class 1 F1: 0.0047
Class 2 F1: 0.0176
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6976
Class 1 Precision: 0.5708
Class 2 Precision: 0.0310
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9990
Class 1 Recall: 0.0024
Class 2 Recall: 0.0123
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.1688
xView2 Score: 0.0052
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.2191
Confusion Matrix:
 [[4568161    1179      44       0       0]
 [1974927    1804      76       0       0]
 [   4630       0       0       0       0]
 [   1901       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8216
Class 1 F1: 0.0018
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6974
Class 1 Precision: 0.6048
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0009
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.1647
xView2 Score: 0.0008
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1401
Confusion Matrix:
 [[4569166     218       0       0       0]
 [1976105     695       7       0       0]
 [   4630       0       0       0       0]
 [   1901       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8216
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6973
Class 1 Precision: 0.7612
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.1645
xView2 Score: 0.0003
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0980
Confusion Matrix:
 [[4569185     199       0       0       0]
 [1976477     330       0       0       0]
 [   4630       0       0       0       0]
 [   1901       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8216
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6973
Class 1 Precision: 0.6238
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.1644
xView2 Score: 0.0001
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0386
Confusion Matrix:
 [[4569142     242       0       0       0]
 [1976214     593       0       0       0]
 [   4630       0       0       0       0]
 [   1901       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8216
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6973
Class 1 Precision: 0.7102
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.1644
xView2 Score: 0.0003
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0351
Confusion Matrix:
 [[4569349      35       0       0       0]
 [1976696     111       0       0       0]
 [   4630       0       0       0       0]
 [   1901       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8216
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6972
Class 1 Precision: 0.7603
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6972
Macro F1 Score: 0.1643
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2304
Best Macro F1: 0.1225
Best xView2 Score: 0.1682
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.6522
Class 1 Precision: 0.3672
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2040
ROC curve saved to .././____________optune_results/131/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/131/plot_loss_curves.jpg
Prediction distribution: {0: 262126, 1: 18}
ROC curve saved to .././____________optune_results/131/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/131/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/131/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/131/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/131/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2692269977321056, 1: 0.7831754585464317, 2: 136.8377140992877, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6037203772587083, 1.3237126126073206, 136.8377140992877, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4937
Confusion Matrix:
 [[3654253    2376    5150  209918  613844]
 [1342308    2723    3351  165914  547045]
 [   4711       0       0     466    1541]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7704
Class 1 F1: 0.0026
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7307
Class 1 Precision: 0.5340
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8147
Class 1 Recall: 0.0013
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5580
Macro F1 Score: 0.1546
xView2 Score: 0.1199
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4109
Confusion Matrix:
 [[4262525     770     404   39683  182159]
 [1839287     736     202   33180  187936]
 [   6120       0       0     239     359]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8047
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6979
Class 1 Precision: 0.4887
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9503
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6505
Macro F1 Score: 0.1611
xView2 Score: 0.0532
Epoch 2 took:  0 hours,  1 minutes, 19 seconds

Epoch 3/10
Train Loss: 1.3268
Confusion Matrix:
 [[4447914     139       1    2078   35409]
 [2020426      99      20    2233   38563]
 [   6556       0       0      30     132]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8116
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6869
Class 1 Precision: 0.4160
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9916
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6787
Macro F1 Score: 0.1623
xView2 Score: 0.0115
Epoch 3 took:  0 hours,  1 minutes, 11 seconds

Epoch 4/10
Train Loss: 1.2623
Confusion Matrix:
 [[4463118     488       0     236   21699]
 [2033687     613       0     310   26731]
 [   6682       0       0       0      36]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8123
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6863
Class 1 Precision: 0.5568
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9950
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6811
Macro F1 Score: 0.1626
xView2 Score: 0.0079
Epoch 4 took:  0 hours,  1 minutes,  0 seconds

Epoch 5/10
Train Loss: 1.1739
Confusion Matrix:
 [[4484331     208       0      22     980]
 [2058945     422       0      18    1956]
 [   6718       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.0004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6846
Class 1 Precision: 0.6698
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6843
Macro F1 Score: 0.1626
xView2 Score: 0.0008
Epoch 5 took:  0 hours,  0 minutes, 43 seconds

Epoch 6/10
Train Loss: 1.1084
Confusion Matrix:
 [[4485279      85       0       0     177]
 [2061008      77       0       0     256]
 [   6718       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6845
Class 1 Precision: 0.4753
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6844
Macro F1 Score: 0.2032
xView2 Score: 0.0001
Epoch 6 took:  0 hours,  0 minutes, 35 seconds

Epoch 7/10
Train Loss: 1.0565
Confusion Matrix:
 [[4485517      24       0       0       0]
 [2061313      28       0       0       0]
 [   6718       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6844
Class 1 Precision: 0.5385
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6844
Macro F1 Score: 0.2709
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.0129
Confusion Matrix:
 [[4485537       4       0       0       0]
 [2061340       1       0       0       0]
 [   6718       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6844
Class 1 Precision: 0.2000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6844
Macro F1 Score: 0.2709
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9594
Confusion Matrix:
 [[4485538       3       0       0       0]
 [2061341       0       0       0       0]
 [   6718       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6844
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6844
Macro F1 Score: 0.2709
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9336
Confusion Matrix:
 [[4485541       0       0       0       0]
 [2061341       0       0       0       0]
 [   6718       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6844
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6844
Macro F1 Score: 0.2709
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5580
Best Macro F1: 0.1546
Best xView2 Score: 0.1199
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7307
Class 1 Precision: 0.5340
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2529
ROC curve saved to .././____________optune_results/132/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/132/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/132/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/132/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/132/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/132/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/132/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27415676405603856, 1: 0.7437168548530332, 2: 152.87221479771594, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [2.651396624963703, 0.8443556592152496, 152.87221479771594, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5412
Confusion Matrix:
 [[3107153 1274955  420914   14691    3991]
 [ 762308  742787  198660   13305    3311]
 [   7836    1897     843       0       0]
 [    159     674     116       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7144
Class 1 F1: 0.3971
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8013
Class 1 Precision: 0.3677
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6444
Class 1 Recall: 0.4318
Class 2 Recall: 0.0797
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5876
Macro F1 Score: 0.2228
xView2 Score: 0.2164
Epoch 1 took:  0 hours,  1 minutes, 17 seconds

Epoch 2/10
Train Loss: 1.4461
Confusion Matrix:
 [[4373515  393252   47528    6436     973]
 [1341638  326179   45221    6120    1213]
 [   9831     583     153       9       0]
 [    742     207       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8293
Class 1 F1: 0.2673
Class 2 F1: 0.0030
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7638
Class 1 Precision: 0.4529
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9070
Class 1 Recall: 0.1896
Class 2 Recall: 0.0145
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7171
Macro F1 Score: 0.2199
xView2 Score: 0.1344
Epoch 2 took:  0 hours,  1 minutes,  3 seconds

Epoch 3/10
Train Loss: 1.3584
Confusion Matrix:
 [[4722525   93235    5222     631      91]
 [1612912   99225    7512     592     130]
 [  10417     105      54       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8457
Class 1 F1: 0.1037
Class 2 F1: 0.0046
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7441
Class 1 Precision: 0.5153
Class 2 Precision: 0.0042
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9794
Class 1 Recall: 0.0577
Class 2 Recall: 0.0051
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.1908
xView2 Score: 0.0494
Epoch 3 took:  0 hours,  0 minutes, 36 seconds

Epoch 4/10
Train Loss: 1.2768
Confusion Matrix:
 [[4799432   22015     251       5       1]
 [1696011   23873     478       9       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8473
Class 1 F1: 0.0270
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7376
Class 1 Precision: 0.5202
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9954
Class 1 Recall: 0.0139
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7360
Macro F1 Score: 0.1749
xView2 Score: 0.0130
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2005
Confusion Matrix:
 [[4819242    2460       2       0       0]
 [1716592    3734      45       0       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8478
Class 1 F1: 0.0043
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7361
Class 1 Precision: 0.6028
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0022
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7359
Macro F1 Score: 0.2130
xView2 Score: 0.0021
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1229
Confusion Matrix:
 [[4821192     512       0       0       0]
 [1719775     595       1       0       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8477
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7358
Class 1 Precision: 0.5375
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.2121
xView2 Score: 0.0003
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0539
Confusion Matrix:
 [[4821614      90       0       0       0]
 [1720287      84       0       0       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8477
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7357
Class 1 Precision: 0.4828
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.2120
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0025
Confusion Matrix:
 [[4821703       1       0       0       0]
 [1720368       3       0       0       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8477
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7357
Class 1 Precision: 0.7500
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.2119
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9443
Confusion Matrix:
 [[4821704       0       0       0       0]
 [1720371       0       0       0       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8477
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7357
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.2119
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9105
Confusion Matrix:
 [[4821704       0       0       0       0]
 [1720371       0       0       0       0]
 [  10576       0       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8477
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7357
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7357
Macro F1 Score: 0.2119
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5876
Best Macro F1: 0.2228
Best xView2 Score: 0.2164
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8013
Class 1 Precision: 0.3677
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2341
ROC curve saved to .././____________optune_results/133/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/133/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/133/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/133/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/133/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/133/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/133/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27715894129081464, 1: 0.7232657028517118, 2: 124.63573285788574, 3: 872.2989254766031, 4: 5732.533940774488}
Final class weights used in loss: [2.6804309718463544, 7.6855631707850485, 124.63573285788574, 872.2989254766031, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5041
Confusion Matrix:
 [[3736912 1056083  223710    2564    1296]
 [1015558  446540   66602     279      31]
 [   2589     520       8       0       0]
 [    534     260      41       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7645
Class 1 F1: 0.2945
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7858
Class 1 Precision: 0.2970
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7443
Class 1 Recall: 0.2920
Class 2 Recall: 0.0026
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6383
Macro F1 Score: 0.2118
xView2 Score: 0.1559
Epoch 1 took:  0 hours,  0 minutes, 41 seconds

Epoch 2/10
Train Loss: 1.4392
Confusion Matrix:
 [[3569683 1416026   34723     123      10]
 [ 739477  776306   13225       0       2]
 [   2639     478       0       0       0]
 [    472     363       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7650
Class 1 F1: 0.4171
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8278
Class 1 Precision: 0.3540
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7110
Class 1 Recall: 0.5077
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6631
Macro F1 Score: 0.2364
xView2 Score: 0.2199
Epoch 2 took:  0 hours,  0 minutes, 27 seconds

Epoch 3/10
Train Loss: 1.3740
Confusion Matrix:
 [[3301232 1717463    1870       0       0]
 [ 487811 1040283     916       0       0]
 [   1937    1180       0       0       0]
 [    291     544       0       0       0]
 [     53      20       0       0       0]]
Class 0 F1: 0.7493
Class 1 F1: 0.4852
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8707
Class 1 Precision: 0.3770
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6575
Class 1 Recall: 0.6804
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6625
Macro F1 Score: 0.2469
xView2 Score: 0.2590
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.3182
Confusion Matrix:
 [[2921155 2099385      25       0       0]
 [ 203928 1325076       6       0       0]
 [    735    2382       0       0       0]
 [    238     597       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7171
Class 1 F1: 0.5347
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9345
Class 1 Precision: 0.3866
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5818
Class 1 Recall: 0.8666
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6479
Macro F1 Score: 0.2504
xView2 Score: 0.2905
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2416
Confusion Matrix:
 [[2997272 2023274      19       0       0]
 [ 199008 1330001       1       0       0]
 [    925    2192       0       0       0]
 [      0     835       0       0       0]
 [     27      46       0       0       0]]
Class 0 F1: 0.7295
Class 1 F1: 0.5445
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9375
Class 1 Precision: 0.3963
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5970
Class 1 Recall: 0.8698
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6603
Macro F1 Score: 0.2548
xView2 Score: 0.2937
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1756
Confusion Matrix:
 [[2903984 2116581       0       0       0]
 [ 169522 1359488       0       0       0]
 [    590    2527       0       0       0]
 [     11     824       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7175
Class 1 F1: 0.5429
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9447
Class 1 Precision: 0.3907
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5784
Class 1 Recall: 0.8891
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6506
Macro F1 Score: 0.2521
xView2 Score: 0.2948
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1178
Confusion Matrix:
 [[3048155 1972410       0       0       0]
 [ 173642 1355368       0       0       0]
 [    235    2882       0       0       0]
 [    235     600       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7396
Class 1 F1: 0.5577
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9459
Class 1 Precision: 0.4069
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6071
Class 1 Recall: 0.8864
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6719
Macro F1 Score: 0.2595
xView2 Score: 0.2990
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0755
Confusion Matrix:
 [[3091232 1929333       0       0       0]
 [ 180847 1348163       0       0       0]
 [    177    2940       0       0       0]
 [    146     689       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7455
Class 1 F1: 0.5606
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9446
Class 1 Precision: 0.4109
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6157
Class 1 Recall: 0.8817
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6774
Macro F1 Score: 0.2612
xView2 Score: 0.2995
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0299
Confusion Matrix:
 [[3181019 1839546       0       0       0]
 [ 238291 1290719       0       0       0]
 [   1135    1982       0       0       0]
 [    542     293       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7537
Class 1 F1: 0.5538
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9298
Class 1 Precision: 0.4120
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6336
Class 1 Recall: 0.8442
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6823
Macro F1 Score: 0.2615
xView2 Score: 0.2943
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0059
Confusion Matrix:
 [[3117815 1902750       0       0       0]
 [ 195670 1333340       0       0       0]
 [    157    2960       0       0       0]
 [    304     531       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7482
Class 1 F1: 0.5592
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9408
Class 1 Precision: 0.4116
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6210
Class 1 Recall: 0.8720
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6792
Macro F1 Score: 0.2615
xView2 Score: 0.2983
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6774
Best Macro F1: 0.2612
Best xView2 Score: 0.2995
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9446
Class 1 Precision: 0.4109
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2711
ROC curve saved to .././____________optune_results/134/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/134/plot_loss_curves.jpg
Prediction distribution: {0: 193111, 1: 69033}
ROC curve saved to .././____________optune_results/134/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/134/visualize_predictions.jpg
Prediction distribution: {0: 191792, 1: 70352}
ROC curve saved to .././____________optune_results/134/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/134/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/134/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2745637781008162, 1: 0.7409611805290669, 2: 137.3680349344978, 3: 1262.7106874059207, 4: 5292.497160883281}
Final class weights used in loss: [2.6553328972214825, 1.0424914994287144, 137.3680349344978, 1262.7106874059207, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4376
Confusion Matrix:
 [[4785741    1676   46294    1458   13750]
 [1672378    1488   14643     653    6040]
 [   6860       0       0       0       0]
 [   2449       0     170       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8458
Class 1 F1: 0.0018
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7400
Class 1 Precision: 0.4703
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9870
Class 1 Recall: 0.0009
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7305
Macro F1 Score: 0.1695
xView2 Score: 0.0079
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.3617
Confusion Matrix:
 [[4846470     212    1899       9     329]
 [1694072     224     757      28     121]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8503
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.5138
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7395
Macro F1 Score: 0.1701
xView2 Score: 0.0004
Epoch 2 took:  0 hours,  0 minutes, 59 seconds

Epoch 3/10
Train Loss: 1.2884
Confusion Matrix:
 [[4848830      12      45       0      32]
 [1695171      19      12       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.6129
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.1701
xView2 Score: 0.0000
Epoch 3 took:  0 hours,  0 minutes, 30 seconds

Epoch 4/10
Train Loss: 1.2280
Confusion Matrix:
 [[4848911       0       8       0       0]
 [1695197       4       1       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 1.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1473
Confusion Matrix:
 [[4848919       0       0       0       0]
 [1695202       0       0       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0835
Confusion Matrix:
 [[4848919       0       0       0       0]
 [1695202       0       0       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0284
Confusion Matrix:
 [[4848919       0       0       0       0]
 [1695202       0       0       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9735
Confusion Matrix:
 [[4848919       0       0       0       0]
 [1695202       0       0       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9536
Confusion Matrix:
 [[4848919       0       0       0       0]
 [1695202       0       0       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9271
Confusion Matrix:
 [[4848919       0       0       0       0]
 [1695202       0       0       0       0]
 [   6860       0       0       0       0]
 [   2619       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8505
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7399
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2126
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7305
Best Macro F1: 0.1695
Best xView2 Score: 0.0079
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7400
Class 1 Precision: 0.4703
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2421
ROC curve saved to .././____________optune_results/135/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/135/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/135/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/135/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/135/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/135/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/135/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2758793579001713, 1: 0.732074656079446, 2: 128.75178553156655, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [2.6680559969118756, 1.05084163351175, 128.75178553156655, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5318
Confusion Matrix:
 [[3430525  223050 1225637   50640    6484]
 [ 850857  104692  636721   19511     965]
 [   2159      37    2201      11       0]
 [    103       0       7       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7442
Class 1 F1: 0.1079
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8008
Class 1 Precision: 0.3194
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6950
Class 1 Recall: 0.0649
Class 2 Recall: 0.4993
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5398
Macro F1 Score: 0.1709
xView2 Score: 0.1360
Epoch 1 took:  0 hours,  1 minutes, 14 seconds

Epoch 2/10
Train Loss: 1.4378
Confusion Matrix:
 [[4581072   74344  276549    4120     251]
 [1408564   43252  159197    1639      94]
 [   4200       2     206       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8382
Class 1 F1: 0.0500
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7643
Class 1 Precision: 0.3678
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9280
Class 1 Recall: 0.0268
Class 2 Recall: 0.0467
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7056
Macro F1 Score: 0.1778
xView2 Score: 0.0640
Epoch 2 took:  0 hours,  0 minutes, 44 seconds

Epoch 3/10
Train Loss: 1.3458
Confusion Matrix:
 [[4893529    9613   33069     124       1]
 [1578525    7773   26400      48       0]
 [   4395       0      13       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8575
Class 1 F1: 0.0095
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7556
Class 1 Precision: 0.4471
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9913
Class 1 Recall: 0.0048
Class 2 Recall: 0.0029
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7479
Macro F1 Score: 0.1735
xView2 Score: 0.0139
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.2605
Confusion Matrix:
 [[4930920    1769    3640       7       0]
 [1606991    1929    3826       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8591
Class 1 F1: 0.0024
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7537
Class 1 Precision: 0.5216
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9989
Class 1 Recall: 0.0012
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7527
Macro F1 Score: 0.2154
xView2 Score: 0.0025
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1814
Confusion Matrix:
 [[4935449     116     771       0       0]
 [1611759     330     657       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7533
Class 1 Precision: 0.7399
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7531
Macro F1 Score: 0.2149
xView2 Score: 0.0004
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0995
Confusion Matrix:
 [[4936297       1      38       0       0]
 [1612640      39      67       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.9750
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0451
Confusion Matrix:
 [[4936335       1       0       0       0]
 [1612730      16       0       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.9412
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0035
Confusion Matrix:
 [[4936336       0       0       0       0]
 [1612746       0       0       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9535
Confusion Matrix:
 [[4936336       0       0       0       0]
 [1612746       0       0       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8957
Confusion Matrix:
 [[4936336       0       0       0       0]
 [1612746       0       0       0       0]
 [   4408       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5398
Best Macro F1: 0.1709
Best xView2 Score: 0.1360
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8008
Class 1 Precision: 0.3194
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2243
ROC curve saved to .././____________optune_results/136/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/136/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/136/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/136/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/136/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/136/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/136/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2721402499931602, 1: 0.759236618836175, 2: 136.54074114264012, 3: 1251.719671723452, 4: 5292.497160883281}
Final class weights used in loss: [2.6318947221056193, 1.6354217116503573, 136.54074114264012, 1251.719671723452, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6137
Confusion Matrix:
 [[1593238  221545  135949  391104 2343833]
 [ 356169  154481   94148  163302 1090609]
 [   1888      86     551     412    3701]
 [    499      41      29       0    2015]
 [      0       0       0       0       0]]
Class 0 F1: 0.4801
Class 1 F1: 0.1382
Class 2 F1: 0.0046
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8163
Class 1 Precision: 0.4107
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3400
Class 1 Recall: 0.0831
Class 2 Recall: 0.0830
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2668
Macro F1 Score: 0.1246
xView2 Score: 0.1630
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5212
Confusion Matrix:
 [[3540005  157112   71702  126092  790758]
 [1201300  115196   50724   57919  433570]
 [   5628     120     183      68     639]
 [   1975       1      54     334     220]
 [      0       0       0       0       0]]
Class 0 F1: 0.7504
Class 1 F1: 0.1081
Class 2 F1: 0.0028
Class 3 F1: 0.0036
Class 4 F1: 0.0000
Class 0 Precision: 0.7454
Class 1 Precision: 0.4228
Class 2 Precision: 0.0015
Class 3 Precision: 0.0018
Class 4 Precision: 0.0000
Class 0 Recall: 0.7555
Class 1 Recall: 0.0620
Class 2 Recall: 0.0276
Class 3 Recall: 0.1293
Class 4 Recall: 0.0000
Validation Accuracy: 0.5578
Macro F1 Score: 0.1730
xView2 Score: 0.1264
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4422
Confusion Matrix:
 [[4466829   67066   11927   21554  118293]
 [1710031   48416    7805   13068   79389]
 [   6615       0       0       0      23]
 [   2545      24       0       5      10]
 [      0       0       0       0       0]]
Class 0 F1: 0.8217
Class 1 F1: 0.0490
Class 2 F1: 0.0000
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.7221
Class 1 Precision: 0.4192
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.9533
Class 1 Recall: 0.0260
Class 2 Recall: 0.0000
Class 3 Recall: 0.0019
Class 4 Recall: 0.0000
Validation Accuracy: 0.6890
Macro F1 Score: 0.1742
xView2 Score: 0.0471
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.3665
Confusion Matrix:
 [[4585768   76451    1861    2596   18993]
 [1763501   76024    1674    2315   15195]
 [   6610      28       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8304
Class 1 F1: 0.0756
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7212
Class 1 Precision: 0.4985
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9787
Class 1 Recall: 0.0409
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7113
Macro F1 Score: 0.1812
xView2 Score: 0.0387
Epoch 4 took:  0 hours,  1 minutes, 17 seconds

Epoch 5/10
Train Loss: 1.2869
Confusion Matrix:
 [[4642167   40653      69     344    2436]
 [1815971   40928     166     100    1544]
 [   6629       9       0       0       0]
 [   2566      18       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8325
Class 1 F1: 0.0422
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7178
Class 1 Precision: 0.5015
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9907
Class 1 Recall: 0.0220
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7146
Macro F1 Score: 0.1749
xView2 Score: 0.0192
Epoch 5 took:  0 hours,  1 minutes,  1 seconds

Epoch 6/10
Train Loss: 1.2131
Confusion Matrix:
 [[4641516   43949       0       6     198]
 [1813023   45457       0       2     227]
 [   6634       4       0       0       0]
 [   2520      64       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8326
Class 1 F1: 0.0467
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7181
Class 1 Precision: 0.5080
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9906
Class 1 Recall: 0.0245
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7152
Macro F1 Score: 0.1759
xView2 Score: 0.0207
Epoch 6 took:  0 hours,  0 minutes, 36 seconds

Epoch 7/10
Train Loss: 1.1303
Confusion Matrix:
 [[4653635   32032       0       0       2]
 [1821912   36768       0       0      29]
 [   6638       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8332
Class 1 F1: 0.0382
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7176
Class 1 Precision: 0.5344
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9932
Class 1 Recall: 0.0198
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7157
Macro F1 Score: 0.1743
xView2 Score: 0.0168
Epoch 7 took:  0 hours,  0 minutes, 29 seconds

Epoch 8/10
Train Loss: 1.0867
Confusion Matrix:
 [[4657405   28264       0       0       0]
 [1827172   31537       0       0       0]
 [   6638       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8332
Class 1 F1: 0.0329
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7172
Class 1 Precision: 0.5274
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9940
Class 1 Recall: 0.0170
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7155
Macro F1 Score: 0.2165
xView2 Score: 0.0157
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0425
Confusion Matrix:
 [[4672626   13043       0       0       0]
 [1840633   18076       0       0       0]
 [   6638       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8338
Class 1 F1: 0.0191
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7164
Class 1 Precision: 0.5809
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9972
Class 1 Recall: 0.0097
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7157
Macro F1 Score: 0.2132
xView2 Score: 0.0091
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9977
Confusion Matrix:
 [[4671804   13865       0       0       0]
 [1840003   18706       0       0       0]
 [   6638       0       0       0       0]
 [   2584       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8338
Class 1 F1: 0.0198
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7164
Class 1 Precision: 0.5743
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9970
Class 1 Recall: 0.0101
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7157
Macro F1 Score: 0.2134
xView2 Score: 0.0094
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.2668
Best Macro F1: 0.1246
Best xView2 Score: 0.1630
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8163
Class 1 Precision: 0.4107
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2459
ROC curve saved to .././____________optune_results/137/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/137/plot_loss_curves.jpg
Prediction distribution: {0: 254963, 1: 7181}
ROC curve saved to .././____________optune_results/137/visualize_predictions.jpg
Prediction distribution: {0: 260673, 1: 1471}
ROC curve saved to .././____________optune_results/137/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/137/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/137/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/137/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2708501537359281, 1: 0.769646373368569, 2: 139.26468000332034, 3: 797.3961977186311, 4: 5292.497160883281}
Final class weights used in loss: [2.619418076219894, 2.3615056209863807, 139.26468000332034, 797.3961977186311, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5511
Confusion Matrix:
 [[3486575  329856  603563  172747    4835]
 [1493421  133901  210260  107930    2860]
 [   5936     129     931     363       0]
 [    257       0      34       2       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7276
Class 1 F1: 0.1110
Class 2 F1: 0.0023
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6992
Class 1 Precision: 0.2887
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7584
Class 1 Recall: 0.0687
Class 2 Recall: 0.1265
Class 3 Recall: 0.0068
Class 4 Recall: 0.0000
Validation Accuracy: 0.5526
Macro F1 Score: 0.1682
xView2 Score: 0.0969
Epoch 1 took:  0 hours,  1 minutes, 12 seconds

Epoch 2/10
Train Loss: 1.4682
Confusion Matrix:
 [[4447274   49239   76663   24037     363]
 [1867403   33206   28085   19343     335]
 [   7355       0       4       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8145
Class 1 F1: 0.0327
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7034
Class 1 Precision: 0.4028
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9673
Class 1 Recall: 0.0170
Class 2 Recall: 0.0005
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6837
Macro F1 Score: 0.1695
xView2 Score: 0.0269
Epoch 2 took:  0 hours,  0 minutes, 43 seconds

Epoch 3/10
Train Loss: 1.4033
Confusion Matrix:
 [[4580138   10203    5867    1336      32]
 [1933901    9957    3079    1406      29]
 [   7359       0       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8238
Class 1 F1: 0.0101
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7023
Class 1 Precision: 0.4939
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9962
Class 1 Recall: 0.0051
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7004
Macro F1 Score: 0.1668
xView2 Score: 0.0058
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3221
Confusion Matrix:
 [[4576958   19087    1253     278       0]
 [1923811   23298     658     601       4]
 [   7353       6       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8242
Class 1 F1: 0.0234
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7032
Class 1 Precision: 0.5496
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9955
Class 1 Recall: 0.0120
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7019
Macro F1 Score: 0.1695
xView2 Score: 0.0107
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2480
Confusion Matrix:
 [[4549869   47482     186      39       0]
 [1890454   57549     123     246       0]
 [   7313      46       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8238
Class 1 F1: 0.0561
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7056
Class 1 Precision: 0.5477
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9896
Class 1 Recall: 0.0295
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7030
Macro F1 Score: 0.2200
xView2 Score: 0.0269
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1813
Confusion Matrix:
 [[4536987   60583       6       0       0]
 [1870261   78105       0       6       0]
 [   7357       2       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8240
Class 1 F1: 0.0748
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7073
Class 1 Precision: 0.5632
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9868
Class 1 Recall: 0.0401
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7042
Macro F1 Score: 0.2247
xView2 Score: 0.0359
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1241
Confusion Matrix:
 [[4513140   84436       0       0       0]
 [1837940  110432       0       0       0]
 [   7325      34       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8238
Class 1 F1: 0.1030
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7098
Class 1 Precision: 0.5666
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9816
Class 1 Recall: 0.0567
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7055
Macro F1 Score: 0.2317
xView2 Score: 0.0496
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0843
Confusion Matrix:
 [[4506521   91055       0       0       0]
 [1829683  118689       0       0       0]
 [   7359       0       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8238
Class 1 F1: 0.1100
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7104
Class 1 Precision: 0.5659
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9802
Class 1 Recall: 0.0609
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7058
Macro F1 Score: 0.2334
xView2 Score: 0.0530
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0306
Confusion Matrix:
 [[4520168   77408       0       0       0]
 [1835652  112720       0       0       0]
 [   7336      23       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8248
Class 1 F1: 0.1054
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7103
Class 1 Precision: 0.5928
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9832
Class 1 Recall: 0.0579
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7069
Macro F1 Score: 0.2325
xView2 Score: 0.0507
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9893
Confusion Matrix:
 [[4483786  113790       0       0       0]
 [1785729  162643       0       0       0]
 [   7126     233       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8246
Class 1 F1: 0.1462
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7143
Class 1 Precision: 0.5879
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9753
Class 1 Recall: 0.0835
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7090
Macro F1 Score: 0.2427
xView2 Score: 0.0707
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5526
Best Macro F1: 0.1682
Best xView2 Score: 0.0969
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.6992
Class 1 Precision: 0.2887
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.1978
ROC curve saved to .././____________optune_results/138/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/138/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/138/visualize_predictions.jpg
Prediction distribution: {0: 238443, 1: 23701}
ROC curve saved to .././____________optune_results/138/visualize_predictions.jpg
Prediction distribution: {0: 261149, 1: 995}
ROC curve saved to .././____________optune_results/138/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/138/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/138/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2751019013384502, 1: 0.7374443766396171, 2: 134.27143657462986, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6605371391849806, 14.682947627115137, 134.27143657462986, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6144
Confusion Matrix:
 [[ 143140 2377361  136570  847613 1380093]
 [  81423 1177072   18750  178236  207327]
 [     18    4055      23    1153     766]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0560
Class 1 F1: 0.4509
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6374
Class 1 Precision: 0.3308
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0293
Class 1 Recall: 0.7079
Class 2 Recall: 0.0038
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2015
Macro F1 Score: 0.1014
xView2 Score: 0.2352
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5205
Confusion Matrix:
 [[ 351513 3496345   85462  368552  582905]
 [  37919 1596005    2664   13040   13180]
 [     13    5956      13       5      28]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1333
Class 1 F1: 0.4721
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9026
Class 1 Precision: 0.3130
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0720
Class 1 Recall: 0.9598
Class 2 Recall: 0.0022
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2972
Macro F1 Score: 0.1211
xView2 Score: 0.2622
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4323
Confusion Matrix:
 [[ 980400 3635361    8515  106953  153548]
 [  19467 1638801     122     498    3920]
 [    304    5709       0       2       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3332
Class 1 F1: 0.4721
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9802
Class 1 Precision: 0.3104
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2007
Class 1 Recall: 0.9856
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3997
Macro F1 Score: 0.1611
xView2 Score: 0.2757
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.3439
Confusion Matrix:
 [[1822389 3047884     390    6241    7873]
 [  26766 1635992      11      22      17]
 [    652    5363       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5412
Class 1 F1: 0.5151
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9852
Class 1 Precision: 0.3489
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3731
Class 1 Recall: 0.9839
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5277
Macro F1 Score: 0.2113
xView2 Score: 0.2932
Epoch 4 took:  0 hours,  1 minutes, 10 seconds

Epoch 5/10
Train Loss: 1.2438
Confusion Matrix:
 [[2128187 2756149      31     348      62]
 [  58702 1604106       0       0       0]
 [    668    5347       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6018
Class 1 F1: 0.5322
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9729
Class 1 Precision: 0.3674
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4357
Class 1 Recall: 0.9647
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5695
Macro F1 Score: 0.2268
xView2 Score: 0.3888
Epoch 5 took:  0 hours,  0 minutes, 40 seconds

Epoch 6/10
Train Loss: 1.1510
Confusion Matrix:
 [[2217040 2667696       2      39       0]
 [  53983 1608825       0       0       0]
 [    665    5350       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6196
Class 1 F1: 0.5413
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9759
Class 1 Precision: 0.3757
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4539
Class 1 Recall: 0.9675
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5838
Macro F1 Score: 0.2902
xView2 Score: 0.3919
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.0732
Confusion Matrix:
 [[2338710 2546067       0       0       0]
 [  75266 1587542       0       0       0]
 [    666    5349       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6408
Class 1 F1: 0.5473
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9686
Class 1 Precision: 0.3836
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4788
Class 1 Recall: 0.9547
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5991
Macro F1 Score: 0.3960
xView2 Score: 0.3921
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0275
Confusion Matrix:
 [[2495267 2389510       0       0       0]
 [ 113033 1549775       0       0       0]
 [    738    5277       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6660
Class 1 F1: 0.5528
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9564
Class 1 Precision: 0.3929
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5108
Class 1 Recall: 0.9320
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6172
Macro F1 Score: 0.4062
xView2 Score: 0.3910
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9680
Confusion Matrix:
 [[2463342 2421435       0       0       0]
 [ 107227 1555581       0       0       0]
 [    888    5127       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6607
Class 1 F1: 0.5511
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9580
Class 1 Precision: 0.3906
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5043
Class 1 Recall: 0.9355
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6132
Macro F1 Score: 0.4040
xView2 Score: 0.3909
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9615
Confusion Matrix:
 [[2520049 2364728       0       0       0]
 [  84534 1578274       0       0       0]
 [    666    5349       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6729
Class 1 F1: 0.5625
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9673
Class 1 Precision: 0.3997
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5159
Class 1 Recall: 0.9492
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6254
Macro F1 Score: 0.4118
xView2 Score: 0.3960
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6254
Best Macro F1: 0.4118
Best xView2 Score: 0.3960
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9673
Class 1 Precision: 0.3997
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4557
ROC curve saved to .././____________optune_results/139/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/139/plot_loss_curves.jpg
Prediction distribution: {0: 110193, 1: 151951}
ROC curve saved to .././____________optune_results/139/visualize_predictions.jpg
Prediction distribution: {0: 163461, 1: 98683}
ROC curve saved to .././____________optune_results/139/visualize_predictions.jpg
Prediction distribution: {0: 68956, 1: 193188}
ROC curve saved to .././____________optune_results/139/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/139/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/139/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27054690505119744, 1: 0.7720885254190281, 2: 137.31931356232778, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [2.616485328811717, 2.0655885848358992, 137.31931356232778, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6760
Confusion Matrix:
 [[ 474637  670857 3076624  204220  150409]
 [ 141550  344503 1243947  125308  113749]
 [    519     303    5467     328     230]
 [    216      85     635      13       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1828
Class 1 F1: 0.2308
Class 2 F1: 0.0025
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7694
Class 1 Precision: 0.3392
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1037
Class 1 Recall: 0.1750
Class 2 Recall: 0.7985
Class 3 Recall: 0.0137
Class 4 Recall: 0.0000
Validation Accuracy: 0.1258
Macro F1 Score: 0.0832
xView2 Score: 0.1820
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5840
Confusion Matrix:
 [[1817341  572894 1989008  123909   73595]
 [ 570997  377582  865212   86412   68854]
 [   2886    1203    2736       0      22]
 [    465     156     328       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5216
Class 1 F1: 0.2585
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7599
Class 1 Precision: 0.3967
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3971
Class 1 Recall: 0.1918
Class 2 Recall: 0.3996
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3353
Macro F1 Score: 0.1564
xView2 Score: 0.1830
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5042
Confusion Matrix:
 [[3517473  328941  656922   53475   19936]
 [1323639  241669  340036   37963   25750]
 [   4977     703    1167       0       0]
 [    445      22     431      51       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7465
Class 1 F1: 0.1903
Class 2 F1: 0.0023
Class 3 F1: 0.0011
Class 4 F1: 0.0000
Class 0 Precision: 0.7258
Class 1 Precision: 0.4230
Class 2 Precision: 0.0012
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Class 0 Recall: 0.7686
Class 1 Recall: 0.1227
Class 2 Recall: 0.1704
Class 3 Recall: 0.0537
Class 4 Recall: 0.0000
Validation Accuracy: 0.5738
Macro F1 Score: 0.1880
xView2 Score: 0.1374
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.4232
Confusion Matrix:
 [[4251709  202171  109976   11712    1179]
 [1696481  181011   77872   11326    2367]
 [   6047     376     424       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8074
Class 1 F1: 0.1539
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7140
Class 1 Precision: 0.4719
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9290
Class 1 Recall: 0.0919
Class 2 Recall: 0.0619
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6764
Macro F1 Score: 0.1931
xView2 Score: 0.0887
Epoch 4 took:  0 hours,  1 minutes,  7 seconds

Epoch 5/10
Train Loss: 1.3445
Confusion Matrix:
 [[4417475  144513   13871     710     178]
 [1815948  140309   11700     821     279]
 [   6590     243      14       0       0]
 [    887      54       8       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8167
Class 1 F1: 0.1245
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7078
Class 1 Precision: 0.4921
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9652
Class 1 Recall: 0.0713
Class 2 Recall: 0.0020
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6955
Macro F1 Score: 0.1884
xView2 Score: 0.0590
Epoch 5 took:  0 hours,  0 minutes, 39 seconds

Epoch 6/10
Train Loss: 1.2730
Confusion Matrix:
 [[4515519   60566     641      21       0]
 [1893632   74226     760     439       0]
 [   6824      23       0       0       0]
 [    948       1       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8215
Class 1 F1: 0.0706
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7037
Class 1 Precision: 0.5506
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9866
Class 1 Recall: 0.0377
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7003
Macro F1 Score: 0.2230
xView2 Score: 0.0341
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.2012
Confusion Matrix:
 [[4522472   54224      51       0       0]
 [1900744   68181     132       0       0]
 [   6818      29       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8217
Class 1 F1: 0.0652
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7032
Class 1 Precision: 0.5569
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9881
Class 1 Recall: 0.0346
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7005
Macro F1 Score: 0.2217
xView2 Score: 0.0312
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1420
Confusion Matrix:
 [[4547227   29518       2       0       0]
 [1926540   42511       6       0       0]
 [   6695     152       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8224
Class 1 F1: 0.0417
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7016
Class 1 Precision: 0.5890
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9936
Class 1 Recall: 0.0216
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7003
Macro F1 Score: 0.2160
xView2 Score: 0.0199
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0981
Confusion Matrix:
 [[4546134   30613       0       0       0]
 [1925943   43114       0       0       0]
 [   6815      32       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8223
Class 1 F1: 0.0422
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7016
Class 1 Precision: 0.5845
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9933
Class 1 Recall: 0.0219
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7003
Macro F1 Score: 0.2161
xView2 Score: 0.0201
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0575
Confusion Matrix:
 [[4537471   39276       0       0       0]
 [1910475   58582       0       0       0]
 [   6547     300       0       0       0]
 [    949       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8226
Class 1 F1: 0.0567
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7029
Class 1 Precision: 0.5968
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9914
Class 1 Recall: 0.0298
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7013
Macro F1 Score: 0.2198
xView2 Score: 0.0271
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3353
Best Macro F1: 0.1564
Best xView2 Score: 0.1830
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7599
Class 1 Precision: 0.3967
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2315
ROC curve saved to .././____________optune_results/140/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/140/plot_loss_curves.jpg
Prediction distribution: {0: 255440, 1: 6704}
ROC curve saved to .././____________optune_results/140/visualize_predictions.jpg
Prediction distribution: {0: 258439, 1: 3705}
ROC curve saved to .././____________optune_results/140/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/140/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/140/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/140/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2689183760341037, 1: 0.7856306567301352, 2: 129.24108463434675, 3: 1638.4, 4: 5292.497160883281}
Final class weights used in loss: [2.600735666918658, 4.189960204243191, 129.24108463434675, 1638.4, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5921
Confusion Matrix:
 [[  15776 4415287     390   16596   16037]
 [   4002 2069560      71    6075    1717]
 [      0    4547       0       9       0]
 [      0    3533       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0070
Class 1 F1: 0.4827
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7977
Class 1 Precision: 0.3187
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0035
Class 1 Recall: 0.9943
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3182
Macro F1 Score: 0.0980
xView2 Score: 0.2844
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5152
Confusion Matrix:
 [[ 160074 4298451       3    2529    3029]
 [  12411 2067790       6     906     312]
 [    158    4398       0       0       0]
 [      3    3530       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0690
Class 1 F1: 0.4891
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9272
Class 1 Precision: 0.3244
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0359
Class 1 Recall: 0.9934
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3399
Macro F1 Score: 0.1116
xView2 Score: 0.2864
Epoch 2 took:  0 hours,  1 minutes, 12 seconds

Epoch 3/10
Train Loss: 1.4423
Confusion Matrix:
 [[1036020 3427420       0     475     171]
 [  68739 2012460       0     126     100]
 [    181    4375       0       0       0]
 [     93    3440       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3721
Class 1 F1: 0.5346
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9375
Class 1 Precision: 0.3694
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2321
Class 1 Recall: 0.9669
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4652
Macro F1 Score: 0.1813
xView2 Score: 0.2982
Epoch 3 took:  0 hours,  0 minutes, 55 seconds

Epoch 4/10
Train Loss: 1.3687
Confusion Matrix:
 [[1563281 2900773       0      31       1]
 [ 104454 1976962       0       9       0]
 [    921    3635       0       0       0]
 [      8    3525       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5098
Class 1 F1: 0.5676
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9368
Class 1 Precision: 0.4047
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3502
Class 1 Recall: 0.9498
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5402
Macro F1 Score: 0.2155
xView2 Score: 0.3409
Epoch 4 took:  0 hours,  0 minutes, 37 seconds

Epoch 5/10
Train Loss: 1.2981
Confusion Matrix:
 [[1816869 2647216       0       0       1]
 [ 140137 1941288       0       0       0]
 [   1484    3072       0       0       0]
 [    274    3259       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5658
Class 1 F1: 0.5815
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9276
Class 1 Precision: 0.4225
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4070
Class 1 Recall: 0.9327
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5734
Macro F1 Score: 0.2295
xView2 Score: 0.3435
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2225
Confusion Matrix:
 [[2116695 2347391       0       0       0]
 [ 226160 1855265       0       0       0]
 [   1564    2992       0       0       0]
 [    330    3203       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6217
Class 1 F1: 0.5899
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9027
Class 1 Precision: 0.4408
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4742
Class 1 Recall: 0.8913
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6061
Macro F1 Score: 0.3029
xView2 Score: 0.3420
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1738
Confusion Matrix:
 [[2184901 2279185       0       0       0]
 [ 273855 1807570       0       0       0]
 [   1624    2932       0       0       0]
 [     44    3489       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6311
Class 1 F1: 0.5855
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8880
Class 1 Precision: 0.4416
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4894
Class 1 Recall: 0.8684
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6092
Macro F1 Score: 0.3041
xView2 Score: 0.3384
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1066
Confusion Matrix:
 [[2263309 2200777       0       0       0]
 [ 304082 1777343       0       0       0]
 [   2149    2407       0       0       0]
 [     56    3477       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6436
Class 1 F1: 0.5861
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8808
Class 1 Precision: 0.4461
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5070
Class 1 Recall: 0.8539
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6166
Macro F1 Score: 0.3074
xView2 Score: 0.3371
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0609
Confusion Matrix:
 [[2387170 2076916       0       0       0]
 [ 343700 1737725       0       0       0]
 [   2204    2352       0       0       0]
 [    124    3409       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6634
Class 1 F1: 0.5889
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8734
Class 1 Precision: 0.4549
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5348
Class 1 Recall: 0.8349
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6294
Macro F1 Score: 0.3131
xView2 Score: 0.3360
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0292
Confusion Matrix:
 [[2273568 2190518       0       0       0]
 [ 274853 1806572       0       0       0]
 [    715    3841       0       0       0]
 [    339    3194       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6483
Class 1 F1: 0.5937
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8918
Class 1 Precision: 0.4512
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5093
Class 1 Recall: 0.8679
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6226
Macro F1 Score: 0.3105
xView2 Score: 0.3409
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5734
Best Macro F1: 0.2295
Best xView2 Score: 0.3435
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9276
Class 1 Precision: 0.4225
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2700
ROC curve saved to .././____________optune_results/141/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/141/plot_loss_curves.jpg
Prediction distribution: {0: 131494, 1: 130650}
ROC curve saved to .././____________optune_results/141/visualize_predictions.jpg
Prediction distribution: {0: 21847, 1: 240297}
ROC curve saved to .././____________optune_results/141/visualize_predictions.jpg
Prediction distribution: {0: 92479, 1: 169665}
ROC curve saved to .././____________optune_results/141/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/141/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/141/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27630605232076033, 1: 0.7282238185487132, 2: 146.44916201117317, 3: 1657.2817912413566, 4: 5292.497160883281}
Final class weights used in loss: [2.672182599990723, 1.2554606255401144, 146.44916201117317, 1657.2817912413566, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5951
Confusion Matrix:
 [[1802410 2702797   58766   21138  379399]
 [ 273723 1151914   20594    4527  125632]
 [   2526    4660      25       0    1921]
 [    892    2620       0       0      56]
 [      0       0       0       0       0]]
Class 0 F1: 0.5118
Class 1 F1: 0.4236
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8667
Class 1 Precision: 0.2983
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3631
Class 1 Recall: 0.7307
Class 2 Recall: 0.0027
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4508
Macro F1 Score: 0.1872
xView2 Score: 0.2480
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5035
Confusion Matrix:
 [[3604170 1251357   12333    5221   91429]
 [ 786344  744398    6570    1989   37089]
 [   4766    3806      91       0     469]
 [   2619     948       0       0       1]
 [      0       0       0       0       0]]
Class 0 F1: 0.7699
Class 1 F1: 0.4162
Class 2 F1: 0.0065
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8195
Class 1 Precision: 0.3721
Class 2 Precision: 0.0048
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7260
Class 1 Recall: 0.4722
Class 2 Recall: 0.0100
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6636
Macro F1 Score: 0.2385
xView2 Score: 0.2187
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.4214
Confusion Matrix:
 [[4513950  440963    1177     342    8078]
 [1247109  324805     963     108    3405]
 [   7566    1561       3       0       2]
 [   1753    1815       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8410
Class 1 F1: 0.2770
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7823
Class 1 Precision: 0.4223
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9092
Class 1 Recall: 0.2060
Class 2 Recall: 0.0003
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7383
Macro F1 Score: 0.2237
xView2 Score: 0.1320
Epoch 3 took:  0 hours,  1 minutes, 16 seconds

Epoch 4/10
Train Loss: 1.3302
Confusion Matrix:
 [[4748353  215713     102       3     339]
 [1396760  179483      81       0      66]
 [   8695     437       0       0       0]
 [   3567       1       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8539
Class 1 F1: 0.1820
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7712
Class 1 Precision: 0.4537
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9565
Class 1 Recall: 0.1139
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7519
Macro F1 Score: 0.2072
xView2 Score: 0.0830
Epoch 4 took:  0 hours,  0 minutes, 47 seconds

Epoch 5/10
Train Loss: 1.2552
Confusion Matrix:
 [[4913098   51411       0       0       1]
 [1525880   50510       0       0       0]
 [   8855     277       0       0       0]
 [   3058     510       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0602
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7616
Class 1 Precision: 0.4918
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9896
Class 1 Recall: 0.0320
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7574
Macro F1 Score: 0.1842
xView2 Score: 0.0291
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1707
Confusion Matrix:
 [[4947015   17495       0       0       0]
 [1555969   20421       0       0       0]
 [   8666     466       0       0       0]
 [   3313     255       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8619
Class 1 F1: 0.0253
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7593
Class 1 Precision: 0.5285
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9965
Class 1 Recall: 0.0130
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7580
Macro F1 Score: 0.2218
xView2 Score: 0.0123
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1066
Confusion Matrix:
 [[4961446    3064       0       0       0]
 [1573303    3087       0       0       0]
 [   9132       0       0       0       0]
 [   3568       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8620
Class 1 F1: 0.0039
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7578
Class 1 Precision: 0.5019
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0020
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7575
Macro F1 Score: 0.2165
xView2 Score: 0.0018
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0529
Confusion Matrix:
 [[4964076     434       0       0       0]
 [1575906     484       0       0       0]
 [   9132       0       0       0       0]
 [   3568       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8620
Class 1 F1: 0.0006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7576
Class 1 Precision: 0.5272
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0003
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7575
Macro F1 Score: 0.2157
xView2 Score: 0.0003
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9936
Confusion Matrix:
 [[4964475      35       0       0       0]
 [1576378      12       0       0       0]
 [   9132       0       0       0       0]
 [   3568       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8620
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7575
Class 1 Precision: 0.2553
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7575
Macro F1 Score: 0.2155
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.9645
Confusion Matrix:
 [[4964510       0       0       0       0]
 [1576390       0       0       0       0]
 [   9132       0       0       0       0]
 [   3568       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8620
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7575
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7575
Macro F1 Score: 0.2155
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4508
Best Macro F1: 0.1872
Best xView2 Score: 0.2480
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8667
Class 1 Precision: 0.2983
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2331
ROC curve saved to .././____________optune_results/142/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/142/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/142/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/142/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/142/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/142/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/142/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2777112793325348, 1: 0.7192818678022364, 2: 135.7196925980855, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.685772686557273, 11.196489664212228, 135.7196925980855, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5879
Confusion Matrix:
 [[1025360 2947155  835146  187071   61951]
 [  43116 1164902  210011   52291   20147]
 [    311    3517    2125     127     335]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3348
Class 1 F1: 0.4156
Class 2 F1: 0.0040
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9594
Class 1 Precision: 0.2830
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2028
Class 1 Recall: 0.7816
Class 2 Recall: 0.3313
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3345
Macro F1 Score: 0.1509
xView2 Score: 0.2503
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4975
Confusion Matrix:
 [[1491598 3337665  156057   62585    8778]
 [  53768 1402373   21720   10832    1774]
 [     22    6318      64       7       4]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4519
Class 1 F1: 0.4497
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9652
Class 1 Precision: 0.2955
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2950
Class 1 Recall: 0.9409
Class 2 Recall: 0.0100
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4416
Macro F1 Score: 0.1805
xView2 Score: 0.2692
Epoch 2 took:  0 hours,  1 minutes, 17 seconds

Epoch 3/10
Train Loss: 1.4148
Confusion Matrix:
 [[1793785 3233435   17563   11431     469]
 [  70019 1415387    3587    1386      88]
 [   1119    5276      20       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5183
Class 1 F1: 0.4607
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9619
Class 1 Precision: 0.3041
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3547
Class 1 Recall: 0.9496
Class 2 Recall: 0.0031
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4897
Macro F1 Score: 0.1961
xView2 Score: 0.2750
Epoch 3 took:  0 hours,  0 minutes, 46 seconds

Epoch 4/10
Train Loss: 1.3315
Confusion Matrix:
 [[2284057 2769715    1156    1741      14]
 [  68267 1422091      44      62       3]
 [     44    6371       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6166
Class 1 F1: 0.5000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9710
Class 1 Precision: 0.3387
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4517
Class 1 Recall: 0.9541
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5655
Macro F1 Score: 0.2233
xView2 Score: 0.2868
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.2446
Confusion Matrix:
 [[2550560 2505903      15     205       0]
 [ 100912 1389555       0       0       0]
 [     64    6351       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6618
Class 1 F1: 0.5154
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9619
Class 1 Precision: 0.3561
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5044
Class 1 Recall: 0.9323
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6012
Macro F1 Score: 0.2943
xView2 Score: 0.3236
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1716
Confusion Matrix:
 [[2653904 2402734       0      45       0]
 [  97823 1392644       0       0       0]
 [     43    6372       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6798
Class 1 F1: 0.5263
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9644
Class 1 Precision: 0.3663
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5248
Class 1 Recall: 0.9344
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6175
Macro F1 Score: 0.3015
xView2 Score: 0.3271
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.0980
Confusion Matrix:
 [[2794617 2262066       0       0       0]
 [ 125402 1365065       0       0       0]
 [    422    5993       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7007
Class 1 F1: 0.5329
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9569
Class 1 Precision: 0.3757
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5527
Class 1 Recall: 0.9159
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6347
Macro F1 Score: 0.3084
xView2 Score: 0.3273
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.0539
Confusion Matrix:
 [[2883262 2173421       0       0       0]
 [ 161023 1329444       0       0       0]
 [   1305    5110       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7117
Class 1 F1: 0.5319
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9467
Class 1 Precision: 0.3790
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5702
Class 1 Recall: 0.8920
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6428
Macro F1 Score: 0.3109
xView2 Score: 0.3247
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.0046
Confusion Matrix:
 [[3013290 2043393       0       0       0]
 [ 164959 1325508       0       0       0]
 [    678    5737       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7318
Class 1 F1: 0.5449
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9479
Class 1 Precision: 0.3928
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5959
Class 1 Recall: 0.8893
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6620
Macro F1 Score: 0.3192
xView2 Score: 0.3284
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 0.9651
Confusion Matrix:
 [[3040193 2016490       0       0       0]
 [ 151261 1339206       0       0       0]
 [    240    6175       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7372
Class 1 F1: 0.5520
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9525
Class 1 Precision: 0.3983
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6012
Class 1 Recall: 0.8985
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6682
Macro F1 Score: 0.3223
xView2 Score: 0.3314
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6682
Best Macro F1: 0.3223
Best xView2 Score: 0.3314
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9525
Class 1 Precision: 0.3983
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3377
ROC curve saved to .././____________optune_results/143/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/143/plot_loss_curves.jpg
Prediction distribution: {0: 144099, 1: 118045}
ROC curve saved to .././____________optune_results/143/visualize_predictions.jpg
Prediction distribution: {0: 232748, 1: 29396}
ROC curve saved to .././____________optune_results/143/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/143/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/143/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/143/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27116603287116475, 1: 0.7665428480832792, 2: 157.10965164190287, 3: 889.2517314487633, 4: 5732.533940774488}
Final class weights used in loss: [2.622472973938528, 9.161473108882696, 157.10965164190287, 889.2517314487633, 5732.533940774488]

Epoch 1/10
Train Loss: 1.6136
Confusion Matrix:
 [[1230228 1482590  301417  601251 1003737]
 [ 330636  918442  169688  263759  239370]
 [   1566    7222     257    1814     605]
 [    252     526      57     110       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.3980
Class 1 F1: 0.4241
Class 2 F1: 0.0011
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.7873
Class 1 Precision: 0.3813
Class 2 Precision: 0.0005
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.2663
Class 1 Recall: 0.4779
Class 2 Recall: 0.0224
Class 3 Recall: 0.1164
Class 4 Recall: 0.0000
Validation Accuracy: 0.3279
Macro F1 Score: 0.1647
xView2 Score: 0.2296
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5329
Confusion Matrix:
 [[1800435 2452333   41153   90453  234849]
 [ 319393 1534169   13897   26841   27595]
 [   1945    8952      17      10     540]
 [     47     844       0      54       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.5342
Class 1 F1: 0.5185
Class 2 F1: 0.0005
Class 3 F1: 0.0009
Class 4 F1: 0.0000
Class 0 Precision: 0.8485
Class 1 Precision: 0.3839
Class 2 Precision: 0.0003
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.3898
Class 1 Recall: 0.7983
Class 2 Recall: 0.0015
Class 3 Recall: 0.0571
Class 4 Recall: 0.0000
Validation Accuracy: 0.5088
Macro F1 Score: 0.2108
xView2 Score: 0.2767
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4631
Confusion Matrix:
 [[1937841 2641561    2699   11864   25258]
 [ 254163 1661933     681    2192    2926]
 [   1539    9894       0       4      27]
 [    113     815       0      17       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.5689
Class 1 F1: 0.5330
Class 2 F1: 0.0000
Class 3 F1: 0.0023
Class 4 F1: 0.0000
Class 0 Precision: 0.8834
Class 1 Precision: 0.3852
Class 2 Precision: 0.0000
Class 3 Precision: 0.0012
Class 4 Precision: 0.0000
Class 0 Recall: 0.4195
Class 1 Recall: 0.8647
Class 2 Recall: 0.0000
Class 3 Recall: 0.0180
Class 4 Recall: 0.0000
Validation Accuracy: 0.5493
Macro F1 Score: 0.2208
xView2 Score: 0.2910
Epoch 3 took:  0 hours,  1 minutes, 18 seconds

Epoch 4/10
Train Loss: 1.3848
Confusion Matrix:
 [[1796612 2820185     245     784    1397]
 [ 166569 1754672      21     310     323]
 [    809   10653       0       2       0]
 [      8     937       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.5458
Class 1 F1: 0.5392
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9148
Class 1 Precision: 0.3826
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3889
Class 1 Recall: 0.9130
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5419
Macro F1 Score: 0.2170
xView2 Score: 0.2957
Epoch 4 took:  0 hours,  1 minutes,  6 seconds

Epoch 5/10
Train Loss: 1.2974
Confusion Matrix:
 [[1877452 2741483       2     125     161]
 [ 166385 1755455       0      48       7]
 [    814   10650       0       0       0]
 [     15     930       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.5635
Class 1 F1: 0.5460
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9182
Class 1 Precision: 0.3894
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4064
Class 1 Recall: 0.9134
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5543
Macro F1 Score: 0.2219
xView2 Score: 0.2978
Epoch 5 took:  0 hours,  0 minutes, 34 seconds

Epoch 6/10
Train Loss: 1.2125
Confusion Matrix:
 [[2115310 2503850       0      20      43]
 [ 219331 1702547       0       6      11]
 [   1418   10046       0       0       0]
 [    110     835       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6083
Class 1 F1: 0.5546
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9055
Class 1 Precision: 0.4037
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4579
Class 1 Recall: 0.8859
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5826
Macro F1 Score: 0.2326
xView2 Score: 0.2983
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.1563
Confusion Matrix:
 [[2089545 2529659       0      14       5]
 [ 230136 1691758       0       0       1]
 [   1658    9806       0       0       0]
 [    110     835       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6021
Class 1 F1: 0.5498
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9001
Class 1 Precision: 0.3997
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4524
Class 1 Recall: 0.8803
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5770
Macro F1 Score: 0.2304
xView2 Score: 0.2963
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0848
Confusion Matrix:
 [[2232347 2386876       0       0       0]
 [ 247687 1674208       0       0       0]
 [   3401    8063       0       0       0]
 [    299     646       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.6286
Class 1 F1: 0.5588
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8988
Class 1 Precision: 0.4114
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4833
Class 1 Recall: 0.8711
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5961
Macro F1 Score: 0.2375
xView2 Score: 0.2982
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0480
Confusion Matrix:
 [[2152177 2467046       0       0       0]
 [ 298120 1623775       0       0       0]
 [   4024    7440       0       0       0]
 [    114     831       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6085
Class 1 F1: 0.5394
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8769
Class 1 Precision: 0.3961
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4659
Class 1 Recall: 0.8449
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5762
Macro F1 Score: 0.2296
xView2 Score: 0.2902
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0062
Confusion Matrix:
 [[2279742 2339481       0       0       0]
 [ 274132 1647763       0       0       0]
 [   3127    8337       0       0       0]
 [    112     833       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.6353
Class 1 F1: 0.5568
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8915
Class 1 Precision: 0.4123
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4935
Class 1 Recall: 0.8574
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5993
Macro F1 Score: 0.2384
xView2 Score: 0.2965
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5826
Best Macro F1: 0.2326
Best xView2 Score: 0.2983
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9055
Class 1 Precision: 0.4037
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2618
ROC curve saved to .././____________optune_results/144/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/144/plot_loss_curves.jpg
Prediction distribution: {0: 135726, 1: 126418}
ROC curve saved to .././____________optune_results/144/visualize_predictions.jpg
Prediction distribution: {0: 85304, 1: 176840}
ROC curve saved to .././____________optune_results/144/visualize_predictions.jpg
Prediction distribution: {0: 57222, 1: 204922}
ROC curve saved to .././____________optune_results/144/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/144/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/144/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2696488181566236, 1: 0.7794817026804434, 2: 141.48834228206786, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.60779984344937, 1.8016256704166267, 141.48834228206786, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4555
Confusion Matrix:
 [[4273160  228897    3727    7911    1091]
 [1775367  244557    3369    6545    1049]
 [   6618    1309       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8086
Class 1 F1: 0.1952
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7057
Class 1 Precision: 0.5151
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9465
Class 1 Recall: 0.1204
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6893
Macro F1 Score: 0.2008
xView2 Score: 0.0908
Epoch 1 took:  0 hours,  1 minutes,  3 seconds

Epoch 2/10
Train Loss: 1.3784
Confusion Matrix:
 [[4456354   58145      51     172      64]
 [1945293   85204      23     318      49]
 [   7766     161       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8159
Class 1 F1: 0.0784
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6953
Class 1 Precision: 0.5937
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9871
Class 1 Recall: 0.0420
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6930
Macro F1 Score: 0.1788
xView2 Score: 0.0348
Epoch 2 took:  0 hours,  0 minutes, 32 seconds

Epoch 3/10
Train Loss: 1.3143
Confusion Matrix:
 [[4496234   18551       1       0       0]
 [1997632   33252       0       0       3]
 [   7927       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8163
Class 1 F1: 0.0319
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6915
Class 1 Precision: 0.6419
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9959
Class 1 Recall: 0.0164
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6911
Macro F1 Score: 0.2120
xView2 Score: 0.0152
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.2528
Confusion Matrix:
 [[4503044   11742       0       0       0]
 [2009680   21207       0       0       0]
 [   7780     147       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8161
Class 1 F1: 0.0205
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6906
Class 1 Precision: 0.6408
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9974
Class 1 Recall: 0.0104
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6903
Macro F1 Score: 0.2789
xView2 Score: 0.0110
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1851
Confusion Matrix:
 [[4504821    9965       0       0       0]
 [2009322   21565       0       0       0]
 [   7895      32       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8163
Class 1 F1: 0.0209
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6907
Class 1 Precision: 0.6833
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9978
Class 1 Recall: 0.0106
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6907
Macro F1 Score: 0.2791
xView2 Score: 0.0112
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1218
Confusion Matrix:
 [[4506887    7899       0       0       0]
 [2013114   17773       0       0       0]
 [   7902      25       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8163
Class 1 F1: 0.0173
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6904
Class 1 Precision: 0.6916
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9983
Class 1 Recall: 0.0088
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6904
Macro F1 Score: 0.2779
xView2 Score: 0.0092
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0702
Confusion Matrix:
 [[4506922    7864       0       0       0]
 [2010393   20494       0       0       0]
 [   7927       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8165
Class 1 F1: 0.0199
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6907
Class 1 Precision: 0.7227
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9983
Class 1 Recall: 0.0101
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6908
Macro F1 Score: 0.2788
xView2 Score: 0.0106
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0220
Confusion Matrix:
 [[4495560   19226       0       0       0]
 [1984592   46295       0       0       0]
 [   7927       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8172
Class 1 F1: 0.0442
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6929
Class 1 Precision: 0.7066
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9957
Class 1 Recall: 0.0228
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6930
Macro F1 Score: 0.2871
xView2 Score: 0.0236
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0067
Confusion Matrix:
 [[4494742   20044       0       0       0]
 [1982100   48787       0       0       0]
 [   7910      17       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8173
Class 1 F1: 0.0465
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6931
Class 1 Precision: 0.7086
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9956
Class 1 Recall: 0.0240
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6933
Macro F1 Score: 0.2879
xView2 Score: 0.0248
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9616
Confusion Matrix:
 [[4506771    8015       0       0       0]
 [2004462   26425       0       0       0]
 [   7927       0       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8169
Class 1 F1: 0.0256
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6913
Class 1 Precision: 0.7673
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9982
Class 1 Recall: 0.0130
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6917
Macro F1 Score: 0.2808
xView2 Score: 0.0136
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6893
Best Macro F1: 0.2008
Best xView2 Score: 0.0908
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7057
Class 1 Precision: 0.5151
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2442
ROC curve saved to .././____________optune_results/145/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/145/plot_loss_curves.jpg
Prediction distribution: {0: 261991, 1: 153}
ROC curve saved to .././____________optune_results/145/visualize_predictions.jpg
Prediction distribution: {0: 262126, 1: 18}
ROC curve saved to .././____________optune_results/145/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/145/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/145/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/145/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27379694038537467, 1: 0.7455604904095738, 2: 183.31080598754417, 3: 1092.029681058798, 4: 68947.46301369862}
Final class weights used in loss: [2.6479167353856905, 14.112228491131484, 183.31080598754417, 1092.029681058798, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6394
Confusion Matrix:
 [[ 502080 1466222  762790  527896 1538589]
 [  49091  780811  361177  191473  354554]
 [    530    1569    5810    1413    6721]
 [     98     463       0     584     851]
 [      0     168      61      21     628]]
Class 0 F1: 0.1877
Class 1 F1: 0.3917
Class 2 F1: 0.0101
Class 3 F1: 0.0016
Class 4 F1: 0.0007
Class 0 Precision: 0.9099
Class 1 Precision: 0.3471
Class 2 Precision: 0.0051
Class 3 Precision: 0.0008
Class 4 Precision: 0.0003
Class 0 Recall: 0.1047
Class 1 Recall: 0.4495
Class 2 Recall: 0.3622
Class 3 Recall: 0.2926
Class 4 Recall: 0.7153
Validation Accuracy: 0.1968
Macro F1 Score: 0.1184
xView2 Score: 0.2243
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5456
Confusion Matrix:
 [[ 818985 3009517  221848  124319  622908]
 [  76148 1429766   79140   35057  116995]
 [    902   13400     354      96    1291]
 [     60    1694     190       9      43]
 [      1     877       0       0       0]]
Class 0 F1: 0.2877
Class 1 F1: 0.4618
Class 2 F1: 0.0022
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.9139
Class 1 Precision: 0.3209
Class 2 Precision: 0.0012
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.1707
Class 1 Recall: 0.8231
Class 2 Recall: 0.0221
Class 3 Recall: 0.0045
Class 4 Recall: 0.0000
Validation Accuracy: 0.3432
Macro F1 Score: 0.1504
xView2 Score: 0.2628
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4609
Confusion Matrix:
 [[1053521 3571364   29268   15694  127730]
 [  60752 1648798    7981    3674   15901]
 [    406   12704     248       0    2685]
 [      1    1915      17       0      63]
 [      0     871       0       0       7]]
Class 0 F1: 0.3564
Class 1 F1: 0.4729
Class 2 F1: 0.0093
Class 3 F1: 0.0000
Class 4 F1: 0.0001
Class 0 Precision: 0.9451
Class 1 Precision: 0.3149
Class 2 Precision: 0.0066
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2196
Class 1 Recall: 0.9492
Class 2 Recall: 0.0155
Class 3 Recall: 0.0000
Class 4 Recall: 0.0080
Validation Accuracy: 0.4124
Macro F1 Score: 0.1677
xView2 Score: 0.2800
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.3731
Confusion Matrix:
 [[1617761 3158743    1026    1126   18921]
 [  88738 1645879     231     265    1993]
 [   1478   14565       0       0       0]
 [      9    1987       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.4973
Class 1 F1: 0.5019
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9472
Class 1 Precision: 0.3413
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3372
Class 1 Recall: 0.9475
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4980
Macro F1 Score: 0.1998
xView2 Score: 0.2869
Epoch 4 took:  0 hours,  1 minutes, 16 seconds

Epoch 5/10
Train Loss: 1.2756
Confusion Matrix:
 [[1931845 2862227     109     218    3178]
 [  51683 1685049       0       2     372]
 [    651   15387       0       0       5]
 [      2    1994       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.5697
Class 1 F1: 0.5347
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9736
Class 1 Precision: 0.3691
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4027
Class 1 Recall: 0.9700
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5519
Macro F1 Score: 0.2209
xView2 Score: 0.2987
Epoch 5 took:  0 hours,  1 minutes,  6 seconds

Epoch 6/10
Train Loss: 1.1847
Confusion Matrix:
 [[2139560 2657607      11       0     399]
 [  61524 1675481       1       0     100]
 [    572   15462       0       0       9]
 [     55    1941       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.6114
Class 1 F1: 0.5504
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9718
Class 1 Precision: 0.3850
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4460
Class 1 Recall: 0.9645
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5821
Macro F1 Score: 0.2323
xView2 Score: 0.3031
Epoch 6 took:  0 hours,  0 minutes, 45 seconds

Epoch 7/10
Train Loss: 1.1226
Confusion Matrix:
 [[1998952 2798589       1       0      35]
 [  58177 1678913       0       0      16]
 [   1432   14611       0       0       0]
 [      0    1996       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.5831
Class 1 F1: 0.5388
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9710
Class 1 Precision: 0.3735
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4167
Class 1 Recall: 0.9665
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5612
Macro F1 Score: 0.2244
xView2 Score: 0.2997
Epoch 7 took:  0 hours,  0 minutes, 31 seconds

Epoch 8/10
Train Loss: 1.0759
Confusion Matrix:
 [[2232582 2564991       2       0       2]
 [  76378 1660724       0       0       4]
 [   1617   14426       0       0       0]
 [      0    1996       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.6282
Class 1 F1: 0.5554
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9662
Class 1 Precision: 0.3914
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4654
Class 1 Recall: 0.9560
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5941
Macro F1 Score: 0.2367
xView2 Score: 0.3040
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0137
Confusion Matrix:
 [[2232861 2564716       0       0       0]
 [ 128995 1608111       0       0       0]
 [   1739   14304       0       0       0]
 [    458    1538       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.6236
Class 1 F1: 0.5427
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9445
Class 1 Precision: 0.3838
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4654
Class 1 Recall: 0.9257
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5861
Macro F1 Score: 0.2332
xView2 Score: 0.2979
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9768
Confusion Matrix:
 [[2222461 2575116       0       0       0]
 [ 102153 1634953       0       0       0]
 [   1343   14700       0       0       0]
 [    538    1458       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.6239
Class 1 F1: 0.5483
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9553
Class 1 Precision: 0.3868
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4632
Class 1 Recall: 0.9412
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5886
Macro F1 Score: 0.2344
xView2 Score: 0.3007
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5941
Best Macro F1: 0.2367
Best xView2 Score: 0.3040
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9662
Class 1 Precision: 0.3914
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2715
ROC curve saved to .././____________optune_results/146/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/146/plot_loss_curves.jpg
Prediction distribution: {0: 203873, 1: 58271}
ROC curve saved to .././____________optune_results/146/visualize_predictions.jpg
Prediction distribution: {0: 144032, 1: 118112}
ROC curve saved to .././____________optune_results/146/visualize_predictions.jpg
Prediction distribution: {0: 95890, 1: 166254}
ROC curve saved to .././____________optune_results/146/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/146/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/146/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.3471892894873118, 1: 0.8985887993761323, 2: 158.63079599606667, 3: 1764.2893998878294}
Final class weights used in loss: [3.3577012536595445, 2.017731615726429, 158.63079599606667, 1764.2893998878294, 1.0]

Epoch 1/10
Train Loss: 1.6111
Confusion Matrix:
 [[2131688  589756  996925  238074 1102860]
 [ 358904  210066  349939   81076  486483]
 [   1027    1317     741     581     173]
 [    399     324     549     540    1227]
 [     19      23     459     183     267]]
Class 0 F1: 0.5646
Class 1 F1: 0.1836
Class 2 F1: 0.0011
Class 3 F1: 0.0033
Class 4 F1: 0.0003
Class 0 Precision: 0.8554
Class 1 Precision: 0.2621
Class 2 Precision: 0.0005
Class 3 Precision: 0.0017
Class 4 Precision: 0.0002
Class 0 Recall: 0.4213
Class 1 Recall: 0.1413
Class 2 Recall: 0.1930
Class 3 Recall: 0.1777
Class 4 Recall: 0.2808
Validation Accuracy: 0.3576
Macro F1 Score: 0.1506
xView2 Score: 0.1596
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5092
Confusion Matrix:
 [[4294281  213497  275072   61901  214552]
 [1049640  127570  141146   25015  143097]
 [   1938     271    1600       0      30]
 [   2097      36       1     238     667]
 [    775       0      93       0      83]]
Class 0 F1: 0.8252
Class 1 F1: 0.1396
Class 2 F1: 0.0076
Class 3 F1: 0.0053
Class 4 F1: 0.0005
Class 0 Precision: 0.8029
Class 1 Precision: 0.3737
Class 2 Precision: 0.0038
Class 3 Precision: 0.0027
Class 4 Precision: 0.0002
Class 0 Recall: 0.8488
Class 1 Recall: 0.0858
Class 2 Recall: 0.4168
Class 3 Recall: 0.0783
Class 4 Recall: 0.0873
Validation Accuracy: 0.6750
Macro F1 Score: 0.1956
xView2 Score: 0.1255
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.4161
Confusion Matrix:
 [[4908888   79131   36867    5951   28466]
 [1382009   53677   21854    3507   25421]
 [   3733     106       0       0       0]
 [   2759     129       0       7     144]
 [    785     166       0       0       0]]
Class 0 F1: 0.8644
Class 1 F1: 0.0663
Class 2 F1: 0.0000
Class 3 F1: 0.0011
Class 4 F1: 0.0000
Class 0 Precision: 0.7794
Class 1 Precision: 0.4030
Class 2 Precision: 0.0000
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.9703
Class 1 Recall: 0.0361
Class 2 Recall: 0.0000
Class 3 Recall: 0.0023
Class 4 Recall: 0.0000
Validation Accuracy: 0.7572
Macro F1 Score: 0.1864
xView2 Score: 0.0461
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.3220
Confusion Matrix:
 [[4960687   78600   10628    2311    7077]
 [1407187   61878    7943    1491    7969]
 [   3792      47       0       0       0]
 [   2992      12       0       0      35]
 [    951       0       0       0       0]]
Class 0 F1: 0.8676
Class 1 F1: 0.0761
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7781
Class 1 Precision: 0.4403
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9805
Class 1 Recall: 0.0416
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7664
Macro F1 Score: 0.1887
xView2 Score: 0.0397
Epoch 4 took:  0 hours,  1 minutes,  5 seconds

Epoch 5/10
Train Loss: 1.2392
Confusion Matrix:
 [[5019442   37965     769     189     938]
 [1444599   39585     759      47    1478]
 [   3835       4       0       0       0]
 [   3027      12       0       0       0]
 [    819     132       0       0       0]]
Class 0 F1: 0.8706
Class 1 F1: 0.0506
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7756
Class 1 Precision: 0.5095
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9921
Class 1 Recall: 0.0266
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7719
Macro F1 Score: 0.1842
xView2 Score: 0.0233
Epoch 5 took:  0 hours,  0 minutes, 43 seconds

Epoch 6/10
Train Loss: 1.1677
Confusion Matrix:
 [[5039658   19628      12       0       5]
 [1463576   22734      66       0      92]
 [   3839       0       0       0       0]
 [   3039       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8711
Class 1 F1: 0.0297
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7740
Class 1 Precision: 0.5367
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9961
Class 1 Recall: 0.0153
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7725
Macro F1 Score: 0.1802
xView2 Score: 0.0132
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.0912
Confusion Matrix:
 [[5045231   14072       0       0       0]
 [1469602   16866       0       0       0]
 [   3833       6       0       0       0]
 [   3039       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8712
Class 1 F1: 0.0222
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7735
Class 1 Precision: 0.5450
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9972
Class 1 Recall: 0.0113
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7724
Macro F1 Score: 0.1787
xView2 Score: 0.0098
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0472
Confusion Matrix:
 [[5051342    7961       0       0       0]
 [1475889   10579       0       0       0]
 [   3839       0       0       0       0]
 [   3039       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8713
Class 1 F1: 0.0141
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7730
Class 1 Precision: 0.5706
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9984
Class 1 Recall: 0.0071
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7724
Macro F1 Score: 0.1771
xView2 Score: 0.0062
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9891
Confusion Matrix:
 [[5057902    1401       0       0       0]
 [1483544    2924       0       0       0]
 [   3825      14       0       0       0]
 [   3039       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8714
Class 1 F1: 0.0039
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7723
Class 1 Precision: 0.6739
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9997
Class 1 Recall: 0.0020
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7722
Macro F1 Score: 0.1751
xView2 Score: 0.0017
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9570
Confusion Matrix:
 [[5058368     935       0       0       0]
 [1484687    1781       0       0       0]
 [   3839       0       0       0       0]
 [   3039       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8714
Class 1 F1: 0.0024
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7722
Class 1 Precision: 0.6557
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0012
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7721
Macro F1 Score: 0.1748
xView2 Score: 0.0010
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.3576
Best Macro F1: 0.1506
Best xView2 Score: 0.1596
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8554
Class 1 Precision: 0.2621
Class 2 Precision: 0.0005
Class 3 Precision: 0.0017
Class 4 Precision: 0.0002
Macro Precision: 0.2240
ROC curve saved to .././____________optune_results/147/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/147/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/147/visualize_predictions.jpg
Prediction distribution: {0: 261768, 1: 376}
ROC curve saved to .././____________optune_results/147/visualize_predictions.jpg
Prediction distribution: {0: 262104, 1: 40}
ROC curve saved to .././____________optune_results/147/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/147/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/147/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2770722792013225, 1: 0.7242239883966799, 2: 116.25011086474501, 3: 797.3961977186311, 4: 5292.497160883281}
Final class weights used in loss: [2.67959285438322, 4.159289464516048, 116.25011086474501, 797.3961977186311, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5195
Confusion Matrix:
 [[3597043 1309264   79539   23519    5520]
 [1177992  339319   11689    7458    1760]
 [    204       0       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7348
Class 1 F1: 0.2130
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.2058
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7173
Class 1 Recall: 0.2206
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6006
Macro F1 Score: 0.1896
xView2 Score: 0.1158
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.4570
Confusion Matrix:
 [[4462283  542510    7898    1855     339]
 [1252078  284705     595     746      94]
 [      3     201       0       0       0]
 [     53     240       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8318
Class 1 F1: 0.2407
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7809
Class 1 Precision: 0.3440
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8898
Class 1 Recall: 0.1851
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7243
Macro F1 Score: 0.2145
xView2 Score: 0.1160
Epoch 2 took:  0 hours,  0 minutes, 55 seconds

Epoch 3/10
Train Loss: 1.3970
Confusion Matrix:
 [[4713354  300940     546      45       0]
 [1315619  222535       0      62       2]
 [    204       0       0       0       0]
 [    293       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8535
Class 1 F1: 0.2159
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7817
Class 1 Precision: 0.4251
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9399
Class 1 Recall: 0.1447
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2139
xView2 Score: 0.1001
Epoch 3 took:  0 hours,  0 minutes, 28 seconds

Epoch 4/10
Train Loss: 1.3314
Confusion Matrix:
 [[4540382  474479      22       2       0]
 [1084808  453410       0       0       0]
 [    185      19       0       0       0]
 [    262      31       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8534
Class 1 F1: 0.3677
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8071
Class 1 Precision: 0.4886
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9054
Class 1 Recall: 0.2948
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7620
Macro F1 Score: 0.3053
xView2 Score: 0.1900
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2694
Confusion Matrix:
 [[4520808  494077       0       0       0]
 [1035973  502245       0       0       0]
 [     27     177       0       0       0]
 [      9     284       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8553
Class 1 F1: 0.3962
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8136
Class 1 Precision: 0.5039
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9015
Class 1 Recall: 0.3265
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7665
Macro F1 Score: 0.3129
xView2 Score: 0.2051
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2119
Confusion Matrix:
 [[4241936  772949       0       0       0]
 [ 781330  756888       0       0       0]
 [      0     204       0       0       0]
 [      0     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8452
Class 1 F1: 0.4933
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8445
Class 1 Precision: 0.4946
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8459
Class 1 Recall: 0.4921
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7628
Macro F1 Score: 0.3346
xView2 Score: 0.2635
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1626
Confusion Matrix:
 [[4148738  866147       0       0       0]
 [ 707043  831175       0       0       0]
 [     11     193       0       0       0]
 [      0     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8406
Class 1 F1: 0.5137
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8544
Class 1 Precision: 0.4896
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8273
Class 1 Recall: 0.5403
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7599
Macro F1 Score: 0.3386
xView2 Score: 0.2769
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1085
Confusion Matrix:
 [[4143465  871420       0       0       0]
 [ 690144  848074       0       0       0]
 [     27     177       0       0       0]
 [     75     218       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8414
Class 1 F1: 0.5206
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8572
Class 1 Precision: 0.4931
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8262
Class 1 Recall: 0.5513
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7616
Macro F1 Score: 0.3405
xView2 Score: 0.2806
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.0792
Confusion Matrix:
 [[4119058  895827       0       0       0]
 [ 641735  896483       0       0       0]
 [      0     204       0       0       0]
 [      0     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8427
Class 1 F1: 0.5383
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8652
Class 1 Precision: 0.5000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8214
Class 1 Recall: 0.5828
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7653
Macro F1 Score: 0.3452
xView2 Score: 0.2904
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0646
Confusion Matrix:
 [[4127195  887690       0       0       0]
 [ 632732  905486       0       0       0]
 [      0     204       0       0       0]
 [      0     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8445
Class 1 F1: 0.5435
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8671
Class 1 Precision: 0.5048
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8230
Class 1 Recall: 0.5887
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7679
Macro F1 Score: 0.3470
xView2 Score: 0.2928
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7679
Best Macro F1: 0.3470
Best xView2 Score: 0.2928
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8671
Class 1 Precision: 0.5048
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3430
ROC curve saved to .././____________optune_results/148/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/148/plot_loss_curves.jpg
Prediction distribution: {0: 230690, 1: 31454}
ROC curve saved to .././____________optune_results/148/visualize_predictions.jpg
Prediction distribution: {0: 209634, 1: 52510}
ROC curve saved to .././____________optune_results/148/visualize_predictions.jpg
Prediction distribution: {0: 248207, 1: 13937}
ROC curve saved to .././____________optune_results/148/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/148/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/148/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27671979736395225, 1: 0.7253826617746375, 2: 162.54367188761506, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.676183968386253, 2.524736470107672, 162.54367188761506, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5161
Confusion Matrix:
 [[3812412   96500   10373 1067193    5268]
 [1018829   59380    5475  463126    2509]
 [   7784     422       3    4326       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7756
Class 1 F1: 0.0696
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7878
Class 1 Precision: 0.3799
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7637
Class 1 Recall: 0.0383
Class 2 Recall: 0.0002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5908
Macro F1 Score: 0.1691
xView2 Score: 0.1084
Epoch 1 took:  0 hours,  1 minutes,  1 seconds

Epoch 2/10
Train Loss: 1.4435
Confusion Matrix:
 [[4777028  100110    1723  112636     249]
 [1416215   64383    1103   67512     106]
 [  10679     698       0    1158       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8534
Class 1 F1: 0.0751
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7700
Class 1 Precision: 0.3897
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9570
Class 1 Recall: 0.0416
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7387
Macro F1 Score: 0.1857
xView2 Score: 0.0535
Epoch 2 took:  0 hours,  0 minutes, 39 seconds

Epoch 3/10
Train Loss: 1.3794
Confusion Matrix:
 [[4947169   38281      69    6217      10]
 [1509490   33451       5    6373       0]
 [  12381     149       0       5       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8633
Class 1 F1: 0.0413
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7647
Class 1 Precision: 0.4654
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9911
Class 1 Recall: 0.0216
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7600
Macro F1 Score: 0.1809
xView2 Score: 0.0220
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3071
Confusion Matrix:
 [[4891487   99619       1     639       0]
 [1460996   88067       0     254       2]
 [  11903     632       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8615
Class 1 F1: 0.1014
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7686
Class 1 Precision: 0.4677
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9799
Class 1 Recall: 0.0568
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7598
Macro F1 Score: 0.1926
xView2 Score: 0.0455
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2374
Confusion Matrix:
 [[4817326  174377       0      43       0]
 [1382479  166788       0      52       0]
 [  11004    1531       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8600
Class 1 F1: 0.1763
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7756
Class 1 Precision: 0.4867
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9651
Class 1 Recall: 0.1077
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7605
Macro F1 Score: 0.2591
xView2 Score: 0.0870
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1825
Confusion Matrix:
 [[4728676  263070       0       0       0]
 [1293555  255764       0       0       0]
 [  10471    2064       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8579
Class 1 F1: 0.2471
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7838
Class 1 Precision: 0.4910
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9473
Class 1 Recall: 0.1651
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7606
Macro F1 Score: 0.3683
xView2 Score: 0.1403
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1310
Confusion Matrix:
 [[4718931  272815       0       0       0]
 [1273877  275442       0       0       0]
 [  10408    2127       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8584
Class 1 F1: 0.2624
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7861
Class 1 Precision: 0.5005
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9453
Class 1 Recall: 0.1778
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7621
Macro F1 Score: 0.3736
xView2 Score: 0.1492
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0884
Confusion Matrix:
 [[4611389  380357       0       0       0]
 [1179250  370069       0       0       0]
 [   9878    2657       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8546
Class 1 F1: 0.3215
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7950
Class 1 Precision: 0.4914
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9238
Class 1 Recall: 0.2389
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7601
Macro F1 Score: 0.3920
xView2 Score: 0.1865
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0653
Confusion Matrix:
 [[4619753  371993       0       0       0]
 [1194157  355162       0       0       0]
 [  11037    1498       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8542
Class 1 F1: 0.3118
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7931
Class 1 Precision: 0.4874
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9255
Class 1 Recall: 0.2292
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7591
Macro F1 Score: 0.3887
xView2 Score: 0.1804
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0033
Confusion Matrix:
 [[4494986  496760       0       0       0]
 [1065764  483555       0       0       0]
 [  10224    2311       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8511
Class 1 F1: 0.3820
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8069
Class 1 Precision: 0.4921
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9005
Class 1 Recall: 0.3121
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7597
Macro F1 Score: 0.4110
xView2 Score: 0.2254
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7597
Best Macro F1: 0.4110
Best xView2 Score: 0.2254
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8069
Class 1 Precision: 0.4921
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4330
ROC curve saved to .././____________optune_results/149/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/149/plot_loss_curves.jpg
Prediction distribution: {0: 153467, 1: 108677}
ROC curve saved to .././____________optune_results/149/visualize_predictions.jpg
Prediction distribution: {0: 259639, 1: 2505}
ROC curve saved to .././____________optune_results/149/visualize_predictions.jpg
Prediction distribution: {0: 137830, 1: 124314}
ROC curve saved to .././____________optune_results/149/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/149/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/149/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27485678480843717, 1: 0.7392520124974002, 2: 131.72031090523672, 3: 805.0487523992323, 4: 5292.497160883281}
Final class weights used in loss: [2.6581665934768086, 6.892447099508459, 131.72031090523672, 805.0487523992323, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5946
Confusion Matrix:
 [[ 392415 3936245  198341  219687  121773]
 [  12104 1581340   37985   28980   19088]
 [      0    4585     327      53     324]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1488
Class 1 F1: 0.4391
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9701
Class 1 Precision: 0.2863
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0806
Class 1 Recall: 0.9416
Class 2 Recall: 0.0618
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3012
Macro F1 Score: 0.1181
xView2 Score: 0.2658
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5241
Confusion Matrix:
 [[1129611 3654248   45212   30444    8946]
 [  28508 1639143    5856    4213    1777]
 [    187    5045      16       6      35]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3749
Class 1 F1: 0.4698
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9752
Class 1 Precision: 0.3093
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2320
Class 1 Recall: 0.9760
Class 2 Recall: 0.0030
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4225
Macro F1 Score: 0.1690
xView2 Score: 0.2788
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4671
Confusion Matrix:
 [[1470039 3390114    5032    2907     369]
 [  48134 1630529     462     298      74]
 [    174    5092      23       0       0]
 [      4     349       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4603
Class 1 F1: 0.4863
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9682
Class 1 Precision: 0.3244
Class 2 Precision: 0.0042
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3020
Class 1 Recall: 0.9708
Class 2 Recall: 0.0043
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4731
Macro F1 Score: 0.1902
xView2 Score: 0.2850
Epoch 3 took:  0 hours,  0 minutes, 58 seconds

Epoch 4/10
Train Loss: 1.3930
Confusion Matrix:
 [[1739462 3128208     514     238      39]
 [  44122 1635351      14       3       7]
 [    450    4839       0       0       0]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5230
Class 1 F1: 0.5072
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9750
Class 1 Precision: 0.3429
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3573
Class 1 Recall: 0.9737
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5150
Macro F1 Score: 0.2060
xView2 Score: 0.2904
Epoch 4 took:  0 hours,  0 minutes, 34 seconds

Epoch 5/10
Train Loss: 1.3213
Confusion Matrix:
 [[2061778 2806621      52       3       7]
 [  89116 1590377       0       0       4]
 [    894    4395       0       0       0]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5874
Class 1 F1: 0.5230
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9582
Class 1 Precision: 0.3613
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4235
Class 1 Recall: 0.9469
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5573
Macro F1 Score: 0.2221
xView2 Score: 0.2932
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2516
Confusion Matrix:
 [[2315058 2553402       1       0       0]
 [ 153058 1526439       0       0       0]
 [   1626    3663       0       0       0]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6310
Class 1 F1: 0.5297
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9374
Class 1 Precision: 0.3738
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4755
Class 1 Recall: 0.9089
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5862
Macro F1 Score: 0.2902
xView2 Score: 0.3256
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1853
Confusion Matrix:
 [[2597215 2271246       0       0       0]
 [ 172451 1507046       0       0       0]
 [   1177    4112       0       0       0]
 [     47     306       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6800
Class 1 F1: 0.5518
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9373
Class 1 Precision: 0.3984
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5335
Class 1 Recall: 0.8973
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6263
Macro F1 Score: 0.3079
xView2 Score: 0.3312
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1234
Confusion Matrix:
 [[2704461 2164000       0       0       0]
 [ 174715 1504782       0       0       0]
 [     86    5203       0       0       0]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6981
Class 1 F1: 0.5621
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9393
Class 1 Precision: 0.4095
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5555
Class 1 Recall: 0.8960
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6423
Macro F1 Score: 0.3151
xView2 Score: 0.3342
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0675
Confusion Matrix:
 [[2591014 2277447       0       0       0]
 [ 185041 1494456       0       0       0]
 [   1466    3823       0       0       0]
 [      0     353       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6777
Class 1 F1: 0.5479
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9329
Class 1 Precision: 0.3958
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5322
Class 1 Recall: 0.8898
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6234
Macro F1 Score: 0.3064
xView2 Score: 0.3292
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0347
Confusion Matrix:
 [[2731747 2136714       0       0       0]
 [ 225768 1453729       0       0       0]
 [   1314    3975       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6980
Class 1 F1: 0.5513
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9231
Class 1 Precision: 0.4044
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5611
Class 1 Recall: 0.8656
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6387
Macro F1 Score: 0.3123
xView2 Score: 0.3278
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6423
Best Macro F1: 0.3151
Best xView2 Score: 0.3342
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9393
Class 1 Precision: 0.4095
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3372
ROC curve saved to .././____________optune_results/150/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/150/plot_loss_curves.jpg
Prediction distribution: {0: 26378, 1: 235766}
ROC curve saved to .././____________optune_results/150/visualize_predictions.jpg
Prediction distribution: {0: 36462, 1: 225682}
ROC curve saved to .././____________optune_results/150/visualize_predictions.jpg
Prediction distribution: {0: 122096, 1: 140048}
ROC curve saved to .././____________optune_results/150/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/150/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/150/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2735183607521123, 1: 0.7481375285336078, 2: 167.42057678874363, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [2.645222564764153, 12.670322792087207, 167.42057678874363, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6181
Confusion Matrix:
 [[1365809  384240 1809983     395 1218427]
 [ 310539  236903  906397      15  306506]
 [   3068    1623    6952      17    1777]
 [    123       9     653       0     164]
 [      0       0       0       0       0]]
Class 0 F1: 0.4230
Class 1 F1: 0.1988
Class 2 F1: 0.0051
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8132
Class 1 Precision: 0.3804
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2858
Class 1 Recall: 0.1346
Class 2 Recall: 0.5174
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2456
Macro F1 Score: 0.1254
xView2 Score: 0.1671
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5312
Confusion Matrix:
 [[2097009 1726583  518638       5  436619]
 [ 357917 1113674  188524       5  100240]
 [   3161    7543    1639       0    1094]
 [    152     563     190       0      44]
 [      0       0       0       0       0]]
Class 0 F1: 0.5795
Class 1 F1: 0.4833
Class 2 F1: 0.0045
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8531
Class 1 Precision: 0.3910
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4388
Class 1 Recall: 0.6326
Class 2 Recall: 0.1220
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4902
Macro F1 Score: 0.2135
xView2 Score: 0.2549
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4485
Confusion Matrix:
 [[2104266 2509957   77349       0   87282]
 [ 253738 1473919   15251       0   17452]
 [   1986   11141     236       0      74]
 [    129     820       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5895
Class 1 F1: 0.5121
Class 2 F1: 0.0044
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8916
Class 1 Precision: 0.3689
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4403
Class 1 Recall: 0.8373
Class 2 Recall: 0.0176
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5460
Macro F1 Score: 0.2212
xView2 Score: 0.2821
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.3598
Confusion Matrix:
 [[2036155 2722992   11393       0    8314]
 [ 152539 1605697     630       0    1494]
 [    961   12463       0       0      13]
 [      0     949       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5844
Class 1 F1: 0.5262
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9299
Class 1 Precision: 0.3698
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4261
Class 1 Recall: 0.9121
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5557
Macro F1 Score: 0.2221
xView2 Score: 0.2915
Epoch 4 took:  0 hours,  1 minutes, 13 seconds

Epoch 5/10
Train Loss: 1.2578
Confusion Matrix:
 [[1977859 2799176     878       0     941]
 [  95874 1664290      65       0     131]
 [   1188   12249       0       0       0]
 [      0     949       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5772
Class 1 F1: 0.5337
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9532
Class 1 Precision: 0.3718
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4139
Class 1 Recall: 0.9454
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5557
Macro F1 Score: 0.2222
xView2 Score: 0.2965
Epoch 5 took:  0 hours,  0 minutes, 51 seconds

Epoch 6/10
Train Loss: 1.1721
Confusion Matrix:
 [[2071599 2707101      46       0     108]
 [ 133817 1626538       3       0       2]
 [   1708   11729       0       0       0]
 [     43     906       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5931
Class 1 F1: 0.5327
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9386
Class 1 Precision: 0.3742
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4335
Class 1 Recall: 0.9240
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5643
Macro F1 Score: 0.2252
xView2 Score: 0.2946
Epoch 6 took:  0 hours,  0 minutes, 31 seconds

Epoch 7/10
Train Loss: 1.0996
Confusion Matrix:
 [[2149524 2629326       2       0       2]
 [ 127488 1632867       0       0       5]
 [    937   12500       0       0       0]
 [     30     919       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6092
Class 1 F1: 0.5410
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9436
Class 1 Precision: 0.3819
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4498
Class 1 Recall: 0.9276
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5771
Macro F1 Score: 0.2300
xView2 Score: 0.2975
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0319
Confusion Matrix:
 [[2160274 2618580       0       0       0]
 [ 136226 1624133       0       0       1]
 [   1884   11553       0       0       0]
 [     18     931       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6105
Class 1 F1: 0.5400
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9399
Class 1 Precision: 0.3817
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4520
Class 1 Recall: 0.9226
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5775
Macro F1 Score: 0.2301
xView2 Score: 0.2967
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9783
Confusion Matrix:
 [[2194344 2584510       0       0       0]
 [ 100244 1660116       0       0       0]
 [   1315   12122       0       0       0]
 [      0     949       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6203
Class 1 F1: 0.5517
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9558
Class 1 Precision: 0.3899
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4592
Class 1 Recall: 0.9431
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5881
Macro F1 Score: 0.2930
xView2 Score: 0.3356
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9523
Confusion Matrix:
 [[2281559 2497295       0       0       0]
 [ 100596 1659764       0       0       0]
 [   1087   12350       0       0       0]
 [      0     949       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6371
Class 1 F1: 0.5597
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9573
Class 1 Precision: 0.3980
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4774
Class 1 Recall: 0.9429
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6014
Macro F1 Score: 0.2992
xView2 Score: 0.3380
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6014
Best Macro F1: 0.2992
Best xView2 Score: 0.3380
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9573
Class 1 Precision: 0.3980
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3388
ROC curve saved to .././____________optune_results/151/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/151/plot_loss_curves.jpg
Prediction distribution: {0: 91623, 1: 170521}
ROC curve saved to .././____________optune_results/151/visualize_predictions.jpg
Prediction distribution: {0: 76845, 1: 185299}
ROC curve saved to .././____________optune_results/151/visualize_predictions.jpg
Prediction distribution: {0: 227060, 1: 35084}
ROC curve saved to .././____________optune_results/151/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/151/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/151/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2753288233691322, 1: 0.7356231955313925, 2: 139.09149394793567, 3: 827.0070325336839, 4: 5292.497160883281}
Final class weights used in loss: [2.6627317241274744, 3.1981913228557186, 139.09149394793567, 827.0070325336839, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6344
Confusion Matrix:
 [[1693349   28982 2236683  258054  682788]
 [ 810678   18045  597786   35532  183870]
 [   2284     207    4177     241     405]
 [      9       0     510       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4573
Class 1 F1: 0.0213
Class 2 F1: 0.0029
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6756
Class 1 Precision: 0.3820
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3456
Class 1 Recall: 0.0110
Class 2 Recall: 0.5711
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2618
Macro F1 Score: 0.0963
xView2 Score: 0.0934
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5487
Confusion Matrix:
 [[4124227   22865  567082   26016  159666]
 [1362846   20037  204752    5975   52301]
 [   6175     167     563       8     401]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7936
Class 1 F1: 0.0237
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7507
Class 1 Precision: 0.4652
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8417
Class 1 Recall: 0.0122
Class 2 Recall: 0.0770
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6325
Macro F1 Score: 0.1638
xView2 Score: 0.0669
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4791
Confusion Matrix:
 [[4817277   20181   47446    1778   13174]
 [1590141   23304   25814     480    6172]
 [   7205      37       2       0      70]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8515
Class 1 F1: 0.0276
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7509
Class 1 Precision: 0.5355
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9831
Class 1 Recall: 0.0142
Class 2 Recall: 0.0003
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7386
Macro F1 Score: 0.1758
xView2 Score: 0.0226
Epoch 3 took:  0 hours,  1 minutes, 18 seconds

Epoch 4/10
Train Loss: 1.4043
Confusion Matrix:
 [[4840739   55667    2741      98     611]
 [1570270   72211    3052      28     350]
 [   7185     118      11       0       0]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8554
Class 1 F1: 0.0814
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7542
Class 1 Precision: 0.5642
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9879
Class 1 Recall: 0.0439
Class 2 Recall: 0.0015
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7497
Macro F1 Score: 0.1877
xView2 Score: 0.0375
Epoch 4 took:  0 hours,  0 minutes, 47 seconds

Epoch 5/10
Train Loss: 1.3286
Confusion Matrix:
 [[4791354  108338     114       0      50]
 [1512462  133294     144       1      10]
 [   7013     301       0       0       0]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8547
Class 1 F1: 0.1412
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7592
Class 1 Precision: 0.5510
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9779
Class 1 Recall: 0.0810
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7514
Macro F1 Score: 0.1992
xView2 Score: 0.0633
Epoch 5 took:  0 hours,  0 minutes, 30 seconds

Epoch 6/10
Train Loss: 1.2577
Confusion Matrix:
 [[4740391  159465       0       0       0]
 [1441730  204179       1       1       0]
 [   7298      16       0       0       0]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8549
Class 1 F1: 0.2032
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7658
Class 1 Precision: 0.5615
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9675
Class 1 Recall: 0.1241
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7545
Macro F1 Score: 0.2645
xView2 Score: 0.0994
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2099
Confusion Matrix:
 [[4722868  176988       0       0       0]
 [1417450  228461       0       0       0]
 [   6546     768       0       0       0]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8550
Class 1 F1: 0.2227
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7683
Class 1 Precision: 0.5624
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9639
Class 1 Recall: 0.1388
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7555
Macro F1 Score: 0.2694
xView2 Score: 0.1094
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1491
Confusion Matrix:
 [[4462469  437387       0       0       0]
 [1166857  479054       0       0       0]
 [   5934    1380       0       0       0]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8471
Class 1 F1: 0.3737
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7918
Class 1 Precision: 0.5219
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9107
Class 1 Recall: 0.2911
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7540
Macro F1 Score: 0.3052
xView2 Score: 0.1909
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1077
Confusion Matrix:
 [[4225438  674418       0       0       0]
 [ 958897  687014       0       0       0]
 [   5302    2012       0       0       0]
 [    519       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8375
Class 1 F1: 0.4566
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8141
Class 1 Precision: 0.5039
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8624
Class 1 Recall: 0.4174
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7496
Macro F1 Score: 0.3235
xView2 Score: 0.2400
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0797
Confusion Matrix:
 [[4335783  564073       0       0       0]
 [1018379  627532       0       0       0]
 [   5466    1848       0       0       0]
 [     37     482       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8452
Class 1 F1: 0.4419
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8090
Class 1 Precision: 0.5256
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8849
Class 1 Recall: 0.3813
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7573
Macro F1 Score: 0.3218
xView2 Score: 0.2292
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7496
Best Macro F1: 0.3235
Best xView2 Score: 0.2400
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8141
Class 1 Precision: 0.5039
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3295
ROC curve saved to .././____________optune_results/152/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/152/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/152/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/152/visualize_predictions.jpg
Prediction distribution: {0: 157434, 1: 104710}
ROC curve saved to .././____________optune_results/152/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/152/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/152/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27587949399448697, 1: 0.7319976788594416, 2: 131.40393180690808, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.6680573130931866, 0.7545414313595138, 131.40393180690808, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5684
Confusion Matrix:
 [[3645642  121085    6553  972421  190644]
 [ 973445   78993    3963  454889  100733]
 [   4082     148       0     908      59]
 [      0       0       0      35       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7627
Class 1 F1: 0.0872
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7886
Class 1 Precision: 0.3945
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7385
Class 1 Recall: 0.0490
Class 2 Recall: 0.0000
Class 3 Recall: 1.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5683
Macro F1 Score: 0.1700
xView2 Score: 0.1213
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4768
Confusion Matrix:
 [[4587668   35066    2241  279021   32349]
 [1417775   25830    1623  145433   21362]
 [   3421       3      65    1588     120]
 [     12       0       0      23       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8383
Class 1 F1: 0.0309
Class 2 F1: 0.0142
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7635
Class 1 Precision: 0.4241
Class 2 Precision: 0.0165
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.9294
Class 1 Recall: 0.0160
Class 2 Recall: 0.0125
Class 3 Recall: 0.6571
Class 4 Recall: 0.0000
Validation Accuracy: 0.7040
Macro F1 Score: 0.1767
xView2 Score: 0.0615
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.3855
Confusion Matrix:
 [[4888857    4733     297   40138    2320]
 [1580874    3822     351   25098    1878]
 [   3994       0       0    1203       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8569
Class 1 F1: 0.0047
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7552
Class 1 Precision: 0.4468
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9904
Class 1 Recall: 0.0024
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7466
Macro F1 Score: 0.1723
xView2 Score: 0.0121
Epoch 3 took:  0 hours,  1 minutes, 16 seconds

Epoch 4/10
Train Loss: 1.3009
Confusion Matrix:
 [[4933116     406       1    2664     158]
 [1609918     392      11    1577     125]
 [   4980       0       0     217       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8591
Class 1 F1: 0.0005
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7534
Class 1 Precision: 0.4912
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9993
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7528
Macro F1 Score: 0.1719
xView2 Score: 0.0009
Epoch 4 took:  0 hours,  0 minutes, 43 seconds

Epoch 5/10
Train Loss: 1.2111
Confusion Matrix:
 [[4936306       9       0      30       0]
 [1611959       7       0      49       8]
 [   5197       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.4375
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.1719
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.1225
Confusion Matrix:
 [[4936345       0       0       0       0]
 [1612023       0       0       0       0]
 [   5197       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0565
Confusion Matrix:
 [[4936345       0       0       0       0]
 [1612023       0       0       0       0]
 [   5197       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0101
Confusion Matrix:
 [[4936345       0       0       0       0]
 [1612023       0       0       0       0]
 [   5197       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9519
Confusion Matrix:
 [[4936345       0       0       0       0]
 [1612023       0       0       0       0]
 [   5197       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9138
Confusion Matrix:
 [[4936345       0       0       0       0]
 [1612023       0       0       0       0]
 [   5197       0       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8592
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7532
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7532
Macro F1 Score: 0.2148
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5683
Best Macro F1: 0.1700
Best xView2 Score: 0.1213
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7886
Class 1 Precision: 0.3945
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2366
ROC curve saved to .././____________optune_results/153/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/153/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/153/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/153/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/153/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/153/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/153/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2733896853606654, 1: 0.7483262899099242, 2: 201.109393854637, 3: 1350.0978540772533, 4: 5292.497160883281}
Final class weights used in loss: [2.643978132587647, 8.614482166388603, 201.109393854637, 1350.0978540772533, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5274
Confusion Matrix:
 [[1916227 2652545   96425   27451   77545]
 [ 345658 1337473   40567    2413   35946]
 [   1686   15802     462       0     523]
 [   1084    1705      88       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5448
Class 1 F1: 0.4636
Class 2 F1: 0.0059
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8461
Class 1 Precision: 0.3337
Class 2 Precision: 0.0034
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4017
Class 1 Recall: 0.7590
Class 2 Recall: 0.0250
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4965
Macro F1 Score: 0.2029
xView2 Score: 0.2641
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4485
Confusion Matrix:
 [[1975152 2784744    6613     860    2824]
 [ 201643 1558501     591      32    1290]
 [   2021   16452       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5685
Class 1 F1: 0.5089
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9065
Class 1 Precision: 0.3572
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4141
Class 1 Recall: 0.8845
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5392
Macro F1 Score: 0.2155
xView2 Score: 0.2846
Epoch 2 took:  0 hours,  1 minutes, 18 seconds

Epoch 3/10
Train Loss: 1.3896
Confusion Matrix:
 [[2122770 2646635     782       1       5]
 [ 166412 1595521     115       0       9]
 [   2713   15760       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6012
Class 1 F1: 0.5298
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9262
Class 1 Precision: 0.3745
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4450
Class 1 Recall: 0.9055
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5674
Macro F1 Score: 0.2262
xView2 Score: 0.2925
Epoch 3 took:  0 hours,  0 minutes, 42 seconds

Epoch 4/10
Train Loss: 1.3083
Confusion Matrix:
 [[1960840 2809335      10       8       0]
 [  72832 1689225       0       0       0]
 [   1106   17367       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5763
Class 1 F1: 0.5379
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9637
Class 1 Precision: 0.3738
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4111
Class 1 Recall: 0.9587
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5570
Macro F1 Score: 0.2785
xView2 Score: 0.3331
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.2318
Confusion Matrix:
 [[2078058 2692135       0       0       0]
 [  84189 1677868       0       0       0]
 [   2129   16344       0       0       0]
 [     19    2858       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5993
Class 1 F1: 0.5455
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9601
Class 1 Precision: 0.3823
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4356
Class 1 Recall: 0.9522
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5731
Macro F1 Score: 0.2862
xView2 Score: 0.3347
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1586
Confusion Matrix:
 [[2183035 2587158       0       0       0]
 [  81553 1680504       0       0       0]
 [   4067   14406       0       0       0]
 [      6    2871       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6203
Class 1 F1: 0.5558
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9623
Class 1 Precision: 0.3922
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4576
Class 1 Recall: 0.9537
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5895
Macro F1 Score: 0.2940
xView2 Score: 0.3379
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0857
Confusion Matrix:
 [[2254745 2515448       0       0       0]
 [  98969 1663088       0       0       0]
 [   2270   16203       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6328
Class 1 F1: 0.5581
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9570
Class 1 Precision: 0.3962
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4727
Class 1 Recall: 0.9438
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5978
Macro F1 Score: 0.2977
xView2 Score: 0.3378
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0497
Confusion Matrix:
 [[2353490 2416703       0       0       0]
 [ 123190 1638867       0       0       0]
 [   3987   14486       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6492
Class 1 F1: 0.5617
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9487
Class 1 Precision: 0.4024
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4934
Class 1 Recall: 0.9301
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6092
Macro F1 Score: 0.3027
xView2 Score: 0.3375
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0141
Confusion Matrix:
 [[2471856 2298337       0       0       0]
 [ 157068 1604989       0       0       0]
 [   6110   12363       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6676
Class 1 F1: 0.5651
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9381
Class 1 Precision: 0.4096
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5182
Class 1 Recall: 0.9109
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6221
Macro F1 Score: 0.3082
xView2 Score: 0.3366
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9823
Confusion Matrix:
 [[2438876 2331317       0       0       0]
 [ 133084 1628973       0       0       0]
 [   4612   13861       0       0       0]
 [      0    2877       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6639
Class 1 F1: 0.5677
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9466
Class 1 Precision: 0.4096
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5113
Class 1 Recall: 0.9245
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6207
Macro F1 Score: 0.3079
xView2 Score: 0.3387
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6207
Best Macro F1: 0.3079
Best xView2 Score: 0.3387
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9466
Class 1 Precision: 0.4096
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3390
ROC curve saved to .././____________optune_results/154/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/154/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/154/visualize_predictions.jpg
Prediction distribution: {0: 83050, 1: 179094}
ROC curve saved to .././____________optune_results/154/visualize_predictions.jpg
Prediction distribution: {0: 139067, 1: 123077}
ROC curve saved to .././____________optune_results/154/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/154/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/154/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2738880484839435, 1: 0.7462487217591619, 2: 135.02065080344448, 3: 805.0487523992323, 4: 5292.497160883281}
Final class weights used in loss: [2.648797850633326, 2.883913591529406, 135.02065080344448, 805.0487523992323, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6192
Confusion Matrix:
 [[1502153 1105692  582129 1576782   36936]
 [ 225404  650178  252356  602958   12436]
 [   2478    2126     390    1225       4]
 [      0     157       0     196       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4598
Class 1 F1: 0.3714
Class 2 F1: 0.0009
Class 3 F1: 0.0002
Class 4 F1: 0.0000
Class 0 Precision: 0.8683
Class 1 Precision: 0.3698
Class 2 Precision: 0.0005
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.3127
Class 1 Recall: 0.3730
Class 2 Recall: 0.0627
Class 3 Recall: 0.5552
Class 4 Recall: 0.0000
Validation Accuracy: 0.3285
Macro F1 Score: 0.1665
xView2 Score: 0.2154
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5440
Confusion Matrix:
 [[2652042 1268404  119983  753004   10259]
 [ 544471  834981   69898  287934    6048]
 [   2970    2525      86     642       0]
 [    339       0       0      14       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6627
Class 1 F1: 0.4338
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8288
Class 1 Precision: 0.3965
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5521
Class 1 Recall: 0.4790
Class 2 Recall: 0.0138
Class 3 Recall: 0.0397
Class 4 Recall: 0.0000
Validation Accuracy: 0.5321
Macro F1 Score: 0.2195
xView2 Score: 0.2322
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4725
Confusion Matrix:
 [[3638571  946826   20288  197075     932]
 [ 971448  684295   12959   73539    1091]
 [   4685    1529       0       4       5]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7726
Class 1 F1: 0.4054
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7884
Class 1 Precision: 0.4191
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7575
Class 1 Recall: 0.3925
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6596
Macro F1 Score: 0.2356
xView2 Score: 0.2047
Epoch 3 took:  0 hours,  1 minutes,  1 seconds

Epoch 4/10
Train Loss: 1.3963
Confusion Matrix:
 [[3594189 1172897    2393   34210       3]
 [ 892732  836023    1784   12763      30]
 [   4580    1643       0       0       0]
 [    326      21       0       6       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7733
Class 1 F1: 0.4454
Class 2 F1: 0.0000
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.8002
Class 1 Precision: 0.4158
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.7482
Class 1 Recall: 0.4796
Class 2 Recall: 0.0000
Class 3 Recall: 0.0170
Class 4 Recall: 0.0000
Validation Accuracy: 0.6760
Macro F1 Score: 0.2438
xView2 Score: 0.2250
Epoch 4 took:  0 hours,  0 minutes, 35 seconds

Epoch 5/10
Train Loss: 1.3178
Confusion Matrix:
 [[3610664 1186915     344    5769       0]
 [ 804300  937387     252    1393       0]
 [   4042    2181       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7830
Class 1 F1: 0.4845
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8170
Class 1 Precision: 0.4408
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7516
Class 1 Recall: 0.5377
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6940
Macro F1 Score: 0.3169
xView2 Score: 0.2677
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2573
Confusion Matrix:
 [[3668242 1134327      15    1108       0]
 [ 835751  907422      41     118       0]
 [   5105    1118       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7878
Class 1 F1: 0.4793
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8135
Class 1 Precision: 0.4442
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7636
Class 1 Recall: 0.5205
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6982
Macro F1 Score: 0.3168
xView2 Score: 0.2635
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1931
Confusion Matrix:
 [[3633890 1169608       0     194       0]
 [ 748281  995031       7      13       0]
 [   2963    3260       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7909
Class 1 F1: 0.5088
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8286
Class 1 Precision: 0.4590
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7565
Class 1 Recall: 0.5708
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7063
Macro F1 Score: 0.3249
xView2 Score: 0.2799
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1386
Confusion Matrix:
 [[3607724 1195968       0       0       0]
 [ 832499  910833       0       0       0]
 [   5078    1145       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7801
Class 1 F1: 0.4730
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8115
Class 1 Precision: 0.4321
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7510
Class 1 Recall: 0.5225
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6895
Macro F1 Score: 0.3133
xView2 Score: 0.2619
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0921
Confusion Matrix:
 [[3559093 1244599       0       0       0]
 [ 717309 1026023       0       0       0]
 [   4812    1411       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7835
Class 1 F1: 0.5110
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8313
Class 1 Precision: 0.4516
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7409
Class 1 Recall: 0.5885
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6996
Macro F1 Score: 0.3236
xView2 Score: 0.2829
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0626
Confusion Matrix:
 [[3560259 1243433       0       0       0]
 [ 806590  936742       0       0       0]
 [   4962    1261       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7760
Class 1 F1: 0.4773
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8143
Class 1 Precision: 0.4294
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7412
Class 1 Recall: 0.5373
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6862
Macro F1 Score: 0.3133
xView2 Score: 0.2654
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6996
Best Macro F1: 0.3236
Best xView2 Score: 0.2829
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8313
Class 1 Precision: 0.4516
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3207
ROC curve saved to .././____________optune_results/155/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/155/plot_loss_curves.jpg
Prediction distribution: {0: 221859, 1: 40285}
ROC curve saved to .././____________optune_results/155/visualize_predictions.jpg
Prediction distribution: {0: 251782, 1: 10362}
ROC curve saved to .././____________optune_results/155/visualize_predictions.jpg
Prediction distribution: {0: 261106, 1: 1038}
ROC curve saved to .././____________optune_results/155/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/155/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/155/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2704912762567598, 1: 0.7698608651680185, 2: 312.9493751165827, 3: 1423.0039016115352, 4: 5292.497160883281}
Final class weights used in loss: [2.6159473373515003, 12.403295107293296, 312.9493751165827, 1423.0039016115352, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5878
Confusion Matrix:
 [[ 612823 2898752  361296  124812  575238]
 [ 141986 1327861  222559   34333  223455]
 [   1371   21253    2409     172    2212]
 [      0    2995      73       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.2300
Class 1 F1: 0.4283
Class 2 F1: 0.0079
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8104
Class 1 Precision: 0.3124
Class 2 Precision: 0.0041
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1340
Class 1 Recall: 0.6809
Class 2 Recall: 0.0879
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2965
Macro F1 Score: 0.1332
xView2 Score: 0.2570
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5096
Confusion Matrix:
 [[1115130 3316986   53258   10849   76698]
 [ 225537 1664230   25473    3313   31641]
 [   5408   21498      55      13     443]
 [    484    2543      41       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3768
Class 1 F1: 0.4785
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8281
Class 1 Precision: 0.3325
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2439
Class 1 Recall: 0.8534
Class 2 Recall: 0.0020
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4241
Macro F1 Score: 0.1713
xView2 Score: 0.2744
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4388
Confusion Matrix:
 [[1167144 3393737    4347    1273    6420]
 [ 200293 1745895    1898     474    1634]
 [   4526   22886       1       0       4]
 [    230    2838       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3926
Class 1 F1: 0.4907
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8506
Class 1 Precision: 0.3380
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2552
Class 1 Recall: 0.8952
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4445
Macro F1 Score: 0.1767
xView2 Score: 0.2801
Epoch 3 took:  0 hours,  1 minutes, 17 seconds

Epoch 4/10
Train Loss: 1.3518
Confusion Matrix:
 [[1453538 3118904     207       2     270]
 [ 139545 1810490      94       3      62]
 [   4097   23320       0       0       0]
 [    484    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4711
Class 1 F1: 0.5244
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9098
Class 1 Precision: 0.3654
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3179
Class 1 Recall: 0.9284
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4981
Macro F1 Score: 0.1991
xView2 Score: 0.2927
Epoch 4 took:  0 hours,  0 minutes, 53 seconds

Epoch 5/10
Train Loss: 1.2436
Confusion Matrix:
 [[1794593 2778307      15       0       6]
 [ 169199 1780969      26       0       0]
 [   2730   24687       0       0       0]
 [      0    3068       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5489
Class 1 F1: 0.5449
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9126
Class 1 Precision: 0.3883
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3924
Class 1 Recall: 0.9132
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5456
Macro F1 Score: 0.2187
xView2 Score: 0.3311
Epoch 5 took:  0 hours,  0 minutes, 31 seconds

Epoch 6/10
Train Loss: 1.1585
Confusion Matrix:
 [[1706263 2866658       0       0       0]
 [ 188413 1761781       0       0       0]
 [   4971   22446       0       0       0]
 [      0    3068       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5272
Class 1 F1: 0.5335
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8982
Class 1 Precision: 0.3786
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3731
Class 1 Recall: 0.9034
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5292
Macro F1 Score: 0.2652
xView2 Score: 0.3266
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1063
Confusion Matrix:
 [[1661855 2911066       0       0       0]
 [ 167343 1782851       0       0       0]
 [   4822   22595       0       0       0]
 [    484    2584       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5187
Class 1 F1: 0.5346
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9059
Class 1 Precision: 0.3778
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3634
Class 1 Recall: 0.9142
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5256
Macro F1 Score: 0.2633
xView2 Score: 0.3280
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0340
Confusion Matrix:
 [[1828131 2744790       0       0       0]
 [ 203338 1746856       0       0       0]
 [   3620   23797       0       0       0]
 [    102    2966       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5533
Class 1 F1: 0.5401
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8983
Class 1 Precision: 0.3866
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3998
Class 1 Recall: 0.8957
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5455
Macro F1 Score: 0.2734
xView2 Score: 0.3279
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9792
Confusion Matrix:
 [[1853665 2719256       0       0       0]
 [ 188487 1761707       0       0       0]
 [   3184   24233       0       0       0]
 [      0    3068       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5602
Class 1 F1: 0.5456
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9063
Class 1 Precision: 0.3908
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4054
Class 1 Recall: 0.9033
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5517
Macro F1 Score: 0.2764
xView2 Score: 0.3303
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9571
Confusion Matrix:
 [[1848853 2724068       0       0       0]
 [ 243010 1707184       0       0       0]
 [   3697   23720       0       0       0]
 [      0    3068       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5545
Class 1 F1: 0.5328
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8823
Class 1 Precision: 0.3829
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4043
Class 1 Recall: 0.8754
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5426
Macro F1 Score: 0.2718
xView2 Score: 0.3238
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5456
Best Macro F1: 0.2187
Best xView2 Score: 0.3311
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9126
Class 1 Precision: 0.3883
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2602
ROC curve saved to .././____________optune_results/156/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/156/plot_loss_curves.jpg
Prediction distribution: {0: 27646, 1: 234498}
ROC curve saved to .././____________optune_results/156/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/156/visualize_predictions.jpg
Prediction distribution: {0: 227594, 1: 34550}
ROC curve saved to .././____________optune_results/156/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/156/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/156/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2746843566404993, 1: 0.7381664124307085, 2: 283.03237923859865, 3: 973.1563805104408, 4: 5292.497160883281}
Final class weights used in loss: [2.6564990239601736, 7.448165367874566, 283.03237923859865, 973.1563805104408, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6943
Confusion Matrix:
 [[2284042    7732 1540802  612497  411893]
 [ 883057    5970  400085  254720  125652]
 [  11652       0    5816    5676    2573]
 [    731       0     294     281     127]
 [      0       0       0       0       0]]
Class 0 F1: 0.5684
Class 1 F1: 0.0071
Class 2 F1: 0.0059
Class 3 F1: 0.0006
Class 4 F1: 0.0000
Class 0 Precision: 0.7184
Class 1 Precision: 0.4357
Class 2 Precision: 0.0030
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.4703
Class 1 Recall: 0.0036
Class 2 Recall: 0.2262
Class 3 Recall: 0.1961
Class 4 Recall: 0.0000
Validation Accuracy: 0.3504
Macro F1 Score: 0.1164
xView2 Score: 0.0999
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.6114
Confusion Matrix:
 [[3844669  112563  520307  264436  114991]
 [1271724   85809  157615  113840   40496]
 [  19646    1463    2741    1578     289]
 [    968       0      69     310      86]
 [      0       0       0       0       0]]
Class 0 F1: 0.7694
Class 1 F1: 0.0918
Class 2 F1: 0.0078
Class 3 F1: 0.0016
Class 4 F1: 0.0000
Class 0 Precision: 0.7484
Class 1 Precision: 0.4294
Class 2 Precision: 0.0040
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.7916
Class 1 Recall: 0.0514
Class 2 Recall: 0.1066
Class 3 Recall: 0.2163
Class 4 Recall: 0.0000
Validation Accuracy: 0.6002
Macro F1 Score: 0.1741
xView2 Score: 0.0965
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.5339
Confusion Matrix:
 [[4247645  372814  124282   78566   33659]
 [1265267  309801   47185   35175   12056]
 [  22613    2265     338     311     190]
 [   1070     131      93       0     139]
 [      0       0       0       0       0]]
Class 0 F1: 0.8174
Class 1 F1: 0.2632
Class 2 F1: 0.0034
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7672
Class 1 Precision: 0.4523
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8745
Class 1 Recall: 0.1856
Class 2 Recall: 0.0131
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6955
Macro F1 Score: 0.2168
xView2 Score: 0.1352
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.4506
Confusion Matrix:
 [[3782440 1049010   12809    7986    4721]
 [ 810435  848116    4479    3569    2885]
 [  20600    4976     116      25       0]
 [    284    1024       0       0     125]
 [      0       0       0       0       0]]
Class 0 F1: 0.7988
Class 1 F1: 0.4748
Class 2 F1: 0.0054
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8198
Class 1 Precision: 0.4456
Class 2 Precision: 0.0067
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7788
Class 1 Recall: 0.5080
Class 2 Recall: 0.0045
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7066
Macro F1 Score: 0.2558
xView2 Score: 0.2379
Epoch 4 took:  0 hours,  1 minutes, 10 seconds

Epoch 5/10
Train Loss: 1.3582
Confusion Matrix:
 [[3267049 1587109    1339     783     686]
 [ 457770 1210972     293     308     141]
 [  10063   15654       0       0       0]
 [    410    1023       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7605
Class 1 F1: 0.5401
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8746
Class 1 Precision: 0.4302
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6727
Class 1 Recall: 0.7254
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6833
Macro F1 Score: 0.2601
xView2 Score: 0.2803
Epoch 5 took:  0 hours,  0 minutes, 42 seconds

Epoch 6/10
Train Loss: 1.2774
Confusion Matrix:
 [[3049554 1807266     118      20       8]
 [ 418281 1251129      48      18       8]
 [  13364   12353       0       0       0]
 [    895     538       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7314
Class 1 F1: 0.5278
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8758
Class 1 Precision: 0.4074
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6279
Class 1 Recall: 0.7494
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6562
Macro F1 Score: 0.2518
xView2 Score: 0.2785
Epoch 6 took:  0 hours,  0 minutes, 29 seconds

Epoch 7/10
Train Loss: 1.1986
Confusion Matrix:
 [[2979680 1877286       0       0       0]
 [ 363396 1306070      18       0       0]
 [  13944   11773       0       0       0]
 [    514     919       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7255
Class 1 F1: 0.5369
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8875
Class 1 Precision: 0.4087
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6135
Class 1 Recall: 0.7823
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6540
Macro F1 Score: 0.3156
xView2 Score: 0.3147
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1403
Confusion Matrix:
 [[2861710 1995256       0       0       0]
 [ 299633 1369851       0       0       0]
 [  12244   13473       0       0       0]
 [    518     915       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7127
Class 1 F1: 0.5426
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9016
Class 1 Precision: 0.4053
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5892
Class 1 Recall: 0.8205
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6457
Macro F1 Score: 0.3138
xView2 Score: 0.3206
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1095
Confusion Matrix:
 [[3105064 1751902       0       0       0]
 [ 378328 1291156       0       0       0]
 [  12674   13043       0       0       0]
 [    886     547       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7434
Class 1 F1: 0.5464
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8879
Class 1 Precision: 0.4224
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6393
Class 1 Recall: 0.7734
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6708
Macro F1 Score: 0.3224
xView2 Score: 0.3166
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0559
Confusion Matrix:
 [[2944727 1912239       0       0       0]
 [ 331026 1338458       0       0       0]
 [  13022   12695       0       0       0]
 [    501     932       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7230
Class 1 F1: 0.5426
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8953
Class 1 Precision: 0.4100
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6063
Class 1 Recall: 0.8017
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6536
Macro F1 Score: 0.3164
xView2 Score: 0.3186
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6457
Best Macro F1: 0.3138
Best xView2 Score: 0.3206
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9016
Class 1 Precision: 0.4053
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3267
ROC curve saved to .././____________optune_results/157/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/157/plot_loss_curves.jpg
Prediction distribution: {0: 138882, 1: 123262}
ROC curve saved to .././____________optune_results/157/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/157/visualize_predictions.jpg
Prediction distribution: {0: 16234, 1: 245910}
ROC curve saved to .././____________optune_results/157/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/157/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/157/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2761977924106537, 1: 0.7293210349267116, 2: 141.67552778246917, 3: 979.7868016351956, 4: 5292.497160883281}
Final class weights used in loss: [2.6711356079120705, 1.3641710563042226, 141.67552778246917, 979.7868016351956, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4717
Confusion Matrix:
 [[4532978  112444   33364  264604   13980]
 [1334101   70364   22251  151904    8168]
 [   5426     312    1148    1058      30]
 [   1357      17       0      94       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8370
Class 1 F1: 0.0795
Class 2 F1: 0.0355
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.7717
Class 1 Precision: 0.3842
Class 2 Precision: 0.0202
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.9144
Class 1 Recall: 0.0443
Class 2 Recall: 0.1440
Class 3 Recall: 0.0640
Class 4 Recall: 0.0000
Validation Accuracy: 0.7026
Macro F1 Score: 0.1905
xView2 Score: 0.0896
Epoch 1 took:  0 hours,  1 minutes, 18 seconds

Epoch 2/10
Train Loss: 1.3881
Confusion Matrix:
 [[4927041   16309    2064   11735     221]
 [1564478   13043    1479    7665     123]
 [   7854     112       8       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8600
Class 1 F1: 0.0161
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7579
Class 1 Precision: 0.4427
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9939
Class 1 Recall: 0.0082
Class 2 Recall: 0.0010
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7538
Macro F1 Score: 0.1755
xView2 Score: 0.0107
Epoch 2 took:  0 hours,  0 minutes, 55 seconds

Epoch 3/10
Train Loss: 1.3103
Confusion Matrix:
 [[4955386    1648      41     295       0]
 [1584851    1539      60     338       0]
 [   7971       3       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0019
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7566
Class 1 Precision: 0.4824
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0010
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2158
xView2 Score: 0.0011
Epoch 3 took:  0 hours,  0 minutes, 27 seconds

Epoch 4/10
Train Loss: 1.2465
Confusion Matrix:
 [[4957126     192       0      52       0]
 [1586546     210       0      32       0]
 [   7974       0       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7565
Class 1 Precision: 0.5224
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2154
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1643
Confusion Matrix:
 [[4957219     150       0       1       0]
 [1586765      22       0       1       0]
 [   7969       5       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7564
Class 1 Precision: 0.1243
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2153
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.0959
Confusion Matrix:
 [[4957363       7       0       0       0]
 [1586787       1       0       0       0]
 [   7974       0       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7564
Class 1 Precision: 0.1250
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2153
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0379
Confusion Matrix:
 [[4957370       0       0       0       0]
 [1586788       0       0       0       0]
 [   7974       0       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7564
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2153
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9983
Confusion Matrix:
 [[4957370       0       0       0       0]
 [1586788       0       0       0       0]
 [   7974       0       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7564
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2153
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9456
Confusion Matrix:
 [[4957369       1       0       0       0]
 [1586788       0       0       0       0]
 [   7974       0       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7564
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2153
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9269
Confusion Matrix:
 [[4957370       0       0       0       0]
 [1586788       0       0       0       0]
 [   7974       0       0       0       0]
 [   1468       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8613
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7564
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7564
Macro F1 Score: 0.2153
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7026
Best Macro F1: 0.1905
Best xView2 Score: 0.0896
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7717
Class 1 Precision: 0.3842
Class 2 Precision: 0.0202
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Macro Precision: 0.2353
ROC curve saved to .././____________optune_results/158/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/158/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/158/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/158/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/158/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/158/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/158/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.272175407385873, 1: 0.7584316514673883, 2: 156.7134165706635, 3: 1007.2373023814289, 4: 68947.46301369862}
Final class weights used in loss: [2.6322347326565247, 1.708128154846561, 156.7134165706635, 1007.2373023814289, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5196
Confusion Matrix:
 [[3918705  230782  449069   83366    6136]
 [1403640  156597  252295   36846    2295]
 [   8357    1864    1155       5       2]
 [   1086     310     212       0       0]
 [    528     305       6      39       0]]
Class 0 F1: 0.7821
Class 1 F1: 0.1397
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7349
Class 1 Precision: 0.4017
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8359
Class 1 Recall: 0.0846
Class 2 Recall: 0.1015
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6220
Macro F1 Score: 0.1850
xView2 Score: 0.1109
Epoch 1 took:  0 hours,  1 minutes, 18 seconds

Epoch 2/10
Train Loss: 1.4406
Confusion Matrix:
 [[4536662   71475   69900    9908     113]
 [1737808   59553   48947    5252     113]
 [  11216     128      39       0       0]
 [   1602       2       1       3       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8266
Class 1 F1: 0.0601
Class 2 F1: 0.0006
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.7215
Class 1 Precision: 0.4541
Class 2 Precision: 0.0003
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.9677
Class 1 Recall: 0.0322
Class 2 Recall: 0.0034
Class 3 Recall: 0.0019
Class 4 Recall: 0.0000
Validation Accuracy: 0.7013
Macro F1 Score: 0.1775
xView2 Score: 0.0411
Epoch 2 took:  0 hours,  0 minutes, 45 seconds

Epoch 3/10
Train Loss: 1.3620
Confusion Matrix:
 [[4666551   15751    5570     184       2]
 [1827057   18452    6043     120       1]
 [  11370      12       1       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8336
Class 1 F1: 0.0196
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7171
Class 1 Precision: 0.5393
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9954
Class 1 Recall: 0.0100
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7149
Macro F1 Score: 0.1707
xView2 Score: 0.0105
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.2970
Confusion Matrix:
 [[4671228   16300     514      15       1]
 [1832840   17985     847       1       0]
 [  11374       3       6       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8337
Class 1 F1: 0.0191
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7167
Class 1 Precision: 0.5245
Class 2 Precision: 0.0044
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9964
Class 1 Recall: 0.0097
Class 2 Recall: 0.0005
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7155
Macro F1 Score: 0.1707
xView2 Score: 0.0088
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2235
Confusion Matrix:
 [[4683476    4570      11       1       0]
 [1844640    6999      34       0       0]
 [  11383       0       0       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8341
Class 1 F1: 0.0075
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7159
Class 1 Precision: 0.6050
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9990
Class 1 Recall: 0.0038
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7157
Macro F1 Score: 0.1683
xView2 Score: 0.0033
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1366
Confusion Matrix:
 [[4684169    3889       0       0       0]
 [1844806    6867       0       0       0]
 [  11383       0       0       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8342
Class 1 F1: 0.0074
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7159
Class 1 Precision: 0.6384
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9992
Class 1 Recall: 0.0037
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7158
Macro F1 Score: 0.1683
xView2 Score: 0.0032
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0937
Confusion Matrix:
 [[4685666    2392       0       0       0]
 [1847131    4542       0       0       0]
 [  11383       0       0       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8341
Class 1 F1: 0.0049
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7157
Class 1 Precision: 0.6550
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9995
Class 1 Recall: 0.0025
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7157
Macro F1 Score: 0.1678
xView2 Score: 0.0021
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0488
Confusion Matrix:
 [[4685423    2635       0       0       0]
 [1846490    5183       0       0       0]
 [  11383       0       0       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8342
Class 1 F1: 0.0056
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7158
Class 1 Precision: 0.6630
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0028
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7157
Macro F1 Score: 0.1679
xView2 Score: 0.0024
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0038
Confusion Matrix:
 [[4683650    4408       0       0       0]
 [1843249    8424       0       0       0]
 [  11383       0       0       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8342
Class 1 F1: 0.0090
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7161
Class 1 Precision: 0.6565
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9991
Class 1 Recall: 0.0045
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7160
Macro F1 Score: 0.1687
xView2 Score: 0.0040
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9740
Confusion Matrix:
 [[4685413    2645       0       0       0]
 [1846177    5496       0       0       0]
 [  11383       0       0       0       0]
 [   1608       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8342
Class 1 F1: 0.0059
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7158
Class 1 Precision: 0.6751
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9994
Class 1 Recall: 0.0030
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7158
Macro F1 Score: 0.1680
xView2 Score: 0.0026
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6220
Best Macro F1: 0.1850
Best xView2 Score: 0.1109
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7349
Class 1 Precision: 0.4017
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2276
ROC curve saved to .././____________optune_results/159/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/159/plot_loss_curves.jpg
Prediction distribution: {0: 256498, 1: 5646}
ROC curve saved to .././____________optune_results/159/visualize_predictions.jpg
Prediction distribution: {0: 261946, 1: 198}
ROC curve saved to .././____________optune_results/159/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/159/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/159/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/159/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.28076204792612447, 1: 0.6995870167128132, 2: 135.54060429794797, 3: 779.1276780185758, 4: 5292.497160883281}
Final class weights used in loss: [2.715276965178447, 1.3093035388709258, 135.54060429794797, 779.1276780185758, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5328
Confusion Matrix:
 [[4550029  283727  209025   11892  198943]
 [1038083  117870   79634    1999   55887]
 [   5937     311      54       0      64]
 [    144       1       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8389
Class 1 F1: 0.1390
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8133
Class 1 Precision: 0.2933
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8661
Class 1 Recall: 0.0911
Class 2 Recall: 0.0085
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7123
Macro F1 Score: 0.1957
xView2 Score: 0.0915
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4410
Confusion Matrix:
 [[5146681   62671   18765     392   25107]
 [1239450   37970    7541      66    8446]
 [   6333      32       0       0       1]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8838
Class 1 F1: 0.0545
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8051
Class 1 Precision: 0.3772
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9796
Class 1 Recall: 0.0294
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7911
Macro F1 Score: 0.1877
xView2 Score: 0.0302
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.3621
Confusion Matrix:
 [[5233159   18443     545       0    1469]
 [1284618    7970     263       0     622]
 [   6364       2       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8886
Class 1 F1: 0.0121
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8021
Class 1 Precision: 0.3017
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9961
Class 1 Recall: 0.0062
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7997
Macro F1 Score: 0.1801
xView2 Score: 0.0057
Epoch 3 took:  0 hours,  1 minutes,  0 seconds

Epoch 4/10
Train Loss: 1.2933
Confusion Matrix:
 [[5251759    1818       1       0      38]
 [1291765    1695       0       0      13]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8899
Class 1 F1: 0.0026
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8018
Class 1 Precision: 0.4825
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9996
Class 1 Recall: 0.0013
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8016
Macro F1 Score: 0.1785
xView2 Score: 0.0012
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.2040
Confusion Matrix:
 [[5252972     644       0       0       0]
 [1292877     596       0       0       0]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8899
Class 1 F1: 0.0009
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8017
Class 1 Precision: 0.4806
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0005
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8016
Macro F1 Score: 0.2227
xView2 Score: 0.0004
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1396
Confusion Matrix:
 [[5252511    1105       0       0       0]
 [1293237     236       0       0       0]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8898
Class 1 F1: 0.0004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8016
Class 1 Precision: 0.1760
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9998
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8015
Macro F1 Score: 0.2225
xView2 Score: 0.0002
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0686
Confusion Matrix:
 [[5253081     535       0       0       0]
 [1292942     531       0       0       0]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8899
Class 1 F1: 0.0008
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8017
Class 1 Precision: 0.4981
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8016
Macro F1 Score: 0.2227
xView2 Score: 0.0004
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0374
Confusion Matrix:
 [[5253327     289       0       0       0]
 [1293370     103       0       0       0]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8899
Class 1 F1: 0.0002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8016
Class 1 Precision: 0.2628
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8016
Macro F1 Score: 0.2225
xView2 Score: 0.0001
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9909
Confusion Matrix:
 [[5253425     191       0       0       0]
 [1293271     202       0       0       0]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8899
Class 1 F1: 0.0003
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8017
Class 1 Precision: 0.5140
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0002
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8016
Macro F1 Score: 0.2226
xView2 Score: 0.0001
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.9544
Confusion Matrix:
 [[5253538      78       0       0       0]
 [1293389      84       0       0       0]
 [   6366       0       0       0       0]
 [    145       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8899
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8016
Class 1 Precision: 0.5185
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0001
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.8016
Macro F1 Score: 0.2225
xView2 Score: 0.0001
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7123
Best Macro F1: 0.1957
Best xView2 Score: 0.0915
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8133
Class 1 Precision: 0.2933
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2214
ROC curve saved to .././____________optune_results/160/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/160/plot_loss_curves.jpg
Prediction distribution: {0: 262057, 1: 87}
ROC curve saved to .././____________optune_results/160/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/160/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/160/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/160/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/160/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27611998564859463, 1: 0.7291473369754256, 2: 180.43897612389762, 3: 830.144285007422, 4: 5732.533940774488}
Final class weights used in loss: [2.6703831311784287, 0.8107623314887964, 180.43897612389762, 830.144285007422, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5224
Confusion Matrix:
 [[4073479   66021  456550  343566   12619]
 [1260492   25645  141281  155390    2336]
 [  15181       1     333      91       0]
 [    202      37     303       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7908
Class 1 F1: 0.0306
Class 2 F1: 0.0011
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7615
Class 1 Precision: 0.2796
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8226
Class 1 Recall: 0.0162
Class 2 Recall: 0.0213
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6255
Macro F1 Score: 0.1645
xView2 Score: 0.0746
Epoch 1 took:  0 hours,  1 minutes, 19 seconds

Epoch 2/10
Train Loss: 1.4264
Confusion Matrix:
 [[4838660   12092   64695   35672    1116]
 [1528419    7961   27403   20900     461]
 [  15596       0       1       9       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8537
Class 1 F1: 0.0099
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7580
Class 1 Precision: 0.3970
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9771
Class 1 Recall: 0.0050
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7395
Macro F1 Score: 0.1727
xView2 Score: 0.0206
Epoch 2 took:  0 hours,  0 minutes, 58 seconds

Epoch 3/10
Train Loss: 1.3436
Confusion Matrix:
 [[4945535     851    3528    2247      74]
 [1580659     557    2006    1880      42]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8605
Class 1 F1: 0.0007
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7559
Class 1 Precision: 0.3956
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9986
Class 1 Recall: 0.0004
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7547
Macro F1 Score: 0.1722
xView2 Score: 0.0018
Epoch 3 took:  0 hours,  0 minutes, 31 seconds

Epoch 4/10
Train Loss: 1.2713
Confusion Matrix:
 [[4951526     288     307     114       0]
 [1584821      77     208      38       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0001
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.2110
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9999
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7556
Macro F1 Score: 0.1722
xView2 Score: 0.0001
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.1869
Confusion Matrix:
 [[4952217      12       4       2       0]
 [1585131       2      11       0       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.1429
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7556
Macro F1 Score: 0.1722
xView2 Score: 0.0000
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1208
Confusion Matrix:
 [[4952235       0       0       0       0]
 [1585144       0       0       0       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7557
Macro F1 Score: 0.1722
xView2 Score: 0.0000
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.0455
Confusion Matrix:
 [[4952235       0       0       0       0]
 [1585144       0       0       0       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7557
Macro F1 Score: 0.1722
xView2 Score: 0.0000
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 0.9967
Confusion Matrix:
 [[4952235       0       0       0       0]
 [1585144       0       0       0       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7557
Macro F1 Score: 0.1722
xView2 Score: 0.0000
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 0.9361
Confusion Matrix:
 [[4952235       0       0       0       0]
 [1585144       0       0       0       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7557
Macro F1 Score: 0.1722
xView2 Score: 0.0000
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 0.8934
Confusion Matrix:
 [[4952235       0       0       0       0]
 [1585144       0       0       0       0]
 [  15606       0       0       0       0]
 [    542       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8608
Class 1 F1: 0.0000
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7557
Class 1 Precision: 0.0000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 1.0000
Class 1 Recall: 0.0000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7557
Macro F1 Score: 0.1722
xView2 Score: 0.0000
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6255
Best Macro F1: 0.1645
Best xView2 Score: 0.0746
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.7615
Class 1 Precision: 0.2796
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2083
ROC curve saved to .././____________optune_results/161/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/161/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/161/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/161/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/161/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/161/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/161/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2737102540369989, 1: 0.7468470080653274, 2: 147.9776791226884, 3: 1647.5171194762684, 4: 5732.533940774488}
Final class weights used in loss: [2.647078383312542, 4.458122075074295, 147.9776791226884, 1647.5171194762684, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5390
Confusion Matrix:
 [[2608236  961106     167   55069 1167177]
 [ 926188  482486     125   31327  308609]
 [   7284    1501       0      56     646]
 [   1719     861       0      75     895]
 [     40      29       0       0       4]]
Class 0 F1: 0.6258
Class 1 F1: 0.3021
Class 2 F1: 0.0000
Class 3 F1: 0.0017
Class 4 F1: 0.0000
Class 0 Precision: 0.7361
Class 1 Precision: 0.3337
Class 2 Precision: 0.0000
Class 3 Precision: 0.0009
Class 4 Precision: 0.0000
Class 0 Recall: 0.5443
Class 1 Recall: 0.2759
Class 2 Recall: 0.0000
Class 3 Recall: 0.0211
Class 4 Recall: 0.0548
Validation Accuracy: 0.4716
Macro F1 Score: 0.1859
xView2 Score: 0.1650
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4622
Confusion Matrix:
 [[3847349  872116       2    4033   68255]
 [1136639  581764       0    2510   27822]
 [   9152     295       0       5      35]
 [   3292     258       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7861
Class 1 F1: 0.3632
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7700
Class 1 Precision: 0.4000
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8029
Class 1 Recall: 0.3327
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6758
Macro F1 Score: 0.2299
xView2 Score: 0.1807
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.3970
Confusion Matrix:
 [[3811787  977348       0     111    2509]
 [1010357  736825       0     135    1418]
 [   8272    1215       0       0       0]
 [   2866     684       0       0       0]
 [      2      71       0       0       0]]
Class 0 F1: 0.7921
Class 1 F1: 0.4253
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7887
Class 1 Precision: 0.4293
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7955
Class 1 Recall: 0.4213
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6941
Macro F1 Score: 0.2435
xView2 Score: 0.2105
Epoch 3 took:  0 hours,  1 minutes, 11 seconds

Epoch 4/10
Train Loss: 1.3239
Confusion Matrix:
 [[3501200 1290194       0       0     361]
 [ 770318  978379       0       0      38]
 [   7993    1494       0       0       0]
 [    799    2751       0       0       0]
 [     13      60       0       0       0]]
Class 0 F1: 0.7719
Class 1 F1: 0.4866
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8180
Class 1 Precision: 0.4305
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7307
Class 1 Recall: 0.5595
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6835
Macro F1 Score: 0.2517
xView2 Score: 0.2464
Epoch 4 took:  0 hours,  0 minutes, 37 seconds

Epoch 5/10
Train Loss: 1.2489
Confusion Matrix:
 [[3426955 1364800       0       0       0]
 [ 698428 1050307       0       0       0]
 [   6768    2719       0       0       0]
 [    610    2940       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7680
Class 1 F1: 0.5038
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8292
Class 1 Precision: 0.4339
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7152
Class 1 Recall: 0.6006
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6832
Macro F1 Score: 0.2544
xView2 Score: 0.2563
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1863
Confusion Matrix:
 [[3323463 1468292       0       0       0]
 [ 645219 1103516       0       0       0]
 [   8096    1391       0       0       0]
 [    708    2842       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7580
Class 1 F1: 0.5103
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8356
Class 1 Precision: 0.4284
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6936
Class 1 Recall: 0.6310
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6755
Macro F1 Score: 0.2537
xView2 Score: 0.2614
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1241
Confusion Matrix:
 [[3227046 1564709       0       0       0]
 [ 562586 1186149       0       0       0]
 [   5773    3714       0       0       0]
 [    107    3443       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7516
Class 1 F1: 0.5264
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8502
Class 1 Precision: 0.4301
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6735
Class 1 Recall: 0.6783
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6734
Macro F1 Score: 0.2556
xView2 Score: 0.2713
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0737
Confusion Matrix:
 [[3120234 1671521       0       0       0]
 [ 554393 1194342       0       0       0]
 [   7919    1568       0       0       0]
 [    619    2931       0       0       0]
 [     29      44       0       0       0]]
Class 0 F1: 0.7363
Class 1 F1: 0.5171
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8472
Class 1 Precision: 0.4161
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6512
Class 1 Recall: 0.6830
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6584
Macro F1 Score: 0.2507
xView2 Score: 0.2687
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0323
Confusion Matrix:
 [[3223899 1567856       0       0       0]
 [ 626502 1122233       0       0       0]
 [   7639    1848       0       0       0]
 [    673    2877       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7454
Class 1 F1: 0.5051
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8355
Class 1 Precision: 0.4164
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6728
Class 1 Recall: 0.6417
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6632
Macro F1 Score: 0.2501
xView2 Score: 0.2610
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0081
Confusion Matrix:
 [[3357481 1434274       0       0       0]
 [ 625447 1123288       0       0       0]
 [   7963    1524       0       0       0]
 [    741    2809       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7645
Class 1 F1: 0.5212
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8411
Class 1 Precision: 0.4385
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7007
Class 1 Recall: 0.6423
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6837
Macro F1 Score: 0.2571
xView2 Score: 0.2658
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6734
Best Macro F1: 0.2556
Best xView2 Score: 0.2713
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8502
Class 1 Precision: 0.4301
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2561
ROC curve saved to .././____________optune_results/162/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/162/plot_loss_curves.jpg
Prediction distribution: {0: 74029, 1: 188115}
ROC curve saved to .././____________optune_results/162/visualize_predictions.jpg
Prediction distribution: {0: 211851, 1: 50293}
ROC curve saved to .././____________optune_results/162/visualize_predictions.jpg
Prediction distribution: {0: 156118, 1: 106026}
ROC curve saved to .././____________optune_results/162/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/162/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/162/plot_epoch_f1.jpg
[FrozenTrial(number=8, state=TrialState.COMPLETE, values=[0.17913874748699635, 0.7874954223632812, 0.9961933212620873], datetime_start=datetime.datetime(2025, 7, 22, 21, 59, 56, 487111), datetime_complete=datetime.datetime(2025, 7, 22, 22, 6, 32, 844992), params={'class4': 1.860699911284984}, user_attrs={'f1': 0.17913874748699635, 'accuracy': 0.7874954223632812, 'val_loss': 0.9961933212620873}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=8, value=None), FrozenTrial(number=15, state=TrialState.COMPLETE, values=[0.4332333069531988, 0.6364539489746093, 1.163855587584632], datetime_start=datetime.datetime(2025, 7, 22, 22, 47, 16, 711368), datetime_complete=datetime.datetime(2025, 7, 22, 22, 54, 55, 487616), params={'class4': 9.859017820710575}, user_attrs={'f1': 0.4332333069531988, 'accuracy': 0.6364539489746093, 'val_loss': 1.163855587584632}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=15, value=None), FrozenTrial(number=26, state=TrialState.COMPLETE, values=[0.41181875075594504, 0.5034186706542968, 1.1445466228893824], datetime_start=datetime.datetime(2025, 7, 23, 0, 7, 42, 272152), datetime_complete=datetime.datetime(2025, 7, 23, 0, 16, 40, 674880), params={'class4': 19.910583214455198}, user_attrs={'f1': 0.41181875075594504, 'accuracy': 0.5034186706542968, 'val_loss': 1.1445466228893824}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=26, value=None), FrozenTrial(number=35, state=TrialState.COMPLETE, values=[0.34699547497563793, 0.7424100036621094, 1.0709629173789703], datetime_start=datetime.datetime(2025, 7, 23, 1, 21, 5, 638936), datetime_complete=datetime.datetime(2025, 7, 23, 1, 27, 45, 460616), params={'class4': 5.743098172878908}, user_attrs={'f1': 0.34699547497563793, 'accuracy': 0.7424100036621094, 'val_loss': 1.0709629173789703}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=35, value=None), FrozenTrial(number=36, state=TrialState.COMPLETE, values=[0.41102238520906315, 0.7411380157470704, 1.158775815793446], datetime_start=datetime.datetime(2025, 7, 23, 1, 27, 45, 463849), datetime_complete=datetime.datetime(2025, 7, 23, 1, 33, 41, 424351), params={'class4': 3.4805580601153925}, user_attrs={'f1': 0.41102238520906315, 'accuracy': 0.7411380157470704, 'val_loss': 1.158775815793446}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=36, value=None), FrozenTrial(number=47, state=TrialState.COMPLETE, values=[0.19565974722610652, 0.7914397125244141, 0.9973800231303489], datetime_start=datetime.datetime(2025, 7, 23, 2, 51, 36, 760632), datetime_complete=datetime.datetime(2025, 7, 23, 2, 59, 4, 72847), params={'class4': 1.8715377895705099}, user_attrs={'f1': 0.19565974722610652, 'accuracy': 0.7914397125244141, 'val_loss': 0.9973800231303489}, system_attrs={'NSGAIISampler:generation': 0}, intermediate_values={}, distributions={'class4': FloatDistribution(high=20.0, log=True, low=1.0, step=None)}, trial_id=47, value=None)]
Found 'class4': 9.859017820710575
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27517408031419444, 1: 0.7368281530871766, 2: 135.68310553983017, 3: 827.0070325336839, 4: 5292.497160883281}
Final class weights used in loss: [2.661235189051963, 4.398316950245897, 216.2441299585934, 827.0070325336839, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6257
Confusion Matrix:
 [[1130389   33403 3692866   10014   22904]
 [ 234508   17410 1400648     955    3579]
 [   3641      50    2714       0       0]
 [    484       0      35       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3612
Class 1 F1: 0.0204
Class 2 F1: 0.0011
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8257
Class 1 Precision: 0.3423
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2312
Class 1 Recall: 0.0105
Class 2 Recall: 0.4237
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1756
Macro F1 Score: 0.0765
xView2 Score: 0.1283
Epoch 1 took:  0 hours,  1 minutes, 13 seconds

Epoch 2/10
Train Loss: 1.5537
Confusion Matrix:
 [[2354343  184362 2338932    5575    6364]
 [ 488744  126438 1041041     411     466]
 [   2431     463    3505       6       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6087
Class 1 F1: 0.1285
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8272
Class 1 Precision: 0.4062
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4815
Class 1 Recall: 0.0763
Class 2 Recall: 0.5472
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3791
Macro F1 Score: 0.1478
xView2 Score: 0.1517
Epoch 2 took:  0 hours,  1 minutes,  5 seconds

Epoch 3/10
Train Loss: 1.4922
Confusion Matrix:
 [[3465838  412637 1009427    1014     660]
 [ 842056  316059  498763     194      28]
 [   4624     495    1286       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7532
Class 1 F1: 0.2649
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8036
Class 1 Precision: 0.4334
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7088
Class 1 Recall: 0.1907
Class 2 Recall: 0.2008
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5773
Macro F1 Score: 0.2040
xView2 Score: 0.1711
Epoch 3 took:  0 hours,  0 minutes, 45 seconds

Epoch 4/10
Train Loss: 1.4251
Confusion Matrix:
 [[3610474 1028795  250160     118      29]
 [ 717422  817840  121820      12       6]
 [   4224    1312     869       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7830
Class 1 F1: 0.4667
Class 2 F1: 0.0046
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8333
Class 1 Precision: 0.4426
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7384
Class 1 Recall: 0.4935
Class 2 Recall: 0.1357
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6758
Macro F1 Score: 0.2508
xView2 Score: 0.2398
Epoch 4 took:  0 hours,  0 minutes, 29 seconds

Epoch 5/10
Train Loss: 1.3582
Confusion Matrix:
 [[3567988 1285349   36237       2       0]
 [ 632544 1001661   22894       0       1]
 [   4940    1445      20       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7846
Class 1 F1: 0.5077
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8483
Class 1 Precision: 0.4377
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7297
Class 1 Recall: 0.6045
Class 2 Recall: 0.0031
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.2586
xView2 Score: 0.2591
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3002
Confusion Matrix:
 [[3545455 1337988    6133       0       0]
 [ 583742 1068777    4581       0       0]
 [   2759    3646       0       0       0]
 [      0     519       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7860
Class 1 F1: 0.5255
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8581
Class 1 Precision: 0.4433
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7251
Class 1 Recall: 0.6450
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7041
Macro F1 Score: 0.3279
xView2 Score: 0.2953
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2415
Confusion Matrix:
 [[3412383 1476861     332       0       0]
 [ 522738 1134056     306       0       0]
 [   4475    1930       0       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7729
Class 1 F1: 0.5312
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8661
Class 1 Precision: 0.4340
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6979
Class 1 Recall: 0.6844
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6937
Macro F1 Score: 0.3260
xView2 Score: 0.3015
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1916
Confusion Matrix:
 [[3543902 1345576      98       0       0]
 [ 583086 1073951      63       0       0]
 [   5261    1144       0       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7856
Class 1 F1: 0.5267
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8575
Class 1 Precision: 0.4437
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7248
Class 1 Recall: 0.6481
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7046
Macro F1 Score: 0.3281
xView2 Score: 0.2955
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1358
Confusion Matrix:
 [[3525925 1363647       4       0       0]
 [ 523734 1133360       6       0       0]
 [   3436    2969       0       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7885
Class 1 F1: 0.5453
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8698
Class 1 Precision: 0.4533
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7211
Class 1 Recall: 0.6839
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7110
Macro F1 Score: 0.3334
xView2 Score: 0.3057
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1087
Confusion Matrix:
 [[3545074 1344502       0       0       0]
 [ 562659 1094441       0       0       0]
 [   5021    1384       0       0       0]
 [    484      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7875
Class 1 F1: 0.5342
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8619
Class 1 Precision: 0.4485
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7250
Class 1 Recall: 0.6605
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7079
Macro F1 Score: 0.3304
xView2 Score: 0.2993
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7110
Best Macro F1: 0.3334
Best xView2 Score: 0.3057
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8698
Class 1 Precision: 0.4533
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3308
ROC curve saved to .././____________optune_results/163/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/163/plot_loss_curves.jpg
Prediction distribution: {0: 191682, 1: 70462}
ROC curve saved to .././____________optune_results/163/visualize_predictions.jpg
Prediction distribution: {0: 197081, 1: 65063}
ROC curve saved to .././____________optune_results/163/visualize_predictions.jpg
Prediction distribution: {0: 148961, 1: 113183}
ROC curve saved to .././____________optune_results/163/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/163/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/163/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2723891371110498, 1: 0.7576176692391408, 2: 135.9910513090703, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6343017335344325, 4.522414924645331, 1272.1052039778112, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5300
Confusion Matrix:
 [[2633835  417859 1613093     762   37019]
 [ 893129  229928  698415     694   22377]
 [   2401     897    3191       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6399
Class 1 F1: 0.1844
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7463
Class 1 Precision: 0.3545
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5601
Class 1 Recall: 0.1247
Class 2 Recall: 0.4918
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4375
Macro F1 Score: 0.1654
xView2 Score: 0.1499
Epoch 1 took:  0 hours,  1 minutes, 19 seconds

Epoch 2/10
Train Loss: 1.4904
Confusion Matrix:
 [[3523330  312905  862488      10    3835]
 [1102771  303613  434508      27    3624]
 [   2761    1315    2413       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7552
Class 1 F1: 0.2466
Class 2 F1: 0.0037
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7612
Class 1 Precision: 0.4914
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7492
Class 1 Recall: 0.1646
Class 2 Recall: 0.3719
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5843
Macro F1 Score: 0.2011
xView2 Score: 0.1595
Epoch 2 took:  0 hours,  1 minutes, 13 seconds

Epoch 3/10
Train Loss: 1.4497
Confusion Matrix:
 [[3821645  269875  610889       0     159]
 [1217255  277993  349148       0     147]
 [   2871     654    2964       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7844
Class 1 F1: 0.2323
Class 2 F1: 0.0061
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7580
Class 1 Precision: 0.5068
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8127
Class 1 Recall: 0.1507
Class 2 Recall: 0.4568
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6260
Macro F1 Score: 0.2557
xView2 Score: 0.1613
Epoch 3 took:  0 hours,  0 minutes, 44 seconds

Epoch 4/10
Train Loss: 1.4147
Confusion Matrix:
 [[3957227  274875  470455       0      11]
 [1267332  305778  271429       0       4]
 [   4457     515    1517       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7969
Class 1 F1: 0.2521
Class 2 F1: 0.0040
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7568
Class 1 Precision: 0.5261
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8415
Class 1 Recall: 0.1658
Class 2 Recall: 0.2338
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6507
Macro F1 Score: 0.2633
xView2 Score: 0.1611
Epoch 4 took:  0 hours,  0 minutes, 29 seconds

Epoch 5/10
Train Loss: 1.3665
Confusion Matrix:
 [[3817227  437902  447439       0       0]
 [1119403  472060  253080       0       0]
 [   2512    1738    2239       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7918
Class 1 F1: 0.3425
Class 2 F1: 0.0063
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7729
Class 1 Precision: 0.5178
Class 2 Precision: 0.0032
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8117
Class 1 Recall: 0.2559
Class 2 Recall: 0.3450
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6548
Macro F1 Score: 0.3802
xView2 Score: 0.2252
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3196
Confusion Matrix:
 [[3771708  445973  484887       0       0]
 [1047887  503697  292959       0       0]
 [   3042     720    2727       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7919
Class 1 F1: 0.3604
Class 2 F1: 0.0069
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7821
Class 1 Precision: 0.5300
Class 2 Precision: 0.0035
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8021
Class 1 Recall: 0.2731
Class 2 Recall: 0.4202
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6528
Macro F1 Score: 0.3864
xView2 Score: 0.2383
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2819
Confusion Matrix:
 [[3712812  552972  436784       0       0]
 [ 957556  631487  255500       0       0]
 [   1725    2806    1958       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7921
Class 1 F1: 0.4166
Class 2 F1: 0.0056
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7947
Class 1 Precision: 0.5319
Class 2 Precision: 0.0028
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7895
Class 1 Recall: 0.3424
Class 2 Recall: 0.3017
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6632
Macro F1 Score: 0.4048
xView2 Score: 0.2657
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2491
Confusion Matrix:
 [[3710500  627586  364482       0       0]
 [ 935253  699667  209623       0       0]
 [   2716    2016    1757       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7936
Class 1 F1: 0.4409
Class 2 F1: 0.0060
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7982
Class 1 Precision: 0.5264
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7890
Class 1 Recall: 0.3793
Class 2 Recall: 0.2708
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6732
Macro F1 Score: 0.4135
xView2 Score: 0.2778
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2243
Confusion Matrix:
 [[3393509  839596  469463       0       0]
 [ 683110  898400  263033       0       0]
 [   1900    2930    1659       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7729
Class 1 F1: 0.5011
Class 2 F1: 0.0045
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8320
Class 1 Precision: 0.5160
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7216
Class 1 Recall: 0.4871
Class 2 Recall: 0.2557
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6551
Macro F1 Score: 0.4262
xView2 Score: 0.3173
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1833
Confusion Matrix:
 [[3595596  792197  314775       0       0]
 [ 792762  870706  181075       0       0]
 [   2495    2454    1540       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7908
Class 1 F1: 0.4961
Class 2 F1: 0.0061
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8189
Class 1 Precision: 0.5228
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7646
Class 1 Recall: 0.4720
Class 2 Recall: 0.2373
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6817
Macro F1 Score: 0.4310
xView2 Score: 0.3111
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6551
Best Macro F1: 0.4262
Best xView2 Score: 0.3173
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8320
Class 1 Precision: 0.5160
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4501
ROC curve saved to .././____________optune_results/164/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/164/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/164/visualize_predictions.jpg
Prediction distribution: {0: 194085, 1: 19989, 2: 48070}
ROC curve saved to .././____________optune_results/164/visualize_predictions.jpg
Prediction distribution: {0: 101129, 1: 149363, 2: 11652}
ROC curve saved to .././____________optune_results/164/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/164/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/164/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27782125059296586, 1: 0.7186857605496845, 2: 128.5774632775578, 3: 845.4837560893667, 4: 5732.533940774488}
Final class weights used in loss: [2.6868362292707046, 4.290020338232179, 133.94260658367776, 845.4837560893667, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5825
Confusion Matrix:
 [[2216537  250913 2331829  263440    1138]
 [ 425629  144124  806051  108611     248]
 [   1547     194    2183     431       0]
 [    240       0     411       1       0]
 [     68       5       0       0       0]]
Class 0 F1: 0.5751
Class 1 F1: 0.1533
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8383
Class 1 Precision: 0.3647
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4377
Class 1 Recall: 0.0971
Class 2 Recall: 0.5013
Class 3 Recall: 0.0015
Class 4 Recall: 0.0000
Validation Accuracy: 0.3605
Macro F1 Score: 0.1460
xView2 Score: 0.1436
Epoch 1 took:  0 hours,  1 minutes,  2 seconds

Epoch 2/10
Train Loss: 1.4963
Confusion Matrix:
 [[4116257  389594  509294   48620      92]
 [ 947936  262797  246408   27393     129]
 [   2242     724    1382       7       0]
 [    402      24     226       0       0]
 [     53      20       0       0       0]]
Class 0 F1: 0.8126
Class 1 F1: 0.2459
Class 2 F1: 0.0036
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8124
Class 1 Precision: 0.4023
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8129
Class 1 Recall: 0.1770
Class 2 Recall: 0.3173
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6684
Macro F1 Score: 0.2124
xView2 Score: 0.1523
Epoch 2 took:  0 hours,  0 minutes, 39 seconds

Epoch 3/10
Train Loss: 1.4244
Confusion Matrix:
 [[4481301  492446   82569    7541       0]
 [1096150  344252   39014    5247       0]
 [   3667     688       0       0       0]
 [    651       1       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8419
Class 1 F1: 0.2965
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8028
Class 1 Precision: 0.4111
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8850
Class 1 Recall: 0.2319
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7363
Macro F1 Score: 0.2277
xView2 Score: 0.1476
Epoch 3 took:  0 hours,  0 minutes, 28 seconds

Epoch 4/10
Train Loss: 1.3531
Confusion Matrix:
 [[4402403  651676    9548     230       0]
 [ 956514  524683    3237     229       0]
 [   3109    1242       4       0       0]
 [    652       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8445
Class 1 F1: 0.3942
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8209
Class 1 Precision: 0.4456
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8694
Class 1 Recall: 0.3534
Class 2 Recall: 0.0009
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7518
Macro F1 Score: 0.2478
xView2 Score: 0.1917
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2820
Confusion Matrix:
 [[4290168  773437     235      17       0]
 [ 852776  631822      65       0       0]
 [   3210    1145       0       0       0]
 [    652       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8403
Class 1 F1: 0.4371
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8335
Class 1 Precision: 0.4492
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8472
Class 1 Recall: 0.4256
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7510
Macro F1 Score: 0.2555
xView2 Score: 0.2147
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2082
Confusion Matrix:
 [[4077028  986811      18       0       0]
 [ 668706  815924      33       0       0]
 [   2474    1881       0       0       0]
 [    580      72       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8310
Class 1 F1: 0.4961
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8585
Class 1 Precision: 0.4521
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8051
Class 1 Recall: 0.5496
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7466
Macro F1 Score: 0.2654
xView2 Score: 0.2482
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1594
Confusion Matrix:
 [[4074451  989406       0       0       0]
 [ 664199  820464       0       0       0]
 [   2582    1773       0       0       0]
 [    596      56       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8310
Class 1 F1: 0.4978
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8592
Class 1 Precision: 0.4529
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8046
Class 1 Recall: 0.5526
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7469
Macro F1 Score: 0.2658
xView2 Score: 0.2490
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1193
Confusion Matrix:
 [[3911953 1151904       0       0       0]
 [ 548824  935839       0       0       0]
 [   2814    1541       0       0       0]
 [    652       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8211
Class 1 F1: 0.5237
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8763
Class 1 Precision: 0.4479
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7725
Class 1 Recall: 0.6303
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7397
Macro F1 Score: 0.2690
xView2 Score: 0.2653
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0947
Confusion Matrix:
 [[3966506 1097351       0       0       0]
 [ 547245  937418       0       0       0]
 [   2386    1969       0       0       0]
 [    652       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8280
Class 1 F1: 0.5324
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8782
Class 1 Precision: 0.4603
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7833
Class 1 Recall: 0.6314
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7483
Macro F1 Score: 0.2721
xView2 Score: 0.2681
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0299
Confusion Matrix:
 [[3958587 1105270       0       0       0]
 [ 547280  937383       0       0       0]
 [   2766    1589       0       0       0]
 [    652       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8270
Class 1 F1: 0.5313
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8779
Class 1 Precision: 0.4585
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7817
Class 1 Recall: 0.6314
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7471
Macro F1 Score: 0.2717
xView2 Score: 0.2677
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7483
Best Macro F1: 0.2721
Best xView2 Score: 0.2681
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8782
Class 1 Precision: 0.4603
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2677
ROC curve saved to .././____________optune_results/165/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/165/plot_loss_curves.jpg
Prediction distribution: {0: 197794, 1: 64350}
ROC curve saved to .././____________optune_results/165/visualize_predictions.jpg
Prediction distribution: {0: 242188, 1: 19956}
ROC curve saved to .././____________optune_results/165/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/165/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/165/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/165/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27484546796683484, 1: 0.7394572828648103, 2: 128.95961464552, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.658057147205319, 4.414010902786815, 2531.2694678798875, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5765
Confusion Matrix:
 [[ 845829 2139225 1774104   58089   50460]
 [ 295188  783807  545901   35597   20894]
 [   2235     601    1622       0      13]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.2814
Class 1 F1: 0.3404
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7398
Class 1 Precision: 0.2681
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1738
Class 1 Recall: 0.4662
Class 2 Recall: 0.3628
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2489
Macro F1 Score: 0.1246
xView2 Score: 0.2072
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5355
Confusion Matrix:
 [[1784222 1469028 1597624    9286    7547]
 [ 473904  646007  551011    6982    3483]
 [   1256    1505    1663       0      47]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5007
Class 1 F1: 0.3402
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7897
Class 1 Precision: 0.3052
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3665
Class 1 Recall: 0.3842
Class 2 Recall: 0.3720
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3711
Macro F1 Score: 0.1685
xView2 Score: 0.2000
Epoch 2 took:  0 hours,  1 minutes, 15 seconds

Epoch 3/10
Train Loss: 1.4940
Confusion Matrix:
 [[2534064  874822 1456840    1203     778]
 [ 590960  476164  612666     992     605]
 [   1029     313    3126       3       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6340
Class 1 F1: 0.3140
Class 2 F1: 0.0030
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8106
Class 1 Precision: 0.3524
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5206
Class 1 Recall: 0.2832
Class 2 Recall: 0.6992
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4598
Macro F1 Score: 0.1902
xView2 Score: 0.1916
Epoch 3 took:  0 hours,  0 minutes, 49 seconds

Epoch 4/10
Train Loss: 1.4710
Confusion Matrix:
 [[3185158  494905 1187382     129     133]
 [ 621817  364728  694601      94     147]
 [   2088     252    2131       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7342
Class 1 F1: 0.2870
Class 2 F1: 0.0023
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8362
Class 1 Precision: 0.4242
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6543
Class 1 Recall: 0.2169
Class 2 Recall: 0.4766
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5420
Macro F1 Score: 0.2047
xView2 Score: 0.1946
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.4175
Confusion Matrix:
 [[3202661  415344 1249696       0       6]
 [ 594559  353090  733733       3       2]
 [   2092     335    2044       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7390
Class 1 F1: 0.2882
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8430
Class 1 Precision: 0.4593
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6579
Class 1 Recall: 0.2100
Class 2 Recall: 0.4572
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5429
Macro F1 Score: 0.2059
xView2 Score: 0.1965
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3780
Confusion Matrix:
 [[3459538  307095 1101074       0       0]
 [ 639349  306344  735694       0       0]
 [   1635     242    2594       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7715
Class 1 F1: 0.2670
Class 2 F1: 0.0028
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8437
Class 1 Precision: 0.4992
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7107
Class 1 Recall: 0.1822
Class 2 Recall: 0.5802
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5750
Macro F1 Score: 0.2603
xView2 Score: 0.2066
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3359
Confusion Matrix:
 [[3658287  301349  908071       0       0]
 [ 717701  320643  643043       0       0]
 [   1613     328    2530       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7914
Class 1 F1: 0.2784
Class 2 F1: 0.0032
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8357
Class 1 Precision: 0.5152
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7515
Class 1 Recall: 0.1907
Class 2 Recall: 0.5659
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6075
Macro F1 Score: 0.2682
xView2 Score: 0.2076
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3062
Confusion Matrix:
 [[3664881  385575  817251       0       0]
 [ 706069  406516  568802       0       0]
 [   2194    1215    1062       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7932
Class 1 F1: 0.3285
Class 2 F1: 0.0015
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8380
Class 1 Precision: 0.5124
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7529
Class 1 Recall: 0.2418
Class 2 Recall: 0.2375
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6214
Macro F1 Score: 0.2808
xView2 Score: 0.2205
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2796
Confusion Matrix:
 [[3626533  335962  905212       0       0]
 [ 664980  379268  637139       0       0]
 [   1609     149    2713       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7917
Class 1 F1: 0.3165
Class 2 F1: 0.0035
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8447
Class 1 Precision: 0.5302
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7450
Class 1 Recall: 0.2256
Class 2 Recall: 0.6068
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6117
Macro F1 Score: 0.2779
xView2 Score: 0.2209
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2510
Confusion Matrix:
 [[3627389  300002  940316       0       0]
 [ 673337  364818  643232       0       0]
 [   1349     508    2614       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7912
Class 1 F1: 0.3109
Class 2 F1: 0.0033
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8432
Class 1 Precision: 0.5483
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7452
Class 1 Recall: 0.2170
Class 2 Recall: 0.5847
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6096
Macro F1 Score: 0.2763
xView2 Score: 0.2179
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6117
Best Macro F1: 0.2779
Best xView2 Score: 0.2209
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8447
Class 1 Precision: 0.5302
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3442
ROC curve saved to .././____________optune_results/166/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/166/plot_loss_curves.jpg
Prediction distribution: {0: 241980, 1: 3377, 2: 16787}
ROC curve saved to .././____________optune_results/166/visualize_predictions.jpg
Prediction distribution: {0: 188745, 1: 5268, 2: 68131}
ROC curve saved to .././____________optune_results/166/visualize_predictions.jpg
Prediction distribution: {0: 181873, 1: 3968, 2: 76303}
ROC curve saved to .././____________optune_results/166/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/166/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/166/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27194163209560446, 1: 0.7597216125797206, 2: 167.3704708699122, 3: 2085.853626191463, 4: 68947.46301369862}
Final class weights used in loss: [2.6299738691766392, 4.534973904128481, 2606.862873011153, 2085.853626191463, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5333
Confusion Matrix:
 [[2386315  891937 1372255    8659   12995]
 [ 832556  573551  450574    2558    3702]
 [   5975    5143    2254       0      56]
 [   1216    1270    1700       6       0]
 [      8     632     238       0       0]]
Class 0 F1: 0.6043
Class 1 F1: 0.3439
Class 2 F1: 0.0024
Class 3 F1: 0.0008
Class 4 F1: 0.0000
Class 0 Precision: 0.7397
Class 1 Precision: 0.3895
Class 2 Precision: 0.0012
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.5108
Class 1 Recall: 0.3079
Class 2 Recall: 0.1679
Class 3 Recall: 0.0014
Class 4 Recall: 0.0000
Validation Accuracy: 0.4520
Macro F1 Score: 0.1903
xView2 Score: 0.1873
Epoch 1 took:  0 hours,  1 minutes, 14 seconds

Epoch 2/10
Train Loss: 1.5026
Confusion Matrix:
 [[3089923  447325 1131099     663    3151]
 [ 979464  355267  527123     180     907]
 [   7729    4254    1402       0      43]
 [   2446     149    1597       0       0]
 [    105     112     661       0       0]]
Class 0 F1: 0.7061
Class 1 F1: 0.2661
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7574
Class 1 Precision: 0.4402
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6613
Class 1 Recall: 0.1907
Class 2 Recall: 0.1044
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5259
Macro F1 Score: 0.1948
xView2 Score: 0.1683
Epoch 2 took:  0 hours,  1 minutes,  0 seconds

Epoch 3/10
Train Loss: 1.4750
Confusion Matrix:
 [[3235452  270860 1165453     106     290]
 [ 982101  238072  642542      24     202]
 [   8507     784    4110       4      23]
 [   1278     200    2714       0       0]
 [     15     470     393       0       0]]
Class 0 F1: 0.7271
Class 1 F1: 0.2006
Class 2 F1: 0.0045
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7654
Class 1 Precision: 0.4665
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6925
Class 1 Recall: 0.1278
Class 2 Recall: 0.3061
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5306
Macro F1 Score: 0.1864
xView2 Score: 0.1603
Epoch 3 took:  0 hours,  0 minutes, 37 seconds

Epoch 4/10
Train Loss: 1.4356
Confusion Matrix:
 [[3436349  307788  927979      22      23]
 [ 889103  313828  659911       1      98]
 [   9862     778    2782       0       6]
 [    653     373    3166       0       0]
 [      3     429     446       0       0]]
Class 0 F1: 0.7629
Class 1 F1: 0.2525
Class 2 F1: 0.0035
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7925
Class 1 Precision: 0.5036
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7355
Class 1 Recall: 0.1685
Class 2 Recall: 0.2072
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5727
Macro F1 Score: 0.2038
xView2 Score: 0.1852
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.3911
Confusion Matrix:
 [[3303055  269772 1099329       0       5]
 [ 730013  308258  824645       0      25]
 [   7532     918    4977       0       1]
 [   1157      28    3007       0       0]
 [    329     272     277       0       0]]
Class 0 F1: 0.7581
Class 1 F1: 0.2524
Class 2 F1: 0.0051
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8172
Class 1 Precision: 0.5322
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7070
Class 1 Recall: 0.1655
Class 2 Recall: 0.3706
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5518
Macro F1 Score: 0.2031
xView2 Score: 0.1974
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3492
Confusion Matrix:
 [[3367147  283926 1021088       0       0]
 [ 721136  341736  800067       0       2]
 [   6913    1198    5317       0       0]
 [    152     551    3489       0       0]
 [      0     771     107       0       0]]
Class 0 F1: 0.7681
Class 1 F1: 0.2744
Class 2 F1: 0.0058
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8222
Class 1 Precision: 0.5440
Class 2 Precision: 0.0029
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7207
Class 1 Recall: 0.1834
Class 2 Recall: 0.3960
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5667
Macro F1 Score: 0.2096
xView2 Score: 0.2046
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3182
Confusion Matrix:
 [[3253023  306226 1112912       0       0]
 [ 655138  377355  830448       0       0]
 [   8459     372    4597       0       0]
 [     87     171    3934       0       0]
 [      0     221     657       0       0]]
Class 0 F1: 0.7575
Class 1 F1: 0.2963
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8306
Class 1 Precision: 0.5514
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6963
Class 1 Recall: 0.2026
Class 2 Recall: 0.3423
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5547
Macro F1 Score: 0.2117
xView2 Score: 0.2104
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2764
Confusion Matrix:
 [[3157526  350687 1163948       0       0]
 [ 546673  447653  868615       0       0]
 [   8770     796    3862       0       0]
 [      8     385    3799       0       0]
 [      0     695     183       0       0]]
Class 0 F1: 0.7531
Class 1 F1: 0.3362
Class 2 F1: 0.0038
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8504
Class 1 Precision: 0.5594
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6758
Class 1 Recall: 0.2403
Class 2 Recall: 0.2876
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5507
Macro F1 Score: 0.2186
xView2 Score: 0.2239
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2449
Confusion Matrix:
 [[3202439  339481 1130241       0       0]
 [ 580634  435176  847131       0       0]
 [   8516     204    4708       0       0]
 [     75     235    3882       0       0]
 [      0     194     684       0       0]]
Class 0 F1: 0.7567
Class 1 F1: 0.3299
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8446
Class 1 Precision: 0.5613
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6854
Class 1 Recall: 0.2336
Class 2 Recall: 0.3506
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5558
Macro F1 Score: 0.2183
xView2 Score: 0.2215
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1961
Confusion Matrix:
 [[3157915  198964 1315282       0       0]
 [ 572030  287829 1003082       0       0]
 [   7399     314    5715       0       0]
 [    891       0    3301       0       0]
 [      0       3     875       0       0]]
Class 0 F1: 0.7510
Class 1 F1: 0.2450
Class 2 F1: 0.0049
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8448
Class 1 Precision: 0.5909
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6759
Class 1 Recall: 0.1545
Class 2 Recall: 0.4256
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5267
Macro F1 Score: 0.2002
xView2 Score: 0.2052
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5507
Best Macro F1: 0.2186
Best xView2 Score: 0.2239
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8504
Class 1 Precision: 0.5594
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2823
ROC curve saved to .././____________optune_results/167/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/167/plot_loss_curves.jpg
Prediction distribution: {0: 137616, 1: 6251, 2: 118277}
ROC curve saved to .././____________optune_results/167/visualize_predictions.jpg
Prediction distribution: {0: 140615, 1: 23295, 2: 98234}
ROC curve saved to .././____________optune_results/167/visualize_predictions.jpg
Prediction distribution: {0: 80279, 1: 68432, 2: 113433}
ROC curve saved to .././____________optune_results/167/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/167/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/167/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2774528053512626, 1: 0.7211857607945421, 2: 127.4993616374506, 3: 872.601386962552, 4: 5292.497160883281}
Final class weights used in loss: [2.6832729596439293, 4.304943483346146, 2424.4286017784075, 872.601386962552, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6507
Confusion Matrix:
 [[  74559  911720 2850510  545457  657553]
 [  16853  378221  773280   64142  276444]
 [      0     850    2834     188     152]
 [      0      82     484       0     271]
 [      0       0       0       0       0]]
Class 0 F1: 0.0291
Class 1 F1: 0.2702
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8156
Class 1 Precision: 0.2930
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0148
Class 1 Recall: 0.2507
Class 2 Recall: 0.7043
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.0695
Macro F1 Score: 0.0602
xView2 Score: 0.1697
Epoch 1 took:  0 hours,  1 minutes, 23 seconds

Epoch 2/10
Train Loss: 1.6012
Confusion Matrix:
 [[ 332382  963744 3029788  408496  305389]
 [  48672  437981  874148   25895  122244]
 [      4     427    3156      20     417]
 [     16     112     689       0      20]
 [      0       0       0       0       0]]
Class 0 F1: 0.1226
Class 1 F1: 0.3009
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8722
Class 1 Precision: 0.3123
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0660
Class 1 Recall: 0.2903
Class 2 Recall: 0.7843
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1180
Macro F1 Score: 0.0850
xView2 Score: 0.1783
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5613
Confusion Matrix:
 [[1010330  857784 2970384   86795  114506]
 [ 106939  412953  943254    5976   39818]
 [     49     452    3428       0      95]
 [      0     152     680       0       5]
 [      0       0       0       0       0]]
Class 0 F1: 0.3282
Class 1 F1: 0.2971
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9042
Class 1 Precision: 0.3248
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2005
Class 1 Recall: 0.2737
Class 2 Recall: 0.8519
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2177
Macro F1 Score: 0.1254
xView2 Score: 0.1826
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.5183
Confusion Matrix:
 [[1524401  552603 2932205    7536   23054]
 [ 132793  295928 1070543    1704    7972]
 [     68     190    3766       0       0]
 [     11      85     705       0      36]
 [      0       0       0       0       0]]
Class 0 F1: 0.4552
Class 1 F1: 0.2510
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9198
Class 1 Precision: 0.3486
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3025
Class 1 Recall: 0.1961
Class 2 Recall: 0.9359
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2783
Macro F1 Score: 0.1416
xView2 Score: 0.1761
Epoch 4 took:  0 hours,  1 minutes, 23 seconds

Epoch 5/10
Train Loss: 1.4615
Confusion Matrix:
 [[1908944  423337 2704527     741    2250]
 [ 140347  258601 1109356      24     612]
 [    107     133    3784       0       0]
 [      0      37     800       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5386
Class 1 F1: 0.2361
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9315
Class 1 Precision: 0.3791
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3788
Class 1 Recall: 0.1714
Class 2 Recall: 0.9404
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3313
Macro F1 Score: 0.1553
xView2 Score: 0.1788
Epoch 5 took:  0 hours,  1 minutes,  6 seconds

Epoch 6/10
Train Loss: 1.4075
Confusion Matrix:
 [[2186239  295162 2558171      93     134]
 [ 119251  196738 1192897       2      52]
 [    124     172    3728       0       0]
 [      0      59     778       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5953
Class 1 F1: 0.1966
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9482
Class 1 Precision: 0.3998
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4338
Class 1 Recall: 0.1304
Class 2 Recall: 0.9264
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3642
Macro F1 Score: 0.1588
xView2 Score: 0.1784
Epoch 6 took:  0 hours,  0 minutes, 40 seconds

Epoch 7/10
Train Loss: 1.3668
Confusion Matrix:
 [[2401956  281496 2356340       0       7]
 [ 180871  188018 1140031       0      20]
 [   2296     164    1564       0       0]
 [    484       0     353       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6300
Class 1 F1: 0.1900
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9290
Class 1 Precision: 0.4003
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4766
Class 1 Recall: 0.1246
Class 2 Recall: 0.3887
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3954
Macro F1 Score: 0.1642
xView2 Score: 0.1770
Epoch 7 took:  0 hours,  0 minutes, 30 seconds

Epoch 8/10
Train Loss: 1.3446
Confusion Matrix:
 [[2727134  163241 2149424       0       0]
 [ 221483  133006 1154439       0      12]
 [    310      84    3630       0       0]
 [     21       0     816       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6827
Class 1 F1: 0.1474
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9248
Class 1 Precision: 0.4488
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5411
Class 1 Recall: 0.0881
Class 2 Recall: 0.9021
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4370
Macro F1 Score: 0.1665
xView2 Score: 0.1750
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2798
Confusion Matrix:
 [[2908060  226414 1905325       0       0]
 [ 286698  194535 1027706       0       1]
 [   2547      73    1404       0       0]
 [    689      74      74       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7060
Class 1 F1: 0.2016
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9093
Class 1 Precision: 0.4620
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5770
Class 1 Recall: 0.1289
Class 2 Recall: 0.3489
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4736
Macro F1 Score: 0.1817
xView2 Score: 0.1832
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2657
Confusion Matrix:
 [[3053264  192315 1794220       0       0]
 [ 297645  174254 1037041       0       0]
 [    196     223    3605       0       0]
 [    285       0     552       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7277
Class 1 F1: 0.1858
Class 2 F1: 0.0025
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9110
Class 1 Precision: 0.4751
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6058
Class 1 Recall: 0.1155
Class 2 Recall: 0.8959
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4930
Macro F1 Score: 0.2290
xView2 Score: 0.1921
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4930
Best Macro F1: 0.2290
Best xView2 Score: 0.1921
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9110
Class 1 Precision: 0.4751
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3468
ROC curve saved to .././____________optune_results/168/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/168/plot_loss_curves.jpg
Prediction distribution: {0: 146523, 1: 29, 2: 115592}
ROC curve saved to .././____________optune_results/168/visualize_predictions.jpg
Prediction distribution: {0: 74747, 1: 24689, 2: 162708}
ROC curve saved to .././____________optune_results/168/visualize_predictions.jpg
Prediction distribution: {0: 217599, 1: 874, 2: 43671}
ROC curve saved to .././____________optune_results/168/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/168/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/168/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2723970682094454, 1: 0.7569802635101438, 2: 141.0521761062691, 3: 1340.3900932090546, 4: 68947.46301369862}
Final class weights used in loss: [2.6343784359553664, 4.51861008574187, 208.1042087922425, 1340.3900932090546, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5173
Confusion Matrix:
 [[3389543 1222352   10536   51605   29070]
 [1022224  769459    3211   22401   21654]
 [   4516    3279       0      22       0]
 [   2225     473       0     152       0]
 [    825      53       0       0       0]]
Class 0 F1: 0.7431
Class 1 F1: 0.4013
Class 2 F1: 0.0000
Class 3 F1: 0.0039
Class 4 F1: 0.0000
Class 0 Precision: 0.7670
Class 1 Precision: 0.3856
Class 2 Precision: 0.0000
Class 3 Precision: 0.0020
Class 4 Precision: 0.0000
Class 0 Recall: 0.7207
Class 1 Recall: 0.4184
Class 2 Recall: 0.0000
Class 3 Recall: 0.0533
Class 4 Recall: 0.0000
Validation Accuracy: 0.6346
Macro F1 Score: 0.2297
xView2 Score: 0.2077
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4595
Confusion Matrix:
 [[3503655 1191287    1423    3876    2865]
 [ 976787  858034     191    1442    2495]
 [   3573    4244       0       0       0]
 [   2036     808       0       6       0]
 [    649     229       0       0       0]]
Class 0 F1: 0.7625
Class 1 F1: 0.4407
Class 2 F1: 0.0000
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.7809
Class 1 Precision: 0.4176
Class 2 Precision: 0.0000
Class 3 Precision: 0.0011
Class 4 Precision: 0.0000
Class 0 Recall: 0.7450
Class 1 Recall: 0.4666
Class 2 Recall: 0.0000
Class 3 Recall: 0.0021
Class 4 Recall: 0.0000
Validation Accuracy: 0.6655
Macro F1 Score: 0.2409
xView2 Score: 0.2222
Epoch 2 took:  0 hours,  1 minutes, 13 seconds

Epoch 3/10
Train Loss: 1.3967
Confusion Matrix:
 [[3662129 1040590     198      76     113]
 [ 994173  844690      31      11      44]
 [   2319    5498       0       0       0]
 [   2199     651       0       0       0]
 [    784      94       0       0       0]]
Class 0 F1: 0.7821
Class 1 F1: 0.4529
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7856
Class 1 Precision: 0.4466
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7787
Class 1 Recall: 0.4593
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6877
Macro F1 Score: 0.2470
xView2 Score: 0.2244
Epoch 3 took:  0 hours,  0 minutes, 36 seconds

Epoch 4/10
Train Loss: 1.3543
Confusion Matrix:
 [[3276178 1426890      38       0       0]
 [ 700606 1138338       5       0       0]
 [   2839    4978       0       0       0]
 [   1853     997       0       0       0]
 [    509     369       0       0       0]]
Class 0 F1: 0.7544
Class 1 F1: 0.5162
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8227
Class 1 Precision: 0.4427
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6966
Class 1 Recall: 0.6190
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6736
Macro F1 Score: 0.2541
xView2 Score: 0.2621
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2851
Confusion Matrix:
 [[3254015 1449090       1       0       0]
 [ 604517 1234432       0       0       0]
 [   1836    5981       0       0       0]
 [   1674    1176       0       0       0]
 [      8     870       0       0       0]]
Class 0 F1: 0.7598
Class 1 F1: 0.5449
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8426
Class 1 Precision: 0.4586
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6919
Class 1 Recall: 0.6713
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6849
Macro F1 Score: 0.2610
xView2 Score: 0.2763
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2353
Confusion Matrix:
 [[3095526 1607580       0       0       0]
 [ 546397 1292552       0       0       0]
 [   3776    4041       0       0       0]
 [   1170    1680       0       0       0]
 [      1     877       0       0       0]]
Class 0 F1: 0.7414
Class 1 F1: 0.5447
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8488
Class 1 Precision: 0.4447
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6582
Class 1 Recall: 0.7029
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6696
Macro F1 Score: 0.2572
xView2 Score: 0.2792
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1755
Confusion Matrix:
 [[3144723 1558383       0       0       0]
 [ 481416 1357533       0       0       0]
 [   2653    5164       0       0       0]
 [    830    2020       0       0       0]
 [    592     286       0       0       0]]
Class 0 F1: 0.7547
Class 1 F1: 0.5701
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8663
Class 1 Precision: 0.4644
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6686
Class 1 Recall: 0.7382
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6870
Macro F1 Score: 0.2650
xView2 Score: 0.2902
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1348
Confusion Matrix:
 [[3266471 1436635       0       0       0]
 [ 556933 1282016       0       0       0]
 [   3909    3908       0       0       0]
 [    904    1946       0       0       0]
 [    154     724       0       0       0]]
Class 0 F1: 0.7657
Class 1 F1: 0.5618
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8532
Class 1 Precision: 0.4704
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6945
Class 1 Recall: 0.6971
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6940
Macro F1 Score: 0.2655
xView2 Score: 0.2837
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0989
Confusion Matrix:
 [[3021031 1682075       0       0       0]
 [ 491790 1347159       0       0       0]
 [   4180    3637       0       0       0]
 [    682    2168       0       0       0]
 [     98     780       0       0       0]]
Class 0 F1: 0.7350
Class 1 F1: 0.5527
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8588
Class 1 Precision: 0.4438
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6423
Class 1 Recall: 0.7326
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6665
Macro F1 Score: 0.2575
xView2 Score: 0.2844
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0661
Confusion Matrix:
 [[3136792 1566314       0       0       0]
 [ 553133 1285816       0       0       0]
 [   3905    3912       0       0       0]
 [    979    1871       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7470
Class 1 F1: 0.5474
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8490
Class 1 Precision: 0.4498
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6670
Class 1 Recall: 0.6992
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6748
Macro F1 Score: 0.2589
xView2 Score: 0.2796
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6870
Best Macro F1: 0.2650
Best xView2 Score: 0.2902
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8663
Class 1 Precision: 0.4644
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2661
ROC curve saved to .././____________optune_results/169/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/169/plot_loss_curves.jpg
Prediction distribution: {0: 64021, 1: 198123}
ROC curve saved to .././____________optune_results/169/visualize_predictions.jpg
Prediction distribution: {0: 168992, 1: 93152}
ROC curve saved to .././____________optune_results/169/visualize_predictions.jpg
Prediction distribution: {0: 244395, 1: 17749}
ROC curve saved to .././____________optune_results/169/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/169/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/169/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2724030684364727, 1: 0.7570418606526049, 2: 152.96978391028173, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6344364647322376, 4.518977774944079, 526.7685521367754, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5688
Confusion Matrix:
 [[1399563 2941918   28443    5006  328583]
 [ 444420 1233728    2776    2895  155671]
 [   1610    8173       0       0     814]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4274
Class 1 F1: 0.4097
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7583
Class 1 Precision: 0.2949
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2976
Class 1 Recall: 0.6707
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4018
Macro F1 Score: 0.1674
xView2 Score: 0.2406
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5184
Confusion Matrix:
 [[2227870 2422880    8360     943   43460]
 [ 637077 1179379    1378     677   20979]
 [   2804    7477       1      15     300]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5885
Class 1 F1: 0.4329
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7769
Class 1 Precision: 0.3267
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4737
Class 1 Recall: 0.6411
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5199
Macro F1 Score: 0.2043
xView2 Score: 0.2403
Epoch 2 took:  0 hours,  1 minutes, 19 seconds

Epoch 3/10
Train Loss: 1.4693
Confusion Matrix:
 [[2846145 1852802     482      35    4049]
 [ 761656 1075889     259      28    1658]
 [   4299    6298       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6845
Class 1 F1: 0.4507
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7879
Class 1 Precision: 0.3666
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6051
Class 1 Recall: 0.5849
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5985
Macro F1 Score: 0.2270
xView2 Score: 0.2389
Epoch 3 took:  0 hours,  1 minutes, 12 seconds

Epoch 4/10
Train Loss: 1.4274
Confusion Matrix:
 [[2995896 1707412      36       0     169]
 [ 661115 1178147     118       0     110]
 [   4648    5949       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7163
Class 1 F1: 0.4981
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8182
Class 1 Precision: 0.4075
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6369
Class 1 Recall: 0.6405
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6369
Macro F1 Score: 0.3036
xView2 Score: 0.2862
Epoch 4 took:  0 hours,  0 minutes, 42 seconds

Epoch 5/10
Train Loss: 1.3711
Confusion Matrix:
 [[2956535 1746946      26       0       6]
 [ 527372 1312070      45       0       3]
 [   3793    6804       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7219
Class 1 F1: 0.5350
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8477
Class 1 Precision: 0.4280
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6286
Class 1 Recall: 0.7133
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6513
Macro F1 Score: 0.3142
xView2 Score: 0.3064
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3179
Confusion Matrix:
 [[3099848 1603665       0       0       0]
 [ 533418 1306056      15       0       1]
 [   4668    5929       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7432
Class 1 F1: 0.5493
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8521
Class 1 Precision: 0.4479
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6590
Class 1 Recall: 0.7100
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6723
Macro F1 Score: 0.3231
xView2 Score: 0.3102
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2775
Confusion Matrix:
 [[2965937 1737576       0       0       0]
 [ 475197 1364293       0       0       0]
 [   4556    6041       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7279
Class 1 F1: 0.5515
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8608
Class 1 Precision: 0.4390
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6306
Class 1 Recall: 0.7417
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6607
Macro F1 Score: 0.4265
xView2 Score: 0.3642
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2396
Confusion Matrix:
 [[3058134 1645379       0       0       0]
 [ 495078 1344412       0       0       0]
 [   4093    6504       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7404
Class 1 F1: 0.5560
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8597
Class 1 Precision: 0.4487
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6502
Class 1 Recall: 0.7309
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6718
Macro F1 Score: 0.4321
xView2 Score: 0.3639
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2042
Confusion Matrix:
 [[3022790 1680723       0       0       0]
 [ 462997 1376493       0       0       0]
 [   4908    5689       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7378
Class 1 F1: 0.5616
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8660
Class 1 Precision: 0.4494
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6427
Class 1 Recall: 0.7483
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6713
Macro F1 Score: 0.4331
xView2 Score: 0.3682
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1669
Confusion Matrix:
 [[3055672 1647841       0       0       0]
 [ 494955 1344535       0       0       0]
 [   5675    4922       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7399
Class 1 F1: 0.5560
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8592
Class 1 Precision: 0.4486
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6497
Class 1 Recall: 0.7309
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6714
Macro F1 Score: 0.4320
xView2 Score: 0.3638
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6713
Best Macro F1: 0.4331
Best xView2 Score: 0.3682
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8660
Class 1 Precision: 0.4494
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4385
ROC curve saved to .././____________optune_results/170/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/170/plot_loss_curves.jpg
Prediction distribution: {0: 158366, 1: 103778}
ROC curve saved to .././____________optune_results/170/visualize_predictions.jpg
Prediction distribution: {0: 49738, 1: 212406}
ROC curve saved to .././____________optune_results/170/visualize_predictions.jpg
Prediction distribution: {0: 208051, 1: 54093}
ROC curve saved to .././____________optune_results/170/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/170/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/170/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27275332293765164, 1: 0.7530856047604584, 2: 208.07659680019844, 3: 1007.2373023814289, 4: 68947.46301369862}
Final class weights used in loss: [2.6378238099451186, 4.495361864942497, 288.30728300960567, 1007.2373023814289, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6280
Confusion Matrix:
 [[  50548 4115839  192622  365818    2413]
 [  17586 1604675   45516  135239    1547]
 [     94   15533    1315    2368       1]
 [      0    1608       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.0211
Class 1 F1: 0.4255
Class 2 F1: 0.0102
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7409
Class 1 Precision: 0.2796
Class 2 Precision: 0.0055
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0107
Class 1 Recall: 0.8892
Class 2 Recall: 0.0681
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2528
Macro F1 Score: 0.0913
xView2 Score: 0.2672
Epoch 1 took:  0 hours,  1 minutes,  7 seconds

Epoch 2/10
Train Loss: 1.5565
Confusion Matrix:
 [[ 306041 4163715  135711  121244     529]
 [  69102 1673849   27273   33958     381]
 [    933   17913     219     246       0]
 [      0    1599       9       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.1199
Class 1 F1: 0.4369
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8138
Class 1 Precision: 0.2857
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0647
Class 1 Recall: 0.9276
Class 2 Recall: 0.0113
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3021
Macro F1 Score: 0.1118
xView2 Score: 0.2669
Epoch 2 took:  0 hours,  0 minutes, 40 seconds

Epoch 3/10
Train Loss: 1.4957
Confusion Matrix:
 [[1014118 3649764   44730   18233     395]
 [ 138696 1654113    7952    3776      26]
 [   1572   17618      80      41       0]
 [    278    1310      20       0       0]
 [     70     733      75       0       0]]
Class 0 F1: 0.3448
Class 1 F1: 0.4641
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8782
Class 1 Precision: 0.3107
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2145
Class 1 Recall: 0.9166
Class 2 Recall: 0.0041
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4072
Macro F1 Score: 0.1622
xView2 Score: 0.2740
Epoch 3 took:  0 hours,  0 minutes, 27 seconds

Epoch 4/10
Train Loss: 1.4255
Confusion Matrix:
 [[2283747 2432115   10107    1165     106]
 [ 221659 1580899    1667     337       1]
 [   4014   15289       8       0       0]
 [     70    1538       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.6312
Class 1 F1: 0.5418
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9100
Class 1 Precision: 0.3922
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4831
Class 1 Recall: 0.8761
Class 2 Recall: 0.0004
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5897
Macro F1 Score: 0.2347
xView2 Score: 0.2938
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3645
Confusion Matrix:
 [[2791463 1933759    1514     504       0]
 [ 280286 1523891     238     148       0]
 [   7031   12277       3       0       0]
 [     36    1572       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7152
Class 1 F1: 0.5776
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9067
Class 1 Precision: 0.4389
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5905
Class 1 Recall: 0.8445
Class 2 Recall: 0.0002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6585
Macro F1 Score: 0.2586
xView2 Score: 0.3019
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3093
Confusion Matrix:
 [[2939591 1787547     102       0       0]
 [ 347476 1457067      20       0       0]
 [  14240    5071       0       0       0]
 [    228    1380       0       0       0]
 [     71     807       0       0       0]]
Class 0 F1: 0.7323
Class 1 F1: 0.5763
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8904
Class 1 Precision: 0.4481
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6218
Class 1 Recall: 0.8074
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6709
Macro F1 Score: 0.2617
xView2 Score: 0.2978
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2436
Confusion Matrix:
 [[2982980 1744256       4       0       0]
 [ 325058 1479505       0       0       0]
 [  10861    8450       0       0       0]
 [     85    1523       0       0       0]
 [     29     849       0       0       0]]
Class 0 F1: 0.7415
Class 1 F1: 0.5872
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8988
Class 1 Precision: 0.4574
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6310
Class 1 Recall: 0.8199
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6809
Macro F1 Score: 0.2657
xView2 Score: 0.3024
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1992
Confusion Matrix:
 [[3178717 1548523       0       0       0]
 [ 435714 1368849       0       0       0]
 [  12712    6599       0       0       0]
 [    291    1317       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7609
Class 1 F1: 0.5787
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8763
Class 1 Precision: 0.4678
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6724
Class 1 Recall: 0.7585
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6939
Macro F1 Score: 0.2679
xView2 Score: 0.2944
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1543
Confusion Matrix:
 [[3141627 1585613       0       0       0]
 [ 397237 1407326       0       0       0]
 [  13181    6130       0       0       0]
 [   1044     564       0       0       0]
 [     12     866       0       0       0]]
Class 0 F1: 0.7588
Class 1 F1: 0.5858
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8842
Class 1 Precision: 0.4690
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6646
Class 1 Recall: 0.7799
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6941
Macro F1 Score: 0.2689
xView2 Score: 0.2983
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1200
Confusion Matrix:
 [[3261304 1465936       0       0       0]
 [ 469283 1335280       0       0       0]
 [  15291    4020       0       0       0]
 [      2    1606       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7698
Class 1 F1: 0.5790
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8706
Class 1 Precision: 0.4756
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6899
Class 1 Recall: 0.7399
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7014
Macro F1 Score: 0.2698
xView2 Score: 0.2926
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6809
Best Macro F1: 0.2657
Best xView2 Score: 0.3024
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8988
Class 1 Precision: 0.4574
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2712
ROC curve saved to .././____________optune_results/171/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/171/plot_loss_curves.jpg
Prediction distribution: {0: 183980, 1: 78164}
ROC curve saved to .././____________optune_results/171/visualize_predictions.jpg
Prediction distribution: {0: 23030, 1: 239114}
ROC curve saved to .././____________optune_results/171/visualize_predictions.jpg
Prediction distribution: {0: 209554, 1: 52590}
ROC curve saved to .././____________optune_results/171/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/171/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/171/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2752623889860148, 1: 0.7359757991356333, 2: 143.30110753637217, 3: 826.7353482260183, 4: 5732.533940774488}
Final class weights used in loss: [2.662089230772311, 4.393229030061286, 624.8530964482306, 826.7353482260183, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5685
Confusion Matrix:
 [[2405598 1123071 1168838   78992  118945]
 [ 629712  415700  504816   48587   50374]
 [   4673    2011    1204       6     483]
 [    118     314      85       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.6063
Class 1 F1: 0.2606
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7913
Class 1 Precision: 0.2697
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4914
Class 1 Recall: 0.2521
Class 2 Recall: 0.1437
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4307
Macro F1 Score: 0.1737
xView2 Score: 0.1757
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5144
Confusion Matrix:
 [[3342633 1068241  447110   16824   20636]
 [ 873105  534782  220534   13150    7618]
 [   4499    2786    1043       0      49]
 [    191     255      71       0       0]
 [     37      10      26       0       0]]
Class 0 F1: 0.7334
Class 1 F1: 0.3286
Class 2 F1: 0.0031
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7920
Class 1 Precision: 0.3330
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6828
Class 1 Recall: 0.3243
Class 2 Recall: 0.1245
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5918
Macro F1 Score: 0.2130
xView2 Score: 0.1870
Epoch 2 took:  0 hours,  1 minutes, 15 seconds

Epoch 3/10
Train Loss: 1.4663
Confusion Matrix:
 [[3809680  959548  123020    2062    1134]
 [ 982906  588611   75821    1379     472]
 [   4946    2757     674       0       0]
 [    277     128     112       0       0]
 [     59      11       3       0       0]]
Class 0 F1: 0.7860
Class 1 F1: 0.3679
Class 2 F1: 0.0065
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7940
Class 1 Precision: 0.3795
Class 2 Precision: 0.0034
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7782
Class 1 Recall: 0.3569
Class 2 Recall: 0.0805
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6712
Macro F1 Score: 0.2321
xView2 Score: 0.1935
Epoch 3 took:  0 hours,  0 minutes, 52 seconds

Epoch 4/10
Train Loss: 1.4157
Confusion Matrix:
 [[3887222  959566   48472      36     148]
 [ 938310  682462   28218     184      15]
 [   4020    4235     122       0       0]
 [    183     293      41       0       0]
 [     69       4       0       0       0]]
Class 0 F1: 0.7994
Class 1 F1: 0.4141
Class 2 F1: 0.0029
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8048
Class 1 Precision: 0.4145
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7940
Class 1 Recall: 0.4138
Class 2 Recall: 0.0146
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6973
Macro F1 Score: 0.2433
xView2 Score: 0.2097
Epoch 4 took:  0 hours,  0 minutes, 31 seconds

Epoch 5/10
Train Loss: 1.3543
Confusion Matrix:
 [[3824865 1059575   10996       7       1]
 [ 847750  795284    6138      17       0]
 [   4523    3850       4       0       0]
 [    306     206       5       0       0]
 [     71       2       0       0       0]]
Class 0 F1: 0.7991
Class 1 F1: 0.4534
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8177
Class 1 Precision: 0.4278
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7813
Class 1 Recall: 0.4822
Class 2 Recall: 0.0005
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7050
Macro F1 Score: 0.2506
xView2 Score: 0.2278
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.2996
Confusion Matrix:
 [[3611323 1281380    2741       0       0]
 [ 713925  934055    1204       5       0]
 [   4015    4362       0       0       0]
 [    389     128       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7829
Class 1 F1: 0.4828
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8341
Class 1 Precision: 0.4208
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7377
Class 1 Recall: 0.5664
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6936
Macro F1 Score: 0.2532
xView2 Score: 0.2463
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2648
Confusion Matrix:
 [[3633438 1261891     115       0       0]
 [ 665074  984003     112       0       0]
 [   2995    5382       0       0       0]
 [    370     147       0       0       0]
 [     70       3       0       0       0]]
Class 0 F1: 0.7901
Class 1 F1: 0.5045
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8446
Class 1 Precision: 0.4371
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7422
Class 1 Recall: 0.5967
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7046
Macro F1 Score: 0.2589
xView2 Score: 0.2563
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2191
Confusion Matrix:
 [[3521066 1374366      12       0       0]
 [ 611609 1037571       9       0       0]
 [   3158    5219       0       0       0]
 [     21     496       0       0       0]
 [      0      73       0       0       0]]
Class 0 F1: 0.7797
Class 1 F1: 0.5102
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8514
Class 1 Precision: 0.4292
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7193
Class 1 Recall: 0.6291
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6956
Macro F1 Score: 0.2580
xView2 Score: 0.2615
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1596
Confusion Matrix:
 [[3470640 1424802       2       0       0]
 [ 541136 1108047       6       0       0]
 [   2661    5716       0       0       0]
 [    189     328       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7790
Class 1 F1: 0.5291
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8645
Class 1 Precision: 0.4364
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7090
Class 1 Recall: 0.6719
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6987
Macro F1 Score: 0.2616
xView2 Score: 0.2715
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1617
Confusion Matrix:
 [[3415700 1479679      65       0       0]
 [ 548167 1101022       0       0       0]
 [   3454    4923       0       0       0]
 [    189     328       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7708
Class 1 F1: 0.5199
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8609
Class 1 Precision: 0.4258
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6977
Class 1 Recall: 0.6676
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6892
Macro F1 Score: 0.2581
xView2 Score: 0.2683
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6987
Best Macro F1: 0.2616
Best xView2 Score: 0.2715
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8645
Class 1 Precision: 0.4364
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2602
ROC curve saved to .././____________optune_results/172/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/172/plot_loss_curves.jpg
Prediction distribution: {0: 98601, 1: 163543}
ROC curve saved to .././____________optune_results/172/visualize_predictions.jpg
Prediction distribution: {0: 243443, 1: 18701}
ROC curve saved to .././____________optune_results/172/visualize_predictions.jpg
Prediction distribution: {0: 184724, 1: 77420}
ROC curve saved to .././____________optune_results/172/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/172/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/172/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27101428337968997, 1: 0.766853510940522, 2: 175.68991901703436, 3: 2374.1343396226416, 4: 68947.46301369862}
Final class weights used in loss: [2.621005389905278, 4.577546041629358, 478.89148589957546, 2374.1343396226416, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5263
Confusion Matrix:
 [[2350978 1834147   12331  396601   14773]
 [ 769610 1015098    4195  129730    5922]
 [   9423    4769       3     641      16]
 [   2490    1573       0     421       1]
 [    490      59       0     329       0]]
Class 0 F1: 0.6073
Class 1 F1: 0.4247
Class 2 F1: 0.0002
Class 3 F1: 0.0016
Class 4 F1: 0.0000
Class 0 Precision: 0.7504
Class 1 Precision: 0.3555
Class 2 Precision: 0.0002
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.5101
Class 1 Recall: 0.5274
Class 2 Recall: 0.0002
Class 3 Recall: 0.0939
Class 4 Recall: 0.0000
Validation Accuracy: 0.5137
Macro F1 Score: 0.2068
xView2 Score: 0.2274
Epoch 1 took:  0 hours,  1 minutes, 19 seconds

Epoch 2/10
Train Loss: 1.4670
Confusion Matrix:
 [[2732964 1786552    3229   84519    1566]
 [ 760412 1141737     666   21270     470]
 [   7810    6790       0     228      24]
 [   2941    1487       0      57       0]
 [    715     156       0       7       0]]
Class 0 F1: 0.6737
Class 1 F1: 0.4697
Class 2 F1: 0.0000
Class 3 F1: 0.0010
Class 4 F1: 0.0000
Class 0 Precision: 0.7798
Class 1 Precision: 0.3888
Class 2 Precision: 0.0000
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.5930
Class 1 Recall: 0.5932
Class 2 Recall: 0.0000
Class 3 Recall: 0.0127
Class 4 Recall: 0.0000
Validation Accuracy: 0.5912
Macro F1 Score: 0.2289
xView2 Score: 0.2455
Epoch 2 took:  0 hours,  1 minutes,  1 seconds

Epoch 3/10
Train Loss: 1.4229
Confusion Matrix:
 [[2938320 1655582     744   13792     392]
 [ 835204 1086395      94    2817      45]
 [   9046    5747       0      59       0]
 [   3508     977       0       0       0]
 [     65     813       0       0       0]]
Class 0 F1: 0.7000
Class 1 F1: 0.4649
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7761
Class 1 Precision: 0.3951
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6375
Class 1 Recall: 0.5645
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6141
Macro F1 Score: 0.2330
xView2 Score: 0.2404
Epoch 3 took:  0 hours,  0 minutes, 35 seconds

Epoch 4/10
Train Loss: 1.3701
Confusion Matrix:
 [[2791303 1815347     371    1795      14]
 [ 663244 1260949      44     318       0]
 [   9331    5521       0       0       0]
 [   2968    1517       0       0       0]
 [    468     410       0       0       0]]
Class 0 F1: 0.6912
Class 1 F1: 0.5035
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8050
Class 1 Precision: 0.4089
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6056
Class 1 Recall: 0.6552
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6183
Macro F1 Score: 0.2390
xView2 Score: 0.2619
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.3223
Confusion Matrix:
 [[2984208 1624527      70      25       0]
 [ 742702 1181789       0      64       0]
 [   7696    7156       0       0       0]
 [   1963    2522       0       0       0]
 [     15     863       0       0       0]]
Class 0 F1: 0.7152
Class 1 F1: 0.4985
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7986
Class 1 Precision: 0.4195
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6475
Class 1 Recall: 0.6141
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6357
Macro F1 Score: 0.2427
xView2 Score: 0.2564
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.2505
Confusion Matrix:
 [[3099637 1509190       0       3       0]
 [ 777802 1146751       0       2       0]
 [   8104    6748       0       0       0]
 [   2807    1678       0       0       0]
 [    420     458       0       0       0]]
Class 0 F1: 0.7295
Class 1 F1: 0.4997
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7971
Class 1 Precision: 0.4303
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6725
Class 1 Recall: 0.5959
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6479
Macro F1 Score: 0.2459
xView2 Score: 0.2547
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2226
Confusion Matrix:
 [[2590482 2018348       0       0       0]
 [ 505012 1419543       0       0       0]
 [   6666    8186       0       0       0]
 [    683    3802       0       0       0]
 [      4     874       0       0       0]]
Class 0 F1: 0.6718
Class 1 F1: 0.5282
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8349
Class 1 Precision: 0.4114
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5621
Class 1 Recall: 0.7376
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6119
Macro F1 Score: 0.2400
xView2 Score: 0.2777
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1669
Confusion Matrix:
 [[2742204 1866626       0       0       0]
 [ 557309 1367246       0       0       0]
 [   8398    6454       0       0       0]
 [    978    3507       0       0       0]
 [     12     866       0       0       0]]
Class 0 F1: 0.6927
Class 1 F1: 0.5290
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8287
Class 1 Precision: 0.4214
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5950
Class 1 Recall: 0.7104
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6271
Macro F1 Score: 0.2443
xView2 Score: 0.2752
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1187
Confusion Matrix:
 [[2446381 2162449       0       0       0]
 [ 486380 1438175       0       0       0]
 [   5171    9681       0       0       0]
 [    789    3696       0       0       0]
 [     45     833       0       0       0]]
Class 0 F1: 0.6483
Class 1 F1: 0.5193
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8325
Class 1 Precision: 0.3979
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5308
Class 1 Recall: 0.7473
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5927
Macro F1 Score: 0.2335
xView2 Score: 0.2760
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1011
Confusion Matrix:
 [[2757382 1851448       0       0       0]
 [ 552755 1371800       0       0       0]
 [   8998    5854       0       0       0]
 [   1287    3198       0       0       0]
 [     10     868       0       0       0]]
Class 0 F1: 0.6955
Class 1 F1: 0.5319
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8304
Class 1 Precision: 0.4243
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5983
Class 1 Recall: 0.7128
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6301
Macro F1 Score: 0.2455
xView2 Score: 0.2763
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6119
Best Macro F1: 0.2400
Best xView2 Score: 0.2777
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8349
Class 1 Precision: 0.4114
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2492
ROC curve saved to .././____________optune_results/173/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/173/plot_loss_curves.jpg
Prediction distribution: {0: 14027, 1: 248117}
ROC curve saved to .././____________optune_results/173/visualize_predictions.jpg
Prediction distribution: {0: 244936, 1: 17208}
ROC curve saved to .././____________optune_results/173/visualize_predictions.jpg
Prediction distribution: {0: 16339, 1: 245805}
ROC curve saved to .././____________optune_results/173/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/173/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/173/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27495657543702623, 1: 0.7386913043631407, 2: 125.82597435064123, 3: 837.0471977382339, 4: 5732.533940774488}
Final class weights used in loss: [2.659131678313417, 4.4094385799008045, 179.85540149818482, 837.0471977382339, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5881
Confusion Matrix:
 [[1352261 1457540 1882227  174084    8995]
 [ 335145  829197  461668   46461    1858]
 [    729    1986     779       2       3]
 [    172     404      14       2       0]
 [     67       0       1       5       0]]
Class 0 F1: 0.4121
Class 1 F1: 0.4184
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8009
Class 1 Precision: 0.3622
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2774
Class 1 Recall: 0.4952
Class 2 Recall: 0.2226
Class 3 Recall: 0.0034
Class 4 Recall: 0.0000
Validation Accuracy: 0.3330
Macro F1 Score: 0.1662
xView2 Score: 0.2162
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5220
Confusion Matrix:
 [[3192404 1083799  537128   60486    1290]
 [ 680003  807329  167487   19313     197]
 [   1890    1303     303       3       0]
 [    581      11       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7297
Class 1 F1: 0.4527
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8239
Class 1 Precision: 0.4266
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6548
Class 1 Recall: 0.4822
Class 2 Recall: 0.0866
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6104
Macro F1 Score: 0.2366
xView2 Score: 0.2287
Epoch 2 took:  0 hours,  1 minutes,  8 seconds

Epoch 3/10
Train Loss: 1.4592
Confusion Matrix:
 [[3604983 1155361  107134    7430     199]
 [ 734461  900665   36242    2961       0]
 [   2854     642       3       0       0]
 [    592       0       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7822
Class 1 F1: 0.4828
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8301
Class 1 Precision: 0.4379
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7395
Class 1 Recall: 0.5379
Class 2 Recall: 0.0009
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6875
Macro F1 Score: 0.2530
xView2 Score: 0.2430
Epoch 3 took:  0 hours,  0 minutes, 39 seconds

Epoch 4/10
Train Loss: 1.3933
Confusion Matrix:
 [[3411809 1453775    9309     213       1]
 [ 509866 1160718    3630     115       0]
 [   1835    1660       4       0       0]
 [    299     293       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7755
Class 1 F1: 0.5410
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8695
Class 1 Precision: 0.4436
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6998
Class 1 Recall: 0.6932
Class 2 Recall: 0.0011
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6977
Macro F1 Score: 0.2634
xView2 Score: 0.2772
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3240
Confusion Matrix:
 [[3445638 1427330    2117      22       0]
 [ 527240 1146708     377       4       0]
 [   3009     490       0       0       0]
 [    444     148       0       0       0]
 [     58      15       0       0       0]]
Class 0 F1: 0.7785
Class 1 F1: 0.5398
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8665
Class 1 Precision: 0.4454
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7068
Class 1 Recall: 0.6849
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7007
Macro F1 Score: 0.2637
xView2 Score: 0.2756
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.2714
Confusion Matrix:
 [[3311603 1563177     319       8       0]
 [ 427092 1247180      57       0       0]
 [   1491    2008       0       0       0]
 [    299     293       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7687
Class 1 F1: 0.5559
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8853
Class 1 Precision: 0.4434
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6793
Class 1 Recall: 0.7449
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6956
Macro F1 Score: 0.2649
xView2 Score: 0.2864
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2062
Confusion Matrix:
 [[3376240 1498865       2       0       0]
 [ 498816 1175513       0       0       0]
 [   2929     570       0       0       0]
 [    254     338       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7714
Class 1 F1: 0.5405
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8705
Class 1 Precision: 0.4394
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6925
Class 1 Recall: 0.7021
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6945
Macro F1 Score: 0.2624
xView2 Score: 0.2776
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1462
Confusion Matrix:
 [[3285480 1589627       0       0       0]
 [ 389157 1285172       0       0       0]
 [   2592     907       0       0       0]
 [    110     482       0       0       0]
 [     22      51       0       0       0]]
Class 0 F1: 0.7683
Class 1 F1: 0.5648
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8934
Class 1 Precision: 0.4468
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6739
Class 1 Recall: 0.7676
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6974
Macro F1 Score: 0.2666
xView2 Score: 0.2910
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1100
Confusion Matrix:
 [[3381472 1493635       0       0       0]
 [ 434155 1240174       0       0       0]
 [   2777     722       0       0       0]
 [    176     416       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7779
Class 1 F1: 0.5625
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8855
Class 1 Precision: 0.4535
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6936
Class 1 Recall: 0.7407
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7052
Macro F1 Score: 0.2681
xView2 Score: 0.2879
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.0837
Confusion Matrix:
 [[3374386 1500721       0       0       0]
 [ 431535 1242794       0       0       0]
 [   2585     914       0       0       0]
 [    110     482       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7772
Class 1 F1: 0.5624
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8860
Class 1 Precision: 0.4528
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6922
Class 1 Recall: 0.7423
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7045
Macro F1 Score: 0.2679
xView2 Score: 0.2880
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6974
Best Macro F1: 0.2666
Best xView2 Score: 0.2910
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8934
Class 1 Precision: 0.4468
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2681
ROC curve saved to .././____________optune_results/174/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/174/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/174/visualize_predictions.jpg
Prediction distribution: {0: 153790, 1: 108354}
ROC curve saved to .././____________optune_results/174/visualize_predictions.jpg
Prediction distribution: {0: 259004, 1: 3140}
ROC curve saved to .././____________optune_results/174/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/174/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/174/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.34206705528960124, 1: 0.9346031685668095, 2: 169.31632488293235, 3: 1393.4564784053157}
Final class weights used in loss: [3.3081636305013307, 5.5788869369851195, 314.84080730070633, 1393.4564784053157, 1.0]

Epoch 1/10
Train Loss: 1.5973
Confusion Matrix:
 [[1691360 1223746  879289  691096  302460]
 [ 418287  617968  413257  257180   49574]
 [    944    1379    1072    2804     143]
 [    877     330     162     721       0]
 [    307      87      19     538       0]]
Class 0 F1: 0.4903
Class 1 F1: 0.3433
Class 2 F1: 0.0016
Class 3 F1: 0.0015
Class 4 F1: 0.0000
Class 0 Precision: 0.8009
Class 1 Precision: 0.3352
Class 2 Precision: 0.0008
Class 3 Precision: 0.0008
Class 4 Precision: 0.0000
Class 0 Recall: 0.3533
Class 1 Recall: 0.3519
Class 2 Recall: 0.1690
Class 3 Recall: 0.3450
Class 4 Recall: 0.0000
Validation Accuracy: 0.3526
Macro F1 Score: 0.1674
xView2 Score: 0.2043
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5269
Confusion Matrix:
 [[3032359 1319110  276172  100254   60056]
 [ 818918  759113  133232   39415    5588]
 [   3414    2356     455     117       0]
 [   1636     241     167      46       0]
 [    916      35       0       0       0]]
Class 0 F1: 0.7015
Class 1 F1: 0.3957
Class 2 F1: 0.0022
Class 3 F1: 0.0006
Class 4 F1: 0.0000
Class 0 Precision: 0.7861
Class 1 Precision: 0.3648
Class 2 Precision: 0.0011
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.6333
Class 1 Recall: 0.4322
Class 2 Recall: 0.0717
Class 3 Recall: 0.0220
Class 4 Recall: 0.0000
Validation Accuracy: 0.5786
Macro F1 Score: 0.2200
xView2 Score: 0.2121
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4628
Confusion Matrix:
 [[3445391 1269820   54641   10605    7494]
 [ 864743  863627   23323    4336     237]
 [   2953    3347      32      10       0]
 [   1135     916      39       0       0]
 [    415     525       0      11       0]]
Class 0 F1: 0.7570
Class 1 F1: 0.4435
Class 2 F1: 0.0008
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7985
Class 1 Precision: 0.4039
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7196
Class 1 Recall: 0.4917
Class 2 Recall: 0.0050
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6575
Macro F1 Score: 0.2403
xView2 Score: 0.2267
Epoch 3 took:  0 hours,  0 minutes, 55 seconds

Epoch 4/10
Train Loss: 1.4061
Confusion Matrix:
 [[3524811 1257193    4279    1245     423]
 [ 790583  963026    2157     495       5]
 [   4248    2094       0       0       0]
 [   1311     779       0       0       0]
 [    245     706       0       0       0]]
Class 0 F1: 0.7739
Class 1 F1: 0.4839
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8157
Class 1 Precision: 0.4331
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7362
Class 1 Recall: 0.5483
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6848
Macro F1 Score: 0.2516
xView2 Score: 0.2445
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.3342
Confusion Matrix:
 [[3400568 1387029     199     134      21]
 [ 687201 1068951     105       9       0]
 [   4585    1757       0       0       0]
 [    851    1239       0       0       0]
 [     83     868       0       0       0]]
Class 0 F1: 0.7658
Class 1 F1: 0.5071
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8308
Class 1 Precision: 0.4346
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7102
Class 1 Recall: 0.6086
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6820
Macro F1 Score: 0.2546
xView2 Score: 0.2581
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.2841
Confusion Matrix:
 [[3422009 1365931      10       1       0]
 [ 650161 1106099       6       0       0]
 [   4934    1408       0       0       0]
 [    933    1157       0       0       0]
 [     73     878       0       0       0]]
Class 0 F1: 0.7719
Class 1 F1: 0.5228
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8391
Class 1 Precision: 0.4468
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7147
Class 1 Recall: 0.6298
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6909
Macro F1 Score: 0.2589
xView2 Score: 0.2650
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2204
Confusion Matrix:
 [[3350840 1437111       0       0       0]
 [ 599622 1156638       6       0       0]
 [   4935    1407       0       0       0]
 [    667    1423       0       0       0]
 [     67     884       0       0       0]]
Class 0 F1: 0.7664
Class 1 F1: 0.5313
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8470
Class 1 Precision: 0.4453
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6998
Class 1 Recall: 0.6586
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6878
Macro F1 Score: 0.2596
xView2 Score: 0.2706
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1654
Confusion Matrix:
 [[3390717 1397234       0       0       0]
 [ 619324 1136942       0       0       0]
 [   6071     271       0       0       0]
 [   1149     941       0       0       0]
 [     73     878       0       0       0]]
Class 0 F1: 0.7702
Class 1 F1: 0.5297
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8440
Class 1 Precision: 0.4483
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7082
Class 1 Recall: 0.6474
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6909
Macro F1 Score: 0.2600
xView2 Score: 0.2688
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1289
Confusion Matrix:
 [[3334493 1453458       0       0       0]
 [ 582622 1173644       0       0       0]
 [   5760     582       0       0       0]
 [   1008    1082       0       0       0]
 [    347     604       0       0       0]]
Class 0 F1: 0.7655
Class 1 F1: 0.5352
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8497
Class 1 Precision: 0.4464
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6964
Class 1 Recall: 0.6683
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6879
Macro F1 Score: 0.2601
xView2 Score: 0.2726
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.0813
Confusion Matrix:
 [[3370798 1417153       0       0       0]
 [ 597878 1158388       0       0       0]
 [   5256    1086       0       0       0]
 [    664    1426       0       0       0]
 [     73     878       0       0       0]]
Class 0 F1: 0.7694
Class 1 F1: 0.5344
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8481
Class 1 Precision: 0.4492
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7040
Class 1 Recall: 0.6596
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6911
Macro F1 Score: 0.2608
xView2 Score: 0.2716
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6879
Best Macro F1: 0.2601
Best xView2 Score: 0.2726
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8497
Class 1 Precision: 0.4464
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2592
ROC curve saved to .././____________optune_results/175/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/175/plot_loss_curves.jpg
Prediction distribution: {0: 196809, 1: 65335}
ROC curve saved to .././____________optune_results/175/visualize_predictions.jpg
Prediction distribution: {0: 52426, 1: 209718}
ROC curve saved to .././____________optune_results/175/visualize_predictions.jpg
Prediction distribution: {0: 260893, 1: 1251}
ROC curve saved to .././____________optune_results/175/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/175/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/175/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2752281904932307, 1: 0.7364521026972461, 2: 133.7433847952595, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [2.6617584938355123, 4.396072208650115, 1386.216757791207, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5699
Confusion Matrix:
 [[3078178 1152981  302456  337012   22545]
 [ 929560  444763  153455  115899    9935]
 [   2303    2919      13     242     390]
 [    230     568       0     151       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6915
Class 1 F1: 0.2733
Class 2 F1: 0.0001
Class 3 F1: 0.0007
Class 4 F1: 0.0000
Class 0 Precision: 0.7676
Class 1 Precision: 0.2778
Class 2 Precision: 0.0000
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.6291
Class 1 Recall: 0.2690
Class 2 Recall: 0.0022
Class 3 Recall: 0.1591
Class 4 Recall: 0.0000
Validation Accuracy: 0.5376
Macro F1 Score: 0.1931
xView2 Score: 0.1636
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5297
Confusion Matrix:
 [[3941691  644429  222170   83012    1870]
 [1191179  306027  121022   34469     915]
 [   3737    2059      43      10      18]
 [    539     410       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7860
Class 1 F1: 0.2348
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7673
Class 1 Precision: 0.3211
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8055
Class 1 Recall: 0.1851
Class 2 Recall: 0.0073
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6482
Macro F1 Score: 0.2042
xView2 Score: 0.1344
Epoch 2 took:  0 hours,  1 minutes,  6 seconds

Epoch 3/10
Train Loss: 1.4831
Confusion Matrix:
 [[4286475  410260  184943   11422      72]
 [1287214  241342  113462   11534      60]
 [   4773    1051       6      37       0]
 [    333     603      13       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8187
Class 1 F1: 0.2092
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7684
Class 1 Precision: 0.3694
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8760
Class 1 Recall: 0.1459
Class 2 Recall: 0.0010
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6909
Macro F1 Score: 0.2056
xView2 Score: 0.1195
Epoch 3 took:  0 hours,  0 minutes, 35 seconds

Epoch 4/10
Train Loss: 1.4412
Confusion Matrix:
 [[4367229  406224  117765    1954       0]
 [1285612  286907   79776    1317       0]
 [   5489     378       0       0       0]
 [    348     593       8       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8278
Class 1 F1: 0.2444
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7718
Class 1 Precision: 0.4133
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8925
Class 1 Recall: 0.1735
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7102
Macro F1 Score: 0.2680
xView2 Score: 0.1384
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.4081
Confusion Matrix:
 [[4283189  494290  115661      32       0]
 [1204440  368907   80108     157       0]
 [   5209     429     229       0       0]
 [    357     592       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8248
Class 1 F1: 0.2930
Class 2 F1: 0.0023
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7797
Class 1 Precision: 0.4269
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8753
Class 1 Recall: 0.2231
Class 2 Recall: 0.0390
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7099
Macro F1 Score: 0.2800
xView2 Score: 0.1641
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.3568
Confusion Matrix:
 [[4224479  554582  113968     143       0]
 [1150346  428654   74598      14       0]
 [   5223     467     177       0       0]
 [    901      48       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8224
Class 1 F1: 0.3251
Class 2 F1: 0.0018
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7851
Class 1 Precision: 0.4357
Class 2 Precision: 0.0009
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8633
Class 1 Recall: 0.2592
Class 2 Recall: 0.0302
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7100
Macro F1 Score: 0.2873
xView2 Score: 0.1795
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.3279
Confusion Matrix:
 [[4188391  576783  127998       0       0]
 [1093989  472184   87437       2       0]
 [   4748     758     361       0       0]
 [    740     204       5       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8228
Class 1 F1: 0.3493
Class 2 F1: 0.0033
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7921
Class 1 Precision: 0.4497
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8560
Class 1 Recall: 0.2855
Class 2 Recall: 0.0615
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7112
Macro F1 Score: 0.2938
xView2 Score: 0.1941
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2893
Confusion Matrix:
 [[4019752  665282  208138       0       0]
 [ 961024  555746  136842       0       0]
 [   3157    1694    1016       0       0]
 [    902      47       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8139
Class 1 F1: 0.3864
Class 2 F1: 0.0058
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8064
Class 1 Precision: 0.4545
Class 2 Precision: 0.0029
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8215
Class 1 Recall: 0.3361
Class 2 Recall: 0.1732
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6983
Macro F1 Score: 0.3015
xView2 Score: 0.2196
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2600
Confusion Matrix:
 [[4023361  723513  146298       0       0]
 [1004134  560229   89249       0       0]
 [   5408       0     459       0       0]
 [    573     376       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8106
Class 1 F1: 0.3814
Class 2 F1: 0.0038
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7993
Class 1 Precision: 0.4363
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8222
Class 1 Recall: 0.3388
Class 2 Recall: 0.0782
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6995
Macro F1 Score: 0.2990
xView2 Score: 0.2129
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.2407
Confusion Matrix:
 [[3989229  749435  154508       0       0]
 [ 911430  642091  100091       0       0]
 [   5391     126     350       0       0]
 [    543     406       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8141
Class 1 F1: 0.4216
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8130
Class 1 Precision: 0.4613
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8153
Class 1 Recall: 0.3883
Class 2 Recall: 0.0597
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7067
Macro F1 Score: 0.3096
xView2 Score: 0.2338
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7067
Best Macro F1: 0.3096
Best xView2 Score: 0.2338
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8130
Class 1 Precision: 0.4613
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3189
ROC curve saved to .././____________optune_results/176/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/176/plot_loss_curves.jpg
Prediction distribution: {0: 252551, 1: 2988, 2: 6605}
ROC curve saved to .././____________optune_results/176/visualize_predictions.jpg
Prediction distribution: {0: 62603, 1: 182552, 2: 16989}
ROC curve saved to .././____________optune_results/176/visualize_predictions.jpg
Prediction distribution: {0: 253440, 1: 3446, 2: 5258}
ROC curve saved to .././____________optune_results/176/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/176/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/176/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27163347293422707, 1: 0.7630919966505709, 2: 151.30057115373054, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.6269936320730944, 4.555092594389636, 346.4260402957825, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6471
Confusion Matrix:
 [[1162952  191649    4879  129339 3162345]
 [ 353351   75609     917   26860 1435465]
 [   1892     348     121     104    7769]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3770
Class 1 F1: 0.0700
Class 2 F1: 0.0150
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7660
Class 1 Precision: 0.2825
Class 2 Precision: 0.0204
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2500
Class 1 Recall: 0.0400
Class 2 Recall: 0.0118
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1890
Macro F1 Score: 0.0924
xView2 Score: 0.1476
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5796
Confusion Matrix:
 [[2565557  348724    5884   51000 1679999]
 [ 800773  212682    1723   12214  864810]
 [   4519     352     345      18    5000]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6396
Class 1 F1: 0.1733
Class 2 F1: 0.0379
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7611
Class 1 Precision: 0.3786
Class 2 Precision: 0.0434
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5516
Class 1 Recall: 0.1124
Class 2 Recall: 0.0337
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4240
Macro F1 Score: 0.1702
xView2 Score: 0.1656
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5232
Confusion Matrix:
 [[3517497  452306    3464   11772  666125]
 [1188338  323652    1169    3521  375522]
 [   6069     889     292       0    2984]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7514
Class 1 F1: 0.2425
Class 2 F1: 0.0385
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7465
Class 1 Precision: 0.4166
Class 2 Precision: 0.0593
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7563
Class 1 Recall: 0.1710
Class 2 Recall: 0.0285
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5862
Macro F1 Score: 0.2065
xView2 Score: 0.1613
Epoch 3 took:  0 hours,  1 minutes, 21 seconds

Epoch 4/10
Train Loss: 1.4625
Confusion Matrix:
 [[3870559  638522     460    1445  140178]
 [1254000  549638     137     328   88099]
 [   6842    3108       0       0     284]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7913
Class 1 F1: 0.3565
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7543
Class 1 Precision: 0.4614
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8322
Class 1 Recall: 0.2905
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6745
Macro F1 Score: 0.2296
xView2 Score: 0.1787
Epoch 4 took:  0 hours,  1 minutes, 22 seconds

Epoch 5/10
Train Loss: 1.4031
Confusion Matrix:
 [[3848023  781365     145      13   21618]
 [1162916  715643       7       7   13629]
 [   7657    2575       0       0       2]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7959
Class 1 F1: 0.4220
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7668
Class 1 Precision: 0.4772
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8273
Class 1 Recall: 0.3782
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6964
Macro F1 Score: 0.2436
xView2 Score: 0.2045
Epoch 5 took:  0 hours,  1 minutes, 20 seconds

Epoch 6/10
Train Loss: 1.3492
Confusion Matrix:
 [[3679358  969919      11       0    1876]
 [ 978808  911768       4       0    1622]
 [   6731    3492       0       0      11]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7899
Class 1 F1: 0.4828
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7887
Class 1 Precision: 0.4837
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7911
Class 1 Recall: 0.4819
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7006
Macro F1 Score: 0.3182
xView2 Score: 0.2588
Epoch 6 took:  0 hours,  1 minutes,  8 seconds

Epoch 7/10
Train Loss: 1.3038
Confusion Matrix:
 [[3614338 1036662       0       4     160]
 [ 937683  954365       0       0     154]
 [   6502    3732       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7849
Class 1 F1: 0.4911
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7929
Class 1 Precision: 0.4784
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7771
Class 1 Recall: 0.5044
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6971
Macro F1 Score: 0.2552
xView2 Score: 0.2647
Epoch 7 took:  0 hours,  0 minutes, 44 seconds

Epoch 8/10
Train Loss: 1.2475
Confusion Matrix:
 [[3295490 1355670       0       0       4]
 [ 693061 1199133       0       0       8]
 [   6847    3387       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7623
Class 1 F1: 0.5389
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8248
Class 1 Precision: 0.4687
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7085
Class 1 Recall: 0.6337
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6858
Macro F1 Score: 0.3253
xView2 Score: 0.2974
Epoch 8 took:  0 hours,  0 minutes, 30 seconds

Epoch 9/10
Train Loss: 1.2141
Confusion Matrix:
 [[3255478 1395686       0       0       0]
 [ 678980 1213222       0       0       0]
 [   7173    3061       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7577
Class 1 F1: 0.5387
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8259
Class 1 Precision: 0.4645
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6999
Class 1 Recall: 0.6412
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6819
Macro F1 Score: 0.4321
xView2 Score: 0.3438
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1918
Confusion Matrix:
 [[3231228 1419936       0       0       0]
 [ 632025 1260177       0       0       0]
 [   6448    3786       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7584
Class 1 F1: 0.5508
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8350
Class 1 Precision: 0.4695
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6947
Class 1 Recall: 0.6660
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6853
Macro F1 Score: 0.4364
xView2 Score: 0.3517
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6853
Best Macro F1: 0.4364
Best xView2 Score: 0.3517
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8350
Class 1 Precision: 0.4695
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4348
ROC curve saved to .././____________optune_results/177/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/177/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/177/visualize_predictions.jpg
Prediction distribution: {0: 199616, 1: 62528}
ROC curve saved to .././____________optune_results/177/visualize_predictions.jpg
Prediction distribution: {0: 59964, 1: 202180}
ROC curve saved to .././____________optune_results/177/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/177/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/177/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27414053248298265, 1: 0.744086942226564, 2: 133.76471151035162, 3: 1224.6143065693432, 4: 68947.46301369862}
Final class weights used in loss: [2.651239647848196, 4.441646531473571, 441.04668454208587, 1224.6143065693432, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6502
Confusion Matrix:
 [[ 504367  494993 2328828 1263452  228977]
 [  74625  358829  812809  414651   62823]
 [   1190     914    2359    1015     395]
 [    175     194     646    1430      50]
 [      4       0     272     602       0]]
Class 0 F1: 0.1868
Class 1 F1: 0.2783
Class 2 F1: 0.0015
Class 3 F1: 0.0017
Class 4 F1: 0.0000
Class 0 Precision: 0.8691
Class 1 Precision: 0.4197
Class 2 Precision: 0.0008
Class 3 Precision: 0.0009
Class 4 Precision: 0.0000
Class 0 Recall: 0.1046
Class 1 Recall: 0.2082
Class 2 Recall: 0.4017
Class 3 Recall: 0.5731
Class 4 Recall: 0.0000
Validation Accuracy: 0.1323
Macro F1 Score: 0.0937
xView2 Score: 0.1790
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5830
Confusion Matrix:
 [[2152580  776433 1256623  571212   63769]
 [ 291974  620458  573288  220640   17377]
 [   1836    2041    1578     259     159]
 [   1080     453     862      62      38]
 [    195      35     239     403       6]]
Class 0 F1: 0.5923
Class 1 F1: 0.3973
Class 2 F1: 0.0017
Class 3 F1: 0.0002
Class 4 F1: 0.0001
Class 0 Precision: 0.8794
Class 1 Precision: 0.4434
Class 2 Precision: 0.0009
Class 3 Precision: 0.0001
Class 4 Precision: 0.0001
Class 0 Recall: 0.4465
Class 1 Recall: 0.3599
Class 2 Recall: 0.2687
Class 3 Recall: 0.0248
Class 4 Recall: 0.0068
Validation Accuracy: 0.4234
Macro F1 Score: 0.1983
xView2 Score: 0.2227
Epoch 2 took:  0 hours,  1 minutes, 22 seconds

Epoch 3/10
Train Loss: 1.5262
Confusion Matrix:
 [[3147466  922886  593382  148503    8380]
 [ 591976  735097  316972   76504    3188]
 [   4215     957     456     245       0]
 [   2088     332      75       0       0]
 [    629      34      73     142       0]]
Class 0 F1: 0.7348
Class 1 F1: 0.4346
Class 2 F1: 0.0010
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8401
Class 1 Precision: 0.4430
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6529
Class 1 Recall: 0.4265
Class 2 Recall: 0.0776
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5925
Macro F1 Score: 0.2341
xView2 Score: 0.2339
Epoch 3 took:  0 hours,  1 minutes, 18 seconds

Epoch 4/10
Train Loss: 1.4719
Confusion Matrix:
 [[3520753 1023256  255607   20681     320]
 [ 647760  907108  156086   12649     134]
 [   3514    1371     988       0       0]
 [   1167     914     414       0       0]
 [    524     291      63       0       0]]
Class 0 F1: 0.7829
Class 1 F1: 0.4961
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8436
Class 1 Precision: 0.4693
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7304
Class 1 Recall: 0.5262
Class 2 Recall: 0.1682
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6758
Macro F1 Score: 0.2567
xView2 Score: 0.2557
Epoch 4 took:  0 hours,  0 minutes, 50 seconds

Epoch 5/10
Train Loss: 1.4143
Confusion Matrix:
 [[3632020 1094891   91612    2094       0]
 [ 686176  977559   58854    1148       0]
 [   4041    1664     168       0       0]
 [   2293     202       0       0       0]
 [    374     496       2       6       0]]
Class 0 F1: 0.7943
Class 1 F1: 0.5147
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8398
Class 1 Precision: 0.4712
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7534
Class 1 Recall: 0.5671
Class 2 Recall: 0.0286
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7034
Macro F1 Score: 0.2622
xView2 Score: 0.2595
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.3613
Confusion Matrix:
 [[3594221 1177915   48325     156       0]
 [ 661986 1038174   23490      87       0]
 [   3335    2521      17       0       0]
 [   1745     713      37       0       0]
 [    470     408       0       0       0]]
Class 0 F1: 0.7915
Class 1 F1: 0.5265
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8434
Class 1 Precision: 0.4677
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7456
Class 1 Recall: 0.6023
Class 2 Recall: 0.0029
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7068
Macro F1 Score: 0.2637
xView2 Score: 0.2641
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.3026
Confusion Matrix:
 [[3559676 1243005   17935       1       0]
 [ 625582 1089838    8306      11       0]
 [   3865    2008       0       0       0]
 [   1269    1226       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7901
Class 1 F1: 0.5368
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8495
Class 1 Precision: 0.4663
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7384
Class 1 Recall: 0.6323
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7095
Macro F1 Score: 0.2654
xView2 Score: 0.2698
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2448
Confusion Matrix:
 [[3445923 1370683    4011       0       0]
 [ 498541 1222348    2848       0       0]
 [   1178    4695       0       0       0]
 [    823    1672       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7861
Class 1 F1: 0.5654
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8732
Class 1 Precision: 0.4701
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7148
Class 1 Recall: 0.7091
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7123
Macro F1 Score: 0.2703
xView2 Score: 0.2863
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1863
Confusion Matrix:
 [[3315359 1495684    9574       0       0]
 [ 467065 1254952    1720       0       0]
 [   3642    2231       0       0       0]
 [   1113    1382       0       0       0]
 [      7     871       0       0       0]]
Class 0 F1: 0.7703
Class 1 F1: 0.5604
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8754
Class 1 Precision: 0.4555
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6877
Class 1 Recall: 0.7280
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6974
Macro F1 Score: 0.2661
xView2 Score: 0.2860
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1804
Confusion Matrix:
 [[3499996 1318019    2602       0       0]
 [ 511187 1211657     893       0       0]
 [   3710    2163       0       0       0]
 [    843    1652       0       0       0]
 [    119     759       0       0       0]]
Class 0 F1: 0.7922
Class 1 F1: 0.5691
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8715
Class 1 Precision: 0.4781
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7260
Class 1 Recall: 0.7029
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7189
Macro F1 Score: 0.2723
xView2 Score: 0.2864
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7189
Best Macro F1: 0.2723
Best xView2 Score: 0.2864
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8715
Class 1 Precision: 0.4781
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2699
ROC curve saved to .././____________optune_results/178/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/178/plot_loss_curves.jpg
Prediction distribution: {0: 204998, 1: 57146}
ROC curve saved to .././____________optune_results/178/visualize_predictions.jpg
Prediction distribution: {0: 162228, 1: 99916}
ROC curve saved to .././____________optune_results/178/visualize_predictions.jpg
Prediction distribution: {0: 167841, 1: 91208, 2: 3095}
ROC curve saved to .././____________optune_results/178/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/178/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/178/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2759907128025997, 1: 0.7308052722541649, 2: 145.84233432818522, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [2.669132920961108, 4.362364823897092, 167.6310703960614, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6004
Confusion Matrix:
 [[2873400  142279 1360493  504335   63190]
 [ 869448   61069  489266  153652   27369]
 [   6161     241    2003     572      12]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6611
Class 1 F1: 0.0677
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7664
Class 1 Precision: 0.3000
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5812
Class 1 Recall: 0.0381
Class 2 Recall: 0.2228
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4481
Macro F1 Score: 0.1462
xView2 Score: 0.1112
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5281
Confusion Matrix:
 [[4256346  261992  359649   56606    9104]
 [1262840  152391  161207   19051    5315]
 [   8269     127     520      73       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8130
Class 1 F1: 0.1512
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7700
Class 1 Precision: 0.3676
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8610
Class 1 Recall: 0.0952
Class 2 Recall: 0.0578
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6728
Macro F1 Score: 0.1932
xView2 Score: 0.1023
Epoch 2 took:  0 hours,  1 minutes, 17 seconds

Epoch 3/10
Train Loss: 1.4649
Confusion Matrix:
 [[4539319  337370   61708    4863     437]
 [1321210  240535   37045    1643     371]
 [   7686     986     317       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8397
Class 1 F1: 0.2207
Class 2 F1: 0.0059
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7735
Class 1 Precision: 0.4155
Class 2 Precision: 0.0032
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9182
Class 1 Recall: 0.1503
Class 2 Recall: 0.0353
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7294
Macro F1 Score: 0.2133
xView2 Score: 0.1119
Epoch 3 took:  0 hours,  0 minutes, 59 seconds

Epoch 4/10
Train Loss: 1.3924
Confusion Matrix:
 [[4329870  608792    4860     143      32]
 [1128275  469167    3276      55      31]
 [   6938    1992      59       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8320
Class 1 F1: 0.3500
Class 2 F1: 0.0069
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7923
Class 1 Precision: 0.4344
Class 2 Precision: 0.0072
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8758
Class 1 Recall: 0.2931
Class 2 Recall: 0.0066
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7323
Macro F1 Score: 0.2378
xView2 Score: 0.1703
Epoch 4 took:  0 hours,  0 minutes, 32 seconds

Epoch 5/10
Train Loss: 1.3229
Confusion Matrix:
 [[4123637  819719     327      11       3]
 [ 945740  654945     109      10       0]
 [   5623    3366       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8232
Class 1 F1: 0.4255
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8125
Class 1 Precision: 0.4431
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8341
Class 1 Recall: 0.4091
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7292
Macro F1 Score: 0.2497
xView2 Score: 0.2294
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.2497
Confusion Matrix:
 [[3837942 1105741      11       3       0]
 [ 742957  857845       2       0       0]
 [   4741    4248       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8055
Class 1 F1: 0.4808
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8369
Class 1 Precision: 0.4359
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7763
Class 1 Recall: 0.5359
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7165
Macro F1 Score: 0.3216
xView2 Score: 0.2665
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2011
Confusion Matrix:
 [[3741021 1202676       0       0       0]
 [ 690186  910618       0       0       0]
 [   5260    3729       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7976
Class 1 F1: 0.4899
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8432
Class 1 Precision: 0.4301
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7567
Class 1 Recall: 0.5689
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7098
Macro F1 Score: 0.3219
xView2 Score: 0.2739
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1480
Confusion Matrix:
 [[3775633 1168064       0       0       0]
 [ 672224  928580       0       0       0]
 [   5001    3988       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8036
Class 1 F1: 0.5017
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8479
Class 1 Precision: 0.4420
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7637
Class 1 Recall: 0.5801
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7178
Macro F1 Score: 0.3263
xView2 Score: 0.2791
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.0820
Confusion Matrix:
 [[3712015 1231682       0       0       0]
 [ 625186  975618       0       0       0]
 [   4288    4701       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7995
Class 1 F1: 0.5118
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8550
Class 1 Precision: 0.4411
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7509
Class 1 Recall: 0.6095
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7153
Macro F1 Score: 0.3278
xView2 Score: 0.2862
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.0648
Confusion Matrix:
 [[3611969 1331728       0       0       0]
 [ 595536 1005268       0       0       0]
 [   5198    3791       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7889
Class 1 F1: 0.5101
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8574
Class 1 Precision: 0.4295
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7306
Class 1 Recall: 0.6280
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7045
Macro F1 Score: 0.3248
xView2 Score: 0.2881
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7045
Best Macro F1: 0.3248
Best xView2 Score: 0.2881
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8574
Class 1 Precision: 0.4295
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3217
ROC curve saved to .././____________optune_results/179/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/179/plot_loss_curves.jpg
Prediction distribution: {0: 34912, 1: 227232}
ROC curve saved to .././____________optune_results/179/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/179/visualize_predictions.jpg
Prediction distribution: {0: 240714, 1: 21430}
ROC curve saved to .././____________optune_results/179/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/179/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/179/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2741654405977079, 1: 0.7442603480297635, 2: 130.91176944885166, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [2.651480536638754, 4.44268163535809, 166.8190040078427, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5594
Confusion Matrix:
 [[1864770 2321813  315118    2243  318341]
 [ 492941 1047951   45821     364  138236]
 [   3115    1771      37       0     130]
 [    663     272       0       0      14]
 [      0       0       0       0       0]]
Class 0 F1: 0.5192
Class 1 F1: 0.4112
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7897
Class 1 Precision: 0.3108
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3867
Class 1 Recall: 0.6074
Class 2 Recall: 0.0073
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4445
Macro F1 Score: 0.1861
xView2 Score: 0.2310
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4935
Confusion Matrix:
 [[3058432 1650905   58896     212   53840]
 [ 589858 1102797    9221     134   23303]
 [   3988    1063       0       0       2]
 [    609     340       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7217
Class 1 F1: 0.4923
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8373
Class 1 Precision: 0.4003
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6342
Class 1 Recall: 0.6392
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6350
Macro F1 Score: 0.2428
xView2 Score: 0.2564
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4316
Confusion Matrix:
 [[3447895 1361247    8295      23    4825]
 [ 667443 1054490    1250      10    2120]
 [   4040    1013       0       0       0]
 [    836     113       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7711
Class 1 F1: 0.5091
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8368
Class 1 Precision: 0.4363
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7150
Class 1 Recall: 0.6112
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6870
Macro F1 Score: 0.2561
xView2 Score: 0.2587
Epoch 3 took:  0 hours,  1 minutes, 14 seconds

Epoch 4/10
Train Loss: 1.3779
Confusion Matrix:
 [[3423122 1398414     640       0     109]
 [ 566975 1158081     156       0     101]
 [   3297    1756       0       0       0]
 [    756     193       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7765
Class 1 F1: 0.5407
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8570
Class 1 Precision: 0.4527
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7099
Class 1 Recall: 0.6712
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6990
Macro F1 Score: 0.2634
xView2 Score: 0.2746
Epoch 4 took:  0 hours,  0 minutes, 44 seconds

Epoch 5/10
Train Loss: 1.3097
Confusion Matrix:
 [[3337844 1484375      66       0       0]
 [ 509731 1215582       0       0       0]
 [   4114     939       0       0       0]
 [    230     719       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7696
Class 1 F1: 0.5492
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8665
Class 1 Precision: 0.4499
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6922
Class 1 Recall: 0.7046
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6948
Macro F1 Score: 0.3297
xView2 Score: 0.3093
Epoch 5 took:  0 hours,  0 minutes, 29 seconds

Epoch 6/10
Train Loss: 1.2590
Confusion Matrix:
 [[3521262 1301005      18       0       0]
 [ 565383 1159930       0       0       0]
 [   3081    1972       0       0       0]
 [    440     509       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7902
Class 1 F1: 0.5538
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8609
Class 1 Precision: 0.4709
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7302
Class 1 Recall: 0.6723
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7143
Macro F1 Score: 0.3360
xView2 Score: 0.3069
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.1915
Confusion Matrix:
 [[3304341 1517944       0       0       0]
 [ 434541 1290772       0       0       0]
 [   3560    1493       0       0       0]
 [    411     538       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7716
Class 1 F1: 0.5691
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8828
Class 1 Precision: 0.4592
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6852
Class 1 Recall: 0.7481
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7012
Macro F1 Score: 0.3352
xView2 Score: 0.3205
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1366
Confusion Matrix:
 [[3339048 1483237       0       0       0]
 [ 422887 1302426       0       0       0]
 [   2905    2148       0       0       0]
 [    411     538       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7776
Class 1 F1: 0.5771
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8868
Class 1 Precision: 0.4671
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6924
Class 1 Recall: 0.7549
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7082
Macro F1 Score: 0.3387
xView2 Score: 0.3237
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.0950
Confusion Matrix:
 [[3319090 1503195       0       0       0]
 [ 440116 1285197       0       0       0]
 [   1637    3416       0       0       0]
 [    385     564       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7734
Class 1 F1: 0.5690
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8824
Class 1 Precision: 0.4603
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6883
Class 1 Recall: 0.7449
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7026
Macro F1 Score: 0.3356
xView2 Score: 0.3202
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.0417
Confusion Matrix:
 [[3341376 1480909       0       0       0]
 [ 400816 1324497       0       0       0]
 [   1410    3643       0       0       0]
 [    228     721       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7801
Class 1 F1: 0.5841
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8925
Class 1 Precision: 0.4714
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6929
Class 1 Recall: 0.7677
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7120
Macro F1 Score: 0.3411
xView2 Score: 0.3274
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7120
Best Macro F1: 0.3411
Best xView2 Score: 0.3274
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8925
Class 1 Precision: 0.4714
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3410
ROC curve saved to .././____________optune_results/180/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/180/plot_loss_curves.jpg
Prediction distribution: {0: 109612, 1: 152532}
ROC curve saved to .././____________optune_results/180/visualize_predictions.jpg
Prediction distribution: {0: 107901, 1: 154243}
ROC curve saved to .././____________optune_results/180/visualize_predictions.jpg
Prediction distribution: {0: 120289, 1: 141855}
ROC curve saved to .././____________optune_results/180/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/180/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/180/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2711390667842193, 1: 0.7662466682377786, 2: 169.4554171436267, 3: 1423.0039016115352, 4: 5292.497160883281}
Final class weights used in loss: [2.6222121822992563, 4.57392364129839, 2606.332623979805, 1423.0039016115352, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6060
Confusion Matrix:
 [[ 575449 2046090 1198202  752055   45581]
 [ 157177 1211949  376191  162979   11061]
 [     19    6693    2786    4291       9]
 [      0    1906     740     422       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.2151
Class 1 F1: 0.4674
Class 2 F1: 0.0035
Class 3 F1: 0.0009
Class 4 F1: 0.0000
Class 0 Precision: 0.7854
Class 1 Precision: 0.3710
Class 2 Precision: 0.0018
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.1246
Class 1 Recall: 0.6314
Class 2 Recall: 0.2019
Class 3 Recall: 0.1375
Class 4 Recall: 0.0000
Validation Accuracy: 0.2732
Macro F1 Score: 0.1374
xView2 Score: 0.2484
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.5741
Confusion Matrix:
 [[1049263 1552144 1687396  314005   14569]
 [ 284512  972954  607927   51331    2633]
 [   3987    2677    7093      19      22]
 [    503    1583     959      23       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3524
Class 1 F1: 0.4374
Class 2 F1: 0.0061
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.7840
Class 1 Precision: 0.3847
Class 2 Precision: 0.0031
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.2272
Class 1 Recall: 0.5069
Class 2 Recall: 0.5141
Class 3 Recall: 0.0075
Class 4 Recall: 0.0000
Validation Accuracy: 0.3097
Macro F1 Score: 0.1592
xView2 Score: 0.2355
Epoch 2 took:  0 hours,  1 minutes, 19 seconds

Epoch 3/10
Train Loss: 1.5305
Confusion Matrix:
 [[1563741 1411596 1582874   56514    2652]
 [ 314144  999787  595636    9398     392]
 [   3454    5894    4356      94       0]
 [      5    1462    1601       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4812
Class 1 F1: 0.4609
Class 2 F1: 0.0040
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8312
Class 1 Precision: 0.4134
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3387
Class 1 Recall: 0.5209
Class 2 Recall: 0.3157
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3918
Macro F1 Score: 0.1892
xView2 Score: 0.2446
Epoch 3 took:  0 hours,  1 minutes,  5 seconds

Epoch 4/10
Train Loss: 1.4898
Confusion Matrix:
 [[2101290 1108379 1400759    6484     465]
 [ 401292  906740  610310     996      19]
 [   7116    2533    4149       0       0]
 [    170    1169    1729       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5896
Class 1 F1: 0.4605
Class 2 F1: 0.0041
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8372
Class 1 Precision: 0.4491
Class 2 Precision: 0.0021
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4551
Class 1 Recall: 0.4724
Class 2 Recall: 0.3007
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4596
Macro F1 Score: 0.2108
xView2 Score: 0.2448
Epoch 4 took:  0 hours,  0 minutes, 39 seconds

Epoch 5/10
Train Loss: 1.4445
Confusion Matrix:
 [[2197099  886860 1533001     374      43]
 [ 407992  794088  717252      25       0]
 [   7527     615    5656       0       0]
 [    493      28    2547       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6077
Class 1 F1: 0.4410
Class 2 F1: 0.0050
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8408
Class 1 Precision: 0.4722
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4758
Class 1 Recall: 0.4137
Class 2 Recall: 0.4099
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4573
Macro F1 Score: 0.2108
xView2 Score: 0.2603
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.3999
Confusion Matrix:
 [[2349055  819676 1448631       5      10]
 [ 344493  834852  740012       0       0]
 [   4518    2589    6691       0       0]
 [      0      12    3056       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6422
Class 1 F1: 0.4669
Class 2 F1: 0.0060
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8706
Class 1 Precision: 0.5038
Class 2 Precision: 0.0030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5087
Class 1 Recall: 0.4350
Class 2 Recall: 0.4849
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4868
Macro F1 Score: 0.2230
xView2 Score: 0.2735
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3526
Confusion Matrix:
 [[2452985  828553 1335839       0       0]
 [ 403199  859551  656607       0       0]
 [   8732    2041    3025       0       0]
 [     66     273    2729       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6557
Class 1 F1: 0.4762
Class 2 F1: 0.0030
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8562
Class 1 Precision: 0.5085
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5313
Class 1 Recall: 0.4478
Class 2 Recall: 0.2192
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5059
Macro F1 Score: 0.2837
xView2 Score: 0.2723
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3080
Confusion Matrix:
 [[2613054  797597 1206726       0       0]
 [ 455663  837113  626581       0       0]
 [   8093    1088    4617       0       0]
 [     48     502    2518       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6792
Class 1 F1: 0.4709
Class 2 F1: 0.0050
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8493
Class 1 Precision: 0.5116
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5659
Class 1 Recall: 0.4361
Class 2 Recall: 0.3346
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5272
Macro F1 Score: 0.2888
xView2 Score: 0.2719
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2819
Confusion Matrix:
 [[2668119  665844 1283414       0       0]
 [ 488350  748656  682351       0       0]
 [   6779    1115    5904       0       0]
 [     39      17    3012       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6858
Class 1 F1: 0.4490
Class 2 F1: 0.0059
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8435
Class 1 Precision: 0.5288
Class 2 Precision: 0.0030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5778
Class 1 Recall: 0.3901
Class 2 Recall: 0.4279
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5223
Macro F1 Score: 0.2852
xView2 Score: 0.2634
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2481
Confusion Matrix:
 [[2658696  577402 1381279       0       0]
 [ 510277  662077  747003       0       0]
 [   7894     432    5472       0       0]
 [    484       0    2584       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6822
Class 1 F1: 0.4191
Class 2 F1: 0.0051
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8368
Class 1 Precision: 0.5340
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5758
Class 1 Recall: 0.3449
Class 2 Recall: 0.3966
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5075
Macro F1 Score: 0.2766
xView2 Score: 0.2523
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4868
Best Macro F1: 0.2230
Best xView2 Score: 0.2735
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8706
Class 1 Precision: 0.5038
Class 2 Precision: 0.0030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2755
ROC curve saved to .././____________optune_results/181/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/181/plot_loss_curves.jpg
Prediction distribution: {0: 130540, 1: 31691, 2: 99913}
ROC curve saved to .././____________optune_results/181/visualize_predictions.jpg
Prediction distribution: {0: 197388, 1: 4540, 2: 60216}
ROC curve saved to .././____________optune_results/181/visualize_predictions.jpg
Prediction distribution: {0: 69797, 1: 14945, 2: 177402}
ROC curve saved to .././____________optune_results/181/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/181/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/181/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27160145989773593, 1: 0.7627369798332156, 2: 178.9760614465543, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [2.6266840308958272, 4.552973407603879, 1500.3159326758703, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5700
Confusion Matrix:
 [[3014143  758594  724881   89564   61798]
 [ 908816  481281  442142   45862   11031]
 [  10971    1552    2094      41     720]
 [    107       0       3       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7024
Class 1 F1: 0.3075
Class 2 F1: 0.0035
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7662
Class 1 Precision: 0.3877
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6483
Class 1 Recall: 0.2548
Class 2 Recall: 0.1362
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5337
Macro F1 Score: 0.2027
xView2 Score: 0.1887
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5213
Confusion Matrix:
 [[3607268  540413  486884    7661    6754]
 [1097207  412728  372691    5588     918]
 [  11767    1157    2446       2       6]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7703
Class 1 F1: 0.2903
Class 2 F1: 0.0056
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7648
Class 1 Precision: 0.4325
Class 2 Precision: 0.0028
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7759
Class 1 Recall: 0.2185
Class 2 Recall: 0.1591
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6138
Macro F1 Score: 0.2132
xView2 Score: 0.1795
Epoch 2 took:  0 hours,  1 minutes, 18 seconds

Epoch 3/10
Train Loss: 1.4867
Confusion Matrix:
 [[3855137  430614  361956     545     728]
 [1223369  365340  299729     449     245]
 [  13162     995    1221       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7915
Class 1 F1: 0.2720
Class 2 F1: 0.0036
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7571
Class 1 Precision: 0.4584
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8292
Class 1 Recall: 0.1934
Class 2 Recall: 0.0794
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6442
Macro F1 Score: 0.2134
xView2 Score: 0.1655
Epoch 3 took:  0 hours,  0 minutes, 53 seconds

Epoch 4/10
Train Loss: 1.4494
Confusion Matrix:
 [[3734933  631047  282973      17      10]
 [1096346  547331  245418       9      28]
 [  12953    1524     901       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7869
Class 1 F1: 0.3567
Class 2 F1: 0.0033
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7710
Class 1 Precision: 0.4639
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8034
Class 1 Recall: 0.2897
Class 2 Recall: 0.0586
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6536
Macro F1 Score: 0.2294
xView2 Score: 0.1959
Epoch 4 took:  0 hours,  0 minutes, 29 seconds

Epoch 5/10
Train Loss: 1.4119
Confusion Matrix:
 [[3677572  680134  291274       0       0]
 [1024722  614665  249745       0       0]
 [  13226    1415     737       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7854
Class 1 F1: 0.3859
Class 2 F1: 0.0026
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7799
Class 1 Precision: 0.4742
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7910
Class 1 Recall: 0.3254
Class 2 Recall: 0.0479
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6551
Macro F1 Score: 0.2935
xView2 Score: 0.2258
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3874
Confusion Matrix:
 [[3625771  722695  300514       0       0]
 [ 971610  661162  256360       0       0]
 [  12231    1378    1769       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7832
Class 1 F1: 0.4038
Class 2 F1: 0.0062
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7865
Class 1 Precision: 0.4773
Class 2 Precision: 0.0032
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7799
Class 1 Recall: 0.3500
Class 2 Recall: 0.1150
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6544
Macro F1 Score: 0.2983
xView2 Score: 0.2365
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3409
Confusion Matrix:
 [[3462424  921198  265358       0       0]
 [ 844753  835317  209062       0       0]
 [  11724    2222    1432       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7722
Class 1 F1: 0.4580
Class 2 F1: 0.0058
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8017
Class 1 Precision: 0.4750
Class 2 Precision: 0.0030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7448
Class 1 Recall: 0.4422
Class 2 Recall: 0.0931
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6560
Macro F1 Score: 0.3090
xView2 Score: 0.2614
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2984
Confusion Matrix:
 [[3375819 1069833  203328       0       0]
 [ 785046  944232  159854       0       0]
 [  10726    3855     797       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7654
Class 1 F1: 0.4833
Class 2 F1: 0.0042
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8092
Class 1 Precision: 0.4679
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7261
Class 1 Recall: 0.4998
Class 2 Recall: 0.0518
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6593
Macro F1 Score: 0.3132
xView2 Score: 0.2733
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2770
Confusion Matrix:
 [[3380860 1100233  167887       0       0]
 [ 762315  991094  135723       0       0]
 [  11991    2804     583       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7680
Class 1 F1: 0.4976
Class 2 F1: 0.0036
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8136
Class 1 Precision: 0.4733
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7272
Class 1 Recall: 0.5246
Class 2 Recall: 0.0379
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6672
Macro F1 Score: 0.3173
xView2 Score: 0.2793
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2111
Confusion Matrix:
 [[3243084 1213118  192778       0       0]
 [ 667053 1079643  142436       0       0]
 [  10591    3928     859       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7569
Class 1 F1: 0.5159
Class 2 F1: 0.0049
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8271
Class 1 Precision: 0.4701
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6976
Class 1 Recall: 0.5715
Class 2 Recall: 0.0559
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6597
Macro F1 Score: 0.3194
xView2 Score: 0.2912
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6597
Best Macro F1: 0.3194
Best xView2 Score: 0.2912
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8271
Class 1 Precision: 0.4701
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3249
ROC curve saved to .././____________optune_results/182/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/182/plot_loss_curves.jpg
Prediction distribution: {0: 207463, 1: 34783, 2: 19898}
ROC curve saved to .././____________optune_results/182/visualize_predictions.jpg
Prediction distribution: {0: 120920, 1: 131799, 2: 9425}
ROC curve saved to .././____________optune_results/182/visualize_predictions.jpg
Prediction distribution: {0: 99141, 1: 154708, 2: 8295}
ROC curve saved to .././____________optune_results/182/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/182/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/182/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27482511800766884, 1: 0.7379491988535698, 2: 179.43546524064172, 3: 1592.2697880417588, 4: 68947.46301369862}
Final class weights used in loss: [2.6578603407787598, 4.405008761050994, 270.17225664193194, 1592.2697880417588, 68947.46301369862]

Epoch 1/10
Train Loss: 1.5010
Confusion Matrix:
 [[3881776  871947    7824   11495   93309]
 [1229168  393360    3075    5946   35928]
 [   9199    5677      76      65     433]
 [   1740    1649      36      18       1]
 [    446     432       0       0       0]]
Class 0 F1: 0.7772
Class 1 F1: 0.2675
Class 2 F1: 0.0057
Class 3 F1: 0.0017
Class 4 F1: 0.0000
Class 0 Precision: 0.7578
Class 1 Precision: 0.3090
Class 2 Precision: 0.0069
Class 3 Precision: 0.0010
Class 4 Precision: 0.0000
Class 0 Recall: 0.7977
Class 1 Recall: 0.2359
Class 2 Recall: 0.0049
Class 3 Recall: 0.0052
Class 4 Recall: 0.0000
Validation Accuracy: 0.6523
Macro F1 Score: 0.2104
xView2 Score: 0.1409
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4394
Confusion Matrix:
 [[4211629  643807    1187     189    9539]
 [1324143  337797     769     260    4508]
 [  13977    1473       0       0       0]
 [   2365    1078       0       1       0]
 [    877       1       0       0       0]]
Class 0 F1: 0.8084
Class 1 F1: 0.2548
Class 2 F1: 0.0000
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.7584
Class 1 Precision: 0.3432
Class 2 Precision: 0.0000
Class 3 Precision: 0.0022
Class 4 Precision: 0.0000
Class 0 Recall: 0.8655
Class 1 Recall: 0.2026
Class 2 Recall: 0.0000
Class 3 Recall: 0.0003
Class 4 Recall: 0.0000
Validation Accuracy: 0.6942
Macro F1 Score: 0.2127
xView2 Score: 0.1244
Epoch 2 took:  0 hours,  1 minutes, 17 seconds

Epoch 3/10
Train Loss: 1.3844
Confusion Matrix:
 [[4361318  504526     104      12     391]
 [1351208  316146      23      12      88]
 [  14628     822       0       0       0]
 [   2886     558       0       0       0]
 [    833      45       0       0       0]]
Class 0 F1: 0.8231
Class 1 F1: 0.2540
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7610
Class 1 Precision: 0.3846
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8962
Class 1 Recall: 0.1896
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7137
Macro F1 Score: 0.2154
xView2 Score: 0.1205
Epoch 3 took:  0 hours,  0 minutes, 47 seconds

Epoch 4/10
Train Loss: 1.3192
Confusion Matrix:
 [[3984903  881448       0       0       0]
 [1023117  644353       6       0       1]
 [  12320    3130       0       0       0]
 [   1697    1747       0       0       0]
 [    158     720       0       0       0]]
Class 0 F1: 0.8060
Class 1 F1: 0.4029
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7935
Class 1 Precision: 0.4208
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8189
Class 1 Recall: 0.3864
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7064
Macro F1 Score: 0.2418
xView2 Score: 0.1990
Epoch 4 took:  0 hours,  0 minutes, 31 seconds

Epoch 5/10
Train Loss: 1.2449
Confusion Matrix:
 [[3989831  876520       0       0       0]
 [1017171  650306       0       0       0]
 [  12568    2882       0       0       0]
 [   2255    1189       0       0       0]
 [    125     753       0       0       0]]
Class 0 F1: 0.8070
Class 1 F1: 0.4066
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7945
Class 1 Precision: 0.4246
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8199
Class 1 Recall: 0.3900
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7080
Macro F1 Score: 0.2427
xView2 Score: 0.2005
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.1900
Confusion Matrix:
 [[3699583 1166768       0       0       0]
 [ 807235  860242       0       0       0]
 [  10965    4485       0       0       0]
 [   1592    1852       0       0       0]
 [    683     195       0       0       0]]
Class 0 F1: 0.7883
Class 1 F1: 0.4649
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8185
Class 1 Precision: 0.4230
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7602
Class 1 Recall: 0.5159
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6958
Macro F1 Score: 0.2506
xView2 Score: 0.2348
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1603
Confusion Matrix:
 [[3768624 1097727       0       0       0]
 [ 865659  801818       0       0       0]
 [  10915    4535       0       0       0]
 [   1579    1865       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7923
Class 1 F1: 0.4487
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8110
Class 1 Precision: 0.4205
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7744
Class 1 Recall: 0.4809
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6974
Macro F1 Score: 0.2482
xView2 Score: 0.2257
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.0954
Confusion Matrix:
 [[3723353 1142998       0       0       0]
 [ 774837  892640       0       0       0]
 [  11078    4372       0       0       0]
 [    669    2775       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7942
Class 1 F1: 0.4811
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8256
Class 1 Precision: 0.4368
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7651
Class 1 Recall: 0.5353
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7043
Macro F1 Score: 0.2551
xView2 Score: 0.2422
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0525
Confusion Matrix:
 [[3693418 1172933       0       0       0]
 [ 731308  936169       0       0       0]
 [  10201    5249       0       0       0]
 [   1098    2346       0       0       0]
 [    294     584       0       0       0]]
Class 0 F1: 0.7941
Class 1 F1: 0.4947
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8325
Class 1 Precision: 0.4422
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7590
Class 1 Recall: 0.5614
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7064
Macro F1 Score: 0.2578
xView2 Score: 0.2493
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0274
Confusion Matrix:
 [[3624437 1241914       0       0       0]
 [ 751730  915747       0       0       0]
 [  10761    4689       0       0       0]
 [    878    2566       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7833
Class 1 F1: 0.4778
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8260
Class 1 Precision: 0.4228
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7448
Class 1 Recall: 0.5492
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6928
Macro F1 Score: 0.2522
xView2 Score: 0.2428
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7064
Best Macro F1: 0.2578
Best xView2 Score: 0.2493
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8325
Class 1 Precision: 0.4422
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2549
ROC curve saved to .././____________optune_results/183/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/183/plot_loss_curves.jpg
Prediction distribution: {0: 206225, 1: 55919}
ROC curve saved to .././____________optune_results/183/visualize_predictions.jpg
Prediction distribution: {0: 151401, 1: 110743}
ROC curve saved to .././____________optune_results/183/visualize_predictions.jpg
Prediction distribution: {0: 241533, 1: 20611}
ROC curve saved to .././____________optune_results/183/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/183/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/183/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2761110334865691, 1: 0.7298053746890671, 2: 130.84710653564187, 3: 2609.20933125972, 4: 68947.46301369862}
Final class weights used in loss: [2.670296553952212, 4.356396177896458, 290.5161086905875, 2609.20933125972, 68947.46301369862]

Epoch 1/10
Train Loss: 1.4906
Confusion Matrix:
 [[4779507   62579       0   13024   96534]
 [1525176   41587       0    2542   22063]
 [   5028       2       0       0       4]
 [   4676       0       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8484
Class 1 F1: 0.0491
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7568
Class 1 Precision: 0.3992
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9652
Class 1 Recall: 0.0261
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7356
Macro F1 Score: 0.1795
xView2 Score: 0.0287
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4390
Confusion Matrix:
 [[4859821   80444       0     841   10538]
 [1515982   71975       0     216    3195]
 [   4927     107       0       0       0]
 [   4648      28       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.8573
Class 1 F1: 0.0825
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7610
Class 1 Precision: 0.4718
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9815
Class 1 Recall: 0.0452
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7525
Macro F1 Score: 0.1880
xView2 Score: 0.0377
Epoch 2 took:  0 hours,  1 minutes, 15 seconds

Epoch 3/10
Train Loss: 1.3809
Confusion Matrix:
 [[4860059   91166       0      38     381]
 [1502276   89009       0      10      73]
 [   4791     243       0       0       0]
 [   4540     136       0       0       0]
 [    481     397       0       0       0]]
Class 0 F1: 0.8584
Class 1 F1: 0.1004
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7627
Class 1 Precision: 0.4919
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9815
Class 1 Recall: 0.0559
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7552
Macro F1 Score: 0.1918
xView2 Score: 0.0451
Epoch 3 took:  0 hours,  0 minutes, 45 seconds

Epoch 4/10
Train Loss: 1.3285
Confusion Matrix:
 [[4564268  387369       0       0       7]
 [1246851  344514       0       0       3]
 [   4430     604       0       0       0]
 [   4325     351       0       0       0]
 [    506     372       0       0       0]]
Class 0 F1: 0.8474
Class 1 F1: 0.2964
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7842
Class 1 Precision: 0.4699
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9218
Class 1 Recall: 0.2165
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7490
Macro F1 Score: 0.2288
xView2 Score: 0.1387
Epoch 4 took:  0 hours,  0 minutes, 28 seconds

Epoch 5/10
Train Loss: 1.2610
Confusion Matrix:
 [[4296174  655470       0       0       0]
 [1000881  590487       0       0       0]
 [   3728    1306       0       0       0]
 [   3195    1481       0       0       0]
 [    211     667       0       0       0]]
Class 0 F1: 0.8378
Class 1 F1: 0.4157
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8100
Class 1 Precision: 0.4726
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8676
Class 1 Recall: 0.3711
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7456
Macro F1 Score: 0.2507
xView2 Score: 0.2006
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2158
Confusion Matrix:
 [[4043922  907722       0       0       0]
 [ 773671  817697       0       0       0]
 [   1177    3857       0       0       0]
 [   1010    3666       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.8277
Class 1 F1: 0.4918
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8390
Class 1 Precision: 0.4716
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8167
Class 1 Recall: 0.5138
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7418
Macro F1 Score: 0.2639
xView2 Score: 0.2433
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1693
Confusion Matrix:
 [[3971358  980286       0       0       0]
 [ 776142  815226       0       0       0]
 [   3239    1795       0       0       0]
 [   1333    3343       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.8185
Class 1 F1: 0.4805
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8357
Class 1 Precision: 0.4525
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8020
Class 1 Recall: 0.5123
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7304
Macro F1 Score: 0.2598
xView2 Score: 0.2394
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1229
Confusion Matrix:
 [[3787032 1164612       0       0       0]
 [ 669139  922229       0       0       0]
 [   3345    1689       0       0       0]
 [   1230    3446       0       0       0]
 [     48     830       0       0       0]]
Class 0 F1: 0.8047
Class 1 F1: 0.5006
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8490
Class 1 Precision: 0.4407
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7648
Class 1 Recall: 0.5795
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7186
Macro F1 Score: 0.2611
xView2 Score: 0.2532
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1082
Confusion Matrix:
 [[3815661 1135983       0       0       0]
 [ 628603  962765       0       0       0]
 [    747    4287       0       0       0]
 [    664    4012       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.8121
Class 1 F1: 0.5205
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8583
Class 1 Precision: 0.4567
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7706
Class 1 Recall: 0.6050
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7291
Macro F1 Score: 0.2665
xView2 Score: 0.2624
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0894
Confusion Matrix:
 [[3997041  954603       0       0       0]
 [ 696781  894587       0       0       0]
 [   1042    3992       0       0       0]
 [    694    3982       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.8286
Class 1 F1: 0.5187
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8512
Class 1 Precision: 0.4815
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8072
Class 1 Recall: 0.5621
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7464
Macro F1 Score: 0.2695
xView2 Score: 0.2571
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7291
Best Macro F1: 0.2665
Best xView2 Score: 0.2624
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8583
Class 1 Precision: 0.4567
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2630
ROC curve saved to .././____________optune_results/184/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/184/plot_loss_curves.jpg
Prediction distribution: {0: 233474, 1: 28670}
ROC curve saved to .././____________optune_results/184/visualize_predictions.jpg
Prediction distribution: {0: 262072, 1: 72}
ROC curve saved to .././____________optune_results/184/visualize_predictions.jpg
Prediction distribution: {0: 207719, 1: 54425}
ROC curve saved to .././____________optune_results/184/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/184/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/184/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27228616322515187, 1: 0.7582747697115231, 2: 131.53098834474469, 3: 1007.2373023814289, 4: 68947.46301369862}
Final class weights used in loss: [2.633305863108003, 4.526337326542686, 2438.683828169858, 1007.2373023814289, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6255
Confusion Matrix:
 [[ 314103 3150188  502570  184305  544414]
 [  78310 1472170  122250   89253   88317]
 [    293    3728     871     184     158]
 [    209    1200       0       0     199]
 [     21     852       0       0       5]]
Class 0 F1: 0.1235
Class 1 F1: 0.4545
Class 2 F1: 0.0028
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7994
Class 1 Precision: 0.3181
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0669
Class 1 Recall: 0.7956
Class 2 Recall: 0.1664
Class 3 Recall: 0.0000
Class 4 Recall: 0.0057
Validation Accuracy: 0.2727
Macro F1 Score: 0.1161
xView2 Score: 0.2589
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5909
Confusion Matrix:
 [[ 713959 2895069  788467   63838  234247]
 [ 131043 1437630  220548   31147   29932]
 [    613    4017     538      33      33]
 [     53    1435      16       0     104]
 [      0     816      60       0       2]]
Class 0 F1: 0.2577
Class 1 F1: 0.4646
Class 2 F1: 0.0011
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8443
Class 1 Precision: 0.3313
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1520
Class 1 Recall: 0.7770
Class 2 Recall: 0.1028
Class 3 Recall: 0.0000
Class 4 Recall: 0.0023
Validation Accuracy: 0.3284
Macro F1 Score: 0.1447
xView2 Score: 0.2598
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.5529
Confusion Matrix:
 [[1319843 2390890  930162   16082   38603]
 [ 208007 1311192  315955    7926    7220]
 [    502    3743     984       0       5]
 [    363    1064     181       0       0]
 [     23     695     160       0       0]]
Class 0 F1: 0.4241
Class 1 F1: 0.4718
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8634
Class 1 Precision: 0.3537
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2811
Class 1 Recall: 0.7086
Class 2 Recall: 0.1880
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4016
Macro F1 Score: 0.1795
xView2 Score: 0.2605
Epoch 3 took:  0 hours,  1 minutes, 18 seconds

Epoch 4/10
Train Loss: 1.5114
Confusion Matrix:
 [[1849832 2012935  825461    2526    4826]
 [ 241085 1297962  309797     920     536]
 [   1769    1894    1571       0       0]
 [    297    1099     212       0       0]
 [     61     758      59       0       0]]
Class 0 F1: 0.5450
Class 1 F1: 0.5026
Class 2 F1: 0.0028
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8838
Class 1 Precision: 0.3916
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3940
Class 1 Recall: 0.7015
Class 2 Recall: 0.3002
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4806
Macro F1 Score: 0.2101
xView2 Score: 0.2700
Epoch 4 took:  0 hours,  1 minutes, 14 seconds

Epoch 5/10
Train Loss: 1.4774
Confusion Matrix:
 [[2207076 1649061  838497     331     615]
 [ 321740 1154288  374131      71      70]
 [   2098    2158     978       0       0]
 [    175     599     834       0       0]
 [      4     617     257       0       0]]
Class 0 F1: 0.6108
Class 1 F1: 0.4957
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8720
Class 1 Precision: 0.4113
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4700
Class 1 Recall: 0.6238
Class 2 Recall: 0.1869
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5131
Macro F1 Score: 0.2216
xView2 Score: 0.2647
Epoch 5 took:  0 hours,  0 minutes, 51 seconds

Epoch 6/10
Train Loss: 1.4501
Confusion Matrix:
 [[2450329 1412577  832622       3      49]
 [ 366638 1090123  393531       7       1]
 [   1340    2083    1811       0       0]
 [    473     837     298       0       0]
 [     76     318     484       0       0]]
Class 0 F1: 0.6522
Class 1 F1: 0.5005
Class 2 F1: 0.0029
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8693
Class 1 Precision: 0.4350
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5218
Class 1 Recall: 0.5892
Class 2 Recall: 0.3460
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5405
Macro F1 Score: 0.2311
xView2 Score: 0.2648
Epoch 6 took:  0 hours,  0 minutes, 31 seconds

Epoch 7/10
Train Loss: 1.3840
Confusion Matrix:
 [[2467763 1173886 1053928       0       3]
 [ 363683  954273  532341       0       3]
 [   2788    1405    1041       0       0]
 [    286     938     384       0       0]
 [     53     548     277       0       0]]
Class 0 F1: 0.6554
Class 1 F1: 0.4794
Class 2 F1: 0.0013
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8706
Class 1 Precision: 0.4478
Class 2 Precision: 0.0007
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5256
Class 1 Recall: 0.5157
Class 2 Recall: 0.1989
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5223
Macro F1 Score: 0.2272
xView2 Score: 0.2561
Epoch 7 took:  0 hours,  0 minutes, 28 seconds

Epoch 8/10
Train Loss: 1.3574
Confusion Matrix:
 [[2532987  938991 1223602       0       0]
 [ 372508  836926  640866       0       0]
 [   2075    1573    1586       0       0]
 [    423     660     525       0       0]
 [     69     505     304       0       0]]
Class 0 F1: 0.6663
Class 1 F1: 0.4612
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8710
Class 1 Precision: 0.4705
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5394
Class 1 Recall: 0.4523
Class 2 Recall: 0.3030
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5144
Macro F1 Score: 0.2258
xView2 Score: 0.2495
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.3247
Confusion Matrix:
 [[2628728  936610 1130242       0       0]
 [ 396304  850116  603880       0       0]
 [   1004     791    3439       0       0]
 [    525     434     649       0       0]
 [     27     576     275       0       0]]
Class 0 F1: 0.6808
Class 1 F1: 0.4672
Class 2 F1: 0.0039
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8685
Class 1 Precision: 0.4753
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5598
Class 1 Recall: 0.4594
Class 2 Recall: 0.6571
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5314
Macro F1 Score: 0.2304
xView2 Score: 0.2523
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2735
Confusion Matrix:
 [[2580103  925592 1189885       0       0]
 [ 350625  861934  637741       0       0]
 [    917    1057    3260       0       0]
 [    112      64    1432       0       0]
 [      0      11     867       0       0]]
Class 0 F1: 0.6765
Class 1 F1: 0.4737
Class 2 F1: 0.0035
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8801
Class 1 Precision: 0.4819
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5495
Class 1 Recall: 0.4658
Class 2 Recall: 0.6229
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5257
Macro F1 Score: 0.2308
xView2 Score: 0.2553
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4806
Best Macro F1: 0.2101
Best xView2 Score: 0.2700
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8838
Class 1 Precision: 0.3916
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2554
ROC curve saved to .././____________optune_results/185/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/185/plot_loss_curves.jpg
Prediction distribution: {0: 111152, 1: 53255, 2: 97737}
ROC curve saved to .././____________optune_results/185/visualize_predictions.jpg
Prediction distribution: {0: 101957, 1: 14170, 2: 146017}
ROC curve saved to .././____________optune_results/185/visualize_predictions.jpg
Prediction distribution: {0: 137578, 1: 32568, 2: 91998}
ROC curve saved to .././____________optune_results/185/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/185/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/185/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27818704700052, 1: 0.7162197471811421, 2: 130.79270308196038, 3: 805.0487523992323, 4: 5292.497160883281}
Final class weights used in loss: [2.6903738817658103, 4.275300069533231, 509.2167051041198, 805.0487523992323, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5761
Confusion Matrix:
 [[2745837 1625282  418857  230900   66803]
 [ 591894  610228  159253   72123   27052]
 [   1875    2515     157     285     186]
 [    263      90       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6516
Class 1 F1: 0.3300
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8221
Class 1 Precision: 0.2727
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5397
Class 1 Recall: 0.4178
Class 2 Recall: 0.0313
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5121
Macro F1 Score: 0.1964
xView2 Score: 0.1945
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5312
Confusion Matrix:
 [[3763538 1107359  178732   30455    7595]
 [ 779904  593985   71760   11919    2982]
 [   3373    1540      40      65       0]
 [    220     133       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7812
Class 1 F1: 0.3755
Class 2 F1: 0.0003
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8277
Class 1 Precision: 0.3488
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7397
Class 1 Recall: 0.4067
Class 2 Recall: 0.0080
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6649
Macro F1 Score: 0.2314
xView2 Score: 0.1989
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4818
Confusion Matrix:
 [[4287844  734703   61010    3812     310]
 [ 983279  448730   26926    1476     139]
 [   4293     725       0       0       0]
 [    253     100       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8275
Class 1 F1: 0.3393
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8128
Class 1 Precision: 0.3789
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8428
Class 1 Recall: 0.3072
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7227
Macro F1 Score: 0.2334
xView2 Score: 0.1703
Epoch 3 took:  0 hours,  0 minutes, 59 seconds

Epoch 4/10
Train Loss: 1.4388
Confusion Matrix:
 [[4398594  663969   24683     432       1]
 [ 913791  532353   14318      88       0]
 [   3916    1100       2       0       0]
 [    348       5       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8455
Class 1 F1: 0.4006
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8273
Class 1 Precision: 0.4446
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8646
Class 1 Recall: 0.3645
Class 2 Recall: 0.0004
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7524
Macro F1 Score: 0.2492
xView2 Score: 0.2151
Epoch 4 took:  0 hours,  0 minutes, 34 seconds

Epoch 5/10
Train Loss: 1.3816
Confusion Matrix:
 [[4409929  664557   13181      12       0]
 [ 927149  524936    8464       1       0]
 [   4405     586      27       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8457
Class 1 F1: 0.3961
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8255
Class 1 Precision: 0.4411
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8668
Class 1 Recall: 0.3594
Class 2 Recall: 0.0054
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7530
Macro F1 Score: 0.3109
xView2 Score: 0.2129
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3433
Confusion Matrix:
 [[4309114  771089    7476       0       0]
 [ 824953  632935    2662       0       0]
 [   4559     459       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8427
Class 1 F1: 0.4418
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8385
Class 1 Precision: 0.4507
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8470
Class 1 Recall: 0.4334
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7541
Macro F1 Score: 0.3211
xView2 Score: 0.2383
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2924
Confusion Matrix:
 [[4315849  768873    2957       0       0]
 [ 816124  642398    2028       0       0]
 [   4431     587       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8442
Class 1 F1: 0.4473
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8402
Class 1 Precision: 0.4550
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8483
Class 1 Recall: 0.4398
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7566
Macro F1 Score: 0.3229
xView2 Score: 0.2411
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2412
Confusion Matrix:
 [[4082178 1004432    1069       0       0]
 [ 701515  758417     618       0       0]
 [   3902    1116       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8267
Class 1 F1: 0.4704
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8526
Class 1 Precision: 0.4300
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8024
Class 1 Recall: 0.5193
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7386
Macro F1 Score: 0.3243
xView2 Score: 0.2607
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2089
Confusion Matrix:
 [[3967357 1120035     287       0       0]
 [ 639828  820601     121       0       0]
 [   4671     347       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8180
Class 1 F1: 0.4825
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8602
Class 1 Precision: 0.4228
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7798
Class 1 Recall: 0.5618
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7306
Macro F1 Score: 0.3251
xView2 Score: 0.2705
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1677
Confusion Matrix:
 [[4037338 1050251      90       0       0]
 [ 680562  779869     119       0       0]
 [   3954    1064       0       0       0]
 [    353       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8231
Class 1 F1: 0.4738
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8550
Class 1 Precision: 0.4259
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7936
Class 1 Recall: 0.5340
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7350
Macro F1 Score: 0.3242
xView2 Score: 0.2639
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7306
Best Macro F1: 0.3251
Best xView2 Score: 0.2705
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8602
Class 1 Precision: 0.4228
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3207
ROC curve saved to .././____________optune_results/186/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/186/plot_loss_curves.jpg
Prediction distribution: {0: 210733, 1: 51411}
ROC curve saved to .././____________optune_results/186/visualize_predictions.jpg
Prediction distribution: {0: 69117, 1: 193013, 2: 14}
ROC curve saved to .././____________optune_results/186/visualize_predictions.jpg
Prediction distribution: {0: 262140, 1: 4}
ROC curve saved to .././____________optune_results/186/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/186/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/186/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2776457733249014, 1: 0.7200227286837764, 2: 125.80081481666625, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.685139171611355, 4.298001045241645, 166.58212448322112, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6716
Confusion Matrix:
 [[ 802063  633301  464781 1959839 1192423]
 [  57635  294940  110400  550739  483953]
 [    184     815     237    1565     690]
 [      0       0       0       0      35]
 [      0       0       0       0       0]]
Class 0 F1: 0.2713
Class 1 F1: 0.2431
Class 2 F1: 0.0008
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9328
Class 1 Precision: 0.3175
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1587
Class 1 Recall: 0.1969
Class 2 Recall: 0.0679
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1674
Macro F1 Score: 0.1030
xView2 Score: 0.1670
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5918
Confusion Matrix:
 [[2751874 1062223  129838  744036  364436]
 [ 314037  663660   60037  276103  183830]
 [   1168    1653     188     237     245]
 [     25       0       0       0      10]
 [      0       0       0       0       0]]
Class 0 F1: 0.6778
Class 1 F1: 0.4115
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8972
Class 1 Precision: 0.3842
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5447
Class 1 Recall: 0.4431
Class 2 Recall: 0.0539
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5212
Macro F1 Score: 0.2183
xView2 Score: 0.2294
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.5178
Confusion Matrix:
 [[3623472 1159329   28142  174152   67312]
 [ 563942  791908   17613   81861   42343]
 [   1733    1671       0       0      87]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7842
Class 1 F1: 0.4590
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8650
Class 1 Precision: 0.4055
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7172
Class 1 Recall: 0.5288
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6737
Macro F1 Score: 0.2486
xView2 Score: 0.2420
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.4457
Confusion Matrix:
 [[3728743 1296428    1702   21081    4453]
 [ 525893  960546    1460    7285    2483]
 [   2333    1158       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8011
Class 1 F1: 0.5115
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8759
Class 1 Precision: 0.4254
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7380
Class 1 Recall: 0.6414
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7155
Macro F1 Score: 0.2625
xView2 Score: 0.2631
Epoch 4 took:  0 hours,  1 minutes, 15 seconds

Epoch 5/10
Train Loss: 1.3656
Confusion Matrix:
 [[3705663 1343627      33    2466     618]
 [ 433200 1063882      25     475      85]
 [   1653    1838       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8062
Class 1 F1: 0.5446
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8950
Class 1 Precision: 0.4416
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7334
Class 1 Recall: 0.7104
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7278
Macro F1 Score: 0.2702
xView2 Score: 0.2797
Epoch 5 took:  0 hours,  0 minutes, 46 seconds

Epoch 6/10
Train Loss: 1.3049
Confusion Matrix:
 [[3898171 1154112       0     120       4]
 [ 546568  951027       0      71       1]
 [   2143    1348       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8207
Class 1 F1: 0.5277
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8766
Class 1 Precision: 0.4515
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7715
Class 1 Recall: 0.6350
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7399
Macro F1 Score: 0.2697
xView2 Score: 0.2671
Epoch 6 took:  0 hours,  0 minutes, 30 seconds

Epoch 7/10
Train Loss: 1.2306
Confusion Matrix:
 [[3859996 1192404       0       7       0]
 [ 529409  968257       0       1       0]
 [   2461    1030       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8174
Class 1 F1: 0.5292
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8789
Class 1 Precision: 0.4479
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7640
Class 1 Recall: 0.6465
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7367
Macro F1 Score: 0.3367
xView2 Score: 0.2961
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1911
Confusion Matrix:
 [[3926742 1125665       0       0       0]
 [ 568863  928804       0       0       0]
 [   2189    1302       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8223
Class 1 F1: 0.5228
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8730
Class 1 Precision: 0.4518
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7772
Class 1 Recall: 0.6202
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7409
Macro F1 Score: 0.3363
xView2 Score: 0.2908
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1247
Confusion Matrix:
 [[3795635 1256772       0       0       0]
 [ 457866 1039801       0       0       0]
 [   1529    1962       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8156
Class 1 F1: 0.5478
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8920
Class 1 Precision: 0.4524
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7513
Class 1 Recall: 0.6943
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7378
Macro F1 Score: 0.3409
xView2 Score: 0.3078
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0920
Confusion Matrix:
 [[3952707 1099700       0       0       0]
 [ 561443  936224       0       0       0]
 [   2409    1082       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8261
Class 1 F1: 0.5297
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8752
Class 1 Precision: 0.4596
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7823
Class 1 Recall: 0.6251
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7460
Macro F1 Score: 0.3390
xView2 Score: 0.2935
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7378
Best Macro F1: 0.3409
Best xView2 Score: 0.3078
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8920
Class 1 Precision: 0.4524
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3361
ROC curve saved to .././____________optune_results/187/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/187/plot_loss_curves.jpg
Prediction distribution: {0: 245777, 1: 16367}
ROC curve saved to .././____________optune_results/187/visualize_predictions.jpg
Prediction distribution: {0: 69103, 1: 193041}
ROC curve saved to .././____________optune_results/187/visualize_predictions.jpg
Prediction distribution: {0: 198541, 1: 63603}
ROC curve saved to .././____________optune_results/187/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/187/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/187/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27412537778147406, 1: 0.7446833083806753, 2: 127.7064041408708, 3: 860.5171482304668, 4: 5292.497160883281}
Final class weights used in loss: [2.6510930852617483, 4.445206394588452, 419.80536939874685, 860.5171482304668, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5156
Confusion Matrix:
 [[2269438 2223189  319939    4581    2455]
 [ 488353 1186351   52918    1129     403]
 [   1793    2273      22       0       0]
 [    250     506       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5988
Class 1 F1: 0.4615
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8223
Class 1 Precision: 0.3477
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4709
Class 1 Recall: 0.6861
Class 2 Recall: 0.0054
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5273
Macro F1 Score: 0.2121
xView2 Score: 0.2489
Epoch 1 took:  0 hours,  1 minutes, 12 seconds

Epoch 2/10
Train Loss: 1.4638
Confusion Matrix:
 [[3053572 1687869   77767     319      75]
 [ 692981 1014596   21385     180      12]
 [   1049    2642     397       0       0]
 [    289     467       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7128
Class 1 F1: 0.4576
Class 2 F1: 0.0077
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8147
Class 1 Precision: 0.3750
Class 2 Precision: 0.0040
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6336
Class 1 Recall: 0.5868
Class 2 Recall: 0.0971
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6208
Macro F1 Score: 0.2356
xView2 Score: 0.2451
Epoch 2 took:  0 hours,  0 minutes, 42 seconds

Epoch 3/10
Train Loss: 1.4109
Confusion Matrix:
 [[3281755 1528696    9145       6       0]
 [ 763420  961585    4139      10       0]
 [   2486    1602       0       0       0]
 [    395     361       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7402
Class 1 F1: 0.4556
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8107
Class 1 Precision: 0.3858
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6809
Class 1 Recall: 0.5561
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6475
Macro F1 Score: 0.2989
xView2 Score: 0.2619
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3669
Confusion Matrix:
 [[3230248 1588728     626       0       0]
 [ 651208 1077570     376       0       0]
 [   2108    1980       0       0       0]
 [    477     279       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7423
Class 1 F1: 0.4901
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8317
Class 1 Precision: 0.4038
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6702
Class 1 Recall: 0.6232
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6573
Macro F1 Score: 0.3081
xView2 Score: 0.2814
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3132
Confusion Matrix:
 [[3313321 1506255      26       0       0]
 [ 651641 1077493      20       0       0]
 [   2231    1857       0       0       0]
 [    681      75       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7541
Class 1 F1: 0.4994
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8350
Class 1 Precision: 0.4167
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6875
Class 1 Recall: 0.6231
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6700
Macro F1 Score: 0.3134
xView2 Score: 0.2842
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2491
Confusion Matrix:
 [[3143939 1675660       3       0       0]
 [ 569409 1159744       1       0       0]
 [   1936    2152       0       0       0]
 [    621     135       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7367
Class 1 F1: 0.5079
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8461
Class 1 Precision: 0.4087
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6523
Class 1 Recall: 0.6707
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6567
Macro F1 Score: 0.3111
xView2 Score: 0.2929
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2302
Confusion Matrix:
 [[3053011 1766591       0       0       0]
 [ 438875 1290279       0       0       0]
 [   1447    2641       0       0       0]
 [    395     361       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7345
Class 1 F1: 0.5388
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8739
Class 1 Precision: 0.4217
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6335
Class 1 Recall: 0.7462
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6627
Macro F1 Score: 0.3183
xView2 Score: 0.3113
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1836
Confusion Matrix:
 [[3215471 1604131       0       0       0]
 [ 527000 1202154       0       0       0]
 [   1523    2565       0       0       0]
 [    463     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7509
Class 1 F1: 0.5298
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8587
Class 1 Precision: 0.4279
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6672
Class 1 Recall: 0.6952
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6741
Macro F1 Score: 0.3202
xView2 Score: 0.3025
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1340
Confusion Matrix:
 [[3143589 1676013       0       0       0]
 [ 461287 1267867       0       0       0]
 [   1333    2755       0       0       0]
 [    240     516       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7462
Class 1 F1: 0.5423
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8717
Class 1 Precision: 0.4302
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6523
Class 1 Recall: 0.7332
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6731
Macro F1 Score: 0.3221
xView2 Score: 0.3108
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1145
Confusion Matrix:
 [[3060491 1759111       0       0       0]
 [ 467766 1261388       0       0       0]
 [   1501    2587       0       0       0]
 [    463     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7331
Class 1 F1: 0.5308
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8669
Class 1 Precision: 0.4172
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6350
Class 1 Recall: 0.7295
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6595
Macro F1 Score: 0.3160
xView2 Score: 0.3069
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6627
Best Macro F1: 0.3183
Best xView2 Score: 0.3113
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8739
Class 1 Precision: 0.4217
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3239
ROC curve saved to .././____________optune_results/188/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/188/plot_loss_curves.jpg
Prediction distribution: {0: 61361, 1: 200783}
ROC curve saved to .././____________optune_results/188/visualize_predictions.jpg
Prediction distribution: {0: 190842, 1: 71302}
ROC curve saved to .././____________optune_results/188/visualize_predictions.jpg
Prediction distribution: {0: 41605, 1: 220539}
ROC curve saved to .././____________optune_results/188/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/188/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/188/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27439801510911505, 1: 0.7419982465650351, 2: 155.14826300052403, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.653729787269942, 4.429178569312358, 267.48282546015804, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5610
Confusion Matrix:
 [[2264264 2135057    3611  314354  120559]
 [ 655473  882715    1329  101584   63595]
 [   2239    6162       0    1123    1535]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5836
Class 1 F1: 0.3733
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7749
Class 1 Precision: 0.2919
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4680
Class 1 Recall: 0.5178
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4802
Macro F1 Score: 0.1914
xView2 Score: 0.2140
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.4937
Confusion Matrix:
 [[3461166 1330641     429   32271   13338]
 [ 866821  817047     246   14269    6313]
 [   5790    4432       0     205     632]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7548
Class 1 F1: 0.4237
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7986
Class 1 Precision: 0.3796
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7154
Class 1 Recall: 0.4793
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6528
Macro F1 Score: 0.2357
xView2 Score: 0.2191
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.4358
Confusion Matrix:
 [[3963250  871505      40    2494     556]
 [1037732  665342      10    1402     210]
 [   9021    2032       0       6       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8049
Class 1 F1: 0.4103
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7911
Class 1 Precision: 0.4324
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8192
Class 1 Recall: 0.3903
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7063
Macro F1 Score: 0.2430
xView2 Score: 0.2017
Epoch 3 took:  0 hours,  1 minutes,  2 seconds

Epoch 4/10
Train Loss: 1.3757
Confusion Matrix:
 [[3887103  950475       2     243      22]
 [ 898615  805948       0     130       3]
 [   8222    2837       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8071
Class 1 F1: 0.4653
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8108
Class 1 Precision: 0.4581
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8035
Class 1 Recall: 0.4728
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7161
Macro F1 Score: 0.2545
xView2 Score: 0.2294
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.3234
Confusion Matrix:
 [[3839141  998677       0      27       0]
 [ 852314  852382       0       0       0]
 [   8092    2960       0       7       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8051
Class 1 F1: 0.4790
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8169
Class 1 Precision: 0.4597
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7936
Class 1 Recall: 0.5000
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7159
Macro F1 Score: 0.3210
xView2 Score: 0.2603
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2559
Confusion Matrix:
 [[3613262 1224578       0       5       0]
 [ 720466  984230       0       0       0]
 [   7745    3314       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7873
Class 1 F1: 0.5026
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8323
Class 1 Precision: 0.4449
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7469
Class 1 Recall: 0.5774
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7015
Macro F1 Score: 0.3225
xView2 Score: 0.3215
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2124
Confusion Matrix:
 [[3624891 1212954       0       0       0]
 [ 679384 1025312       0       0       0]
 [   6685    4374       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7924
Class 1 F1: 0.5195
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8409
Class 1 Precision: 0.4572
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7493
Class 1 Recall: 0.6015
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7096
Macro F1 Score: 0.4373
xView2 Score: 0.3311
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1496
Confusion Matrix:
 [[3500173 1337672       0       0       0]
 [ 575754 1128942       0       0       0]
 [   5103    5956       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7849
Class 1 F1: 0.5405
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8577
Class 1 Precision: 0.4566
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7235
Class 1 Recall: 0.6623
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7063
Macro F1 Score: 0.4418
xView2 Score: 0.3481
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1266
Confusion Matrix:
 [[3609163 1228682       0       0       0]
 [ 611677 1093019       0       0       0]
 [   6233    4826       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7963
Class 1 F1: 0.5423
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8538
Class 1 Precision: 0.4698
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7460
Class 1 Recall: 0.6412
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7175
Macro F1 Score: 0.4462
xView2 Score: 0.3450
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0886
Confusion Matrix:
 [[3690943 1146902       0       0       0]
 [ 664928 1039768       0       0       0]
 [   6928    4131       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8023
Class 1 F1: 0.5338
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8460
Class 1 Precision: 0.4746
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7629
Class 1 Recall: 0.6099
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7218
Macro F1 Score: 0.4454
xView2 Score: 0.3369
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7063
Best Macro F1: 0.4418
Best xView2 Score: 0.3481
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8577
Class 1 Precision: 0.4566
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4381
ROC curve saved to .././____________optune_results/189/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/189/plot_loss_curves.jpg
Prediction distribution: {0: 149404, 1: 112740}
ROC curve saved to .././____________optune_results/189/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/189/visualize_predictions.jpg
Prediction distribution: {0: 54792, 1: 207352}
ROC curve saved to .././____________optune_results/189/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/189/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/189/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.276159603282532, 1: 0.7294459710987694, 2: 150.98739463026848, 3: 830.144285007422, 4: 5732.533940774488}
Final class weights used in loss: [2.670766277154317, 4.354250805333584, 349.5767499940974, 830.144285007422, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5162
Confusion Matrix:
 [[2532328 2074556  318627   27283    2056]
 [ 566969  955273   59910    3964    1854]
 [   4769    4962     425       6       3]
 [    134     408       0       0       0]
 [     56      17       0       0       0]]
Class 0 F1: 0.6284
Class 1 F1: 0.4133
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8158
Class 1 Precision: 0.3147
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5111
Class 1 Recall: 0.6016
Class 2 Recall: 0.0418
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5322
Macro F1 Score: 0.2088
xView2 Score: 0.2287
Epoch 1 took:  0 hours,  1 minutes, 11 seconds

Epoch 2/10
Train Loss: 1.4559
Confusion Matrix:
 [[3440239 1469476   43526    1514      95]
 [ 701933  873392   12332     227      86]
 [   5911    4190      64       0       0]
 [    278     259       5       0       0]
 [     25      48       0       0       0]]
Class 0 F1: 0.7558
Class 1 F1: 0.4439
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8293
Class 1 Precision: 0.3721
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6943
Class 1 Recall: 0.5500
Class 2 Recall: 0.0063
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6582
Macro F1 Score: 0.2403
xView2 Score: 0.2334
Epoch 2 took:  0 hours,  0 minutes, 39 seconds

Epoch 3/10
Train Loss: 1.3969
Confusion Matrix:
 [[3747869 1201552    5429       0       0]
 [ 796513  790199    1256       0       2]
 [   5244    4921       0       0       0]
 [    156     386       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7886
Class 1 F1: 0.4408
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8237
Class 1 Precision: 0.3957
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7564
Class 1 Recall: 0.4976
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6925
Macro F1 Score: 0.2459
xView2 Score: 0.2255
Epoch 3 took:  0 hours,  0 minutes, 27 seconds

Epoch 4/10
Train Loss: 1.3428
Confusion Matrix:
 [[3694943 1259250     657       0       0]
 [ 711357  876556      57       0       0]
 [   6019    4146       0       0       0]
 [    247     295       0       0       0]
 [     71       2       0       0       0]]
Class 0 F1: 0.7889
Class 1 F1: 0.4702
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8374
Class 1 Precision: 0.4096
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7457
Class 1 Recall: 0.5520
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6976
Macro F1 Score: 0.2518
xView2 Score: 0.2408
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2915
Confusion Matrix:
 [[3507691 1447159       0       0       0]
 [ 581653 1006317       0       0       0]
 [   4449    5716       0       0       0]
 [    197     345       0       0       0]
 [     55      18       0       0       0]]
Class 0 F1: 0.7753
Class 1 F1: 0.4973
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8568
Class 1 Precision: 0.4091
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7079
Class 1 Recall: 0.6337
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6888
Macro F1 Score: 0.2545
xView2 Score: 0.2580
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2241
Confusion Matrix:
 [[3629618 1325232       0       0       0]
 [ 615344  972626       0       0       0]
 [   4415    5750       0       0       0]
 [    427     115       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7886
Class 1 F1: 0.4998
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8541
Class 1 Precision: 0.4222
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7325
Class 1 Recall: 0.6125
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7022
Macro F1 Score: 0.2577
xView2 Score: 0.2566
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1778
Confusion Matrix:
 [[3726151 1228699       0       0       0]
 [ 646919  941051       0       0       0]
 [   5619    4546       0       0       0]
 [    480      62       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7984
Class 1 F1: 0.5002
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8509
Class 1 Precision: 0.4328
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7520
Class 1 Recall: 0.5926
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7122
Macro F1 Score: 0.2597
xView2 Score: 0.2544
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1251
Confusion Matrix:
 [[3616870 1337980       0       0       0]
 [ 661512  926458       0       0       0]
 [   4726    5439       0       0       0]
 [    538       4       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7830
Class 1 F1: 0.4803
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8443
Class 1 Precision: 0.4082
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7300
Class 1 Recall: 0.5834
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6933
Macro F1 Score: 0.2527
xView2 Score: 0.2475
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0839
Confusion Matrix:
 [[3569918 1384932       0       0       0]
 [ 531562 1056408       0       0       0]
 [   3764    6401       0       0       0]
 [    371     171       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.7880
Class 1 F1: 0.5235
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8695
Class 1 Precision: 0.4316
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7205
Class 1 Recall: 0.6653
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7059
Macro F1 Score: 0.2623
xView2 Score: 0.2692
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0563
Confusion Matrix:
 [[3571208 1383642       0       0       0]
 [ 511055 1076915       0       0       0]
 [   2003    8162       0       0       0]
 [    217     325       0       0       0]
 [     59      14       0       0       0]]
Class 0 F1: 0.7901
Class 1 F1: 0.5309
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8743
Class 1 Precision: 0.4362
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7207
Class 1 Recall: 0.6782
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7092
Macro F1 Score: 0.2642
xView2 Score: 0.2729
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7092
Best Macro F1: 0.2642
Best xView2 Score: 0.2729
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8743
Class 1 Precision: 0.4362
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2621
ROC curve saved to .././____________optune_results/190/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/190/plot_loss_curves.jpg
Prediction distribution: {0: 127544, 1: 134600}
ROC curve saved to .././____________optune_results/190/visualize_predictions.jpg
Prediction distribution: {0: 214253, 1: 47891}
ROC curve saved to .././____________optune_results/190/visualize_predictions.jpg
Prediction distribution: {0: 252547, 1: 9597}
ROC curve saved to .././____________optune_results/190/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/190/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/190/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27755654126352525, 1: 0.719469305482554, 2: 156.1155334987593, 3: 1605.9874920229738, 4: 5292.497160883281}
Final class weights used in loss: [2.684276199701156, 4.294697519668691, 177.12312468994585, 1605.9874920229738, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5366
Confusion Matrix:
 [[2789728 1928450  316334     668   11399]
 [ 591087  758387  139529     471    2816]
 [   3960    6192    1101       0       7]
 [   1178    1630     643       0      20]
 [      0       0       0       0       0]]
Class 0 F1: 0.6617
Class 1 F1: 0.3623
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8239
Class 1 Precision: 0.2814
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5528
Class 1 Recall: 0.5082
Class 2 Recall: 0.0978
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5416
Macro F1 Score: 0.2057
xView2 Score: 0.2129
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4661
Confusion Matrix:
 [[3519918 1475780   50572      22     287]
 [ 697348  770258   24647       5      32]
 [   7864    3302      94       0       0]
 [   1132    2258      81       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7592
Class 1 F1: 0.4115
Class 2 F1: 0.0022
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8329
Class 1 Precision: 0.3421
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6975
Class 1 Recall: 0.5162
Class 2 Recall: 0.0083
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6546
Macro F1 Score: 0.2346
xView2 Score: 0.2211
Epoch 2 took:  0 hours,  1 minutes,  0 seconds

Epoch 3/10
Train Loss: 1.4129
Confusion Matrix:
 [[3852082 1185384    9113       0       0]
 [ 791988  696404    3898       0       0]
 [   8287    2966       7       0       0]
 [   1802    1660       9       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7942
Class 1 F1: 0.4122
Class 2 F1: 0.0006
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8277
Class 1 Precision: 0.3692
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7633
Class 1 Recall: 0.4667
Class 2 Recall: 0.0006
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6940
Macro F1 Score: 0.3017
xView2 Score: 0.2355
Epoch 3 took:  0 hours,  0 minutes, 29 seconds

Epoch 4/10
Train Loss: 1.3525
Confusion Matrix:
 [[4023876 1022212     491       0       0]
 [ 729404  762426     460       0       0]
 [   8662    2598       0       0       0]
 [   1253    2218       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8204
Class 1 F1: 0.4646
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8448
Class 1 Precision: 0.4261
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7973
Class 1 Recall: 0.5109
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7303
Macro F1 Score: 0.3213
xView2 Score: 0.2578
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.2831
Confusion Matrix:
 [[3877135 1169367      77       0       0]
 [ 630505  861729      56       0       0]
 [   9482    1778       0       0       0]
 [   1324    2147       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8107
Class 1 F1: 0.4886
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8581
Class 1 Precision: 0.4234
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7683
Class 1 Recall: 0.5775
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7231
Macro F1 Score: 0.3248
xView2 Score: 0.2746
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2256
Confusion Matrix:
 [[3852867 1193697      15       0       0]
 [ 550700  941590       0       0       0]
 [   5828    5432       0       0       0]
 [    110    3361       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8149
Class 1 F1: 0.5179
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8738
Class 1 Precision: 0.4392
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7635
Class 1 Recall: 0.6310
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7316
Macro F1 Score: 0.3332
xView2 Score: 0.2911
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.1567
Confusion Matrix:
 [[3810581 1235998       0       0       0]
 [ 564148  928142       0       0       0]
 [   7369    3891       0       0       0]
 [    133    3338       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8083
Class 1 F1: 0.5067
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8696
Class 1 Precision: 0.4274
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7551
Class 1 Recall: 0.6220
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7231
Macro F1 Score: 0.3287
xView2 Score: 0.2864
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1131
Confusion Matrix:
 [[3879919 1166660       0       0       0]
 [ 597824  894466       0       0       0]
 [   8728    2532       0       0       0]
 [    601    2870       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8139
Class 1 F1: 0.5027
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8647
Class 1 Precision: 0.4328
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7688
Class 1 Recall: 0.5994
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7285
Macro F1 Score: 0.3292
xView2 Score: 0.2820
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.0737
Confusion Matrix:
 [[3716225 1330354       0       0       0]
 [ 541551  950739       0       0       0]
 [   9330    1930       0       0       0]
 [    987    2484       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7979
Class 1 F1: 0.5033
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8707
Class 1 Precision: 0.4160
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7364
Class 1 Recall: 0.6371
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7121
Macro F1 Score: 0.3253
xView2 Score: 0.2871
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.0444
Confusion Matrix:
 [[3662051 1384528       0       0       0]
 [ 466879 1025411       0       0       0]
 [   6158    5102       0       0       0]
 [    110    3361       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7977
Class 1 F1: 0.5244
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8856
Class 1 Precision: 0.4240
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7257
Class 1 Recall: 0.6871
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7152
Macro F1 Score: 0.3305
xView2 Score: 0.3001
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7152
Best Macro F1: 0.3305
Best xView2 Score: 0.3001
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8856
Class 1 Precision: 0.4240
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3274
ROC curve saved to .././____________optune_results/191/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/191/plot_loss_curves.jpg
Prediction distribution: {0: 59048, 1: 203096}
ROC curve saved to .././____________optune_results/191/visualize_predictions.jpg
Prediction distribution: {0: 225515, 1: 36629}
ROC curve saved to .././____________optune_results/191/visualize_predictions.jpg
Prediction distribution: {0: 218455, 1: 43689}
ROC curve saved to .././____________optune_results/191/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/191/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/191/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27363345549573415, 1: 0.7471378047811988, 2: 180.71107281344248, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.646335657179877, 4.459857915540127, 3057.6488388664297, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.4964
Confusion Matrix:
 [[3909097  134122  637230  106145       0]
 [1261122   92609  389449    8178       0]
 [  13923     642    1083       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7841
Class 1 F1: 0.0936
Class 2 F1: 0.0021
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7540
Class 1 Precision: 0.4073
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8167
Class 1 Recall: 0.0529
Class 2 Recall: 0.0692
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6108
Macro F1 Score: 0.2199
xView2 Score: 0.1126
Epoch 1 took:  0 hours,  0 minutes, 24 seconds

Epoch 2/10
Train Loss: 1.4626
Confusion Matrix:
 [[4001872  110106  661045   13571       0]
 [1199373   91675  458840    1470       0]
 [  13022    1151    1471       4       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8003
Class 1 F1: 0.0938
Class 2 F1: 0.0026
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7675
Class 1 Precision: 0.4518
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8361
Class 1 Recall: 0.0523
Class 2 Recall: 0.0940
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6249
Macro F1 Score: 0.2242
xView2 Score: 0.1256
Epoch 2 took:  0 hours,  0 minutes, 25 seconds

Epoch 3/10
Train Loss: 1.4225
Confusion Matrix:
 [[3924283   93751  766534    2026       0]
 [1095759   78732  576710     157       0]
 [  10674    3235    1739       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7995
Class 1 F1: 0.0817
Class 2 F1: 0.0026
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7801
Class 1 Precision: 0.4481
Class 2 Precision: 0.0013
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8198
Class 1 Recall: 0.0450
Class 2 Recall: 0.1111
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6111
Macro F1 Score: 0.2209
xView2 Score: 0.1365
Epoch 3 took:  0 hours,  0 minutes, 25 seconds

Epoch 4/10
Train Loss: 1.3976
Confusion Matrix:
 [[3902883  110170  773466      75       0]
 [1022687  104321  624350       0       0]
 [  13708     252    1688       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8026
Class 1 F1: 0.1061
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7902
Class 1 Precision: 0.4858
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8154
Class 1 Recall: 0.0596
Class 2 Recall: 0.1079
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6117
Macro F1 Score: 0.2278
xView2 Score: 0.1571
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3563
Confusion Matrix:
 [[3625907  123667 1037020       0       0]
 [ 816694  115055  819609       0       0]
 [  12267     777    2604       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7847
Class 1 F1: 0.1156
Class 2 F1: 0.0028
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8139
Class 1 Precision: 0.4804
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7575
Class 1 Recall: 0.0657
Class 2 Recall: 0.1664
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5712
Macro F1 Score: 0.3010
xView2 Score: 0.1758
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3190
Confusion Matrix:
 [[3401349  120730 1264515       0       0]
 [ 648229  117719  985410       0       0]
 [  12672     366    2610       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7688
Class 1 F1: 0.1183
Class 2 F1: 0.0023
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8373
Class 1 Precision: 0.4929
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7106
Class 1 Recall: 0.0672
Class 2 Recall: 0.1668
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5374
Macro F1 Score: 0.2965
xView2 Score: 0.1864
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2730
Confusion Matrix:
 [[3223997   68898 1493699       0       0]
 [ 571214   72617 1107527       0       0]
 [   8698      94    6856       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7506
Class 1 F1: 0.0767
Class 2 F1: 0.0052
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8475
Class 1 Precision: 0.5128
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6735
Class 1 Recall: 0.0415
Class 2 Recall: 0.4381
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5041
Macro F1 Score: 0.2775
xView2 Score: 0.1791
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2362
Confusion Matrix:
 [[3241459   73344 1471791       0       0]
 [ 552197   79310 1119851       0       0]
 [   8965     124    6559       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7548
Class 1 F1: 0.0833
Class 2 F1: 0.0050
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8524
Class 1 Precision: 0.5191
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6772
Class 1 Recall: 0.0453
Class 2 Recall: 0.4192
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5077
Macro F1 Score: 0.2810
xView2 Score: 0.1830
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1968
Confusion Matrix:
 [[3279456   69423 1437715       0       0]
 [ 599017   79819 1072522       0       0]
 [  10157       0    5491       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7561
Class 1 F1: 0.0840
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8433
Class 1 Precision: 0.5348
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6851
Class 1 Recall: 0.0456
Class 2 Recall: 0.3509
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5134
Macro F1 Score: 0.2815
xView2 Score: 0.1794
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1894
Confusion Matrix:
 [[3135892   81390 1569312       0       0]
 [ 514594   93140 1143624       0       0]
 [   8512       9    7127       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7426
Class 1 F1: 0.0967
Class 2 F1: 0.0052
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8570
Class 1 Precision: 0.5336
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6551
Class 1 Recall: 0.0532
Class 2 Recall: 0.4555
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4938
Macro F1 Score: 0.2815
xView2 Score: 0.1865
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4938
Best Macro F1: 0.2815
Best xView2 Score: 0.1865
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8570
Class 1 Precision: 0.5336
Class 2 Precision: 0.0026
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4644
ROC curve saved to .././____________optune_results/192/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/192/plot_loss_curves.jpg
Prediction distribution: {0: 171338, 1: 128, 2: 90678}
ROC curve saved to .././____________optune_results/192/visualize_predictions.jpg
Prediction distribution: {0: 261362, 2: 782}
ROC curve saved to .././____________optune_results/192/visualize_predictions.jpg
Prediction distribution: {0: 55633, 1: 3097, 2: 203414}
ROC curve saved to .././____________optune_results/192/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/192/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/192/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2777340512870204, 1: 0.7193866275650268, 2: 127.13222530942157, 3: 766.0829223744292, 4: 5292.497160883281}
Final class weights used in loss: [2.6859929163352056, 4.294203993892638, 394.8791866505699, 766.0829223744292, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5356
Confusion Matrix:
 [[3534195 1276608  206386   37218    3762]
 [1096304  331790   56397    6405     590]
 [   2802     585     523       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7293
Class 1 F1: 0.2140
Class 2 F1: 0.0039
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7628
Class 1 Precision: 0.2062
Class 2 Precision: 0.0020
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6987
Class 1 Recall: 0.2225
Class 2 Recall: 0.1338
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5900
Macro F1 Score: 0.1895
xView2 Score: 0.1230
Epoch 1 took:  0 hours,  1 minutes,  9 seconds

Epoch 2/10
Train Loss: 1.4797
Confusion Matrix:
 [[4387187  616222   51767    2896      97]
 [1171034  296428   23365     659       0]
 [   3290     384     236       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8262
Class 1 F1: 0.2466
Class 2 F1: 0.0060
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7888
Class 1 Precision: 0.3247
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8673
Class 1 Recall: 0.1987
Class 2 Recall: 0.0604
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7147
Macro F1 Score: 0.2157
xView2 Score: 0.1385
Epoch 2 took:  0 hours,  0 minutes, 39 seconds

Epoch 3/10
Train Loss: 1.4266
Confusion Matrix:
 [[4628168  418775   11128      98       0]
 [1201847  284007    5595      37       0]
 [   3727     130      53       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8498
Class 1 F1: 0.2588
Class 2 F1: 0.0051
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7933
Class 1 Precision: 0.4040
Class 2 Precision: 0.0032
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9150
Class 1 Recall: 0.1904
Class 2 Recall: 0.0136
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7495
Macro F1 Score: 0.2785
xView2 Score: 0.1364
Epoch 3 took:  0 hours,  0 minutes, 26 seconds

Epoch 4/10
Train Loss: 1.3751
Confusion Matrix:
 [[4590405  466653    1111       0       0]
 [1071142  419485     859       0       0]
 [   2886    1024       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8562
Class 1 F1: 0.3527
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8104
Class 1 Precision: 0.4728
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9075
Class 1 Recall: 0.2813
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7644
Macro F1 Score: 0.3022
xView2 Score: 0.1828
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3216
Confusion Matrix:
 [[4421341  636614     214       0       0]
 [ 924649  566753      84       0       0]
 [   2560    1350       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8497
Class 1 F1: 0.4204
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8266
Class 1 Precision: 0.4704
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8741
Class 1 Recall: 0.3800
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7611
Macro F1 Score: 0.3175
xView2 Score: 0.2226
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2726
Confusion Matrix:
 [[4378201  679942      26       0       0]
 [ 865820  625654      12       0       0]
 [   2181    1729       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8498
Class 1 F1: 0.4471
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8345
Class 1 Precision: 0.4786
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8656
Class 1 Recall: 0.4195
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7635
Macro F1 Score: 0.3242
xView2 Score: 0.2377
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2210
Confusion Matrix:
 [[4117087  941082       0       0       0]
 [ 660432  831054       0       0       0]
 [   1853    2057       0       0       0]
 [      0      35       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8370
Class 1 F1: 0.5090
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8614
Class 1 Precision: 0.4684
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8139
Class 1 Recall: 0.5572
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7550
Macro F1 Score: 0.3365
xView2 Score: 0.2780
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1817
Confusion Matrix:
 [[4039378 1018791       0       0       0]
 [ 601560  889926       0       0       0]
 [   2414    1496       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8327
Class 1 F1: 0.5232
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8699
Class 1 Precision: 0.4659
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7986
Class 1 Recall: 0.5967
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7522
Macro F1 Score: 0.3390
xView2 Score: 0.2878
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1424
Confusion Matrix:
 [[4063277  994892       0       0       0]
 [ 635260  856226       0       0       0]
 [   2880    1030       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8327
Class 1 F1: 0.5122
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8643
Class 1 Precision: 0.4623
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8033
Class 1 Recall: 0.5741
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7507
Macro F1 Score: 0.3362
xView2 Score: 0.2812
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1271
Confusion Matrix:
 [[4013457 1044712       0       0       0]
 [ 566430  925056       0       0       0]
 [   2554    1356       0       0       0]
 [     35       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8326
Class 1 F1: 0.5343
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8758
Class 1 Precision: 0.4693
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7935
Class 1 Recall: 0.6202
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7536
Macro F1 Score: 0.3417
xView2 Score: 0.2943
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7536
Best Macro F1: 0.3417
Best xView2 Score: 0.2943
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8758
Class 1 Precision: 0.4693
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3363
ROC curve saved to .././____________optune_results/193/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/193/plot_loss_curves.jpg
Prediction distribution: {0: 243382, 1: 18762}
ROC curve saved to .././____________optune_results/193/visualize_predictions.jpg
Prediction distribution: {0: 261531, 1: 613}
ROC curve saved to .././____________optune_results/193/visualize_predictions.jpg
Prediction distribution: {0: 196245, 1: 65899}
ROC curve saved to .././____________optune_results/193/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/193/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/193/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2775767313495418, 1: 0.7196171241821469, 2: 152.38623028247903, 3: 972.7802087359877, 4: 5732.533940774488}
Final class weights used in loss: [2.6844714599789987, 4.295579887544103, 407.32604637673427, 972.7802087359877, 5732.533940774488]

Epoch 1/10
Train Loss: 1.5644
Confusion Matrix:
 [[3563654  391183  716464  299224   77373]
 [ 954431  175562  243066   93335   27333]
 [   4425    3141    2262     556      87]
 [   1199     181      41       2       8]
 [     73       0       0       0       0]]
Class 0 F1: 0.7446
Class 1 F1: 0.1701
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7878
Class 1 Precision: 0.3080
Class 2 Precision: 0.0024
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7060
Class 1 Recall: 0.1175
Class 2 Recall: 0.2160
Class 3 Recall: 0.0014
Class 4 Recall: 0.0000
Validation Accuracy: 0.5709
Macro F1 Score: 0.1839
xView2 Score: 0.1245
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5001
Confusion Matrix:
 [[4608018  291937  123329   20218    4396]
 [1241279  188783   54532    7433    1700]
 [   7425    2816     112     118       0]
 [   1358      56      17       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8450
Class 1 F1: 0.1909
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7866
Class 1 Precision: 0.3904
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9129
Class 1 Recall: 0.1264
Class 2 Recall: 0.0107
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7320
Macro F1 Score: 0.2074
xView2 Score: 0.1015
Epoch 2 took:  0 hours,  1 minutes, 16 seconds

Epoch 3/10
Train Loss: 1.4535
Confusion Matrix:
 [[4825559  192102   29466     609     162]
 [1309129  171611   12606     347      34]
 [   9537     934       0       0       0]
 [   1264     167       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8622
Class 1 F1: 0.1847
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7852
Class 1 Precision: 0.4704
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9560
Class 1 Recall: 0.1149
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7625
Macro F1 Score: 0.2094
xView2 Score: 0.0871
Epoch 3 took:  0 hours,  0 minutes, 39 seconds

Epoch 4/10
Train Loss: 1.3874
Confusion Matrix:
 [[4757911  283129    6829      26       3]
 [1211048  279439    3229       9       2]
 [   8344    2126       1       0       0]
 [   1187     244       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8630
Class 1 F1: 0.2715
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7958
Class 1 Precision: 0.4946
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9426
Class 1 Recall: 0.1871
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7686
Macro F1 Score: 0.2269
xView2 Score: 0.1263
Epoch 4 took:  0 hours,  0 minutes, 29 seconds

Epoch 5/10
Train Loss: 1.3287
Confusion Matrix:
 [[4487160  559562    1176       0       0]
 [1017487  475642     598       0       0]
 [   7979    2492       0       0       0]
 [    905     526       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8497
Class 1 F1: 0.3757
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8138
Class 1 Precision: 0.4581
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8889
Class 1 Recall: 0.3184
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7573
Macro F1 Score: 0.2451
xView2 Score: 0.1805
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.2781
Confusion Matrix:
 [[4319016  728814      68       0       0]
 [ 856464  637191      72       0       0]
 [   4745    5726       0       0       0]
 [   1092     339       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8444
Class 1 F1: 0.4447
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8336
Class 1 Precision: 0.4644
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8556
Class 1 Recall: 0.4266
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7563
Macro F1 Score: 0.2578
xView2 Score: 0.2176
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2264
Confusion Matrix:
 [[4264067  783831       0       0       0]
 [ 789326  704400       1       0       0]
 [   5321    5150       0       0       0]
 [    717     714       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8438
Class 1 F1: 0.4715
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8428
Class 1 Precision: 0.4715
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8447
Class 1 Recall: 0.4716
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7581
Macro F1 Score: 0.2631
xView2 Score: 0.2316
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.1783
Confusion Matrix:
 [[4194862  853036       0       0       0]
 [ 749436  744291       0       0       0]
 [   5584    4887       0       0       0]
 [   1269     162       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8390
Class 1 F1: 0.4808
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8472
Class 1 Precision: 0.4645
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8310
Class 1 Recall: 0.4983
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7537
Macro F1 Score: 0.2640
xView2 Score: 0.2376
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.1413
Confusion Matrix:
 [[4056262  991636       0       0       0]
 [ 633262  860465       0       0       0]
 [   4337    6134       0       0       0]
 [    845     586       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8327
Class 1 F1: 0.5133
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8640
Class 1 Precision: 0.4629
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8036
Class 1 Recall: 0.5761
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7502
Macro F1 Score: 0.2692
xView2 Score: 0.2567
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1008
Confusion Matrix:
 [[4014074 1033824       0       0       0]
 [ 623079  870648       0       0       0]
 [   4904    5567       0       0       0]
 [    629     802       0       0       0]
 [     73       0       0       0       0]]
Class 0 F1: 0.8284
Class 1 F1: 0.5115
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8646
Class 1 Precision: 0.4556
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7952
Class 1 Recall: 0.5829
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7453
Macro F1 Score: 0.2680
xView2 Score: 0.2568
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7453
Best Macro F1: 0.2680
Best xView2 Score: 0.2568
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8646
Class 1 Precision: 0.4556
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2640
ROC curve saved to .././____________optune_results/194/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/194/plot_loss_curves.jpg
Prediction distribution: {0: 188069, 1: 74075}
ROC curve saved to .././____________optune_results/194/visualize_predictions.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/194/visualize_predictions.jpg
Prediction distribution: {0: 40576, 1: 221568}
ROC curve saved to .././____________optune_results/194/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/194/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/194/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27263577729880145, 1: 0.7560569399037783, 2: 117.6192933258553, 3: 1069.9755102040817, 4: 68947.46301369862}
Final class weights used in loss: [2.636687014684204, 4.5130985294157115, 163.54396884788824, 1069.9755102040817, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6000
Confusion Matrix:
 [[1602289 1777631  612230  396035  331099]
 [ 397328  948868  293124  143462   48047]
 [      8     204     482      14       0]
 [    343     778     341     360      79]
 [    274     175     156     273       0]]
Class 0 F1: 0.4769
Class 1 F1: 0.4163
Class 2 F1: 0.0011
Class 3 F1: 0.0013
Class 4 F1: 0.0000
Class 0 Precision: 0.8010
Class 1 Precision: 0.3479
Class 2 Precision: 0.0005
Class 3 Precision: 0.0007
Class 4 Precision: 0.0000
Class 0 Recall: 0.3395
Class 1 Recall: 0.5183
Class 2 Recall: 0.6808
Class 3 Recall: 0.1894
Class 4 Recall: 0.0000
Validation Accuracy: 0.3894
Macro F1 Score: 0.1791
xView2 Score: 0.2316
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.5292
Confusion Matrix:
 [[3066701 1329088  193135   96714   33646]
 [ 762961  930779   88986   42723    5380]
 [    510     104      94       0       0]
 [   1168     283     401      49       0]
 [    635     243       0       0       0]]
Class 0 F1: 0.7173
Class 1 F1: 0.4550
Class 2 F1: 0.0007
Class 3 F1: 0.0007
Class 4 F1: 0.0000
Class 0 Precision: 0.8003
Class 1 Precision: 0.4118
Class 2 Precision: 0.0003
Class 3 Precision: 0.0004
Class 4 Precision: 0.0000
Class 0 Recall: 0.6498
Class 1 Recall: 0.5084
Class 2 Recall: 0.1328
Class 3 Recall: 0.0258
Class 4 Recall: 0.0000
Validation Accuracy: 0.6100
Macro F1 Score: 0.2347
xView2 Score: 0.2357
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4632
Confusion Matrix:
 [[3600576 1076914   33850    7016     928]
 [ 913148  897420   14766    4934     561]
 [    547     161       0       0       0]
 [   1517     384       0       0       0]
 [    869       9       0       0       0]]
Class 0 F1: 0.7797
Class 1 F1: 0.4716
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7972
Class 1 Precision: 0.4544
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7629
Class 1 Recall: 0.4902
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6863
Macro F1 Score: 0.2503
xView2 Score: 0.2344
Epoch 3 took:  0 hours,  1 minutes,  4 seconds

Epoch 4/10
Train Loss: 1.3996
Confusion Matrix:
 [[3512437 1202397    4152     287      11]
 [ 788801 1040718    1094     211       5]
 [    653      55       0       0       0]
 [    991     910       0       0       0]
 [    698     180       0       0       0]]
Class 0 F1: 0.7786
Class 1 F1: 0.5108
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8162
Class 1 Precision: 0.4637
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7443
Class 1 Recall: 0.5684
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6948
Macro F1 Score: 0.2579
xView2 Score: 0.2547
Epoch 4 took:  0 hours,  0 minutes, 32 seconds

Epoch 5/10
Train Loss: 1.3376
Confusion Matrix:
 [[3288254 1430614     392      24       0]
 [ 596324 1234459      42       4       0]
 [    513     194       1       0       0]
 [    379    1522       0       0       0]
 [    329     549       0       0       0]]
Class 0 F1: 0.7643
Class 1 F1: 0.5489
Class 2 F1: 0.0017
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8462
Class 1 Precision: 0.4628
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6968
Class 1 Recall: 0.6743
Class 2 Recall: 0.0014
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6901
Macro F1 Score: 0.2630
xView2 Score: 0.2779
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.2634
Confusion Matrix:
 [[3224342 1494926      16       0       0]
 [ 556244 1274583       2       0       0]
 [    533     175       0       0       0]
 [   1085     816       0       0       0]
 [    722     156       0       0       0]]
Class 0 F1: 0.7585
Class 1 F1: 0.5540
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8523
Class 1 Precision: 0.4600
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6832
Class 1 Recall: 0.6962
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6865
Macro F1 Score: 0.2625
xView2 Score: 0.2811
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2203
Confusion Matrix:
 [[3136886 1582398       0       0       0]
 [ 493457 1337372       0       0       0]
 [    504     204       0       0       0]
 [    664    1237       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7513
Class 1 F1: 0.5628
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8638
Class 1 Precision: 0.4577
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6647
Class 1 Recall: 0.7305
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6827
Macro F1 Score: 0.2628
xView2 Score: 0.2871
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.1468
Confusion Matrix:
 [[3182099 1537185       0       0       0]
 [ 519683 1311146       0       0       0]
 [    504     204       0       0       0]
 [    920     981       0       0       0]
 [    285     593       0       0       0]]
Class 0 F1: 0.7556
Class 1 F1: 0.5602
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8592
Class 1 Precision: 0.4600
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6743
Class 1 Recall: 0.7161
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6856
Macro F1 Score: 0.2632
xView2 Score: 0.2849
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.0974
Confusion Matrix:
 [[3307979 1411305       0       0       0]
 [ 595261 1235568       0       0       0]
 [    504     204       0       0       0]
 [    688    1213       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7672
Class 1 F1: 0.5516
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8472
Class 1 Precision: 0.4664
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7009
Class 1 Recall: 0.6749
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6933
Macro F1 Score: 0.2638
xView2 Score: 0.2784
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.0732
Confusion Matrix:
 [[3169915 1549369       0       0       0]
 [ 487828 1343001       0       0       0]
 [    114     594       0       0       0]
 [    383    1518       0       0       0]
 [    252     626       0       0       0]]
Class 0 F1: 0.7567
Class 1 F1: 0.5684
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8665
Class 1 Precision: 0.4639
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6717
Class 1 Recall: 0.7335
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6886
Macro F1 Score: 0.2650
xView2 Score: 0.2891
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6886
Best Macro F1: 0.2650
Best xView2 Score: 0.2891
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8665
Class 1 Precision: 0.4639
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2661
ROC curve saved to .././____________optune_results/195/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/195/plot_loss_curves.jpg
Prediction distribution: {0: 155521, 1: 106623}
ROC curve saved to .././____________optune_results/195/visualize_predictions.jpg
Prediction distribution: {0: 55941, 1: 206203}
ROC curve saved to .././____________optune_results/195/visualize_predictions.jpg
Prediction distribution: {0: 152535, 1: 109609}
ROC curve saved to .././____________optune_results/195/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/195/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/195/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27411854005095837, 1: 0.7430168300423474, 2: 197.18569245837415, 3: 1007.2373023814289, 4: 68947.46301369862}
Final class weights used in loss: [2.651026956907505, 4.435258756333894, 1756.9615509261946, 1007.2373023814289, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6422
Confusion Matrix:
 [[ 309367 1759654   42433 2707312     378]
 [ 195975  780534   15372  722053      61]
 [    916    2909      91   14059       0]
 [     63    1026       0     519       0]
 [      0     760       0     118       0]]
Class 0 F1: 0.1162
Class 1 F1: 0.3665
Class 2 F1: 0.0024
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.6110
Class 1 Precision: 0.3067
Class 2 Precision: 0.0016
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.0642
Class 1 Recall: 0.4554
Class 2 Recall: 0.0051
Class 3 Recall: 0.3228
Class 4 Recall: 0.0000
Validation Accuracy: 0.1664
Macro F1 Score: 0.0971
xView2 Score: 0.2070
Epoch 1 took:  0 hours,  0 minutes, 43 seconds

Epoch 2/10
Train Loss: 1.5901
Confusion Matrix:
 [[ 752151 2180082   60344 1826459     108]
 [ 357435  960966   25035  370542      17]
 [   1479    3633       1   12862       0]
 [    686     891       0      31       0]
 [    608     117       0     153       0]]
Class 0 F1: 0.2536
Class 1 F1: 0.3955
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.6762
Class 1 Precision: 0.3055
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1561
Class 1 Recall: 0.5607
Class 2 Recall: 0.0001
Class 3 Recall: 0.0193
Class 4 Recall: 0.0000
Validation Accuracy: 0.2614
Macro F1 Score: 0.1298
xView2 Score: 0.2154
Epoch 2 took:  0 hours,  0 minutes, 36 seconds

Epoch 3/10
Train Loss: 1.5527
Confusion Matrix:
 [[2106174 1863888   75367  773695      20]
 [ 636836  906252   29825  141082       0]
 [   6054    8589     228    3104       0]
 [    912     696       0       0       0]
 [    637     240       0       1       0]]
Class 0 F1: 0.5565
Class 1 F1: 0.4033
Class 2 F1: 0.0037
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7657
Class 1 Precision: 0.3260
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4370
Class 1 Recall: 0.5287
Class 2 Recall: 0.0127
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4597
Macro F1 Score: 0.1927
xView2 Score: 0.2159
Epoch 3 took:  0 hours,  0 minutes, 27 seconds

Epoch 4/10
Train Loss: 1.5058
Confusion Matrix:
 [[3115965 1525404   41642  136130       3]
 [ 740796  924833   20777   27589       0]
 [  12790    2678     114    2393       0]
 [    266    1269      16      57       0]
 [      0     874       4       0       0]]
Class 0 F1: 0.7172
Class 1 F1: 0.4437
Class 2 F1: 0.0028
Class 3 F1: 0.0007
Class 4 F1: 0.0000
Class 0 Precision: 0.8052
Class 1 Precision: 0.3767
Class 2 Precision: 0.0018
Class 3 Precision: 0.0003
Class 4 Precision: 0.0000
Class 0 Recall: 0.6466
Class 1 Recall: 0.5396
Class 2 Recall: 0.0063
Class 3 Recall: 0.0354
Class 4 Recall: 0.0000
Validation Accuracy: 0.6166
Macro F1 Score: 0.2329
xView2 Score: 0.2324
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.4602
Confusion Matrix:
 [[3572067 1199207   25902   21968       0]
 [ 855358  837462   16830    4345       0]
 [  12003    5665      44     263       0]
 [    816     792       0       0       0]
 [      0     876       2       0       0]]
Class 0 F1: 0.7716
Class 1 F1: 0.4457
Class 2 F1: 0.0014
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8045
Class 1 Precision: 0.4097
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7412
Class 1 Recall: 0.4886
Class 2 Recall: 0.0024
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6728
Macro F1 Score: 0.2437
xView2 Score: 0.2271
Epoch 5 took:  0 hours,  0 minutes, 26 seconds

Epoch 6/10
Train Loss: 1.4208
Confusion Matrix:
 [[3663290 1140308   14086    1460       0]
 [ 807985  893140   12362     508       0]
 [  13496    4323     156       0       0]
 [   1468     140       0       0       0]
 [    878       0       0       0       0]]
Class 0 F1: 0.7873
Class 1 F1: 0.4761
Class 2 F1: 0.0070
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8164
Class 1 Precision: 0.4383
Class 2 Precision: 0.0059
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7602
Class 1 Recall: 0.5211
Class 2 Recall: 0.0087
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6953
Macro F1 Score: 0.2541
xView2 Score: 0.2409
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.3878
Confusion Matrix:
 [[3657853 1146061   15139      91       0]
 [ 760654  937824   15443      74       0]
 [  12270    5704       1       0       0]
 [    963     645       0       0       0]
 [    686     192       0       0       0]]
Class 0 F1: 0.7908
Class 1 F1: 0.4930
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8252
Class 1 Precision: 0.4486
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7590
Class 1 Recall: 0.5472
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7012
Macro F1 Score: 0.2568
xView2 Score: 0.2482
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.3451
Confusion Matrix:
 [[3763245 1044550   11349       0       0]
 [ 798205  907912    7876       2       0]
 [  15720    2255       0       0       0]
 [   1112     496       0       0       0]
 [    745     133       0       0       0]]
Class 0 F1: 0.8008
Class 1 F1: 0.4949
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8218
Class 1 Precision: 0.4643
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7809
Class 1 Recall: 0.5297
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7128
Macro F1 Score: 0.2591
xView2 Score: 0.2455
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.3080
Confusion Matrix:
 [[3720232 1084455   14457       0       0]
 [ 776980  924568   12447       0       0]
 [  14960    3000      15       0       0]
 [    753     855       0       0       0]
 [    609     269       0       0       0]]
Class 0 F1: 0.7972
Class 1 F1: 0.4961
Class 2 F1: 0.0007
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8242
Class 1 Precision: 0.4593
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7720
Class 1 Recall: 0.5394
Class 2 Recall: 0.0008
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7087
Macro F1 Score: 0.2588
xView2 Score: 0.2477
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.2951
Confusion Matrix:
 [[3681171 1116491   21482       0       0]
 [ 725003  970932   18060       0       0]
 [  12316    5106     553       0       0]
 [    668     940       0       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.7969
Class 1 F1: 0.5099
Class 2 F1: 0.0190
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8330
Class 1 Precision: 0.4636
Class 2 Precision: 0.0138
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7639
Class 1 Recall: 0.5665
Class 2 Recall: 0.0308
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7099
Macro F1 Score: 0.2652
xView2 Score: 0.2598
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7099
Best Macro F1: 0.2652
Best xView2 Score: 0.2598
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8330
Class 1 Precision: 0.4636
Class 2 Precision: 0.0138
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2621
ROC curve saved to .././____________optune_results/196/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/196/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/196/visualize_predictions.jpg
Prediction distribution: {0: 241864, 1: 20179, 2: 101}
ROC curve saved to .././____________optune_results/196/visualize_predictions.jpg
Prediction distribution: {0: 127258, 1: 127397, 2: 7489}
ROC curve saved to .././____________optune_results/196/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/196/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/196/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27538986525160414, 1: 0.7352044474833912, 2: 136.87864893530227, 3: 889.880622347949, 4: 5292.497160883281}
Final class weights used in loss: [2.66332206608648, 4.388624633456131, 234.61249348869237, 889.880622347949, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6458
Confusion Matrix:
 [[ 294249  337094   11989 4237973   22603]
 [ 107281  234973    7918 1279500   12342]
 [    750     735      54    5190       0]
 [      0      91       0     857       1]
 [      0       0       0       0       0]]
Class 0 F1: 0.1109
Class 1 F1: 0.2122
Class 2 F1: 0.0040
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.7315
Class 1 Precision: 0.4102
Class 2 Precision: 0.0027
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.0600
Class 1 Recall: 0.1431
Class 2 Recall: 0.0080
Class 3 Recall: 0.9031
Class 4 Recall: 0.0000
Validation Accuracy: 0.0809
Macro F1 Score: 0.0655
xView2 Score: 0.1548
Epoch 1 took:  0 hours,  1 minutes, 19 seconds

Epoch 2/10
Train Loss: 1.5773
Confusion Matrix:
 [[1635046  663013    6541 2588460   10848]
 [ 385881  518963    4699  727712    4759]
 [   1404     713       0    4603       9]
 [    144      24       0     781       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4721
Class 1 F1: 0.3674
Class 2 F1: 0.0000
Class 3 F1: 0.0005
Class 4 F1: 0.0000
Class 0 Precision: 0.8084
Class 1 Precision: 0.4388
Class 2 Precision: 0.0000
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.3334
Class 1 Recall: 0.3161
Class 2 Recall: 0.0000
Class 3 Recall: 0.8230
Class 4 Recall: 0.0000
Validation Accuracy: 0.3288
Macro F1 Score: 0.1680
xView2 Score: 0.1901
Epoch 2 took:  0 hours,  1 minutes, 18 seconds

Epoch 3/10
Train Loss: 1.5223
Confusion Matrix:
 [[3195819  924441    1769  780512    1367]
 [ 699527  713596    1371  226590     930]
 [   5970      13       0     746       0]
 [    295     486       0     168       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7259
Class 1 F1: 0.4350
Class 2 F1: 0.0000
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.8191
Class 1 Precision: 0.4355
Class 2 Precision: 0.0000
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.6517
Class 1 Recall: 0.4346
Class 2 Recall: 0.0000
Class 3 Recall: 0.1770
Class 4 Recall: 0.0000
Validation Accuracy: 0.5966
Macro F1 Score: 0.2322
xView2 Score: 0.2167
Epoch 3 took:  0 hours,  1 minutes,  4 seconds

Epoch 4/10
Train Loss: 1.4518
Confusion Matrix:
 [[3592050 1181740     234  129709     175]
 [ 607908  998742      90   35258      16]
 [   4742    1856       0     131       0]
 [    902      47       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7886
Class 1 F1: 0.5223
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8541
Class 1 Precision: 0.4576
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7325
Class 1 Recall: 0.6082
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7005
Macro F1 Score: 0.2622
xView2 Score: 0.2613
Epoch 4 took:  0 hours,  0 minutes, 39 seconds

Epoch 5/10
Train Loss: 1.3881
Confusion Matrix:
 [[3696175 1194084      29   13620       0]
 [ 592719 1044434       8    4853       0]
 [   6354     375       0       0       0]
 [    132     817       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8036
Class 1 F1: 0.5381
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8605
Class 1 Precision: 0.4663
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7537
Class 1 Recall: 0.6361
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7234
Macro F1 Score: 0.3354
xView2 Score: 0.2973
Epoch 5 took:  0 hours,  0 minutes, 28 seconds

Epoch 6/10
Train Loss: 1.3217
Confusion Matrix:
 [[3594088 1307872      22    1926       0]
 [ 511115 1130527       0     372       0]
 [   5763     966       0       0       0]
 [    526     423       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7973
Class 1 F1: 0.5539
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8742
Class 1 Precision: 0.4634
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7329
Class 1 Recall: 0.6885
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7209
Macro F1 Score: 0.3378
xView2 Score: 0.3087
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2483
Confusion Matrix:
 [[3624545 1279340       0      23       0]
 [ 504061 1137927       0      26       0]
 [   3096    3633       0       0       0]
 [    478     471       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8022
Class 1 F1: 0.5601
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8772
Class 1 Precision: 0.4700
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7391
Class 1 Recall: 0.6930
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7267
Macro F1 Score: 0.3406
xView2 Score: 0.3114
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2070
Confusion Matrix:
 [[3494665 1409243       0       0       0]
 [ 420919 1221091       0       4       0]
 [   6060     669       0       0       0]
 [    230     719       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7919
Class 1 F1: 0.5714
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8911
Class 1 Precision: 0.4640
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7126
Class 1 Recall: 0.7437
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7196
Macro F1 Score: 0.3408
xView2 Score: 0.3205
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.1649
Confusion Matrix:
 [[3580801 1323107       0       0       0]
 [ 458675 1183339       0       0       0]
 [   1768    4961       0       0       0]
 [    421     528       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8006
Class 1 F1: 0.5697
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8860
Class 1 Precision: 0.4711
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7302
Class 1 Recall: 0.7207
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7270
Macro F1 Score: 0.3426
xView2 Score: 0.3177
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1340
Confusion Matrix:
 [[3499414 1404494       0       0       0]
 [ 409111 1232903       0       0       0]
 [   3961    2768       0       0       0]
 [    467     482       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7938
Class 1 F1: 0.5758
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8943
Class 1 Precision: 0.4669
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7136
Class 1 Recall: 0.7508
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7221
Macro F1 Score: 0.3424
xView2 Score: 0.3228
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7221
Best Macro F1: 0.3424
Best xView2 Score: 0.3228
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8943
Class 1 Precision: 0.4669
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3403
ROC curve saved to .././____________optune_results/197/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/197/plot_loss_curves.jpg
Prediction distribution: {0: 234093, 1: 28051}
ROC curve saved to .././____________optune_results/197/visualize_predictions.jpg
Prediction distribution: {0: 28062, 1: 234082}
ROC curve saved to .././____________optune_results/197/visualize_predictions.jpg
Prediction distribution: {0: 224245, 1: 37899}
ROC curve saved to .././____________optune_results/197/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/197/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/197/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27462866187978335, 1: 0.7400378696429144, 2: 163.09143579274811, 3: 895.4215975805017, 4: 5292.497160883281}
Final class weights used in loss: [2.6559603945336887, 4.417476574743736, 3215.4206788135493, 895.4215975805017, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6478
Confusion Matrix:
 [[  15237   15636 3268679 1545021    8677]
 [   2402    5651 1033249  641216    4209]
 [      0       2    8529    3967     141]
 [      0       0     560     424       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0063
Class 1 F1: 0.0066
Class 2 F1: 0.0039
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.8638
Class 1 Precision: 0.2654
Class 2 Precision: 0.0020
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.0031
Class 1 Recall: 0.0034
Class 2 Recall: 0.6748
Class 3 Recall: 0.4309
Class 4 Recall: 0.0000
Validation Accuracy: 0.0046
Macro F1 Score: 0.0034
xView2 Score: 0.1271
Epoch 1 took:  0 hours,  1 minutes, 10 seconds

Epoch 2/10
Train Loss: 1.6204
Confusion Matrix:
 [[  75152   28269 3794272  952112    3445]
 [  10558   15213 1286614  372175    2167]
 [      7     116   10895    1621       0]
 [      0       0     700     284       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0304
Class 1 F1: 0.0176
Class 2 F1: 0.0043
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.8767
Class 1 Precision: 0.3489
Class 2 Precision: 0.0021
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.0155
Class 1 Recall: 0.0090
Class 2 Recall: 0.8620
Class 3 Recall: 0.2886
Class 4 Recall: 0.0000
Validation Accuracy: 0.0155
Macro F1 Score: 0.0105
xView2 Score: 0.1292
Epoch 2 took:  0 hours,  1 minutes,  6 seconds

Epoch 3/10
Train Loss: 1.5671
Confusion Matrix:
 [[ 279333   73000 3984924  513943    2050]
 [  32959   45433 1410517  196599    1219]
 [     97     387   11459     683      13]
 [      0      59     921       4       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.1082
Class 1 F1: 0.0503
Class 2 F1: 0.0042
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8942
Class 1 Precision: 0.3822
Class 2 Precision: 0.0021
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.0576
Class 1 Recall: 0.0269
Class 2 Recall: 0.9066
Class 3 Recall: 0.0041
Class 4 Recall: 0.0000
Validation Accuracy: 0.0513
Macro F1 Score: 0.0325
xView2 Score: 0.1356
Epoch 3 took:  0 hours,  0 minutes, 58 seconds

Epoch 4/10
Train Loss: 1.5313
Confusion Matrix:
 [[ 730871   68245 3851747  202037     350]
 [  53643   53312 1507354   72086     332]
 [    223     165   12076     175       0]
 [      0       0     984       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.2593
Class 1 F1: 0.0590
Class 2 F1: 0.0045
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9314
Class 1 Precision: 0.4380
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1506
Class 1 Recall: 0.0316
Class 2 Recall: 0.9555
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1215
Macro F1 Score: 0.0645
xView2 Score: 0.1430
Epoch 4 took:  0 hours,  0 minutes, 44 seconds

Epoch 5/10
Train Loss: 1.4932
Confusion Matrix:
 [[1389708  107651 3285301   70489     101]
 [  86150   98589 1475266   26606     116]
 [    123     407   12108       1       0]
 [      0       0     984       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4391
Class 1 F1: 0.1041
Class 2 F1: 0.0051
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9415
Class 1 Precision: 0.4771
Class 2 Precision: 0.0025
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2863
Class 1 Recall: 0.0584
Class 2 Recall: 0.9580
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2289
Macro F1 Score: 0.1097
xView2 Score: 0.1606
Epoch 5 took:  0 hours,  0 minutes, 33 seconds

Epoch 6/10
Train Loss: 1.4488
Confusion Matrix:
 [[1851911  114934 2868876   17514      15]
 [ 142164  118043 1417778    8728      14]
 [   1479    1074   10086       0       0]
 [      0      24     960       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5408
Class 1 F1: 0.1229
Class 2 F1: 0.0047
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9280
Class 1 Precision: 0.5043
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3816
Class 1 Recall: 0.0700
Class 2 Recall: 0.7980
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3021
Macro F1 Score: 0.1337
xView2 Score: 0.1695
Epoch 6 took:  0 hours,  0 minutes, 28 seconds

Epoch 7/10
Train Loss: 1.4101
Confusion Matrix:
 [[2163022  167475 2516375    6362      16]
 [ 135444  181982 1365725    3571       5]
 [   1140     710   10789       0       0]
 [     14      20     950       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6048
Class 1 F1: 0.1787
Class 2 F1: 0.0055
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9406
Class 1 Precision: 0.5197
Class 2 Precision: 0.0028
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4457
Class 1 Recall: 0.1079
Class 2 Recall: 0.8536
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3595
Macro F1 Score: 0.1578
xView2 Score: 0.1870
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.3818
Confusion Matrix:
 [[2375613  192048 2284213    1374       2]
 [ 185189  214652 1286391     491       4]
 [    832     651   11156       0       0]
 [      0     139     845       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6408
Class 1 F1: 0.2050
Class 2 F1: 0.0062
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9274
Class 1 Precision: 0.5268
Class 2 Precision: 0.0031
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4895
Class 1 Recall: 0.1273
Class 2 Recall: 0.8827
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3969
Macro F1 Score: 0.1704
xView2 Score: 0.1936
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.3248
Confusion Matrix:
 [[2761896  199671 1891532     150       1]
 [ 262126  224653 1199865      83       0]
 [   1755      44   10840       0       0]
 [     25       3     956       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7011
Class 1 F1: 0.2128
Class 2 F1: 0.0070
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9128
Class 1 Precision: 0.5294
Class 2 Precision: 0.0035
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5691
Class 1 Recall: 0.1332
Class 2 Recall: 0.8577
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4574
Macro F1 Score: 0.1842
xView2 Score: 0.2091
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.3137
Confusion Matrix:
 [[2802620  282635 1767992       3       0]
 [ 293735  306315 1086674       3       0]
 [    856     780   11003       0       0]
 [     96       0     888       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7050
Class 1 F1: 0.2691
Class 2 F1: 0.0076
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9049
Class 1 Precision: 0.5194
Class 2 Precision: 0.0038
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5775
Class 1 Recall: 0.1816
Class 2 Recall: 0.8706
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4761
Macro F1 Score: 0.2454
xView2 Score: 0.2208
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.4761
Best Macro F1: 0.2454
Best xView2 Score: 0.2208
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9049
Class 1 Precision: 0.5194
Class 2 Precision: 0.0038
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3570
ROC curve saved to .././____________optune_results/198/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/198/plot_loss_curves.jpg
Prediction distribution: {0: 84361, 1: 71623, 2: 106160}
ROC curve saved to .././____________optune_results/198/visualize_predictions.jpg
Prediction distribution: {0: 45204, 1: 70616, 2: 146318, 3: 6}
ROC curve saved to .././____________optune_results/198/visualize_predictions.jpg
Prediction distribution: {0: 259691, 2: 2453}
ROC curve saved to .././____________optune_results/198/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/198/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/198/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2739830501877727, 1: 0.7440595523814522, 2: 210.98993083211067, 3: 811.5389874234118, 4: 5292.497160883281}
Final class weights used in loss: [2.64971662131464, 4.441483034436284, 1198.621030417223, 811.5389874234118, 5292.497160883281]

Epoch 1/10
Train Loss: 1.5937
Confusion Matrix:
 [[1245420  691406 1901052  957499   14687]
 [ 215969  359495  823987  316524    7513]
 [   4271    3445    7838    3692     399]
 [    110      82     189      22       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3969
Class 1 F1: 0.2588
Class 2 F1: 0.0057
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8497
Class 1 Precision: 0.3409
Class 2 Precision: 0.0029
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2589
Class 1 Recall: 0.2086
Class 2 Recall: 0.3990
Class 3 Recall: 0.0546
Class 4 Recall: 0.0000
Validation Accuracy: 0.2461
Macro F1 Score: 0.1323
xView2 Score: 0.1846
Epoch 1 took:  0 hours,  1 minutes, 18 seconds

Epoch 2/10
Train Loss: 1.5448
Confusion Matrix:
 [[2420326  896484 1108984  381565    2705]
 [ 516714  558486  511789  134028    2471]
 [  10677    4764    3566     638       0]
 [    110      72     211      10       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6240
Class 1 F1: 0.3509
Class 2 F1: 0.0043
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8211
Class 1 Precision: 0.3826
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5032
Class 1 Recall: 0.3240
Class 2 Recall: 0.1815
Class 3 Recall: 0.0248
Class 4 Recall: 0.0000
Validation Accuracy: 0.4551
Macro F1 Score: 0.1958
xView2 Score: 0.2067
Epoch 2 took:  0 hours,  1 minutes,  6 seconds

Epoch 3/10
Train Loss: 1.4982
Confusion Matrix:
 [[3017471  963305  750891   78202     195]
 [ 736555  629871  328218   28587     257]
 [  13465    4039    1992     149       0]
 [    216     165      22       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7036
Class 1 F1: 0.3793
Class 2 F1: 0.0036
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8009
Class 1 Precision: 0.3943
Class 2 Precision: 0.0018
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6273
Class 1 Recall: 0.3655
Class 2 Recall: 0.1014
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5568
Macro F1 Score: 0.2173
xView2 Score: 0.2080
Epoch 3 took:  0 hours,  0 minutes, 39 seconds

Epoch 4/10
Train Loss: 1.4451
Confusion Matrix:
 [[3272826 1264801  264875    7493      69]
 [ 727982  881893  111082    2518      13]
 [  13492    5654     469      30       0]
 [    118     283       2       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7418
Class 1 F1: 0.4550
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8153
Class 1 Precision: 0.4097
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6804
Class 1 Recall: 0.5117
Class 2 Recall: 0.0239
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6340
Macro F1 Score: 0.2398
xView2 Score: 0.2359
Epoch 4 took:  0 hours,  0 minutes, 27 seconds

Epoch 5/10
Train Loss: 1.3987
Confusion Matrix:
 [[3471202 1192227  145691     943       1]
 [ 695214  957046   70721     507       0]
 [  11359    7791     490       5       0]
 [    110      83     210       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7724
Class 1 F1: 0.4932
Class 2 F1: 0.0041
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8309
Class 1 Precision: 0.4437
Class 2 Precision: 0.0023
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7217
Class 1 Recall: 0.5553
Class 2 Recall: 0.0249
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6758
Macro F1 Score: 0.2540
xView2 Score: 0.2775
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3379
Confusion Matrix:
 [[3382032 1303645  124306      81       0]
 [ 664443 1003617   55379      49       0]
 [  11680    7222     743       0       0]
 [    110     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7627
Class 1 F1: 0.4971
Class 2 F1: 0.0074
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8334
Class 1 Precision: 0.4336
Class 2 Precision: 0.0041
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7031
Class 1 Recall: 0.5823
Class 2 Recall: 0.0378
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6693
Macro F1 Score: 0.3168
xView2 Score: 0.2830
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.2956
Confusion Matrix:
 [[3321015 1412510   76532       7       0]
 [ 633220 1057205   33063       0       0]
 [  11428    7070    1147       0       0]
 [    110      65     228       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7569
Class 1 F1: 0.5034
Class 2 F1: 0.0176
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8374
Class 1 Precision: 0.4268
Class 2 Precision: 0.0103
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6904
Class 1 Recall: 0.6134
Class 2 Recall: 0.0584
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6682
Macro F1 Score: 0.3195
xView2 Score: 0.2924
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.2652
Confusion Matrix:
 [[3384196 1356880   68988       0       0]
 [ 644834 1051350   27304       0       0]
 [  12699    6840     106       0       0]
 [    110     293       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7646
Class 1 F1: 0.5080
Class 2 F1: 0.0018
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8373
Class 1 Precision: 0.4353
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7036
Class 1 Recall: 0.6100
Class 2 Recall: 0.0054
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6768
Macro F1 Score: 0.3186
xView2 Score: 0.2862
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2280
Confusion Matrix:
 [[3703070 1065089   41905       0       0]
 [ 834533  868345   20610       0       0]
 [  14546    5050      49       0       0]
 [    125     278       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7911
Class 1 F1: 0.4742
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8135
Class 1 Precision: 0.4479
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7699
Class 1 Recall: 0.5038
Class 2 Recall: 0.0025
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6976
Macro F1 Score: 0.3166
xView2 Score: 0.2607
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.1953
Confusion Matrix:
 [[3579148 1204845   26071       0       0]
 [ 743641  967324   12523       0       0]
 [  13959    5398     288       0       0]
 [    110     215      78       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7826
Class 1 F1: 0.4959
Class 2 F1: 0.0098
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8253
Class 1 Precision: 0.4442
Class 2 Precision: 0.0074
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7441
Class 1 Recall: 0.5613
Class 2 Recall: 0.0147
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6938
Macro F1 Score: 0.3221
xView2 Score: 0.2780
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6682
Best Macro F1: 0.3195
Best xView2 Score: 0.2924
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8374
Class 1 Precision: 0.4268
Class 2 Precision: 0.0103
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3186
ROC curve saved to .././____________optune_results/199/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/199/plot_loss_curves.jpg
Prediction distribution: {0: 102191, 1: 159538, 2: 415}
ROC curve saved to .././____________optune_results/199/visualize_predictions.jpg
Prediction distribution: {0: 117147, 1: 144993, 2: 4}
ROC curve saved to .././____________optune_results/199/visualize_predictions.jpg
Prediction distribution: {0: 174052, 1: 84797, 2: 3295}
ROC curve saved to .././____________optune_results/199/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/199/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/199/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2704267051838828, 1: 0.7722982185705785, 2: 154.20235294117646, 3: 1243.3707509881424, 4: 68947.46301369862}
Final class weights used in loss: [2.615322864250186, 4.610046903272706, 3081.9298359715212, 1243.3707509881424, 68947.46301369862]

Epoch 1/10
Train Loss: 1.6136
Confusion Matrix:
 [[ 811761 3024413  183851  293306  255147]
 [ 119072 1560373   68474   95759  127149]
 [    408    7197    1521     803     931]
 [    481    1244      10      77     745]
 [    241      22       9      11     595]]
Class 0 F1: 0.2952
Class 1 F1: 0.4754
Class 2 F1: 0.0115
Class 3 F1: 0.0004
Class 4 F1: 0.0031
Class 0 Precision: 0.8710
Class 1 Precision: 0.3397
Class 2 Precision: 0.0060
Class 3 Precision: 0.0002
Class 4 Precision: 0.0015
Class 0 Recall: 0.1777
Class 1 Recall: 0.7917
Class 2 Recall: 0.1401
Class 3 Recall: 0.0301
Class 4 Recall: 0.6777
Validation Accuracy: 0.3623
Macro F1 Score: 0.1571
xView2 Score: 0.2773
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5807
Confusion Matrix:
 [[1215673 2906312  203102  144156   99235]
 [ 144521 1649982   89648   39866   46810]
 [    592    7465    2118     459     226]
 [    282    2191      32       0      52]
 [     17     861       0       0       0]]
Class 0 F1: 0.4100
Class 1 F1: 0.5048
Class 2 F1: 0.0139
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8932
Class 1 Precision: 0.3613
Class 2 Precision: 0.0072
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.2661
Class 1 Recall: 0.8372
Class 2 Recall: 0.1950
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.4376
Macro F1 Score: 0.1857
xView2 Score: 0.2868
Epoch 2 took:  0 hours,  1 minutes, 21 seconds

Epoch 3/10
Train Loss: 1.5390
Confusion Matrix:
 [[1649757 2664391  204609   33627   16094]
 [ 212254 1635685  101947   11091    9850]
 [   1243    7729    1881       6       1]
 [    204    1804     539      10       0]
 [    357     516       5       0       0]]
Class 0 F1: 0.5130
Class 1 F1: 0.5208
Class 2 F1: 0.0118
Class 3 F1: 0.0004
Class 4 F1: 0.0000
Class 0 Precision: 0.8852
Class 1 Precision: 0.3795
Class 2 Precision: 0.0061
Class 3 Precision: 0.0002
Class 4 Precision: 0.0000
Class 0 Recall: 0.3611
Class 1 Recall: 0.8299
Class 2 Recall: 0.1732
Class 3 Recall: 0.0039
Class 4 Recall: 0.0000
Validation Accuracy: 0.5016
Macro F1 Score: 0.2092
xView2 Score: 0.2906
Epoch 3 took:  0 hours,  1 minutes, 20 seconds

Epoch 4/10
Train Loss: 1.5117
Confusion Matrix:
 [[1954692 2385782  218147    6611    3246]
 [ 263033 1581589  122726    1897    1582]
 [   1939    6395    2462      50      14]
 [    780    1517     259       0       1]
 [      0     760      92       0      26]]
Class 0 F1: 0.5758
Class 1 F1: 0.5319
Class 2 F1: 0.0139
Class 3 F1: 0.0000
Class 4 F1: 0.0090
Class 0 Precision: 0.8803
Class 1 Precision: 0.3978
Class 2 Precision: 0.0072
Class 3 Precision: 0.0000
Class 4 Precision: 0.0053
Class 0 Recall: 0.4279
Class 1 Recall: 0.8025
Class 2 Recall: 0.2267
Class 3 Recall: 0.0000
Class 4 Recall: 0.0296
Validation Accuracy: 0.5400
Macro F1 Score: 0.2261
xView2 Score: 0.2956
Epoch 4 took:  0 hours,  1 minutes,  9 seconds

Epoch 5/10
Train Loss: 1.4660
Confusion Matrix:
 [[2076057 2218551  271377    2282     211]
 [ 271135 1547309  151639     508     236]
 [   2318    6597    1945       0       0]
 [   1075    1272     205       0       5]
 [    116     762       0       0       0]]
Class 0 F1: 0.6001
Class 1 F1: 0.5386
Class 2 F1: 0.0089
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8832
Class 1 Precision: 0.4099
Class 2 Precision: 0.0046
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4544
Class 1 Recall: 0.7851
Class 2 Recall: 0.1791
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5532
Macro F1 Score: 0.2295
xView2 Score: 0.2920
Epoch 5 took:  0 hours,  0 minutes, 46 seconds

Epoch 6/10
Train Loss: 1.4232
Confusion Matrix:
 [[2149960 2191417  226934     151      16]
 [ 263648 1588528  118607       3      41]
 [   2159    6219    2482       0       0]
 [    818    1673      66       0       0]
 [     27     851       0       0       0]]
Class 0 F1: 0.6156
Class 1 F1: 0.5516
Class 2 F1: 0.0138
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8897
Class 1 Precision: 0.4193
Class 2 Precision: 0.0071
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4706
Class 1 Recall: 0.8060
Class 2 Recall: 0.2285
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5708
Macro F1 Score: 0.2362
xView2 Score: 0.2983
Epoch 6 took:  0 hours,  0 minutes, 32 seconds

Epoch 7/10
Train Loss: 1.3917
Confusion Matrix:
 [[2357659 1991827  218978      10       4]
 [ 337216 1512208  121391       0      12]
 [   2949    7246     665       0       0]
 [   1193    1152     212       0       0]
 [      0     757     121       0       0]]
Class 0 F1: 0.6488
Class 1 F1: 0.5515
Class 2 F1: 0.0038
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8735
Class 1 Precision: 0.4304
Class 2 Precision: 0.0019
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5161
Class 1 Recall: 0.7673
Class 2 Recall: 0.0612
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5906
Macro F1 Score: 0.2408
xView2 Score: 0.2915
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3525
Confusion Matrix:
 [[2275931 1838474  454073       0       0]
 [ 367811 1374675  228341       0       0]
 [   3590    6102    1168       0       0]
 [   1081     772     704       0       0]
 [    136       0     742       0       0]]
Class 0 F1: 0.6307
Class 1 F1: 0.5297
Class 2 F1: 0.0034
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8593
Class 1 Precision: 0.4269
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4982
Class 1 Recall: 0.6975
Class 2 Recall: 0.1076
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5572
Macro F1 Score: 0.2327
xView2 Score: 0.2804
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.3021
Confusion Matrix:
 [[2507561 1743297  317620       0       0]
 [ 456819 1332095  181913       0       0]
 [   3916    5071    1873       0       0]
 [    670    1775     112       0       0]
 [      0     878       0       0       0]]
Class 0 F1: 0.6654
Class 1 F1: 0.5272
Class 2 F1: 0.0073
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8446
Class 1 Precision: 0.4321
Class 2 Precision: 0.0037
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5489
Class 1 Recall: 0.6759
Class 2 Recall: 0.1725
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5862
Macro F1 Score: 0.2400
xView2 Score: 0.2795
Epoch 9 took:  0 hours,  0 minutes, 26 seconds

Epoch 10/10
Train Loss: 1.2907
Confusion Matrix:
 [[2430690 1656272  481516       0       0]
 [ 435060 1274529  261238       0       0]
 [   3050    6145    1665       0       0]
 [   1086     739     732       0       0]
 [      0     706     172       0       0]]
Class 0 F1: 0.6536
Class 1 F1: 0.5192
Class 2 F1: 0.0044
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8470
Class 1 Precision: 0.4338
Class 2 Precision: 0.0022
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5321
Class 1 Recall: 0.6467
Class 2 Recall: 0.1533
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5656
Macro F1 Score: 0.2354
xView2 Score: 0.2750
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.5708
Best Macro F1: 0.2362
Best xView2 Score: 0.2983
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8897
Class 1 Precision: 0.4193
Class 2 Precision: 0.0071
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2632
ROC curve saved to .././____________optune_results/200/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/200/plot_loss_curves.jpg
Prediction distribution: {0: 34726, 1: 197781, 2: 29637}
ROC curve saved to .././____________optune_results/200/visualize_predictions.jpg
Prediction distribution: {0: 262088, 2: 56}
ROC curve saved to .././____________optune_results/200/visualize_predictions.jpg
Prediction distribution: {0: 25798, 1: 216527, 2: 19819}
ROC curve saved to .././____________optune_results/200/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/200/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/200/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.2770647598541519, 1: 0.7242050228801293, 2: 118.6004241481691, 3: 774.9291454965359, 4: 5292.497160883281}
Final class weights used in loss: [2.6795201340482735, 4.322966236077069, 1003.3919227956586, 774.9291454965359, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6313
Confusion Matrix:
 [[1600022   55918  447502 2887197   23753]
 [ 398359   26203  239143  862666   11665]
 [    445     106       0     511       0]
 [      0       0       0     110       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.4563
Class 1 F1: 0.0323
Class 2 F1: 0.0000
Class 3 F1: 0.0001
Class 4 F1: 0.0000
Class 0 Precision: 0.8005
Class 1 Precision: 0.3187
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.3191
Class 1 Recall: 0.0170
Class 2 Recall: 0.0000
Class 3 Recall: 1.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.2482
Macro F1 Score: 0.0977
xView2 Score: 0.1170
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.5759
Confusion Matrix:
 [[2921031   48734  786996 1251382    6249]
 [ 626104   34843  443750  428871    4468]
 [    743       0     243      76       0]
 [      8       0     101       1       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6823
Class 1 F1: 0.0430
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8233
Class 1 Precision: 0.4169
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.5825
Class 1 Recall: 0.0227
Class 2 Recall: 0.2288
Class 3 Recall: 0.0091
Class 4 Recall: 0.0000
Validation Accuracy: 0.4511
Macro F1 Score: 0.1451
xView2 Score: 0.1268
Epoch 2 took:  0 hours,  1 minutes, 14 seconds

Epoch 3/10
Train Loss: 1.5311
Confusion Matrix:
 [[3944936   70531  731514  265961    1450]
 [ 884898   57039  461987  133308     804]
 [   1014       8       0      40       0]
 [     98       0       5       7       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8014
Class 1 F1: 0.0685
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8166
Class 1 Precision: 0.4471
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7867
Class 1 Recall: 0.0371
Class 2 Recall: 0.0000
Class 3 Recall: 0.0636
Class 4 Recall: 0.0000
Validation Accuracy: 0.6107
Macro F1 Score: 0.1740
xView2 Score: 0.1302
Epoch 3 took:  0 hours,  0 minutes, 49 seconds

Epoch 4/10
Train Loss: 1.4892
Confusion Matrix:
 [[4294402   94763  583467   41618     142]
 [1000200   86937  423948   26862      89]
 [    564      27     408      63       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8331
Class 1 F1: 0.1011
Class 2 F1: 0.0008
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8110
Class 1 Precision: 0.4784
Class 2 Precision: 0.0004
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8564
Class 1 Recall: 0.0565
Class 2 Recall: 0.3842
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6686
Macro F1 Score: 0.1870
xView2 Score: 0.1307
Epoch 4 took:  0 hours,  0 minutes, 31 seconds

Epoch 5/10
Train Loss: 1.4372
Confusion Matrix:
 [[4348876  139777  522878    2859       2]
 [ 971779  140085  423909    2257       6]
 [   1004      26      32       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8415
Class 1 F1: 0.1541
Class 2 F1: 0.0001
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8172
Class 1 Precision: 0.5005
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8673
Class 1 Recall: 0.0911
Class 2 Recall: 0.0301
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6850
Macro F1 Score: 0.1991
xView2 Score: 0.1460
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.4024
Confusion Matrix:
 [[4292053  198448  523633     258       0]
 [ 900394  201212  436189     241       0]
 [   1039      23       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8409
Class 1 F1: 0.2077
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8264
Class 1 Precision: 0.5034
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8559
Class 1 Recall: 0.1308
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6856
Macro F1 Score: 0.2621
xView2 Score: 0.1725
Epoch 6 took:  0 hours,  0 minutes, 26 seconds

Epoch 7/10
Train Loss: 1.3722
Confusion Matrix:
 [[4287818  276836  449723      15       0]
 [ 871826  290166  376017      27       0]
 [   1062       0       0       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8428
Class 1 F1: 0.2757
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8308
Class 1 Precision: 0.5118
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8551
Class 1 Recall: 0.1887
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6985
Macro F1 Score: 0.2796
xView2 Score: 0.1919
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.3225
Confusion Matrix:
 [[4274358  259739  480295       0       0]
 [ 871525  266183  400323       5       0]
 [   1055       0       7       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8413
Class 1 F1: 0.2579
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8304
Class 1 Precision: 0.5061
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8524
Class 1 Recall: 0.1731
Class 2 Recall: 0.0066
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6928
Macro F1 Score: 0.2748
xView2 Score: 0.1874
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2897
Confusion Matrix:
 [[4125989  285767  602636       0       0]
 [ 745986  303106  488944       0       0]
 [    737      34     291       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8346
Class 1 F1: 0.2850
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8467
Class 1 Precision: 0.5147
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8228
Class 1 Recall: 0.1971
Class 2 Recall: 0.2740
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6759
Macro F1 Score: 0.2800
xView2 Score: 0.2055
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2450
Confusion Matrix:
 [[3984531  377337  652524       0       0]
 [ 633763  398240  506033       0       0]
 [    817      14     231       0       0]
 [    110       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8272
Class 1 F1: 0.3443
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8626
Class 1 Precision: 0.5135
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7946
Class 1 Recall: 0.2589
Class 2 Recall: 0.2175
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6688
Macro F1 Score: 0.2930
xView2 Score: 0.2284
Epoch 10 took:  0 hours,  0 minutes, 26 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6688
Best Macro F1: 0.2930
Best xView2 Score: 0.2284
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8626
Class 1 Precision: 0.5135
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3441
ROC curve saved to .././____________optune_results/201/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/201/plot_loss_curves.jpg
Prediction distribution: {0: 168129, 1: 21562, 2: 72453}
ROC curve saved to .././____________optune_results/201/visualize_predictions.jpg
Prediction distribution: {0: 57894, 1: 101029, 2: 103221}
ROC curve saved to .././____________optune_results/201/visualize_predictions.jpg
Prediction distribution: {0: 183305, 1: 15179, 2: 63660}
ROC curve saved to .././____________optune_results/201/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/201/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/201/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27141529192015634, 1: 0.7653876661200297, 2: 131.91709388268595, 3: 762.0234367903104, 4: 5292.497160883281}
Final class weights used in loss: [2.624883582349061, 4.568796036498054, 738.0292902072091, 762.0234367903104, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6762
Confusion Matrix:
 [[ 770310   95736  968612 1083630 1717981]
 [ 223706   60694  487064  386678  753843]
 [    467       8    1769     227    2875]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.2736
Class 1 F1: 0.0587
Class 2 F1: 0.0024
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7746
Class 1 Precision: 0.3880
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.1661
Class 1 Recall: 0.0317
Class 2 Recall: 0.3309
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.1271
Macro F1 Score: 0.0669
xView2 Score: 0.1455
Epoch 1 took:  0 hours,  1 minutes, 22 seconds

Epoch 2/10
Train Loss: 1.6202
Confusion Matrix:
 [[2211983  326778  846895  488826  761787]
 [ 670084  252804  461794  208450  318853]
 [   1447     407    1799      31    1662]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.5883
Class 1 F1: 0.2029
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7671
Class 1 Precision: 0.4359
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.4771
Class 1 Recall: 0.1322
Class 2 Recall: 0.3365
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.3764
Macro F1 Score: 0.1588
xView2 Score: 0.1675
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.5698
Confusion Matrix:
 [[2931382  562767  761655  136234  244231]
 [ 882456  451264  423481   57926   96858]
 [   2262    1349    1614      22      99]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6936
Class 1 F1: 0.3083
Class 2 F1: 0.0027
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7682
Class 1 Precision: 0.4444
Class 2 Precision: 0.0014
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6323
Class 1 Recall: 0.2360
Class 2 Recall: 0.3019
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.5164
Macro F1 Score: 0.2009
xView2 Score: 0.1876
Epoch 3 took:  0 hours,  1 minutes, 22 seconds

Epoch 4/10
Train Loss: 1.5090
Confusion Matrix:
 [[3173103 1065234  357403   14946   25583]
 [ 803051  893254  197622    8135    9923]
 [   2824    2058     445       0      19]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7366
Class 1 F1: 0.4613
Class 2 F1: 0.0016
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7975
Class 1 Precision: 0.4556
Class 2 Precision: 0.0008
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6844
Class 1 Recall: 0.4672
Class 2 Recall: 0.0832
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6205
Macro F1 Score: 0.2399
xView2 Score: 0.2382
Epoch 4 took:  0 hours,  1 minutes, 21 seconds

Epoch 5/10
Train Loss: 1.4454
Confusion Matrix:
 [[3275618 1117247  239967    1902    1535]
 [ 809729  979285  120768    1448     755]
 [   2470    2459     417       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7509
Class 1 F1: 0.4883
Class 2 F1: 0.0023
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8013
Class 1 Precision: 0.4666
Class 2 Precision: 0.0012
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7065
Class 1 Recall: 0.5122
Class 2 Recall: 0.0780
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6493
Macro F1 Score: 0.2483
xView2 Score: 0.2470
Epoch 5 took:  0 hours,  1 minutes,  9 seconds

Epoch 6/10
Train Loss: 1.3903
Confusion Matrix:
 [[2904788 1614477  116490     294     220]
 [ 533585 1321642   56563      95     100]
 [   2485    2594     267       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7193
Class 1 F1: 0.5449
Class 2 F1: 0.0030
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8442
Class 1 Precision: 0.4497
Class 2 Precision: 0.0015
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6265
Class 1 Recall: 0.6912
Class 2 Recall: 0.0499
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6449
Macro F1 Score: 0.2534
xView2 Score: 0.2803
Epoch 6 took:  0 hours,  0 minutes, 39 seconds

Epoch 7/10
Train Loss: 1.3454
Confusion Matrix:
 [[3089563 1488256   58406      44       0]
 [ 612877 1264270   34806      32       0]
 [   2472    2712     162       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7408
Class 1 F1: 0.5418
Class 2 F1: 0.0033
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8339
Class 1 Precision: 0.4589
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6664
Class 1 Recall: 0.6612
Class 2 Recall: 0.0303
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6644
Macro F1 Score: 0.3215
xView2 Score: 0.3045
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3014
Confusion Matrix:
 [[3001027 1548386   86850       6       0]
 [ 545951 1318849   47176       9       0]
 [   1474    3872       0       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7333
Class 1 F1: 0.5515
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8457
Class 1 Precision: 0.4594
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6473
Class 1 Recall: 0.6898
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6592
Macro F1 Score: 0.3212
xView2 Score: 0.3097
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2477
Confusion Matrix:
 [[2951999 1616727   67543       0       0]
 [ 532483 1348725   30777       0       0]
 [   2525    2668     153       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7268
Class 1 F1: 0.5527
Class 2 F1: 0.0029
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8466
Class 1 Precision: 0.4544
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6367
Class 1 Recall: 0.7054
Class 2 Recall: 0.0286
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6563
Macro F1 Score: 0.4275
xView2 Score: 0.3613
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2276
Confusion Matrix:
 [[3085772 1506677   43820       0       0]
 [ 580652 1305079   26254       0       0]
 [   1997    3233     116       0       0]
 [      0       0       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7431
Class 1 F1: 0.5522
Class 2 F1: 0.0031
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8412
Class 1 Precision: 0.4636
Class 2 Precision: 0.0017
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.6656
Class 1 Recall: 0.6826
Class 2 Recall: 0.0217
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6700
Macro F1 Score: 0.4328
xView2 Score: 0.3576
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.6563
Best Macro F1: 0.4275
Best xView2 Score: 0.3613
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8466
Class 1 Precision: 0.4544
Class 2 Precision: 0.0016
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.4342
ROC curve saved to .././____________optune_results/202/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/202/plot_loss_curves.jpg
Prediction distribution: {0: 158587, 1: 100732, 2: 2825}
ROC curve saved to .././____________optune_results/202/visualize_predictions.jpg
Prediction distribution: {0: 129264, 1: 122146, 2: 10734}
ROC curve saved to .././____________optune_results/202/visualize_predictions.jpg
Prediction distribution: {0: 107524, 1: 154528, 2: 92}
ROC curve saved to .././____________optune_results/202/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/202/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/202/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3]
{0: 0.3406878894802165, 1: 0.9446803680187535, 2: 181.29952164140394, 3: 1455.0083256244218}
Final class weights used in loss: [3.294825584347851, 5.639040334999012, 1925.7762278218293, 1455.0083256244218, 1.0]

Epoch 1/10
Train Loss: 1.5330
Confusion Matrix:
 [[4089706  377940  173600    3311   68938]
 [1403353  277920  108211    2259   36332]
 [   7770     646     273      48      61]
 [   2194      77      10       0       0]
 [    809      45      88       9       0]]
Class 0 F1: 0.8005
Class 1 F1: 0.2237
Class 2 F1: 0.0019
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7431
Class 1 Precision: 0.4233
Class 2 Precision: 0.0010
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8677
Class 1 Recall: 0.1520
Class 2 Recall: 0.0310
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6665
Macro F1 Score: 0.2052
xView2 Score: 0.1260
Epoch 1 took:  0 hours,  1 minutes, 21 seconds

Epoch 2/10
Train Loss: 1.4912
Confusion Matrix:
 [[4341861  264955   99381     730    6568]
 [1519707  234650   69542     655    3521]
 [   8302     414      82       0       0]
 [   2225      46      10       0       0]
 [    910      28      13       0       0]]
Class 0 F1: 0.8203
Class 1 F1: 0.2016
Class 2 F1: 0.0009
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7393
Class 1 Precision: 0.4692
Class 2 Precision: 0.0005
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9212
Class 1 Recall: 0.1284
Class 2 Recall: 0.0093
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.6983
Macro F1 Score: 0.2046
xView2 Score: 0.1057
Epoch 2 took:  0 hours,  1 minutes, 20 seconds

Epoch 3/10
Train Loss: 1.4526
Confusion Matrix:
 [[4427383  212469   73222      50     371]
 [1567315  210480   50031      61     188]
 [   8010     787       1       0       0]
 [   2277       0       4       0       0]
 [    949       1       1       0       0]]
Class 0 F1: 0.8260
Class 1 F1: 0.1869
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7372
Class 1 Precision: 0.4967
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9393
Class 1 Recall: 0.1151
Class 2 Recall: 0.0001
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7077
Macro F1 Score: 0.2026
xView2 Score: 0.0946
Epoch 3 took:  0 hours,  0 minutes, 53 seconds

Epoch 4/10
Train Loss: 1.4087
Confusion Matrix:
 [[4335842  326325   51310      14       4]
 [1456023  339949   32079       9      15]
 [   7420    1128     250       0       0]
 [   2074     178      29       0       0]
 [    949       2       0       0       0]]
Class 0 F1: 0.8246
Class 1 F1: 0.2724
Class 2 F1: 0.0054
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7473
Class 1 Precision: 0.5092
Class 2 Precision: 0.0030
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9199
Class 1 Recall: 0.1860
Class 2 Recall: 0.0284
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7135
Macro F1 Score: 0.2205
xView2 Score: 0.1321
Epoch 4 took:  0 hours,  0 minutes, 30 seconds

Epoch 5/10
Train Loss: 1.3675
Confusion Matrix:
 [[4260180  392445   60870       0       0]
 [1383039  407254   37782       0       0]
 [   6819    1916      63       0       0]
 [   2172     109       0       0       0]
 [    873      78       0       0       0]]
Class 0 F1: 0.8219
Class 1 F1: 0.3097
Class 2 F1: 0.0012
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7536
Class 1 Precision: 0.5079
Class 2 Precision: 0.0006
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.9038
Class 1 Recall: 0.2228
Class 2 Recall: 0.0072
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7122
Macro F1 Score: 0.2266
xView2 Score: 0.1492
Epoch 5 took:  0 hours,  0 minutes, 27 seconds

Epoch 6/10
Train Loss: 1.3259
Confusion Matrix:
 [[4238533  420700   54262       0       0]
 [1345432  452440   30203       0       0]
 [   6804    1974      20       0       0]
 [   2281       0       0       0       0]
 [    951       0       0       0       0]]
Class 0 F1: 0.8224
Class 1 F1: 0.3347
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7577
Class 1 Precision: 0.5170
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8992
Class 1 Recall: 0.2475
Class 2 Recall: 0.0023
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7158
Macro F1 Score: 0.2315
xView2 Score: 0.1595
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.2861
Confusion Matrix:
 [[4026246  638389   48860       0       0]
 [1153605  647531   26939       0       0]
 [   5864    2924      10       0       0]
 [   1994     287       0       0       0]
 [    835     112       4       0       0]]
Class 0 F1: 0.8132
Class 1 F1: 0.4154
Class 2 F1: 0.0002
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7760
Class 1 Precision: 0.5023
Class 2 Precision: 0.0001
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8542
Class 1 Recall: 0.3542
Class 2 Recall: 0.0011
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7132
Macro F1 Score: 0.2458
xView2 Score: 0.2001
Epoch 7 took:  0 hours,  0 minutes, 26 seconds

Epoch 8/10
Train Loss: 1.2376
Confusion Matrix:
 [[3834186  783916   95393       0       0]
 [ 994639  780700   52736       0       0]
 [   5503    3266      29       0       0]
 [   2077     197       7       0       0]
 [    721     145      85       0       0]]
Class 0 F1: 0.8029
Class 1 F1: 0.4597
Class 2 F1: 0.0004
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7927
Class 1 Precision: 0.4978
Class 2 Precision: 0.0002
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8134
Class 1 Recall: 0.4271
Class 2 Recall: 0.0033
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7042
Macro F1 Score: 0.2526
xView2 Score: 0.2250
Epoch 8 took:  0 hours,  0 minutes, 26 seconds

Epoch 9/10
Train Loss: 1.2010
Confusion Matrix:
 [[3838758  788140   86597       0       0]
 [1032465  753921   41689       0       0]
 [   5353    3410      35       0       0]
 [   2006     275       0       0       0]
 [    839      99      13       0       0]]
Class 0 F1: 0.8003
Class 1 F1: 0.4469
Class 2 F1: 0.0005
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.7867
Class 1 Precision: 0.4877
Class 2 Precision: 0.0003
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.8144
Class 1 Recall: 0.4124
Class 2 Recall: 0.0040
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7008
Macro F1 Score: 0.2496
xView2 Score: 0.2183
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.1719
Confusion Matrix:
 [[3686897  949178   77420       0       0]
 [ 856776  933044   38255       0       0]
 [   4016    4657     125       0       0]
 [   2075     206       0       0       0]
 [    800     151       0       0       0]]
Class 0 F1: 0.7960
Class 1 F1: 0.5023
Class 2 F1: 0.0020
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8102
Class 1 Precision: 0.4944
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7822
Class 1 Recall: 0.5104
Class 2 Recall: 0.0142
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7050
Macro F1 Score: 0.2600
xView2 Score: 0.2476
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7050
Best Macro F1: 0.2600
Best xView2 Score: 0.2476
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.8102
Class 1 Precision: 0.4944
Class 2 Precision: 0.0011
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.2611
ROC curve saved to .././____________optune_results/203/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/203/plot_loss_curves.jpg
Prediction distribution: {0: 262144}
ROC curve saved to .././____________optune_results/203/visualize_predictions.jpg
Prediction distribution: {0: 248632, 1: 9130, 2: 4382}
ROC curve saved to .././____________optune_results/203/visualize_predictions.jpg
Prediction distribution: {0: 213386, 1: 48583, 2: 175}
ROC curve saved to .././____________optune_results/203/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/203/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/203/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
Class 0: 23,180,415 pixels (73.08%)
Class 1: 8,487,953 pixels (26.76%)
Class 2: 43,500 pixels (0.14%)
Class 3: 6,605 pixels (0.02%)
Class 4: 951 pixels (0.00%)
--------------------------------------------------
Model loaded on: cuda:0
[0 1 2 3 4]
{0: 0.27734642658021397, 1: 0.7213169184768028, 2: 139.74026320173246, 3: 1423.0039016115352, 4: 5292.497160883281}
Final class weights used in loss: [2.6822441602433478, 4.30572639731954, 467.23525862410634, 1423.0039016115352, 5292.497160883281]

Epoch 1/10
Train Loss: 1.6767
Confusion Matrix:
 [[ 121239  138392  546057 4177229   49924]
 [  27181   50185   76288 1347619    8936]
 [      8      90     309    7064      11]
 [      0       0      28    3040       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.0468
Class 1 F1: 0.0591
Class 2 F1: 0.0010
Class 3 F1: 0.0011
Class 4 F1: 0.0000
Class 0 Precision: 0.8168
Class 1 Precision: 0.2660
Class 2 Precision: 0.0005
Class 3 Precision: 0.0005
Class 4 Precision: 0.0000
Class 0 Recall: 0.0241
Class 1 Recall: 0.0332
Class 2 Recall: 0.0413
Class 3 Recall: 0.9909
Class 4 Recall: 0.0000
Validation Accuracy: 0.0267
Macro F1 Score: 0.0216
xView2 Score: 0.1237
Epoch 1 took:  0 hours,  1 minutes, 20 seconds

Epoch 2/10
Train Loss: 1.6173
Confusion Matrix:
 [[1169625  419165  620041 2784763   39247]
 [ 218055  241629   91952  949372    9201]
 [    989     581     235    5677       0]
 [      2       0     651    2415       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.3643
Class 1 F1: 0.2225
Class 2 F1: 0.0007
Class 3 F1: 0.0013
Class 4 F1: 0.0000
Class 0 Precision: 0.8423
Class 1 Precision: 0.3653
Class 2 Precision: 0.0003
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Class 0 Recall: 0.2324
Class 1 Recall: 0.1600
Class 2 Recall: 0.0314
Class 3 Recall: 0.7872
Class 4 Recall: 0.0000
Validation Accuracy: 0.2157
Macro F1 Score: 0.1178
xView2 Score: 0.1568
Epoch 2 took:  0 hours,  1 minutes, 23 seconds

Epoch 3/10
Train Loss: 1.5647
Confusion Matrix:
 [[2871307  679140  270001 1202636    9757]
 [ 534374  462706   63805  445748    3576]
 [   2243    2289     346    2604       0]
 [    366     369    1364     969       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.6803
Class 1 F1: 0.3486
Class 2 F1: 0.0020
Class 3 F1: 0.0012
Class 4 F1: 0.0000
Class 0 Precision: 0.8424
Class 1 Precision: 0.4043
Class 2 Precision: 0.0010
Class 3 Precision: 0.0006
Class 4 Precision: 0.0000
Class 0 Recall: 0.5705
Class 1 Recall: 0.3064
Class 2 Recall: 0.0462
Class 3 Recall: 0.3158
Class 4 Recall: 0.0000
Validation Accuracy: 0.5089
Macro F1 Score: 0.2064
xView2 Score: 0.1940
Epoch 3 took:  0 hours,  1 minutes, 19 seconds

Epoch 4/10
Train Loss: 1.5178
Confusion Matrix:
 [[3647611  967916  108753  307807     754]
 [ 617200  723435   34167  134891     516]
 [   3341    3148     126     867       0]
 [    639     633     614    1182       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7843
Class 1 F1: 0.4514
Class 2 F1: 0.0017
Class 3 F1: 0.0053
Class 4 F1: 0.0000
Class 0 Precision: 0.8545
Class 1 Precision: 0.4268
Class 2 Precision: 0.0009
Class 3 Precision: 0.0027
Class 4 Precision: 0.0000
Class 0 Recall: 0.7248
Class 1 Recall: 0.4790
Class 2 Recall: 0.0168
Class 3 Recall: 0.3853
Class 4 Recall: 0.0000
Validation Accuracy: 0.6672
Macro F1 Score: 0.2485
xView2 Score: 0.2356
Epoch 4 took:  0 hours,  1 minutes,  4 seconds

Epoch 5/10
Train Loss: 1.4647
Confusion Matrix:
 [[3714743 1241334   21159   55601       4]
 [ 545213  937911    7160   19923       2]
 [   3301    3893       0     288       0]
 [    907    2149       2      10       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.7991
Class 1 F1: 0.5076
Class 2 F1: 0.0000
Class 3 F1: 0.0003
Class 4 F1: 0.0000
Class 0 Precision: 0.8712
Class 1 Precision: 0.4292
Class 2 Precision: 0.0000
Class 3 Precision: 0.0001
Class 4 Precision: 0.0000
Class 0 Recall: 0.7381
Class 1 Recall: 0.6210
Class 2 Recall: 0.0000
Class 3 Recall: 0.0033
Class 4 Recall: 0.0000
Validation Accuracy: 0.7099
Macro F1 Score: 0.2614
xView2 Score: 0.2601
Epoch 5 took:  0 hours,  0 minutes, 34 seconds

Epoch 6/10
Train Loss: 1.4019
Confusion Matrix:
 [[3792948 1227172    5046    7675       0]
 [ 549445  954820    2203    3741       0]
 [   3259    4223       0       0       0]
 [    910    2108      11      39       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8088
Class 1 F1: 0.5163
Class 2 F1: 0.0000
Class 3 F1: 0.0054
Class 4 F1: 0.0000
Class 0 Precision: 0.8726
Class 1 Precision: 0.4363
Class 2 Precision: 0.0000
Class 3 Precision: 0.0034
Class 4 Precision: 0.0000
Class 0 Recall: 0.7536
Class 1 Recall: 0.6322
Class 2 Recall: 0.0000
Class 3 Recall: 0.0127
Class 4 Recall: 0.0000
Validation Accuracy: 0.7245
Macro F1 Score: 0.3326
xView2 Score: 0.2929
Epoch 6 took:  0 hours,  0 minutes, 27 seconds

Epoch 7/10
Train Loss: 1.3458
Confusion Matrix:
 [[3808828 1221530    1765     718       0]
 [ 473931 1035167     783     328       0]
 [   1481    6001       0       0       0]
 [    119    2949       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8176
Class 1 F1: 0.5483
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8890
Class 1 Precision: 0.4569
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7568
Class 1 Recall: 0.6854
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7391
Macro F1 Score: 0.3415
xView2 Score: 0.3073
Epoch 7 took:  0 hours,  0 minutes, 27 seconds

Epoch 8/10
Train Loss: 1.3010
Confusion Matrix:
 [[3975545 1056886     351      59       0]
 [ 599439  910552     208      10       0]
 [   3283    4199       0       0       0]
 [    870    2198       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8272
Class 1 F1: 0.5227
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.8682
Class 1 Precision: 0.4613
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7899
Class 1 Recall: 0.6029
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7456
Macro F1 Score: 0.3375
xView2 Score: 0.2887
Epoch 8 took:  0 hours,  0 minutes, 27 seconds

Epoch 9/10
Train Loss: 1.2581
Confusion Matrix:
 [[3722949 1309864      25       3       0]
 [ 403398 1106770      33       8       0]
 [   2487    4995       0       0       0]
 [      5    3063       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8127
Class 1 F1: 0.5625
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9017
Class 1 Precision: 0.4565
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7397
Class 1 Recall: 0.7329
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7370
Macro F1 Score: 0.3438
xView2 Score: 0.3171
Epoch 9 took:  0 hours,  0 minutes, 27 seconds

Epoch 10/10
Train Loss: 1.2068
Confusion Matrix:
 [[3685292 1347549       0       0       0]
 [ 388844 1121346      15       4       0]
 [   2652    4830       0       0       0]
 [      0    3068       0       0       0]
 [      0       0       0       0       0]]
Class 0 F1: 0.8091
Class 1 F1: 0.5625
Class 2 F1: 0.0000
Class 3 F1: 0.0000
Class 4 F1: 0.0000
Class 0 Precision: 0.9040
Class 1 Precision: 0.4527
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Class 0 Recall: 0.7322
Class 1 Recall: 0.7425
Class 2 Recall: 0.0000
Class 3 Recall: 0.0000
Class 4 Recall: 0.0000
Validation Accuracy: 0.7334
Macro F1 Score: 0.3429
xView2 Score: 0.3182
Epoch 10 took:  0 hours,  0 minutes, 27 seconds

=== FINAL EVALUATION ===
Best Accuracy: 0.7334
Best Macro F1: 0.3429
Best xView2 Score: 0.3182
=== FINAL PRECISION RESULTS ===
Class 0 Precision: 0.9040
Class 1 Precision: 0.4527
Class 2 Precision: 0.0000
Class 3 Precision: 0.0000
Class 4 Precision: 0.0000
Macro Precision: 0.3392
ROC curve saved to .././____________optune_results/204/plot_multiclass_roc.jpg
ROC curve saved to .././____________optune_results/204/plot_loss_curves.jpg
Prediction distribution: {0: 260916, 1: 1228}
ROC curve saved to .././____________optune_results/204/visualize_predictions.jpg
Prediction distribution: {0: 111700, 1: 150444}
ROC curve saved to .././____________optune_results/204/visualize_predictions.jpg
Prediction distribution: {0: 32792, 1: 229352}
ROC curve saved to .././____________optune_results/204/visualize_predictions.jpg
ROC curve saved to .././____________optune_results/204/plot_epoch_accuracy.jpg
ROC curve saved to .././____________optune_results/204/plot_epoch_f1.jpg
Training on cuda cores: True
Training with texture loss: True
Using device: cuda
Patches featuring class 4:
	('mexico-earthquake_00000059', 0, 0)
	('mexico-earthquake_00000142', 0, 0)
Dataset loaded
Analyzing class distribution
